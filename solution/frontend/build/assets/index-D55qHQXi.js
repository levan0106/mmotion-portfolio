var Wx=Object.defineProperty;var Fx=(r,t,n)=>t in r?Wx(r,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[t]=n;var zn=(r,t,n)=>Fx(r,typeof t!="symbol"?t+"":t,n);import{b as yo,d as zx,e as Ye,t as zu,j as e,T as Ae,I as un,f as Ue,B as l,g as Ie,C as zs,A as xt,h as Te,i as D,N as Ox,k as Fe,H as Vx,L as lt,l as Pe,m as ve,V as He,n as Bt,o as ce,u as Je,p as Nt,q as ut,r as $x,D as kt,s as Et,v as sr,w as Pt,x as Dt,y as Ce,S as Jt,z as ia,E as Xt,F as Tt,G as ci,J as at,K as it,M as ct,O as De,Q as S,R as ot,U as se,W as pa,X as me,Y as je,Z as an,$ as jn,a0 as oa,a1 as Gn,a2 as Mt,a3 as Gr,a4 as bt,a5 as re,a6 as tt,a7 as Vt,a8 as Ou,a9 as Os,aa as bo,ab as wr,ac as pt,ad as on,ae as Hx,af as di,ag as ui,ah as Dn,ai as ln,aj as ar,ak as Bx,al as Vi,am as Ux,an as _x,ao as Ti,ap as Al,aq as hc,ar as no,as as Yx,at as nt,au as st,av as Vu,aw as Ze,ax as U,ay as ed,c as Wn,_ as be,az as Ot,aA as Rn,aB as Kn,aC as Qn,aD as vt,aE as Hn,aF as Ps,aG as Xr,aH as td,aI as Vs,aJ as Rs,aK as qx,aL as et,aM as el,aN as Gx,aO as Cs,aP as ga,P as ge,aQ as Kx,aR as Qx,aS as $u,aT as mc,aU as Hu,aV as Bu,aW as jo,aX as W,aY as qr,aZ as mr,a_ as Zt,a$ as Ga,b0 as yr,b1 as qt,b2 as Tr,b3 as ht,b4 as Xx,b5 as Il,b6 as xc,b7 as Za,b8 as Ss,b9 as pc,ba as Jx,bb as Zx,bc as ep,bd as fa,be as Uu,bf as ss,bg as tp,bh as np,bi as rp,bj as Xe,bk as sp,bl as _u,bm as Rl,bn as ks,bo as Yu,bp as rn,bq as Sn,br as gc,bs as ei,bt as $n,bu as ro,bv as xs,bw as as,bx as ti,by as fc,bz as ds,bA as ya,bB as ap,bC as ip,bD as op,bE as ft,bF as Ir,bG as lp,bH as tl,bI as cp,bJ as ba,bK as dp,bL as Zn,bM as up,bN as Rr,bO as hp,bP as xn,bQ as yc,bR as qu,bS as mp,bT as xp,bU as pp,bV as $s,bW as Gu,bX as Ku,bY as vo,bZ as wo,b_ as la,b$ as Qu,c0 as $i,c1 as gp,c2 as fp,c3 as Xu,c4 as Ju,c5 as yp,c6 as Ml,c7 as ja,c8 as bp,c9 as Kr,ca as jp,cb as Nl,cc as vp,cd as Na,ce as wp,cf as hi,cg as Ll,ch as El,ci as Wl,cj as bc,ck as Ua,cl as qn,cm as Sp,cn as Tp,co as Cp,cp as va,cq as Dr,cr as _n,cs as Yn,ct as wa,cu as kp,cv as Pp,cw as Dp,cx as Ap,cy as Ip,cz as Rp,cA as Mp,cB as Np,cC as Lp,cD as Ep,cE as Wp,cF as Fp,cG as zp,cH as jc,cI as Fl,cJ as Op,cK as ni,cL as Zu,cM as Jn,cN as Vp,cO as $p,cP as Hp,cQ as nd,cR as eh,cS as Bp,cT as Up,cU as rd,cV as _p,cW as Yp,cX as nl,cY as qp,cZ as Gp,c_ as Kp,c$ as rl,d0 as sd,d1 as Qp,d2 as Xp,d3 as Jp,d4 as ad,d5 as Zp,d6 as eg}from"./mui-BYK74sV8.js";import{d as tg,g as th,r as p,b as rt}from"./vendor-Cr2nE3UY.js";import{u as An,a as Pa,b as So,c as vc,B as ng,R as rg,d as en,N as sg}from"./router-C_lmpfqF.js";import{u as yt,a as Kt,b as jt,Q as ag,c as ig}from"./query-CjMy13ca.js";import{o as og,r as lg,a as cg,c as mi,b as sn,d as Ka,u as xi,C as mn,e as dg}from"./forms-B2EMAUw_.js";import{R as Ln,C as nh,a as cr,X as dr,Y as er,L as ca,T as En,b as or,B as br,c as ri,d as To,P as Co,e as ko,f as Br,g as ys,S as ug,h as hg}from"./charts-CD7ZZACs.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var zl={},id=tg;zl.createRoot=id.createRoot,zl.hydrateRoot=id.hydrateRoot;var rh={exports:{}};rh.exports={ReactQueryDevtools:function(){return null},ReactQueryDevtoolsPanel:function(){return null}};var mg=rh.exports;const dt=r=>typeof r=="string",La=()=>{let r,t;const n=new Promise((s,a)=>{r=s,t=a});return n.resolve=r,n.reject=t,n},od=r=>r==null?"":""+r,xg=(r,t,n)=>{r.forEach(s=>{t[s]&&(n[s]=t[s])})},pg=/###/g,ld=r=>r&&r.indexOf("###")>-1?r.replace(pg,"."):r,cd=r=>!r||dt(r),Qa=(r,t,n)=>{const s=dt(t)?t.split("."):t;let a=0;for(;a<s.length-1;){if(cd(r))return{};const i=ld(s[a]);!r[i]&&n&&(r[i]=new n),Object.prototype.hasOwnProperty.call(r,i)?r=r[i]:r={},++a}return cd(r)?{}:{obj:r,k:ld(s[a])}},dd=(r,t,n)=>{const{obj:s,k:a}=Qa(r,t,Object);if(s!==void 0||t.length===1){s[a]=n;return}let i=t[t.length-1],o=t.slice(0,t.length-1),d=Qa(r,o,Object);for(;d.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),d=Qa(r,o,Object),d!=null&&d.obj&&typeof d.obj[`${d.k}.${i}`]<"u"&&(d.obj=void 0);d.obj[`${d.k}.${i}`]=n},gg=(r,t,n,s)=>{const{obj:a,k:i}=Qa(r,t,Object);a[i]=a[i]||[],a[i].push(n)},so=(r,t)=>{const{obj:n,k:s}=Qa(r,t);if(n&&Object.prototype.hasOwnProperty.call(n,s))return n[s]},fg=(r,t,n)=>{const s=so(r,n);return s!==void 0?s:so(t,n)},sh=(r,t,n)=>{for(const s in t)s!=="__proto__"&&s!=="constructor"&&(s in r?dt(r[s])||r[s]instanceof String||dt(t[s])||t[s]instanceof String?n&&(r[s]=t[s]):sh(r[s],t[s],n):r[s]=t[s]);return r},_s=r=>r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var yg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const bg=r=>dt(r)?r.replace(/[&<>"'\/]/g,t=>yg[t]):r;class jg{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const n=this.regExpMap.get(t);if(n!==void 0)return n;const s=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,s),this.regExpQueue.push(t),s}}const vg=[" ",",","?","!",";"],wg=new jg(20),Sg=(r,t,n)=>{t=t||"",n=n||"";const s=vg.filter(o=>t.indexOf(o)<0&&n.indexOf(o)<0);if(s.length===0)return!0;const a=wg.getRegExp(`(${s.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!a.test(r);if(!i){const o=r.indexOf(n);o>0&&!a.test(r.substring(0,o))&&(i=!0)}return i},Ol=(r,t,n=".")=>{if(!r)return;if(r[t])return Object.prototype.hasOwnProperty.call(r,t)?r[t]:void 0;const s=t.split(n);let a=r;for(let i=0;i<s.length;){if(!a||typeof a!="object")return;let o,d="";for(let u=i;u<s.length;++u)if(u!==i&&(d+=n),d+=s[u],o=a[d],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&u<s.length-1)continue;i+=u-i+1;break}a=o}return a},si=r=>r==null?void 0:r.replace("_","-"),Tg={type:"logger",log(r){this.output("log",r)},warn(r){this.output("warn",r)},error(r){this.output("error",r)},output(r,t){var n,s;(s=(n=console==null?void 0:console[r])==null?void 0:n.apply)==null||s.call(n,console,t)}};class ao{constructor(t,n={}){this.init(t,n)}init(t,n={}){this.prefix=n.prefix||"i18next:",this.logger=t||Tg,this.options=n,this.debug=n.debug}log(...t){return this.forward(t,"log","",!0)}warn(...t){return this.forward(t,"warn","",!0)}error(...t){return this.forward(t,"error","")}deprecate(...t){return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(t,n,s,a){return a&&!this.debug?null:(dt(t[0])&&(t[0]=`${s}${this.prefix} ${t[0]}`),this.logger[n](t))}create(t){return new ao(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new ao(this.logger,t)}}var Ur=new ao;class Po{constructor(){this.observers={}}on(t,n){return t.split(" ").forEach(s=>{this.observers[s]||(this.observers[s]=new Map);const a=this.observers[s].get(n)||0;this.observers[s].set(n,a+1)}),this}off(t,n){if(this.observers[t]){if(!n){delete this.observers[t];return}this.observers[t].delete(n)}}emit(t,...n){this.observers[t]&&Array.from(this.observers[t].entries()).forEach(([a,i])=>{for(let o=0;o<i;o++)a(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([a,i])=>{for(let o=0;o<i;o++)a.apply(a,[t,...n])})}}class ud extends Po{constructor(t,n={ns:["translation"],defaultNS:"translation"}){super(),this.data=t||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const n=this.options.ns.indexOf(t);n>-1&&this.options.ns.splice(n,1)}getResource(t,n,s,a={}){var h,m;const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,o=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let d;t.indexOf(".")>-1?d=t.split("."):(d=[t,n],s&&(Array.isArray(s)?d.push(...s):dt(s)&&i?d.push(...s.split(i)):d.push(s)));const u=so(this.data,d);return!u&&!n&&!s&&t.indexOf(".")>-1&&(t=d[0],n=d[1],s=d.slice(2).join(".")),u||!o||!dt(s)?u:Ol((m=(h=this.data)==null?void 0:h[t])==null?void 0:m[n],s,i)}addResource(t,n,s,a,i={silent:!1}){const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let d=[t,n];s&&(d=d.concat(o?s.split(o):s)),t.indexOf(".")>-1&&(d=t.split("."),a=n,n=d[1]),this.addNamespaces(n),dd(this.data,d,a),i.silent||this.emit("added",t,n,s,a)}addResources(t,n,s,a={silent:!1}){for(const i in s)(dt(s[i])||Array.isArray(s[i]))&&this.addResource(t,n,i,s[i],{silent:!0});a.silent||this.emit("added",t,n,s)}addResourceBundle(t,n,s,a,i,o={silent:!1,skipCopy:!1}){let d=[t,n];t.indexOf(".")>-1&&(d=t.split("."),a=s,s=n,n=d[1]),this.addNamespaces(n);let u=so(this.data,d)||{};o.skipCopy||(s=JSON.parse(JSON.stringify(s))),a?sh(u,s,i):u={...u,...s},dd(this.data,d,u),o.silent||this.emit("added",t,n,s)}removeResourceBundle(t,n){this.hasResourceBundle(t,n)&&delete this.data[t][n],this.removeNamespaces(n),this.emit("removed",t,n)}hasResourceBundle(t,n){return this.getResource(t,n)!==void 0}getResourceBundle(t,n){return n||(n=this.options.defaultNS),this.getResource(t,n)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const n=this.getDataByLanguage(t);return!!(n&&Object.keys(n)||[]).find(a=>n[a]&&Object.keys(n[a]).length>0)}toJSON(){return this.data}}var ah={processors:{},addPostProcessor(r){this.processors[r.name]=r},handle(r,t,n,s,a){return r.forEach(i=>{var o;t=((o=this.processors[i])==null?void 0:o.process(t,n,s,a))??t}),t}};const ih=Symbol("i18next/PATH_KEY");function Cg(){const r=[],t=Object.create(null);let n;return t.get=(s,a)=>{var i;return(i=n==null?void 0:n.revoke)==null||i.call(n),a===ih?r:(r.push(a),n=Proxy.revocable(s,t),n.proxy)},Proxy.revocable(Object.create(null),t).proxy}function io(r,t){const{[ih]:n}=r(Cg());return n.join((t==null?void 0:t.keySeparator)??".")}const hd={},sl=r=>!dt(r)&&typeof r!="boolean"&&typeof r!="number";class oo extends Po{constructor(t,n={}){super(),xg(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Ur.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t,n={interpolation:{}}){const s={...n};if(t==null)return!1;const a=this.resolve(t,s);if((a==null?void 0:a.res)===void 0)return!1;const i=sl(a.res);return!(s.returnObjects===!1&&i)}extractFromKey(t,n){let s=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;s===void 0&&(s=":");const a=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let i=n.ns||this.options.defaultNS||[];const o=s&&t.indexOf(s)>-1,d=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!Sg(t,s,a);if(o&&!d){const u=t.match(this.interpolator.nestingRegexp);if(u&&u.length>0)return{key:t,namespaces:dt(i)?[i]:i};const h=t.split(s);(s!==a||s===a&&this.options.ns.indexOf(h[0])>-1)&&(i=h.shift()),t=h.join(a)}return{key:t,namespaces:dt(i)?[i]:i}}translate(t,n,s){let a=typeof n=="object"?{...n}:n;if(typeof a!="object"&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),typeof a=="object"&&(a={...a}),a||(a={}),t==null)return"";typeof t=="function"&&(t=io(t,{...this.options,...a})),Array.isArray(t)||(t=[String(t)]);const i=a.returnDetails!==void 0?a.returnDetails:this.options.returnDetails,o=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,{key:d,namespaces:u}=this.extractFromKey(t[t.length-1],a),h=u[u.length-1];let m=a.nsSeparator!==void 0?a.nsSeparator:this.options.nsSeparator;m===void 0&&(m=":");const x=a.lng||this.language,g=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((x==null?void 0:x.toLowerCase())==="cimode")return g?i?{res:`${h}${m}${d}`,usedKey:d,exactUsedKey:d,usedLng:x,usedNS:h,usedParams:this.getUsedParamsDetails(a)}:`${h}${m}${d}`:i?{res:d,usedKey:d,exactUsedKey:d,usedLng:x,usedNS:h,usedParams:this.getUsedParamsDetails(a)}:d;const f=this.resolve(t,a);let y=f==null?void 0:f.res;const j=(f==null?void 0:f.usedKey)||d,b=(f==null?void 0:f.exactUsedKey)||d,v=["[object Number]","[object Function]","[object RegExp]"],P=a.joinArrays!==void 0?a.joinArrays:this.options.joinArrays,w=!this.i18nFormat||this.i18nFormat.handleAsObject,C=a.count!==void 0&&!dt(a.count),k=oo.hasDefaultValue(a),A=C?this.pluralResolver.getSuffix(x,a.count,a):"",L=a.ordinal&&C?this.pluralResolver.getSuffix(x,a.count,{ordinal:!1}):"",T=C&&!a.ordinal&&a.count===0,M=T&&a[`defaultValue${this.options.pluralSeparator}zero`]||a[`defaultValue${A}`]||a[`defaultValue${L}`]||a.defaultValue;let O=y;w&&!y&&k&&(O=M);const I=sl(O),z=Object.prototype.toString.apply(O);if(w&&O&&I&&v.indexOf(z)<0&&!(dt(P)&&Array.isArray(O))){if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const N=this.options.returnedObjectHandler?this.options.returnedObjectHandler(j,O,{...a,ns:u}):`key '${d} (${this.language})' returned an object instead of string.`;return i?(f.res=N,f.usedParams=this.getUsedParamsDetails(a),f):N}if(o){const N=Array.isArray(O),E=N?[]:{},R=N?b:j;for(const V in O)if(Object.prototype.hasOwnProperty.call(O,V)){const F=`${R}${o}${V}`;k&&!y?E[V]=this.translate(F,{...a,defaultValue:sl(M)?M[V]:void 0,joinArrays:!1,ns:u}):E[V]=this.translate(F,{...a,joinArrays:!1,ns:u}),E[V]===F&&(E[V]=O[V])}y=E}}else if(w&&dt(P)&&Array.isArray(y))y=y.join(P),y&&(y=this.extendTranslation(y,t,a,s));else{let N=!1,E=!1;!this.isValidLookup(y)&&k&&(N=!0,y=M),this.isValidLookup(y)||(E=!0,y=d);const V=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&E?void 0:y,F=k&&M!==y&&this.options.updateMissing;if(E||N||F){if(this.logger.log(F?"updateKey":"missingKey",x,h,d,F?M:y),o){const _=this.resolve(d,{...a,keySeparator:!1});_&&_.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let B=[];const $=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if(this.options.saveMissingTo==="fallback"&&$&&$[0])for(let _=0;_<$.length;_++)B.push($[_]);else this.options.saveMissingTo==="all"?B=this.languageUtils.toResolveHierarchy(a.lng||this.language):B.push(a.lng||this.language);const Y=(_,K,X)=>{var oe;const ne=k&&X!==y?X:V;this.options.missingKeyHandler?this.options.missingKeyHandler(_,h,K,ne,F,a):(oe=this.backendConnector)!=null&&oe.saveMissing&&this.backendConnector.saveMissing(_,h,K,ne,F,a),this.emit("missingKey",_,h,K,y)};this.options.saveMissing&&(this.options.saveMissingPlurals&&C?B.forEach(_=>{const K=this.pluralResolver.getSuffixes(_,a);T&&a[`defaultValue${this.options.pluralSeparator}zero`]&&K.indexOf(`${this.options.pluralSeparator}zero`)<0&&K.push(`${this.options.pluralSeparator}zero`),K.forEach(X=>{Y([_],d+X,a[`defaultValue${X}`]||M)})}):Y(B,d,M))}y=this.extendTranslation(y,t,a,f,s),E&&y===d&&this.options.appendNamespaceToMissingKey&&(y=`${h}${m}${d}`),(E||N)&&this.options.parseMissingKeyHandler&&(y=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${h}${m}${d}`:d,N?y:void 0,a))}return i?(f.res=y,f.usedParams=this.getUsedParamsDetails(a),f):y}extendTranslation(t,n,s,a,i){var u,h;if((u=this.i18nFormat)!=null&&u.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...s},s.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!s.skipInterpolation){s.interpolation&&this.interpolator.init({...s,interpolation:{...this.options.interpolation,...s.interpolation}});const m=dt(t)&&(((h=s==null?void 0:s.interpolation)==null?void 0:h.skipOnVariables)!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let x;if(m){const f=t.match(this.interpolator.nestingRegexp);x=f&&f.length}let g=s.replace&&!dt(s.replace)?s.replace:s;if(this.options.interpolation.defaultVariables&&(g={...this.options.interpolation.defaultVariables,...g}),t=this.interpolator.interpolate(t,g,s.lng||this.language||a.usedLng,s),m){const f=t.match(this.interpolator.nestingRegexp),y=f&&f.length;x<y&&(s.nest=!1)}!s.lng&&a&&a.res&&(s.lng=this.language||a.usedLng),s.nest!==!1&&(t=this.interpolator.nest(t,(...f)=>(i==null?void 0:i[0])===f[0]&&!s.context?(this.logger.warn(`It seems you are nesting recursively key: ${f[0]} in key: ${n[0]}`),null):this.translate(...f,n),s)),s.interpolation&&this.interpolator.reset()}const o=s.postProcess||this.options.postProcess,d=dt(o)?[o]:o;return t!=null&&(d!=null&&d.length)&&s.applyPostProcessor!==!1&&(t=ah.handle(d,t,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(s)},...s}:s,this)),t}resolve(t,n={}){let s,a,i,o,d;return dt(t)&&(t=[t]),t.forEach(u=>{if(this.isValidLookup(s))return;const h=this.extractFromKey(u,n),m=h.key;a=m;let x=h.namespaces;this.options.fallbackNS&&(x=x.concat(this.options.fallbackNS));const g=n.count!==void 0&&!dt(n.count),f=g&&!n.ordinal&&n.count===0,y=n.context!==void 0&&(dt(n.context)||typeof n.context=="number")&&n.context!=="",j=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);x.forEach(b=>{var v,P;this.isValidLookup(s)||(d=b,!hd[`${j[0]}-${b}`]&&((v=this.utils)!=null&&v.hasLoadedNamespace)&&!((P=this.utils)!=null&&P.hasLoadedNamespace(d))&&(hd[`${j[0]}-${b}`]=!0,this.logger.warn(`key "${a}" for languages "${j.join(", ")}" won't get resolved as namespace "${d}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),j.forEach(w=>{var A;if(this.isValidLookup(s))return;o=w;const C=[m];if((A=this.i18nFormat)!=null&&A.addLookupKeys)this.i18nFormat.addLookupKeys(C,m,w,b,n);else{let L;g&&(L=this.pluralResolver.getSuffix(w,n.count,n));const T=`${this.options.pluralSeparator}zero`,M=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(g&&(n.ordinal&&L.indexOf(M)===0&&C.push(m+L.replace(M,this.options.pluralSeparator)),C.push(m+L),f&&C.push(m+T)),y){const O=`${m}${this.options.contextSeparator||"_"}${n.context}`;C.push(O),g&&(n.ordinal&&L.indexOf(M)===0&&C.push(O+L.replace(M,this.options.pluralSeparator)),C.push(O+L),f&&C.push(O+T))}}let k;for(;k=C.pop();)this.isValidLookup(s)||(i=k,s=this.getResource(w,b,k,n))}))})}),{res:s,usedKey:a,exactUsedKey:i,usedLng:o,usedNS:d}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,n,s,a={}){var i;return(i=this.i18nFormat)!=null&&i.getResource?this.i18nFormat.getResource(t,n,s,a):this.resourceStore.getResource(t,n,s,a)}getUsedParamsDetails(t={}){const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],s=t.replace&&!dt(t.replace);let a=s?t.replace:t;if(s&&typeof t.count<"u"&&(a.count=t.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!s){a={...a};for(const i of n)delete a[i]}return a}static hasDefaultValue(t){const n="defaultValue";for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&n===s.substring(0,n.length)&&t[s]!==void 0)return!0;return!1}}class md{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Ur.create("languageUtils")}getScriptPartFromCode(t){if(t=si(t),!t||t.indexOf("-")<0)return null;const n=t.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(t){if(t=si(t),!t||t.indexOf("-")<0)return t;const n=t.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(t){if(dt(t)&&t.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(t)[0]}catch{}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let n;return t.forEach(s=>{if(n)return;const a=this.formatLanguageCode(s);(!this.options.supportedLngs||this.isSupportedCode(a))&&(n=a)}),!n&&this.options.supportedLngs&&t.forEach(s=>{if(n)return;const a=this.getScriptPartFromCode(s);if(this.isSupportedCode(a))return n=a;const i=this.getLanguagePartFromCode(s);if(this.isSupportedCode(i))return n=i;n=this.options.supportedLngs.find(o=>{if(o===i)return o;if(!(o.indexOf("-")<0&&i.indexOf("-")<0)&&(o.indexOf("-")>0&&i.indexOf("-")<0&&o.substring(0,o.indexOf("-"))===i||o.indexOf(i)===0&&i.length>1))return o})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(t,n){if(!t)return[];if(typeof t=="function"&&(t=t(n)),dt(t)&&(t=[t]),Array.isArray(t))return t;if(!n)return t.default||[];let s=t[n];return s||(s=t[this.getScriptPartFromCode(n)]),s||(s=t[this.formatLanguageCode(n)]),s||(s=t[this.getLanguagePartFromCode(n)]),s||(s=t.default),s||[]}toResolveHierarchy(t,n){const s=this.getFallbackCodes((n===!1?[]:n)||this.options.fallbackLng||[],t),a=[],i=o=>{o&&(this.isSupportedCode(o)?a.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return dt(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(t))):dt(t)&&i(this.formatLanguageCode(t)),s.forEach(o=>{a.indexOf(o)<0&&i(this.formatLanguageCode(o))}),a}}const xd={zero:0,one:1,two:2,few:3,many:4,other:5},pd={select:r=>r===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class kg{constructor(t,n={}){this.languageUtils=t,this.options=n,this.logger=Ur.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,n){this.rules[t]=n}clearCache(){this.pluralRulesCache={}}getRule(t,n={}){const s=si(t==="dev"?"en":t),a=n.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:s,type:a});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let o;try{o=new Intl.PluralRules(s,{type:a})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),pd;if(!t.match(/-|_/))return pd;const u=this.languageUtils.getLanguagePartFromCode(t);o=this.getRule(u,n)}return this.pluralRulesCache[i]=o,o}needsPlural(t,n={}){let s=this.getRule(t,n);return s||(s=this.getRule("dev",n)),(s==null?void 0:s.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(t,n,s={}){return this.getSuffixes(t,s).map(a=>`${n}${a}`)}getSuffixes(t,n={}){let s=this.getRule(t,n);return s||(s=this.getRule("dev",n)),s?s.resolvedOptions().pluralCategories.sort((a,i)=>xd[a]-xd[i]).map(a=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${a}`):[]}getSuffix(t,n,s={}){const a=this.getRule(t,s);return a?`${this.options.prepend}${s.ordinal?`ordinal${this.options.prepend}`:""}${a.select(n)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",n,s))}}const gd=(r,t,n,s=".",a=!0)=>{let i=fg(r,t,n);return!i&&a&&dt(n)&&(i=Ol(r,n,s),i===void 0&&(i=Ol(t,n,s))),i},al=r=>r.replace(/\$/g,"$$$$");class Pg{constructor(t={}){var n;this.logger=Ur.create("interpolator"),this.options=t,this.format=((n=t==null?void 0:t.interpolation)==null?void 0:n.format)||(s=>s),this.init(t)}init(t={}){t.interpolation||(t.interpolation={escapeValue:!0});const{escape:n,escapeValue:s,useRawValueToEscape:a,prefix:i,prefixEscaped:o,suffix:d,suffixEscaped:u,formatSeparator:h,unescapeSuffix:m,unescapePrefix:x,nestingPrefix:g,nestingPrefixEscaped:f,nestingSuffix:y,nestingSuffixEscaped:j,nestingOptionsSeparator:b,maxReplaces:v,alwaysFormat:P}=t.interpolation;this.escape=n!==void 0?n:bg,this.escapeValue=s!==void 0?s:!0,this.useRawValueToEscape=a!==void 0?a:!1,this.prefix=i?_s(i):o||"{{",this.suffix=d?_s(d):u||"}}",this.formatSeparator=h||",",this.unescapePrefix=m?"":x||"-",this.unescapeSuffix=this.unescapePrefix?"":m||"",this.nestingPrefix=g?_s(g):f||_s("$t("),this.nestingSuffix=y?_s(y):j||_s(")"),this.nestingOptionsSeparator=b||",",this.maxReplaces=v||1e3,this.alwaysFormat=P!==void 0?P:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(n,s)=>(n==null?void 0:n.source)===s?(n.lastIndex=0,n):new RegExp(s,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(t,n,s,a){var f;let i,o,d;const u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},h=y=>{if(y.indexOf(this.formatSeparator)<0){const P=gd(n,u,y,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(P,void 0,s,{...a,...n,interpolationkey:y}):P}const j=y.split(this.formatSeparator),b=j.shift().trim(),v=j.join(this.formatSeparator).trim();return this.format(gd(n,u,b,this.options.keySeparator,this.options.ignoreJSONStructure),v,s,{...a,...n,interpolationkey:b})};this.resetRegExp();const m=(a==null?void 0:a.missingInterpolationHandler)||this.options.missingInterpolationHandler,x=((f=a==null?void 0:a.interpolation)==null?void 0:f.skipOnVariables)!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:y=>al(y)},{regex:this.regexp,safeValue:y=>this.escapeValue?al(this.escape(y)):al(y)}].forEach(y=>{for(d=0;i=y.regex.exec(t);){const j=i[1].trim();if(o=h(j),o===void 0)if(typeof m=="function"){const v=m(t,i,a);o=dt(v)?v:""}else if(a&&Object.prototype.hasOwnProperty.call(a,j))o="";else if(x){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${j} for interpolating ${t}`),o="";else!dt(o)&&!this.useRawValueToEscape&&(o=od(o));const b=y.safeValue(o);if(t=t.replace(i[0],b),x?(y.regex.lastIndex+=o.length,y.regex.lastIndex-=i[0].length):y.regex.lastIndex=0,d++,d>=this.maxReplaces)break}}),t}nest(t,n,s={}){let a,i,o;const d=(u,h)=>{const m=this.nestingOptionsSeparator;if(u.indexOf(m)<0)return u;const x=u.split(new RegExp(`${m}[ ]*{`));let g=`{${x[1]}`;u=x[0],g=this.interpolate(g,o);const f=g.match(/'/g),y=g.match(/"/g);(((f==null?void 0:f.length)??0)%2===0&&!y||y.length%2!==0)&&(g=g.replace(/'/g,'"'));try{o=JSON.parse(g),h&&(o={...h,...o})}catch(j){return this.logger.warn(`failed parsing options string in nesting for key ${u}`,j),`${u}${m}${g}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,u};for(;a=this.nestingRegexp.exec(t);){let u=[];o={...s},o=o.replace&&!dt(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;const h=/{.*}/.test(a[1])?a[1].lastIndexOf("}")+1:a[1].indexOf(this.formatSeparator);if(h!==-1&&(u=a[1].slice(h).split(this.formatSeparator).map(m=>m.trim()).filter(Boolean),a[1]=a[1].slice(0,h)),i=n(d.call(this,a[1].trim(),o),o),i&&a[0]===t&&!dt(i))return i;dt(i)||(i=od(i)),i||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${t}`),i=""),u.length&&(i=u.reduce((m,x)=>this.format(m,x,s.lng,{...s,interpolationkey:a[1].trim()}),i.trim())),t=t.replace(a[0],i),this.regexp.lastIndex=0}return t}}const Dg=r=>{let t=r.toLowerCase().trim();const n={};if(r.indexOf("(")>-1){const s=r.split("(");t=s[0].toLowerCase().trim();const a=s[1].substring(0,s[1].length-1);t==="currency"&&a.indexOf(":")<0?n.currency||(n.currency=a.trim()):t==="relativetime"&&a.indexOf(":")<0?n.range||(n.range=a.trim()):a.split(";").forEach(o=>{if(o){const[d,...u]=o.split(":"),h=u.join(":").trim().replace(/^'+|'+$/g,""),m=d.trim();n[m]||(n[m]=h),h==="false"&&(n[m]=!1),h==="true"&&(n[m]=!0),isNaN(h)||(n[m]=parseInt(h,10))}})}return{formatName:t,formatOptions:n}},fd=r=>{const t={};return(n,s,a)=>{let i=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(i={...i,[a.interpolationkey]:void 0});const o=s+JSON.stringify(i);let d=t[o];return d||(d=r(si(s),a),t[o]=d),d(n)}},Ag=r=>(t,n,s)=>r(si(n),s)(t);class Ig{constructor(t={}){this.logger=Ur.create("formatter"),this.options=t,this.init(t)}init(t,n={interpolation:{}}){this.formatSeparator=n.interpolation.formatSeparator||",";const s=n.cacheInBuiltFormats?fd:Ag;this.formats={number:s((a,i)=>{const o=new Intl.NumberFormat(a,{...i});return d=>o.format(d)}),currency:s((a,i)=>{const o=new Intl.NumberFormat(a,{...i,style:"currency"});return d=>o.format(d)}),datetime:s((a,i)=>{const o=new Intl.DateTimeFormat(a,{...i});return d=>o.format(d)}),relativetime:s((a,i)=>{const o=new Intl.RelativeTimeFormat(a,{...i});return d=>o.format(d,i.range||"day")}),list:s((a,i)=>{const o=new Intl.ListFormat(a,{...i});return d=>o.format(d)})}}add(t,n){this.formats[t.toLowerCase().trim()]=n}addCached(t,n){this.formats[t.toLowerCase().trim()]=fd(n)}format(t,n,s,a={}){const i=n.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(d=>d.indexOf(")")>-1)){const d=i.findIndex(u=>u.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,d)].join(this.formatSeparator)}return i.reduce((d,u)=>{var x;const{formatName:h,formatOptions:m}=Dg(u);if(this.formats[h]){let g=d;try{const f=((x=a==null?void 0:a.formatParams)==null?void 0:x[a.interpolationkey])||{},y=f.locale||f.lng||a.locale||a.lng||s;g=this.formats[h](d,y,{...m,...a,...f})}catch(f){this.logger.warn(f)}return g}else this.logger.warn(`there was no format function for ${h}`);return d},t)}}const Rg=(r,t)=>{r.pending[t]!==void 0&&(delete r.pending[t],r.pendingCount--)};class Mg extends Po{constructor(t,n,s,a={}){var i,o;super(),this.backend=t,this.store=n,this.services=s,this.languageUtils=s.languageUtils,this.options=a,this.logger=Ur.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],(o=(i=this.backend)==null?void 0:i.init)==null||o.call(i,s,a.backend,a)}queueLoad(t,n,s,a){const i={},o={},d={},u={};return t.forEach(h=>{let m=!0;n.forEach(x=>{const g=`${h}|${x}`;!s.reload&&this.store.hasResourceBundle(h,x)?this.state[g]=2:this.state[g]<0||(this.state[g]===1?o[g]===void 0&&(o[g]=!0):(this.state[g]=1,m=!1,o[g]===void 0&&(o[g]=!0),i[g]===void 0&&(i[g]=!0),u[x]===void 0&&(u[x]=!0)))}),m||(d[h]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(d),toLoadNamespaces:Object.keys(u)}}loaded(t,n,s){const a=t.split("|"),i=a[0],o=a[1];n&&this.emit("failedLoading",i,o,n),!n&&s&&this.store.addResourceBundle(i,o,s,void 0,void 0,{skipCopy:!0}),this.state[t]=n?-1:2,n&&s&&(this.state[t]=0);const d={};this.queue.forEach(u=>{gg(u.loaded,[i],o),Rg(u,t),n&&u.errors.push(n),u.pendingCount===0&&!u.done&&(Object.keys(u.loaded).forEach(h=>{d[h]||(d[h]={});const m=u.loaded[h];m.length&&m.forEach(x=>{d[h][x]===void 0&&(d[h][x]=!0)})}),u.done=!0,u.errors.length?u.callback(u.errors):u.callback())}),this.emit("loaded",d),this.queue=this.queue.filter(u=>!u.done)}read(t,n,s,a=0,i=this.retryTimeout,o){if(!t.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:n,fcName:s,tried:a,wait:i,callback:o});return}this.readingCalls++;const d=(h,m)=>{if(this.readingCalls--,this.waitingReads.length>0){const x=this.waitingReads.shift();this.read(x.lng,x.ns,x.fcName,x.tried,x.wait,x.callback)}if(h&&m&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,t,n,s,a+1,i*2,o)},i);return}o(h,m)},u=this.backend[s].bind(this.backend);if(u.length===2){try{const h=u(t,n);h&&typeof h.then=="function"?h.then(m=>d(null,m)).catch(d):d(null,h)}catch(h){d(h)}return}return u(t,n,d)}prepareLoading(t,n,s={},a){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();dt(t)&&(t=this.languageUtils.toResolveHierarchy(t)),dt(n)&&(n=[n]);const i=this.queueLoad(t,n,s,a);if(!i.toLoad.length)return i.pending.length||a(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(t,n,s){this.prepareLoading(t,n,{},s)}reload(t,n,s){this.prepareLoading(t,n,{reload:!0},s)}loadOne(t,n=""){const s=t.split("|"),a=s[0],i=s[1];this.read(a,i,"read",void 0,void 0,(o,d)=>{o&&this.logger.warn(`${n}loading namespace ${i} for language ${a} failed`,o),!o&&d&&this.logger.log(`${n}loaded namespace ${i} for language ${a}`,d),this.loaded(t,o,d)})}saveMissing(t,n,s,a,i,o={},d=()=>{}){var u,h,m,x,g;if((h=(u=this.services)==null?void 0:u.utils)!=null&&h.hasLoadedNamespace&&!((x=(m=this.services)==null?void 0:m.utils)!=null&&x.hasLoadedNamespace(n))){this.logger.warn(`did not save key "${s}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(s==null||s==="")){if((g=this.backend)!=null&&g.create){const f={...o,isUpdate:i},y=this.backend.create.bind(this.backend);if(y.length<6)try{let j;y.length===5?j=y(t,n,s,a,f):j=y(t,n,s,a),j&&typeof j.then=="function"?j.then(b=>d(null,b)).catch(d):d(null,j)}catch(j){d(j)}else y(t,n,s,a,d,f)}!t||!t[0]||this.store.addResource(t[0],n,s,a)}}}const yd=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:r=>{let t={};if(typeof r[1]=="object"&&(t=r[1]),dt(r[1])&&(t.defaultValue=r[1]),dt(r[2])&&(t.tDescription=r[2]),typeof r[2]=="object"||typeof r[3]=="object"){const n=r[3]||r[2];Object.keys(n).forEach(s=>{t[s]=n[s]})}return t},interpolation:{escapeValue:!0,format:r=>r,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),bd=r=>{var t,n;return dt(r.ns)&&(r.ns=[r.ns]),dt(r.fallbackLng)&&(r.fallbackLng=[r.fallbackLng]),dt(r.fallbackNS)&&(r.fallbackNS=[r.fallbackNS]),((n=(t=r.supportedLngs)==null?void 0:t.indexOf)==null?void 0:n.call(t,"cimode"))<0&&(r.supportedLngs=r.supportedLngs.concat(["cimode"])),typeof r.initImmediate=="boolean"&&(r.initAsync=r.initImmediate),r},Ci=()=>{},Ng=r=>{Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach(n=>{typeof r[n]=="function"&&(r[n]=r[n].bind(r))})};class ai extends Po{constructor(t={},n){if(super(),this.options=bd(t),this.services={},this.logger=Ur,this.modules={external:[]},Ng(this),n&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,n),this;setTimeout(()=>{this.init(t,n)},0)}}init(t={},n){this.isInitializing=!0,typeof t=="function"&&(n=t,t={}),t.defaultNS==null&&t.ns&&(dt(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const s=yd();this.options={...s,...this.options,...bd(t)},this.options.interpolation={...s.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const a=h=>h?typeof h=="function"?new h:h:null;if(!this.options.isClone){this.modules.logger?Ur.init(a(this.modules.logger),this.options):Ur.init(null,this.options);let h;this.modules.formatter?h=this.modules.formatter:h=Ig;const m=new md(this.options);this.store=new ud(this.options.resources,this.options);const x=this.services;x.logger=Ur,x.resourceStore=this.store,x.languageUtils=m,x.pluralResolver=new kg(m,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==s.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),h&&(!this.options.interpolation.format||this.options.interpolation.format===s.interpolation.format)&&(x.formatter=a(h),x.formatter.init&&x.formatter.init(x,this.options),this.options.interpolation.format=x.formatter.format.bind(x.formatter)),x.interpolator=new Pg(this.options),x.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},x.backendConnector=new Mg(a(this.modules.backend),x.resourceStore,x,this.options),x.backendConnector.on("*",(f,...y)=>{this.emit(f,...y)}),this.modules.languageDetector&&(x.languageDetector=a(this.modules.languageDetector),x.languageDetector.init&&x.languageDetector.init(x,this.options.detection,this.options)),this.modules.i18nFormat&&(x.i18nFormat=a(this.modules.i18nFormat),x.i18nFormat.init&&x.i18nFormat.init(this)),this.translator=new oo(this.services,this.options),this.translator.on("*",(f,...y)=>{this.emit(f,...y)}),this.modules.external.forEach(f=>{f.init&&f.init(this)})}if(this.format=this.options.interpolation.format,n||(n=Ci),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const h=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);h.length>0&&h[0]!=="dev"&&(this.options.lng=h[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(h=>{this[h]=(...m)=>this.store[h](...m)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(h=>{this[h]=(...m)=>(this.store[h](...m),this)});const d=La(),u=()=>{const h=(m,x)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),d.resolve(x),n(m,x)};if(this.languages&&!this.isInitialized)return h(null,this.t.bind(this));this.changeLanguage(this.options.lng,h)};return this.options.resources||!this.options.initAsync?u():setTimeout(u,0),d}loadResources(t,n=Ci){var i,o;let s=n;const a=dt(t)?t:this.language;if(typeof t=="function"&&(s=t),!this.options.resources||this.options.partialBundledLanguages){if((a==null?void 0:a.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return s();const d=[],u=h=>{if(!h||h==="cimode")return;this.services.languageUtils.toResolveHierarchy(h).forEach(x=>{x!=="cimode"&&d.indexOf(x)<0&&d.push(x)})};a?u(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(m=>u(m)),(o=(i=this.options.preload)==null?void 0:i.forEach)==null||o.call(i,h=>u(h)),this.services.backendConnector.load(d,this.options.ns,h=>{!h&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),s(h)})}else s(null)}reloadResources(t,n,s){const a=La();return typeof t=="function"&&(s=t,t=void 0),typeof n=="function"&&(s=n,n=void 0),t||(t=this.languages),n||(n=this.options.ns),s||(s=Ci),this.services.backendConnector.reload(t,n,i=>{a.resolve(),s(i)}),a}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&ah.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1)){for(let n=0;n<this.languages.length;n++){const s=this.languages[n];if(!(["cimode","dev"].indexOf(s)>-1)&&this.store.hasLanguageSomeTranslations(s)){this.resolvedLanguage=s;break}}!this.resolvedLanguage&&this.languages.indexOf(t)<0&&this.store.hasLanguageSomeTranslations(t)&&(this.resolvedLanguage=t,this.languages.unshift(t))}}changeLanguage(t,n){this.isLanguageChangingTo=t;const s=La();this.emit("languageChanging",t);const a=d=>{this.language=d,this.languages=this.services.languageUtils.toResolveHierarchy(d),this.resolvedLanguage=void 0,this.setResolvedLanguage(d)},i=(d,u)=>{u?this.isLanguageChangingTo===t&&(a(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,s.resolve((...h)=>this.t(...h)),n&&n(d,(...h)=>this.t(...h))},o=d=>{var m,x;!t&&!d&&this.services.languageDetector&&(d=[]);const u=dt(d)?d:d&&d[0],h=this.store.hasLanguageSomeTranslations(u)?u:this.services.languageUtils.getBestMatchFromCodes(dt(d)?[d]:d);h&&(this.language||a(h),this.translator.language||this.translator.changeLanguage(h),(x=(m=this.services.languageDetector)==null?void 0:m.cacheUserLanguage)==null||x.call(m,h)),this.loadResources(h,g=>{i(g,h)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t),s}getFixedT(t,n,s){const a=(i,o,...d)=>{let u;typeof o!="object"?u=this.options.overloadTranslationOptionHandler([i,o].concat(d)):u={...o},u.lng=u.lng||a.lng,u.lngs=u.lngs||a.lngs,u.ns=u.ns||a.ns,u.keyPrefix!==""&&(u.keyPrefix=u.keyPrefix||s||a.keyPrefix);const h=this.options.keySeparator||".";let m;return u.keyPrefix&&Array.isArray(i)?m=i.map(x=>(typeof x=="function"&&(x=io(x,{...this.options,...o})),`${u.keyPrefix}${h}${x}`)):(typeof i=="function"&&(i=io(i,{...this.options,...o})),m=u.keyPrefix?`${u.keyPrefix}${h}${i}`:i),this.t(m,u)};return dt(t)?a.lng=t:a.lngs=t,a.ns=n,a.keyPrefix=s,a}t(...t){var n;return(n=this.translator)==null?void 0:n.translate(...t)}exists(...t){var n;return(n=this.translator)==null?void 0:n.exists(...t)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t,n={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const s=n.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(s.toLowerCase()==="cimode")return!0;const o=(d,u)=>{const h=this.services.backendConnector.state[`${d}|${u}`];return h===-1||h===0||h===2};if(n.precheck){const d=n.precheck(this,o);if(d!==void 0)return d}return!!(this.hasResourceBundle(s,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(s,t)&&(!a||o(i,t)))}loadNamespaces(t,n){const s=La();return this.options.ns?(dt(t)&&(t=[t]),t.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{s.resolve(),n&&n(a)}),s):(n&&n(),Promise.resolve())}loadLanguages(t,n){const s=La();dt(t)&&(t=[t]);const a=this.options.preload||[],i=t.filter(o=>a.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return i.length?(this.options.preload=a.concat(i),this.loadResources(o=>{s.resolve(),n&&n(o)}),s):(n&&n(),Promise.resolve())}dir(t){var a,i;if(t||(t=this.resolvedLanguage||(((a=this.languages)==null?void 0:a.length)>0?this.languages[0]:this.language)),!t)return"rtl";try{const o=new Intl.Locale(t);if(o&&o.getTextInfo){const d=o.getTextInfo();if(d&&d.direction)return d.direction}}catch{}const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],s=((i=this.services)==null?void 0:i.languageUtils)||new md(yd());return t.toLowerCase().indexOf("-latn")>1?"ltr":n.indexOf(s.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(t={},n){return new ai(t,n)}cloneInstance(t={},n=Ci){const s=t.forkResourceStore;s&&delete t.forkResourceStore;const a={...this.options,...t,isClone:!0},i=new ai(a);if((t.debug!==void 0||t.prefix!==void 0)&&(i.logger=i.logger.clone(t)),["store","services","language"].forEach(d=>{i[d]=this[d]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},s){const d=Object.keys(this.store.data).reduce((u,h)=>(u[h]={...this.store.data[h]},u[h]=Object.keys(u[h]).reduce((m,x)=>(m[x]={...u[h][x]},m),u[h]),u),{});i.store=new ud(d,a),i.services.resourceStore=i.store}return i.translator=new oo(i.services,a),i.translator.on("*",(d,...u)=>{i.emit(d,...u)}),i.init(a,n),i.translator.options=a,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Bn=ai.createInstance();Bn.createInstance=ai.createInstance;Bn.createInstance;Bn.dir;Bn.init;Bn.loadResources;Bn.reloadResources;Bn.use;Bn.changeLanguage;Bn.getFixedT;Bn.t;Bn.exists;Bn.setDefaultNamespace;Bn.hasLoadedNamespace;Bn.loadNamespaces;Bn.loadLanguages;var Lg={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};const Eg=th(Lg);var Wg=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function jd(r){var t={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},n=r.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(t.name=n[1],(Eg[n[1]]||r.charAt(r.length-2)==="/")&&(t.voidElement=!0),t.name.startsWith("!--"))){var s=r.indexOf("-->");return{type:"comment",comment:s!==-1?r.slice(4,s):""}}for(var a=new RegExp(Wg),i=null;(i=a.exec(r))!==null;)if(i[0].trim())if(i[1]){var o=i[1].trim(),d=[o,""];o.indexOf("=")>-1&&(d=o.split("=")),t.attrs[d[0]]=d[1],a.lastIndex--}else i[2]&&(t.attrs[i[2]]=i[3].trim().substring(1,i[3].length-1));return t}var Fg=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,zg=/^\s*$/,Og=Object.create(null);function oh(r,t){switch(t.type){case"text":return r+t.content;case"tag":return r+="<"+t.name+(t.attrs?function(n){var s=[];for(var a in n)s.push(a+'="'+n[a]+'"');return s.length?" "+s.join(" "):""}(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?r:r+t.children.reduce(oh,"")+"</"+t.name+">";case"comment":return r+"<!--"+t.comment+"-->"}}var Vg={parse:function(r,t){t||(t={}),t.components||(t.components=Og);var n,s=[],a=[],i=-1,o=!1;if(r.indexOf("<")!==0){var d=r.indexOf("<");s.push({type:"text",content:d===-1?r:r.substring(0,d)})}return r.replace(Fg,function(u,h){if(o){if(u!=="</"+n.name+">")return;o=!1}var m,x=u.charAt(1)!=="/",g=u.startsWith("<!--"),f=h+u.length,y=r.charAt(f);if(g){var j=jd(u);return i<0?(s.push(j),s):((m=a[i]).children.push(j),s)}if(x&&(i++,(n=jd(u)).type==="tag"&&t.components[n.name]&&(n.type="component",o=!0),n.voidElement||o||!y||y==="<"||n.children.push({type:"text",content:r.slice(f,r.indexOf("<",f))}),i===0&&s.push(n),(m=a[i-1])&&m.children.push(n),a[i]=n),(!x||n.voidElement)&&(i>-1&&(n.voidElement||n.name===u.slice(2,-1))&&(i--,n=i===-1?s:a[i]),!o&&y!=="<"&&y)){m=i===-1?s:a[i].children;var b=r.indexOf("<",f),v=r.slice(f,b===-1?void 0:b);zg.test(v)&&(v=" "),(b>-1&&i+m.length>=0||v!==" ")&&m.push({type:"text",content:v})}}),s},stringify:function(r){return r.reduce(function(t,n){return t+oh("",n)},"")}};const Hi=(r,t,n,s)=>{var i,o,d,u;const a=[n,{code:t,...s||{}}];if((o=(i=r==null?void 0:r.services)==null?void 0:i.logger)!=null&&o.forward)return r.services.logger.forward(a,"warn","react-i18next::",!0);jr(a[0])&&(a[0]=`react-i18next:: ${a[0]}`),(u=(d=r==null?void 0:r.services)==null?void 0:d.logger)!=null&&u.warn?r.services.logger.warn(...a):console!=null&&console.warn&&console.warn(...a)},vd={},ii=(r,t,n,s)=>{jr(n)&&vd[n]||(jr(n)&&(vd[n]=new Date),Hi(r,t,n,s))},lh=(r,t)=>()=>{if(r.isInitialized)t();else{const n=()=>{setTimeout(()=>{r.off("initialized",n)},0),t()};r.on("initialized",n)}},Vl=(r,t,n)=>{r.loadNamespaces(t,lh(r,n))},wd=(r,t,n,s)=>{if(jr(n)&&(n=[n]),r.options.preload&&r.options.preload.indexOf(t)>-1)return Vl(r,n,s);n.forEach(a=>{r.options.ns.indexOf(a)<0&&r.options.ns.push(a)}),r.loadLanguages(t,lh(r,s))},$g=(r,t,n={})=>!t.languages||!t.languages.length?(ii(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0):t.hasLoadedNamespace(r,{lng:n.lng,precheck:(s,a)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&s.services.backendConnector.backend&&s.isLanguageChangingTo&&!a(s.isLanguageChangingTo,r))return!1}}),jr=r=>typeof r=="string",bs=r=>typeof r=="object"&&r!==null,Hg=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,Bg={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},Ug=r=>Bg[r],_g=r=>r.replace(Hg,Ug);let $l={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:_g};const Yg=(r={})=>{$l={...$l,...r}},ch=()=>$l;let dh;const qg=r=>{dh=r},wc=()=>dh,il=(r,t)=>{var s;if(!r)return!1;const n=((s=r.props)==null?void 0:s.children)??r.children;return t?n.length>0:!!n},ol=r=>{var n,s;if(!r)return[];const t=((n=r.props)==null?void 0:n.children)??r.children;return(s=r.props)!=null&&s.i18nIsDynamicList?sa(t):t},Gg=r=>Array.isArray(r)&&r.every(p.isValidElement),sa=r=>Array.isArray(r)?r:[r],Kg=(r,t)=>{const n={...t};return n.props=Object.assign(r.props,t.props),n},uh=(r,t,n,s)=>{if(!r)return"";let a="";const i=sa(r),o=t!=null&&t.transSupportBasicHtmlNodes?t.transKeepBasicHtmlNodesFor??[]:[];return i.forEach((d,u)=>{if(jr(d)){a+=`${d}`;return}if(p.isValidElement(d)){const{props:h,type:m}=d,x=Object.keys(h).length,g=o.indexOf(m)>-1,f=h.children;if(!f&&g&&!x){a+=`<${m}/>`;return}if(!f&&(!g||x)||h.i18nIsDynamicList){a+=`<${u}></${u}>`;return}if(g&&x===1&&jr(f)){a+=`<${m}>${f}</${m}>`;return}const y=uh(f,t,n,s);a+=`<${u}>${y}</${u}>`;return}if(d===null){Hi(n,"TRANS_NULL_VALUE","Passed in a null value as child",{i18nKey:s});return}if(bs(d)){const{format:h,...m}=d,x=Object.keys(m);if(x.length===1){const g=h?`${x[0]}, ${h}`:x[0];a+=`{{${g}}}`;return}Hi(n,"TRANS_INVALID_OBJ","Invalid child - Object should only have keys {{ value, format }} (format is optional).",{i18nKey:s,child:d});return}Hi(n,"TRANS_INVALID_VAR","Passed in a variable like {number} - pass variables for interpolation as full objects like {{number}}.",{i18nKey:s,child:d})}),a},Qg=(r,t,n,s,a,i,o)=>{if(n==="")return[];const d=a.transKeepBasicHtmlNodesFor||[],u=n&&new RegExp(d.map(v=>`<${v}`).join("|")).test(n);if(!r&&!t&&!u&&!o)return[n];const h=t??{},m=v=>{sa(v).forEach(w=>{jr(w)||(il(w)?m(ol(w)):bs(w)&&!p.isValidElement(w)&&Object.assign(h,w))})};m(r);const x=Vg.parse(`<0>${n}</0>`),g={...h,...i},f=(v,P,w)=>{var A;const C=ol(v),k=j(C,P.children,w);return Gg(C)&&k.length===0||(A=v.props)!=null&&A.i18nIsDynamicList?C:k},y=(v,P,w,C,k)=>{v.dummy?(v.children=P,w.push(p.cloneElement(v,{key:C},k?void 0:P))):w.push(...p.Children.map([v],A=>{const L={...A.props};return delete L.i18nIsDynamicList,p.createElement(A.type,{...L,key:C,ref:A.props.ref??A.ref},k?null:P)}))},j=(v,P,w)=>{const C=sa(v);return sa(P).reduce((A,L,T)=>{var O,I;const M=((I=(O=L.children)==null?void 0:O[0])==null?void 0:I.content)&&s.services.interpolator.interpolate(L.children[0].content,g,s.language);if(L.type==="tag"){let z=C[parseInt(L.name,10)];!z&&t&&(z=t[L.name]),w.length===1&&!z&&(z=w[0][L.name]),z||(z={});const N=Object.keys(L.attrs).length!==0?Kg({props:L.attrs},z):z,E=p.isValidElement(N),R=E&&il(L,!0)&&!L.voidElement,V=u&&bs(N)&&N.dummy&&!E,F=bs(t)&&Object.hasOwnProperty.call(t,L.name);if(jr(N)){const B=s.services.interpolator.interpolate(N,g,s.language);A.push(B)}else if(il(N)||R){const B=f(N,L,w);y(N,B,A,T)}else if(V){const B=j(C,L.children,w);y(N,B,A,T)}else if(Number.isNaN(parseFloat(L.name)))if(F){const B=f(N,L,w);y(N,B,A,T,L.voidElement)}else if(a.transSupportBasicHtmlNodes&&d.indexOf(L.name)>-1)if(L.voidElement)A.push(p.createElement(L.name,{key:`${L.name}-${T}`}));else{const B=j(C,L.children,w);A.push(p.createElement(L.name,{key:`${L.name}-${T}`},B))}else if(L.voidElement)A.push(`<${L.name} />`);else{const B=j(C,L.children,w);A.push(`<${L.name}>${B}</${L.name}>`)}else if(bs(N)&&!E){const B=L.children[0]?M:null;B&&A.push(B)}else y(N,M,A,T,L.children.length!==1||!M)}else if(L.type==="text"){const z=a.transWrapTextNodes,N=o?a.unescape(s.services.interpolator.interpolate(L.content,g,s.language)):s.services.interpolator.interpolate(L.content,g,s.language);z?A.push(p.createElement(z,{key:`${L.name}-${T}`},N)):A.push(N)}return A},[])},b=j([{dummy:!0,children:r||[]}],x,sa(r||[]));return ol(b[0])},hh=(r,t,n)=>{const s=r.key||t,a=p.cloneElement(r,{key:s});if(!a.props||!a.props.children||n.indexOf(`${t}/>`)<0&&n.indexOf(`${t} />`)<0)return a;function i(){return p.createElement(p.Fragment,null,a)}return p.createElement(i,{key:s})},Xg=(r,t)=>r.map((n,s)=>hh(n,s,t)),Jg=(r,t)=>{const n={};return Object.keys(r).forEach(s=>{Object.assign(n,{[s]:hh(r[s],s,t)})}),n},Zg=(r,t,n,s)=>r?Array.isArray(r)?Xg(r,t):bs(r)?Jg(r,t):(ii(n,"TRANS_INVALID_COMPONENTS",'<Trans /> "components" prop expects an object or array',{i18nKey:s}),null):null,ef=r=>!bs(r)||Array.isArray(r)?!1:Object.keys(r).reduce((t,n)=>t&&Number.isNaN(Number.parseFloat(n)),!0);function tf({children:r,count:t,parent:n,i18nKey:s,context:a,tOptions:i={},values:o,defaults:d,components:u,ns:h,i18n:m,t:x,shouldUnescape:g,...f}){var E,R,V,F,B,$;const y=m||wc();if(!y)return ii(y,"NO_I18NEXT_INSTANCE","Trans: You need to pass in an i18next instance using i18nextReactModule",{i18nKey:s}),r;const j=x||y.t.bind(y)||(Y=>Y),b={...ch(),...(E=y.options)==null?void 0:E.react};let v=h||j.ns||((R=y.options)==null?void 0:R.defaultNS);v=jr(v)?[v]:v||["translation"];const P=uh(r,b,y,s),w=d||P||b.transEmptyNodeValue||(typeof s=="function"?io(s):s),{hashTransKey:C}=b,k=s||(C?C(P||w):P||w);(F=(V=y.options)==null?void 0:V.interpolation)!=null&&F.defaultVariables&&(o=o&&Object.keys(o).length>0?{...o,...y.options.interpolation.defaultVariables}:{...y.options.interpolation.defaultVariables});const A=o||t!==void 0&&!(($=(B=y.options)==null?void 0:B.interpolation)!=null&&$.alwaysFormat)||!r?i.interpolation:{interpolation:{...i.interpolation,prefix:"#$?",suffix:"?$#"}},L={...i,context:a||i.context,count:t,...o,...A,defaultValue:w,ns:v},T=k?j(k,L):w,M=Zg(u,T,y,s);let O=M||r,I=null;ef(M)&&(I=M,O=r);const z=Qg(O,I,T,y,b,L,g),N=n??b.defaultTransParent;return N?p.createElement(N,f,z):z}const nf={type:"3rdParty",init(r){Yg(r.options.react),qg(r)}},mh=p.createContext();class rf{constructor(){this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}function sf({children:r,count:t,parent:n,i18nKey:s,context:a,tOptions:i={},values:o,defaults:d,components:u,ns:h,i18n:m,t:x,shouldUnescape:g,...f}){var P;const{i18n:y,defaultNS:j}=p.useContext(mh)||{},b=m||y||wc(),v=x||(b==null?void 0:b.t.bind(b));return tf({children:r,count:t,parent:n,i18nKey:s,context:a,tOptions:i,values:o,defaults:d,components:u,ns:h||(v==null?void 0:v.ns)||j||((P=b==null?void 0:b.options)==null?void 0:P.defaultNS),i18n:b,t:x,shouldUnescape:g,...f})}const af=(r,t)=>{const n=p.useRef();return p.useEffect(()=>{n.current=r},[r,t]),n.current},xh=(r,t,n,s)=>r.getFixedT(t,n,s),of=(r,t,n,s)=>p.useCallback(xh(r,t,n,s),[r,t,n,s]),Ne=(r,t={})=>{var C,k,A,L;const{i18n:n}=t,{i18n:s,defaultNS:a}=p.useContext(mh)||{},i=n||s||wc();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new rf),!i){ii(i,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const T=(O,I)=>jr(I)?I:bs(I)&&jr(I.defaultValue)?I.defaultValue:Array.isArray(O)?O[O.length-1]:O,M=[T,{},!1];return M.t=T,M.i18n={},M.ready=!1,M}(C=i.options.react)!=null&&C.wait&&ii(i,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...ch(),...i.options.react,...t},{useSuspense:d,keyPrefix:u}=o;let h=a||((k=i.options)==null?void 0:k.defaultNS);h=jr(h)?[h]:h||["translation"],(L=(A=i.reportNamespaces).addUsedNamespaces)==null||L.call(A,h);const m=(i.isInitialized||i.initializedStoreOnce)&&h.every(T=>$g(T,i,o)),x=of(i,t.lng||null,o.nsMode==="fallback"?h:h[0],u),g=()=>x,f=()=>xh(i,t.lng||null,o.nsMode==="fallback"?h:h[0],u),[y,j]=p.useState(g);let b=h.join();t.lng&&(b=`${t.lng}${b}`);const v=af(b),P=p.useRef(!0);p.useEffect(()=>{const{bindI18n:T,bindI18nStore:M}=o;P.current=!0,!m&&!d&&(t.lng?wd(i,t.lng,h,()=>{P.current&&j(f)}):Vl(i,h,()=>{P.current&&j(f)})),m&&v&&v!==b&&P.current&&j(f);const O=()=>{P.current&&j(f)};return T&&(i==null||i.on(T,O)),M&&(i==null||i.store.on(M,O)),()=>{P.current=!1,i&&T&&(T==null||T.split(" ").forEach(I=>i.off(I,O))),M&&i&&M.split(" ").forEach(I=>i.store.off(I,O))}},[i,b]),p.useEffect(()=>{P.current&&m&&j(g)},[i,u,m]);const w=[y,i,m];if(w.t=y,w.i18n=i,w.ready=m,m||!m&&!d)return w;throw new Promise(T=>{t.lng?wd(i,t.lng,h,()=>T()):Vl(i,h,()=>T())})};function Wt(r){if(r===null||r===!0||r===!1)return NaN;var t=Number(r);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function ze(r,t){if(t.length<r)throw new TypeError(r+" argument"+(r>1?"s":"")+" required, but only "+t.length+" present")}function Oe(r){ze(1,arguments);var t=Object.prototype.toString.call(r);return r instanceof Date||yo(r)==="object"&&t==="[object Date]"?new Date(r.getTime()):typeof r=="number"||t==="[object Number]"?new Date(r):((typeof r=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}function Bi(r,t){ze(2,arguments);var n=Oe(r),s=Wt(t);return isNaN(s)?new Date(NaN):(s&&n.setDate(n.getDate()+s),n)}function Ui(r,t){ze(2,arguments);var n=Oe(r),s=Wt(t);if(isNaN(s))return new Date(NaN);if(!s)return n;var a=n.getDate(),i=new Date(n.getTime());i.setMonth(n.getMonth()+s+1,0);var o=i.getDate();return a>=o?i:(n.setFullYear(i.getFullYear(),i.getMonth(),a),n)}function Do(r,t){ze(2,arguments);var n=Oe(r).getTime(),s=Wt(t);return new Date(n+s)}var lf=36e5;function cf(r,t){ze(2,arguments);var n=Wt(t);return Do(r,n*lf)}var df={};function Jr(){return df}function Ws(r,t){var n,s,a,i,o,d,u,h;ze(1,arguments);var m=Jr(),x=Wt((n=(s=(a=(i=t==null?void 0:t.weekStartsOn)!==null&&i!==void 0?i:t==null||(o=t.locale)===null||o===void 0||(d=o.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&a!==void 0?a:m.weekStartsOn)!==null&&s!==void 0?s:(u=m.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.weekStartsOn)!==null&&n!==void 0?n:0);if(!(x>=0&&x<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=Oe(r),f=g.getDay(),y=(f<x?7:0)+f-x;return g.setDate(g.getDate()-y),g.setHours(0,0,0,0),g}function lo(r){var t=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return t.setUTCFullYear(r.getFullYear()),r.getTime()-t.getTime()}function Sa(r){ze(1,arguments);var t=Oe(r);return t.setHours(0,0,0,0),t}var uf=864e5;function hf(r,t){ze(2,arguments);var n=Sa(r),s=Sa(t),a=n.getTime()-lo(n),i=s.getTime()-lo(s);return Math.round((a-i)/uf)}var mf=6e4;function xf(r,t){ze(2,arguments);var n=Wt(t);return Do(r,n*mf)}function pf(r,t){ze(2,arguments);var n=Wt(t);return Do(r,n*1e3)}function gf(r,t){ze(2,arguments);var n=Wt(t),s=n*7;return Bi(r,s)}function Sd(r,t){ze(2,arguments);var n=Wt(t);return Ui(r,n*12)}function Xa(r,t){ze(2,arguments);var n=Oe(r),s=Oe(t),a=n.getTime()-s.getTime();return a<0?-1:a>0?1:a}var Ao=6e4,Io=36e5,ff=1e3;function yf(r,t){ze(2,arguments);var n=Sa(r),s=Sa(t);return n.getTime()===s.getTime()}function bf(r){return ze(1,arguments),r instanceof Date||yo(r)==="object"&&Object.prototype.toString.call(r)==="[object Date]"}function ph(r){if(ze(1,arguments),!bf(r)&&typeof r!="number")return!1;var t=Oe(r);return!isNaN(Number(t))}function jf(r,t){ze(2,arguments);var n=Oe(r),s=Oe(t),a=n.getFullYear()-s.getFullYear(),i=n.getMonth()-s.getMonth();return a*12+i}function vf(r,t){ze(2,arguments);var n=Oe(r),s=Oe(t);return n.getFullYear()-s.getFullYear()}function Td(r,t){var n=r.getFullYear()-t.getFullYear()||r.getMonth()-t.getMonth()||r.getDate()-t.getDate()||r.getHours()-t.getHours()||r.getMinutes()-t.getMinutes()||r.getSeconds()-t.getSeconds()||r.getMilliseconds()-t.getMilliseconds();return n<0?-1:n>0?1:n}function gh(r,t){ze(2,arguments);var n=Oe(r),s=Oe(t),a=Td(n,s),i=Math.abs(hf(n,s));n.setDate(n.getDate()-a*i);var o=+(Td(n,s)===-a),d=a*(i-o);return d===0?0:d}function Ro(r,t){return ze(2,arguments),Oe(r).getTime()-Oe(t).getTime()}var Cd={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},wf="trunc";function pi(r){return r?Cd[r]:Cd[wf]}function Sf(r,t,n){ze(2,arguments);var s=Ro(r,t)/Io;return pi(void 0)(s)}function Tf(r,t,n){ze(2,arguments);var s=Ro(r,t)/Ao;return pi(void 0)(s)}function Hl(r){ze(1,arguments);var t=Oe(r);return t.setHours(23,59,59,999),t}function Bl(r){ze(1,arguments);var t=Oe(r),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Cf(r){ze(1,arguments);var t=Oe(r);return Hl(t).getTime()===Bl(t).getTime()}function fh(r,t){ze(2,arguments);var n=Oe(r),s=Oe(t),a=Xa(n,s),i=Math.abs(jf(n,s)),o;if(i<1)o=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-a*i);var d=Xa(n,s)===-a;Cf(Oe(r))&&i===1&&Xa(r,s)===1&&(d=!1),o=a*(i-Number(d))}return o===0?0:o}function kf(r,t,n){ze(2,arguments);var s=fh(r,t)/3;return pi(void 0)(s)}function Pf(r,t,n){ze(2,arguments);var s=Ro(r,t)/1e3;return pi(void 0)(s)}function Df(r,t,n){ze(2,arguments);var s=gh(r,t)/7;return pi(void 0)(s)}function Af(r,t){ze(2,arguments);var n=Oe(r),s=Oe(t),a=Xa(n,s),i=Math.abs(vf(n,s));n.setFullYear(1584),s.setFullYear(1584);var o=Xa(n,s)===-a,d=a*(i-Number(o));return d===0?0:d}function If(r,t){var n;ze(1,arguments);var s=r||{},a=Oe(s.start),i=Oe(s.end),o=i.getTime();if(!(a.getTime()<=o))throw new RangeError("Invalid interval");var d=[],u=a;u.setHours(0,0,0,0);var h=Number((n=void 0)!==null&&n!==void 0?n:1);if(h<1||isNaN(h))throw new RangeError("`options.step` must be a number greater than 1");for(;u.getTime()<=o;)d.push(Oe(u)),u.setDate(u.getDate()+h),u.setHours(0,0,0,0);return d}function kd(r){ze(1,arguments);var t=Oe(r);return t.setDate(1),t.setHours(0,0,0,0),t}function ll(r){ze(1,arguments);var t=Oe(r),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}function ki(r){ze(1,arguments);var t=Oe(r),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function cl(r,t){var n,s,a,i,o,d,u,h;ze(1,arguments);var m=Jr(),x=Wt((n=(s=(a=(i=t==null?void 0:t.weekStartsOn)!==null&&i!==void 0?i:t==null||(o=t.locale)===null||o===void 0||(d=o.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&a!==void 0?a:m.weekStartsOn)!==null&&s!==void 0?s:(u=m.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.weekStartsOn)!==null&&n!==void 0?n:0);if(!(x>=0&&x<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=Oe(r),f=g.getDay(),y=(f<x?-7:0)+6-(f-x);return g.setDate(g.getDate()+y),g.setHours(23,59,59,999),g}function yh(r,t){ze(2,arguments);var n=Wt(t);return Do(r,-n)}var Rf=864e5;function Mf(r){ze(1,arguments);var t=Oe(r),n=t.getTime();t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);var s=t.getTime(),a=n-s;return Math.floor(a/Rf)+1}function Ta(r){ze(1,arguments);var t=1,n=Oe(r),s=n.getUTCDay(),a=(s<t?7:0)+s-t;return n.setUTCDate(n.getUTCDate()-a),n.setUTCHours(0,0,0,0),n}function bh(r){ze(1,arguments);var t=Oe(r),n=t.getUTCFullYear(),s=new Date(0);s.setUTCFullYear(n+1,0,4),s.setUTCHours(0,0,0,0);var a=Ta(s),i=new Date(0);i.setUTCFullYear(n,0,4),i.setUTCHours(0,0,0,0);var o=Ta(i);return t.getTime()>=a.getTime()?n+1:t.getTime()>=o.getTime()?n:n-1}function Nf(r){ze(1,arguments);var t=bh(r),n=new Date(0);n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0);var s=Ta(n);return s}var Lf=6048e5;function jh(r){ze(1,arguments);var t=Oe(r),n=Ta(t).getTime()-Nf(t).getTime();return Math.round(n/Lf)+1}function Hs(r,t){var n,s,a,i,o,d,u,h;ze(1,arguments);var m=Jr(),x=Wt((n=(s=(a=(i=t==null?void 0:t.weekStartsOn)!==null&&i!==void 0?i:t==null||(o=t.locale)===null||o===void 0||(d=o.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&a!==void 0?a:m.weekStartsOn)!==null&&s!==void 0?s:(u=m.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.weekStartsOn)!==null&&n!==void 0?n:0);if(!(x>=0&&x<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var g=Oe(r),f=g.getUTCDay(),y=(f<x?7:0)+f-x;return g.setUTCDate(g.getUTCDate()-y),g.setUTCHours(0,0,0,0),g}function Sc(r,t){var n,s,a,i,o,d,u,h;ze(1,arguments);var m=Oe(r),x=m.getUTCFullYear(),g=Jr(),f=Wt((n=(s=(a=(i=t==null?void 0:t.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(o=t.locale)===null||o===void 0||(d=o.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&a!==void 0?a:g.firstWeekContainsDate)!==null&&s!==void 0?s:(u=g.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&n!==void 0?n:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var y=new Date(0);y.setUTCFullYear(x+1,0,f),y.setUTCHours(0,0,0,0);var j=Hs(y,t),b=new Date(0);b.setUTCFullYear(x,0,f),b.setUTCHours(0,0,0,0);var v=Hs(b,t);return m.getTime()>=j.getTime()?x+1:m.getTime()>=v.getTime()?x:x-1}function Ef(r,t){var n,s,a,i,o,d,u,h;ze(1,arguments);var m=Jr(),x=Wt((n=(s=(a=(i=t==null?void 0:t.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(o=t.locale)===null||o===void 0||(d=o.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&a!==void 0?a:m.firstWeekContainsDate)!==null&&s!==void 0?s:(u=m.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&n!==void 0?n:1),g=Sc(r,t),f=new Date(0);f.setUTCFullYear(g,0,x),f.setUTCHours(0,0,0,0);var y=Hs(f,t);return y}var Wf=6048e5;function vh(r,t){ze(1,arguments);var n=Oe(r),s=Hs(n,t).getTime()-Ef(n,t).getTime();return Math.round(s/Wf)+1}function St(r,t){for(var n=r<0?"-":"",s=Math.abs(r).toString();s.length<t;)s="0"+s;return n+s}var ms={y:function(t,n){var s=t.getUTCFullYear(),a=s>0?s:1-s;return St(n==="yy"?a%100:a,n.length)},M:function(t,n){var s=t.getUTCMonth();return n==="M"?String(s+1):St(s+1,2)},d:function(t,n){return St(t.getUTCDate(),n.length)},a:function(t,n){var s=t.getUTCHours()/12>=1?"pm":"am";switch(n){case"a":case"aa":return s.toUpperCase();case"aaa":return s;case"aaaaa":return s[0];case"aaaa":default:return s==="am"?"a.m.":"p.m."}},h:function(t,n){return St(t.getUTCHours()%12||12,n.length)},H:function(t,n){return St(t.getUTCHours(),n.length)},m:function(t,n){return St(t.getUTCMinutes(),n.length)},s:function(t,n){return St(t.getUTCSeconds(),n.length)},S:function(t,n){var s=n.length,a=t.getUTCMilliseconds(),i=Math.floor(a*Math.pow(10,s-3));return St(i,n.length)}},Ys={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ff={G:function(t,n,s){var a=t.getUTCFullYear()>0?1:0;switch(n){case"G":case"GG":case"GGG":return s.era(a,{width:"abbreviated"});case"GGGGG":return s.era(a,{width:"narrow"});case"GGGG":default:return s.era(a,{width:"wide"})}},y:function(t,n,s){if(n==="yo"){var a=t.getUTCFullYear(),i=a>0?a:1-a;return s.ordinalNumber(i,{unit:"year"})}return ms.y(t,n)},Y:function(t,n,s,a){var i=Sc(t,a),o=i>0?i:1-i;if(n==="YY"){var d=o%100;return St(d,2)}return n==="Yo"?s.ordinalNumber(o,{unit:"year"}):St(o,n.length)},R:function(t,n){var s=bh(t);return St(s,n.length)},u:function(t,n){var s=t.getUTCFullYear();return St(s,n.length)},Q:function(t,n,s){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(n){case"Q":return String(a);case"QQ":return St(a,2);case"Qo":return s.ordinalNumber(a,{unit:"quarter"});case"QQQ":return s.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return s.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return s.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,n,s){var a=Math.ceil((t.getUTCMonth()+1)/3);switch(n){case"q":return String(a);case"qq":return St(a,2);case"qo":return s.ordinalNumber(a,{unit:"quarter"});case"qqq":return s.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return s.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return s.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,n,s){var a=t.getUTCMonth();switch(n){case"M":case"MM":return ms.M(t,n);case"Mo":return s.ordinalNumber(a+1,{unit:"month"});case"MMM":return s.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return s.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return s.month(a,{width:"wide",context:"formatting"})}},L:function(t,n,s){var a=t.getUTCMonth();switch(n){case"L":return String(a+1);case"LL":return St(a+1,2);case"Lo":return s.ordinalNumber(a+1,{unit:"month"});case"LLL":return s.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return s.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return s.month(a,{width:"wide",context:"standalone"})}},w:function(t,n,s,a){var i=vh(t,a);return n==="wo"?s.ordinalNumber(i,{unit:"week"}):St(i,n.length)},I:function(t,n,s){var a=jh(t);return n==="Io"?s.ordinalNumber(a,{unit:"week"}):St(a,n.length)},d:function(t,n,s){return n==="do"?s.ordinalNumber(t.getUTCDate(),{unit:"date"}):ms.d(t,n)},D:function(t,n,s){var a=Mf(t);return n==="Do"?s.ordinalNumber(a,{unit:"dayOfYear"}):St(a,n.length)},E:function(t,n,s){var a=t.getUTCDay();switch(n){case"E":case"EE":case"EEE":return s.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return s.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return s.day(a,{width:"short",context:"formatting"});case"EEEE":default:return s.day(a,{width:"wide",context:"formatting"})}},e:function(t,n,s,a){var i=t.getUTCDay(),o=(i-a.weekStartsOn+8)%7||7;switch(n){case"e":return String(o);case"ee":return St(o,2);case"eo":return s.ordinalNumber(o,{unit:"day"});case"eee":return s.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return s.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return s.day(i,{width:"short",context:"formatting"});case"eeee":default:return s.day(i,{width:"wide",context:"formatting"})}},c:function(t,n,s,a){var i=t.getUTCDay(),o=(i-a.weekStartsOn+8)%7||7;switch(n){case"c":return String(o);case"cc":return St(o,n.length);case"co":return s.ordinalNumber(o,{unit:"day"});case"ccc":return s.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return s.day(i,{width:"narrow",context:"standalone"});case"cccccc":return s.day(i,{width:"short",context:"standalone"});case"cccc":default:return s.day(i,{width:"wide",context:"standalone"})}},i:function(t,n,s){var a=t.getUTCDay(),i=a===0?7:a;switch(n){case"i":return String(i);case"ii":return St(i,n.length);case"io":return s.ordinalNumber(i,{unit:"day"});case"iii":return s.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return s.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return s.day(a,{width:"short",context:"formatting"});case"iiii":default:return s.day(a,{width:"wide",context:"formatting"})}},a:function(t,n,s){var a=t.getUTCHours(),i=a/12>=1?"pm":"am";switch(n){case"a":case"aa":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return s.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return s.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(t,n,s){var a=t.getUTCHours(),i;switch(a===12?i=Ys.noon:a===0?i=Ys.midnight:i=a/12>=1?"pm":"am",n){case"b":case"bb":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return s.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return s.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(t,n,s){var a=t.getUTCHours(),i;switch(a>=17?i=Ys.evening:a>=12?i=Ys.afternoon:a>=4?i=Ys.morning:i=Ys.night,n){case"B":case"BB":case"BBB":return s.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return s.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return s.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(t,n,s){if(n==="ho"){var a=t.getUTCHours()%12;return a===0&&(a=12),s.ordinalNumber(a,{unit:"hour"})}return ms.h(t,n)},H:function(t,n,s){return n==="Ho"?s.ordinalNumber(t.getUTCHours(),{unit:"hour"}):ms.H(t,n)},K:function(t,n,s){var a=t.getUTCHours()%12;return n==="Ko"?s.ordinalNumber(a,{unit:"hour"}):St(a,n.length)},k:function(t,n,s){var a=t.getUTCHours();return a===0&&(a=24),n==="ko"?s.ordinalNumber(a,{unit:"hour"}):St(a,n.length)},m:function(t,n,s){return n==="mo"?s.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):ms.m(t,n)},s:function(t,n,s){return n==="so"?s.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):ms.s(t,n)},S:function(t,n){return ms.S(t,n)},X:function(t,n,s,a){var i=a._originalDate||t,o=i.getTimezoneOffset();if(o===0)return"Z";switch(n){case"X":return Dd(o);case"XXXX":case"XX":return Ms(o);case"XXXXX":case"XXX":default:return Ms(o,":")}},x:function(t,n,s,a){var i=a._originalDate||t,o=i.getTimezoneOffset();switch(n){case"x":return Dd(o);case"xxxx":case"xx":return Ms(o);case"xxxxx":case"xxx":default:return Ms(o,":")}},O:function(t,n,s,a){var i=a._originalDate||t,o=i.getTimezoneOffset();switch(n){case"O":case"OO":case"OOO":return"GMT"+Pd(o,":");case"OOOO":default:return"GMT"+Ms(o,":")}},z:function(t,n,s,a){var i=a._originalDate||t,o=i.getTimezoneOffset();switch(n){case"z":case"zz":case"zzz":return"GMT"+Pd(o,":");case"zzzz":default:return"GMT"+Ms(o,":")}},t:function(t,n,s,a){var i=a._originalDate||t,o=Math.floor(i.getTime()/1e3);return St(o,n.length)},T:function(t,n,s,a){var i=a._originalDate||t,o=i.getTime();return St(o,n.length)}};function Pd(r,t){var n=r>0?"-":"+",s=Math.abs(r),a=Math.floor(s/60),i=s%60;if(i===0)return n+String(a);var o=t;return n+String(a)+o+St(i,2)}function Dd(r,t){if(r%60===0){var n=r>0?"-":"+";return n+St(Math.abs(r)/60,2)}return Ms(r,t)}function Ms(r,t){var n=t||"",s=r>0?"-":"+",a=Math.abs(r),i=St(Math.floor(a/60),2),o=St(a%60,2);return s+i+n+o}var Ad=function(t,n){switch(t){case"P":return n.date({width:"short"});case"PP":return n.date({width:"medium"});case"PPP":return n.date({width:"long"});case"PPPP":default:return n.date({width:"full"})}},wh=function(t,n){switch(t){case"p":return n.time({width:"short"});case"pp":return n.time({width:"medium"});case"ppp":return n.time({width:"long"});case"pppp":default:return n.time({width:"full"})}},zf=function(t,n){var s=t.match(/(P+)(p+)?/)||[],a=s[1],i=s[2];if(!i)return Ad(t,n);var o;switch(a){case"P":o=n.dateTime({width:"short"});break;case"PP":o=n.dateTime({width:"medium"});break;case"PPP":o=n.dateTime({width:"long"});break;case"PPPP":default:o=n.dateTime({width:"full"});break}return o.replace("{{date}}",Ad(a,n)).replace("{{time}}",wh(i,n))},Ul={p:wh,P:zf},Of=["D","DD"],Vf=["YY","YYYY"];function Sh(r){return Of.indexOf(r)!==-1}function Th(r){return Vf.indexOf(r)!==-1}function co(r,t,n){if(r==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(r==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(r==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(r==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var $f={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Hf=function(t,n,s){var a,i=$f[t];return typeof i=="string"?a=i:n===1?a=i.one:a=i.other.replace("{{count}}",n.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+a:a+" ago":a};function da(r){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.width?String(t.width):r.defaultWidth,s=r.formats[n]||r.formats[r.defaultWidth];return s}}var Bf={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Uf={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},_f={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Yf={date:da({formats:Bf,defaultWidth:"full"}),time:da({formats:Uf,defaultWidth:"full"}),dateTime:da({formats:_f,defaultWidth:"full"})},qf={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Gf=function(t,n,s,a){return qf[t]};function Or(r){return function(t,n){var s=n!=null&&n.context?String(n.context):"standalone",a;if(s==="formatting"&&r.formattingValues){var i=r.defaultFormattingWidth||r.defaultWidth,o=n!=null&&n.width?String(n.width):i;a=r.formattingValues[o]||r.formattingValues[i]}else{var d=r.defaultWidth,u=n!=null&&n.width?String(n.width):r.defaultWidth;a=r.values[u]||r.values[d]}var h=r.argumentCallback?r.argumentCallback(t):t;return a[h]}}var Kf={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Qf={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Xf={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Jf={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Zf={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},e0={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},t0=function(t,n){var s=Number(t),a=s%100;if(a>20||a<10)switch(a%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},n0={ordinalNumber:t0,era:Or({values:Kf,defaultWidth:"wide"}),quarter:Or({values:Qf,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:Or({values:Xf,defaultWidth:"wide"}),day:Or({values:Jf,defaultWidth:"wide"}),dayPeriod:Or({values:Zf,defaultWidth:"wide",formattingValues:e0,defaultFormattingWidth:"wide"})};function Vr(r){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=n.width,a=s&&r.matchPatterns[s]||r.matchPatterns[r.defaultMatchWidth],i=t.match(a);if(!i)return null;var o=i[0],d=s&&r.parsePatterns[s]||r.parsePatterns[r.defaultParseWidth],u=Array.isArray(d)?s0(d,function(x){return x.test(o)}):r0(d,function(x){return x.test(o)}),h;h=r.valueCallback?r.valueCallback(u):u,h=n.valueCallback?n.valueCallback(h):h;var m=t.slice(o.length);return{value:h,rest:m}}}function r0(r,t){for(var n in r)if(r.hasOwnProperty(n)&&t(r[n]))return n}function s0(r,t){for(var n=0;n<r.length;n++)if(t(r[n]))return n}function Ch(r){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=t.match(r.matchPattern);if(!s)return null;var a=s[0],i=t.match(r.parsePattern);if(!i)return null;var o=r.valueCallback?r.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;var d=t.slice(a.length);return{value:o,rest:d}}}var a0=/^(\d+)(th|st|nd|rd)?/i,i0=/\d+/i,o0={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},l0={any:[/^b/i,/^(a|c)/i]},c0={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},d0={any:[/1/i,/2/i,/3/i,/4/i]},u0={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},h0={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},m0={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},x0={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},p0={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},g0={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},f0={ordinalNumber:Ch({matchPattern:a0,parsePattern:i0,valueCallback:function(t){return parseInt(t,10)}}),era:Vr({matchPatterns:o0,defaultMatchWidth:"wide",parsePatterns:l0,defaultParseWidth:"any"}),quarter:Vr({matchPatterns:c0,defaultMatchWidth:"wide",parsePatterns:d0,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Vr({matchPatterns:u0,defaultMatchWidth:"wide",parsePatterns:h0,defaultParseWidth:"any"}),day:Vr({matchPatterns:m0,defaultMatchWidth:"wide",parsePatterns:x0,defaultParseWidth:"any"}),dayPeriod:Vr({matchPatterns:p0,defaultMatchWidth:"any",parsePatterns:g0,defaultParseWidth:"any"})},Tc={code:"en-US",formatDistance:Hf,formatLong:Yf,formatRelative:Gf,localize:n0,match:f0,options:{weekStartsOn:0,firstWeekContainsDate:1}},y0=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,b0=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,j0=/^'([^]*?)'?$/,v0=/''/g,w0=/[a-zA-Z]/;function fn(r,t,n){var s,a,i,o,d,u,h,m,x,g,f,y,j,b,v,P,w,C;ze(2,arguments);var k=String(t),A=Jr(),L=(s=(a=n==null?void 0:n.locale)!==null&&a!==void 0?a:A.locale)!==null&&s!==void 0?s:Tc,T=Wt((i=(o=(d=(u=n==null?void 0:n.firstWeekContainsDate)!==null&&u!==void 0?u:n==null||(h=n.locale)===null||h===void 0||(m=h.options)===null||m===void 0?void 0:m.firstWeekContainsDate)!==null&&d!==void 0?d:A.firstWeekContainsDate)!==null&&o!==void 0?o:(x=A.locale)===null||x===void 0||(g=x.options)===null||g===void 0?void 0:g.firstWeekContainsDate)!==null&&i!==void 0?i:1);if(!(T>=1&&T<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var M=Wt((f=(y=(j=(b=n==null?void 0:n.weekStartsOn)!==null&&b!==void 0?b:n==null||(v=n.locale)===null||v===void 0||(P=v.options)===null||P===void 0?void 0:P.weekStartsOn)!==null&&j!==void 0?j:A.weekStartsOn)!==null&&y!==void 0?y:(w=A.locale)===null||w===void 0||(C=w.options)===null||C===void 0?void 0:C.weekStartsOn)!==null&&f!==void 0?f:0);if(!(M>=0&&M<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!L.localize)throw new RangeError("locale must contain localize property");if(!L.formatLong)throw new RangeError("locale must contain formatLong property");var O=Oe(r);if(!ph(O))throw new RangeError("Invalid time value");var I=lo(O),z=yh(O,I),N={firstWeekContainsDate:T,weekStartsOn:M,locale:L,_originalDate:O},E=k.match(b0).map(function(R){var V=R[0];if(V==="p"||V==="P"){var F=Ul[V];return F(R,L.formatLong)}return R}).join("").match(y0).map(function(R){if(R==="''")return"'";var V=R[0];if(V==="'")return S0(R);var F=Ff[V];if(F)return!(n!=null&&n.useAdditionalWeekYearTokens)&&Th(R)&&co(R,t,String(r)),!(n!=null&&n.useAdditionalDayOfYearTokens)&&Sh(R)&&co(R,t,String(r)),F(z,R,L.localize,N);if(V.match(w0))throw new RangeError("Format string contains an unescaped latin alphabet character `"+V+"`");return R}).join("");return E}function S0(r){var t=r.match(j0);return t?t[1].replace(v0,"'"):r}function T0(r,t){if(r==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n]);return r}function C0(r,t){var n,s;ze(1,arguments);var a=Oe(r);if(isNaN(a.getTime()))throw new RangeError("Invalid time value");var i=String((n=t==null?void 0:t.format)!==null&&n!==void 0?n:"extended"),o=String((s=t==null?void 0:t.representation)!==null&&s!==void 0?s:"complete");if(i!=="extended"&&i!=="basic")throw new RangeError("format must be 'extended' or 'basic'");if(o!=="date"&&o!=="time"&&o!=="complete")throw new RangeError("representation must be 'date', 'time', or 'complete'");var d="",u="",h=i==="extended"?"-":"",m=i==="extended"?":":"";if(o!=="time"){var x=St(a.getDate(),2),g=St(a.getMonth()+1,2),f=St(a.getFullYear(),4);d="".concat(f).concat(h).concat(g).concat(h).concat(x)}if(o!=="date"){var y=a.getTimezoneOffset();if(y!==0){var j=Math.abs(y),b=St(Math.floor(j/60),2),v=St(j%60,2),P=y<0?"+":"-";u="".concat(P).concat(b,":").concat(v)}else u="Z";var w=St(a.getHours(),2),C=St(a.getMinutes(),2),k=St(a.getSeconds(),2),A=d===""?"":"T",L=[w,C,k].join(m);d="".concat(d).concat(A).concat(L).concat(u)}return d}function k0(r){ze(1,arguments);var t=Oe(r),n=t.getDate();return n}function kh(r){ze(1,arguments);var t=Oe(r),n=t.getFullYear(),s=t.getMonth(),a=new Date(0);return a.setFullYear(n,s+1,0),a.setHours(0,0,0,0),a.getDate()}function P0(r){ze(1,arguments);var t=Oe(r),n=t.getHours();return n}function D0(r){ze(1,arguments);var t=Oe(r),n=t.getMilliseconds();return n}function A0(r){ze(1,arguments);var t=Oe(r),n=t.getMinutes();return n}function I0(r){ze(1,arguments);var t=Oe(r),n=t.getMonth();return n}function R0(r){ze(1,arguments);var t=Oe(r),n=t.getSeconds();return n}function M0(r,t){var n,s,a,i,o,d,u,h;ze(1,arguments);var m=Oe(r),x=m.getFullYear(),g=Jr(),f=Wt((n=(s=(a=(i=t==null?void 0:t.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(o=t.locale)===null||o===void 0||(d=o.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&a!==void 0?a:g.firstWeekContainsDate)!==null&&s!==void 0?s:(u=g.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&n!==void 0?n:1);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var y=new Date(0);y.setFullYear(x+1,0,f),y.setHours(0,0,0,0);var j=Ws(y,t),b=new Date(0);b.setFullYear(x,0,f),b.setHours(0,0,0,0);var v=Ws(b,t);return m.getTime()>=j.getTime()?x+1:m.getTime()>=v.getTime()?x:x-1}function N0(r,t){var n,s,a,i,o,d,u,h;ze(1,arguments);var m=Jr(),x=Wt((n=(s=(a=(i=t==null?void 0:t.firstWeekContainsDate)!==null&&i!==void 0?i:t==null||(o=t.locale)===null||o===void 0||(d=o.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&a!==void 0?a:m.firstWeekContainsDate)!==null&&s!==void 0?s:(u=m.locale)===null||u===void 0||(h=u.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&n!==void 0?n:1),g=M0(r,t),f=new Date(0);f.setFullYear(g,0,x),f.setHours(0,0,0,0);var y=Ws(f,t);return y}var L0=6048e5;function E0(r,t){ze(1,arguments);var n=Oe(r),s=Ws(n,t).getTime()-N0(n,t).getTime();return Math.round(s/L0)+1}function W0(r){return ze(1,arguments),Oe(r).getFullYear()}function dl(r,t){ze(2,arguments);var n=Oe(r),s=Oe(t);return n.getTime()>s.getTime()}function Ea(r,t){ze(2,arguments);var n=Oe(r),s=Oe(t);return n.getTime()<s.getTime()}function F0(r,t){ze(2,arguments);var n=Oe(r),s=Oe(t);return n.getTime()===s.getTime()}function Id(r,t){(t==null||t>r.length)&&(t=r.length);for(var n=0,s=Array(t);n<t;n++)s[n]=r[n];return s}function z0(r,t){if(r){if(typeof r=="string")return Id(r,t);var n={}.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Id(r,t):void 0}}function Rd(r,t){var n=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=z0(r))||t){n&&(r=n);var s=0,a=function(){};return{s:a,n:function(){return s>=r.length?{done:!0}:{done:!1,value:r[s++]}},e:function(h){throw h},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,o=!0,d=!1;return{s:function(){n=n.call(r)},n:function(){var h=n.next();return o=h.done,h},e:function(h){d=!0,i=h},f:function(){try{o||n.return==null||n.return()}finally{if(d)throw i}}}}function Ft(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&zx(r,t)}function uo(r){return uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},uo(r)}function Ph(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ph=function(){return!!r})()}function O0(r,t){if(t&&(yo(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ye(r)}function zt(r){var t=Ph();return function(){var n,s=uo(r);if(t){var a=uo(this).constructor;n=Reflect.construct(s,arguments,a)}else n=s.apply(this,arguments);return O0(this,n)}}function At(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function V0(r,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(r,zu(s.key),s)}}function It(r,t,n){return t&&V0(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Be(r,t,n){return(t=zu(t))in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n,r}var $0=10,Dh=function(){function r(){At(this,r),Be(this,"priority",void 0),Be(this,"subPriority",0)}return It(r,[{key:"validate",value:function(n,s){return!0}}]),r}(),H0=function(r){Ft(n,r);var t=zt(n);function n(s,a,i,o,d){var u;return At(this,n),u=t.call(this),u.value=s,u.validateValue=a,u.setValue=i,u.priority=o,d&&(u.subPriority=d),u}return It(n,[{key:"validate",value:function(a,i){return this.validateValue(a,this.value,i)}},{key:"set",value:function(a,i,o){return this.setValue(a,i,this.value,o)}}]),n}(Dh),B0=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",$0),Be(Ye(s),"subPriority",-1),s}return It(n,[{key:"set",value:function(a,i){if(i.timestampIsSet)return a;var o=new Date(0);return o.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),o.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),o}}]),n}(Dh),$t=function(){function r(){At(this,r),Be(this,"incompatibleTokens",void 0),Be(this,"priority",void 0),Be(this,"subPriority",void 0)}return It(r,[{key:"run",value:function(n,s,a,i){var o=this.parse(n,s,a,i);return o?{setter:new H0(o.value,this.validate,this.set,this.priority,this.subPriority),rest:o.rest}:null}},{key:"validate",value:function(n,s,a){return!0}}]),r}(),U0=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",140),Be(Ye(s),"incompatibleTokens",["R","u","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"G":case"GG":case"GGG":return o.era(a,{width:"abbreviated"})||o.era(a,{width:"narrow"});case"GGGGG":return o.era(a,{width:"narrow"});case"GGGG":default:return o.era(a,{width:"wide"})||o.era(a,{width:"abbreviated"})||o.era(a,{width:"narrow"})}}},{key:"set",value:function(a,i,o){return i.era=o,a.setUTCFullYear(o,0,1),a.setUTCHours(0,0,0,0),a}}]),n}($t),vn={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},$r={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function wn(r,t){return r&&{value:t(r.value),rest:r.rest}}function pn(r,t){var n=t.match(r);return n?{value:parseInt(n[0],10),rest:t.slice(n[0].length)}:null}function Hr(r,t){var n=t.match(r);if(!n)return null;if(n[0]==="Z")return{value:0,rest:t.slice(1)};var s=n[1]==="+"?1:-1,a=n[2]?parseInt(n[2],10):0,i=n[3]?parseInt(n[3],10):0,o=n[5]?parseInt(n[5],10):0;return{value:s*(a*Io+i*Ao+o*ff),rest:t.slice(n[0].length)}}function Ah(r){return pn(vn.anyDigitsSigned,r)}function gn(r,t){switch(r){case 1:return pn(vn.singleDigit,t);case 2:return pn(vn.twoDigits,t);case 3:return pn(vn.threeDigits,t);case 4:return pn(vn.fourDigits,t);default:return pn(new RegExp("^\\d{1,"+r+"}"),t)}}function ho(r,t){switch(r){case 1:return pn(vn.singleDigitSigned,t);case 2:return pn(vn.twoDigitsSigned,t);case 3:return pn(vn.threeDigitsSigned,t);case 4:return pn(vn.fourDigitsSigned,t);default:return pn(new RegExp("^-?\\d{1,"+r+"}"),t)}}function Cc(r){switch(r){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Ih(r,t){var n=t>0,s=n?t:1-t,a;if(s<=50)a=r||100;else{var i=s+50,o=Math.floor(i/100)*100,d=r>=i%100;a=r+o-(d?100:0)}return n?a:1-a}function Rh(r){return r%400===0||r%4===0&&r%100!==0}var _0=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",130),Be(Ye(s),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){var d=function(h){return{year:h,isTwoDigitYear:i==="yy"}};switch(i){case"y":return wn(gn(4,a),d);case"yo":return wn(o.ordinalNumber(a,{unit:"year"}),d);default:return wn(gn(i.length,a),d)}}},{key:"validate",value:function(a,i){return i.isTwoDigitYear||i.year>0}},{key:"set",value:function(a,i,o){var d=a.getUTCFullYear();if(o.isTwoDigitYear){var u=Ih(o.year,d);return a.setUTCFullYear(u,0,1),a.setUTCHours(0,0,0,0),a}var h=!("era"in i)||i.era===1?o.year:1-o.year;return a.setUTCFullYear(h,0,1),a.setUTCHours(0,0,0,0),a}}]),n}($t),Y0=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",130),Be(Ye(s),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){var d=function(h){return{year:h,isTwoDigitYear:i==="YY"}};switch(i){case"Y":return wn(gn(4,a),d);case"Yo":return wn(o.ordinalNumber(a,{unit:"year"}),d);default:return wn(gn(i.length,a),d)}}},{key:"validate",value:function(a,i){return i.isTwoDigitYear||i.year>0}},{key:"set",value:function(a,i,o,d){var u=Sc(a,d);if(o.isTwoDigitYear){var h=Ih(o.year,u);return a.setUTCFullYear(h,0,d.firstWeekContainsDate),a.setUTCHours(0,0,0,0),Hs(a,d)}var m=!("era"in i)||i.era===1?o.year:1-o.year;return a.setUTCFullYear(m,0,d.firstWeekContainsDate),a.setUTCHours(0,0,0,0),Hs(a,d)}}]),n}($t),q0=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",130),Be(Ye(s),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i){return ho(i==="R"?4:i.length,a)}},{key:"set",value:function(a,i,o){var d=new Date(0);return d.setUTCFullYear(o,0,4),d.setUTCHours(0,0,0,0),Ta(d)}}]),n}($t),G0=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",130),Be(Ye(s),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i){return ho(i==="u"?4:i.length,a)}},{key:"set",value:function(a,i,o){return a.setUTCFullYear(o,0,1),a.setUTCHours(0,0,0,0),a}}]),n}($t),K0=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",120),Be(Ye(s),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"Q":case"QQ":return gn(i.length,a);case"Qo":return o.ordinalNumber(a,{unit:"quarter"});case"QQQ":return o.quarter(a,{width:"abbreviated",context:"formatting"})||o.quarter(a,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(a,{width:"wide",context:"formatting"})||o.quarter(a,{width:"abbreviated",context:"formatting"})||o.quarter(a,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(a,i){return i>=1&&i<=4}},{key:"set",value:function(a,i,o){return a.setUTCMonth((o-1)*3,1),a.setUTCHours(0,0,0,0),a}}]),n}($t),Q0=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",120),Be(Ye(s),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"q":case"qq":return gn(i.length,a);case"qo":return o.ordinalNumber(a,{unit:"quarter"});case"qqq":return o.quarter(a,{width:"abbreviated",context:"standalone"})||o.quarter(a,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(a,{width:"wide",context:"standalone"})||o.quarter(a,{width:"abbreviated",context:"standalone"})||o.quarter(a,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(a,i){return i>=1&&i<=4}},{key:"set",value:function(a,i,o){return a.setUTCMonth((o-1)*3,1),a.setUTCHours(0,0,0,0),a}}]),n}($t),X0=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),Be(Ye(s),"priority",110),s}return It(n,[{key:"parse",value:function(a,i,o){var d=function(h){return h-1};switch(i){case"M":return wn(pn(vn.month,a),d);case"MM":return wn(gn(2,a),d);case"Mo":return wn(o.ordinalNumber(a,{unit:"month"}),d);case"MMM":return o.month(a,{width:"abbreviated",context:"formatting"})||o.month(a,{width:"narrow",context:"formatting"});case"MMMMM":return o.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return o.month(a,{width:"wide",context:"formatting"})||o.month(a,{width:"abbreviated",context:"formatting"})||o.month(a,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(a,i){return i>=0&&i<=11}},{key:"set",value:function(a,i,o){return a.setUTCMonth(o,1),a.setUTCHours(0,0,0,0),a}}]),n}($t),J0=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",110),Be(Ye(s),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){var d=function(h){return h-1};switch(i){case"L":return wn(pn(vn.month,a),d);case"LL":return wn(gn(2,a),d);case"Lo":return wn(o.ordinalNumber(a,{unit:"month"}),d);case"LLL":return o.month(a,{width:"abbreviated",context:"standalone"})||o.month(a,{width:"narrow",context:"standalone"});case"LLLLL":return o.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return o.month(a,{width:"wide",context:"standalone"})||o.month(a,{width:"abbreviated",context:"standalone"})||o.month(a,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(a,i){return i>=0&&i<=11}},{key:"set",value:function(a,i,o){return a.setUTCMonth(o,1),a.setUTCHours(0,0,0,0),a}}]),n}($t);function Z0(r,t,n){ze(2,arguments);var s=Oe(r),a=Wt(t),i=vh(s,n)-a;return s.setUTCDate(s.getUTCDate()-i*7),s}var ey=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",100),Be(Ye(s),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"w":return pn(vn.week,a);case"wo":return o.ordinalNumber(a,{unit:"week"});default:return gn(i.length,a)}}},{key:"validate",value:function(a,i){return i>=1&&i<=53}},{key:"set",value:function(a,i,o,d){return Hs(Z0(a,o,d),d)}}]),n}($t);function ty(r,t){ze(2,arguments);var n=Oe(r),s=Wt(t),a=jh(n)-s;return n.setUTCDate(n.getUTCDate()-a*7),n}var ny=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",100),Be(Ye(s),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"I":return pn(vn.week,a);case"Io":return o.ordinalNumber(a,{unit:"week"});default:return gn(i.length,a)}}},{key:"validate",value:function(a,i){return i>=1&&i<=53}},{key:"set",value:function(a,i,o){return Ta(ty(a,o))}}]),n}($t),ry=[31,28,31,30,31,30,31,31,30,31,30,31],sy=[31,29,31,30,31,30,31,31,30,31,30,31],ay=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",90),Be(Ye(s),"subPriority",1),Be(Ye(s),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"d":return pn(vn.date,a);case"do":return o.ordinalNumber(a,{unit:"date"});default:return gn(i.length,a)}}},{key:"validate",value:function(a,i){var o=a.getUTCFullYear(),d=Rh(o),u=a.getUTCMonth();return d?i>=1&&i<=sy[u]:i>=1&&i<=ry[u]}},{key:"set",value:function(a,i,o){return a.setUTCDate(o),a.setUTCHours(0,0,0,0),a}}]),n}($t),iy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",90),Be(Ye(s),"subpriority",1),Be(Ye(s),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"D":case"DD":return pn(vn.dayOfYear,a);case"Do":return o.ordinalNumber(a,{unit:"date"});default:return gn(i.length,a)}}},{key:"validate",value:function(a,i){var o=a.getUTCFullYear(),d=Rh(o);return d?i>=1&&i<=366:i>=1&&i<=365}},{key:"set",value:function(a,i,o){return a.setUTCMonth(0,o),a.setUTCHours(0,0,0,0),a}}]),n}($t);function kc(r,t,n){var s,a,i,o,d,u,h,m;ze(2,arguments);var x=Jr(),g=Wt((s=(a=(i=(o=n==null?void 0:n.weekStartsOn)!==null&&o!==void 0?o:n==null||(d=n.locale)===null||d===void 0||(u=d.options)===null||u===void 0?void 0:u.weekStartsOn)!==null&&i!==void 0?i:x.weekStartsOn)!==null&&a!==void 0?a:(h=x.locale)===null||h===void 0||(m=h.options)===null||m===void 0?void 0:m.weekStartsOn)!==null&&s!==void 0?s:0);if(!(g>=0&&g<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=Oe(r),y=Wt(t),j=f.getUTCDay(),b=y%7,v=(b+7)%7,P=(v<g?7:0)+y-j;return f.setUTCDate(f.getUTCDate()+P),f}var oy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",90),Be(Ye(s),"incompatibleTokens",["D","i","e","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"E":case"EE":case"EEE":return o.day(a,{width:"abbreviated",context:"formatting"})||o.day(a,{width:"short",context:"formatting"})||o.day(a,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(a,{width:"short",context:"formatting"})||o.day(a,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(a,{width:"wide",context:"formatting"})||o.day(a,{width:"abbreviated",context:"formatting"})||o.day(a,{width:"short",context:"formatting"})||o.day(a,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(a,i){return i>=0&&i<=6}},{key:"set",value:function(a,i,o,d){return a=kc(a,o,d),a.setUTCHours(0,0,0,0),a}}]),n}($t),ly=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",90),Be(Ye(s),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o,d){var u=function(m){var x=Math.floor((m-1)/7)*7;return(m+d.weekStartsOn+6)%7+x};switch(i){case"e":case"ee":return wn(gn(i.length,a),u);case"eo":return wn(o.ordinalNumber(a,{unit:"day"}),u);case"eee":return o.day(a,{width:"abbreviated",context:"formatting"})||o.day(a,{width:"short",context:"formatting"})||o.day(a,{width:"narrow",context:"formatting"});case"eeeee":return o.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return o.day(a,{width:"short",context:"formatting"})||o.day(a,{width:"narrow",context:"formatting"});case"eeee":default:return o.day(a,{width:"wide",context:"formatting"})||o.day(a,{width:"abbreviated",context:"formatting"})||o.day(a,{width:"short",context:"formatting"})||o.day(a,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(a,i){return i>=0&&i<=6}},{key:"set",value:function(a,i,o,d){return a=kc(a,o,d),a.setUTCHours(0,0,0,0),a}}]),n}($t),cy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",90),Be(Ye(s),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o,d){var u=function(m){var x=Math.floor((m-1)/7)*7;return(m+d.weekStartsOn+6)%7+x};switch(i){case"c":case"cc":return wn(gn(i.length,a),u);case"co":return wn(o.ordinalNumber(a,{unit:"day"}),u);case"ccc":return o.day(a,{width:"abbreviated",context:"standalone"})||o.day(a,{width:"short",context:"standalone"})||o.day(a,{width:"narrow",context:"standalone"});case"ccccc":return o.day(a,{width:"narrow",context:"standalone"});case"cccccc":return o.day(a,{width:"short",context:"standalone"})||o.day(a,{width:"narrow",context:"standalone"});case"cccc":default:return o.day(a,{width:"wide",context:"standalone"})||o.day(a,{width:"abbreviated",context:"standalone"})||o.day(a,{width:"short",context:"standalone"})||o.day(a,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(a,i){return i>=0&&i<=6}},{key:"set",value:function(a,i,o,d){return a=kc(a,o,d),a.setUTCHours(0,0,0,0),a}}]),n}($t);function dy(r,t){ze(2,arguments);var n=Wt(t);n%7===0&&(n=n-7);var s=1,a=Oe(r),i=a.getUTCDay(),o=n%7,d=(o+7)%7,u=(d<s?7:0)+n-i;return a.setUTCDate(a.getUTCDate()+u),a}var uy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",90),Be(Ye(s),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){var d=function(h){return h===0?7:h};switch(i){case"i":case"ii":return gn(i.length,a);case"io":return o.ordinalNumber(a,{unit:"day"});case"iii":return wn(o.day(a,{width:"abbreviated",context:"formatting"})||o.day(a,{width:"short",context:"formatting"})||o.day(a,{width:"narrow",context:"formatting"}),d);case"iiiii":return wn(o.day(a,{width:"narrow",context:"formatting"}),d);case"iiiiii":return wn(o.day(a,{width:"short",context:"formatting"})||o.day(a,{width:"narrow",context:"formatting"}),d);case"iiii":default:return wn(o.day(a,{width:"wide",context:"formatting"})||o.day(a,{width:"abbreviated",context:"formatting"})||o.day(a,{width:"short",context:"formatting"})||o.day(a,{width:"narrow",context:"formatting"}),d)}}},{key:"validate",value:function(a,i){return i>=1&&i<=7}},{key:"set",value:function(a,i,o){return a=dy(a,o),a.setUTCHours(0,0,0,0),a}}]),n}($t),hy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",80),Be(Ye(s),"incompatibleTokens",["b","B","H","k","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"a":case"aa":case"aaa":return o.dayPeriod(a,{width:"abbreviated",context:"formatting"})||o.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(a,{width:"wide",context:"formatting"})||o.dayPeriod(a,{width:"abbreviated",context:"formatting"})||o.dayPeriod(a,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(a,i,o){return a.setUTCHours(Cc(o),0,0,0),a}}]),n}($t),my=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",80),Be(Ye(s),"incompatibleTokens",["a","B","H","k","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"b":case"bb":case"bbb":return o.dayPeriod(a,{width:"abbreviated",context:"formatting"})||o.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(a,{width:"wide",context:"formatting"})||o.dayPeriod(a,{width:"abbreviated",context:"formatting"})||o.dayPeriod(a,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(a,i,o){return a.setUTCHours(Cc(o),0,0,0),a}}]),n}($t),xy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",80),Be(Ye(s),"incompatibleTokens",["a","b","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"B":case"BB":case"BBB":return o.dayPeriod(a,{width:"abbreviated",context:"formatting"})||o.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(a,{width:"wide",context:"formatting"})||o.dayPeriod(a,{width:"abbreviated",context:"formatting"})||o.dayPeriod(a,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(a,i,o){return a.setUTCHours(Cc(o),0,0,0),a}}]),n}($t),py=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",70),Be(Ye(s),"incompatibleTokens",["H","K","k","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"h":return pn(vn.hour12h,a);case"ho":return o.ordinalNumber(a,{unit:"hour"});default:return gn(i.length,a)}}},{key:"validate",value:function(a,i){return i>=1&&i<=12}},{key:"set",value:function(a,i,o){var d=a.getUTCHours()>=12;return d&&o<12?a.setUTCHours(o+12,0,0,0):!d&&o===12?a.setUTCHours(0,0,0,0):a.setUTCHours(o,0,0,0),a}}]),n}($t),gy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",70),Be(Ye(s),"incompatibleTokens",["a","b","h","K","k","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"H":return pn(vn.hour23h,a);case"Ho":return o.ordinalNumber(a,{unit:"hour"});default:return gn(i.length,a)}}},{key:"validate",value:function(a,i){return i>=0&&i<=23}},{key:"set",value:function(a,i,o){return a.setUTCHours(o,0,0,0),a}}]),n}($t),fy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",70),Be(Ye(s),"incompatibleTokens",["h","H","k","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"K":return pn(vn.hour11h,a);case"Ko":return o.ordinalNumber(a,{unit:"hour"});default:return gn(i.length,a)}}},{key:"validate",value:function(a,i){return i>=0&&i<=11}},{key:"set",value:function(a,i,o){var d=a.getUTCHours()>=12;return d&&o<12?a.setUTCHours(o+12,0,0,0):a.setUTCHours(o,0,0,0),a}}]),n}($t),yy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",70),Be(Ye(s),"incompatibleTokens",["a","b","h","H","K","t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"k":return pn(vn.hour24h,a);case"ko":return o.ordinalNumber(a,{unit:"hour"});default:return gn(i.length,a)}}},{key:"validate",value:function(a,i){return i>=1&&i<=24}},{key:"set",value:function(a,i,o){var d=o<=24?o%24:o;return a.setUTCHours(d,0,0,0),a}}]),n}($t),by=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",60),Be(Ye(s),"incompatibleTokens",["t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"m":return pn(vn.minute,a);case"mo":return o.ordinalNumber(a,{unit:"minute"});default:return gn(i.length,a)}}},{key:"validate",value:function(a,i){return i>=0&&i<=59}},{key:"set",value:function(a,i,o){return a.setUTCMinutes(o,0,0),a}}]),n}($t),jy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",50),Be(Ye(s),"incompatibleTokens",["t","T"]),s}return It(n,[{key:"parse",value:function(a,i,o){switch(i){case"s":return pn(vn.second,a);case"so":return o.ordinalNumber(a,{unit:"second"});default:return gn(i.length,a)}}},{key:"validate",value:function(a,i){return i>=0&&i<=59}},{key:"set",value:function(a,i,o){return a.setUTCSeconds(o,0),a}}]),n}($t),vy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",30),Be(Ye(s),"incompatibleTokens",["t","T"]),s}return It(n,[{key:"parse",value:function(a,i){var o=function(u){return Math.floor(u*Math.pow(10,-i.length+3))};return wn(gn(i.length,a),o)}},{key:"set",value:function(a,i,o){return a.setUTCMilliseconds(o),a}}]),n}($t),wy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",10),Be(Ye(s),"incompatibleTokens",["t","T","x"]),s}return It(n,[{key:"parse",value:function(a,i){switch(i){case"X":return Hr($r.basicOptionalMinutes,a);case"XX":return Hr($r.basic,a);case"XXXX":return Hr($r.basicOptionalSeconds,a);case"XXXXX":return Hr($r.extendedOptionalSeconds,a);case"XXX":default:return Hr($r.extended,a)}}},{key:"set",value:function(a,i,o){return i.timestampIsSet?a:new Date(a.getTime()-o)}}]),n}($t),Sy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",10),Be(Ye(s),"incompatibleTokens",["t","T","X"]),s}return It(n,[{key:"parse",value:function(a,i){switch(i){case"x":return Hr($r.basicOptionalMinutes,a);case"xx":return Hr($r.basic,a);case"xxxx":return Hr($r.basicOptionalSeconds,a);case"xxxxx":return Hr($r.extendedOptionalSeconds,a);case"xxx":default:return Hr($r.extended,a)}}},{key:"set",value:function(a,i,o){return i.timestampIsSet?a:new Date(a.getTime()-o)}}]),n}($t),Ty=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",40),Be(Ye(s),"incompatibleTokens","*"),s}return It(n,[{key:"parse",value:function(a){return Ah(a)}},{key:"set",value:function(a,i,o){return[new Date(o*1e3),{timestampIsSet:!0}]}}]),n}($t),Cy=function(r){Ft(n,r);var t=zt(n);function n(){var s;At(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return s=t.call.apply(t,[this].concat(i)),Be(Ye(s),"priority",20),Be(Ye(s),"incompatibleTokens","*"),s}return It(n,[{key:"parse",value:function(a){return Ah(a)}},{key:"set",value:function(a,i,o){return[new Date(o),{timestampIsSet:!0}]}}]),n}($t),ky={G:new U0,y:new _0,Y:new Y0,R:new q0,u:new G0,Q:new K0,q:new Q0,M:new X0,L:new J0,w:new ey,I:new ny,d:new ay,D:new iy,E:new oy,e:new ly,c:new cy,i:new uy,a:new hy,b:new my,B:new xy,h:new py,H:new gy,K:new fy,k:new yy,m:new by,s:new jy,S:new vy,X:new wy,x:new Sy,t:new Ty,T:new Cy},Py=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Dy=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ay=/^'([^]*?)'?$/,Iy=/''/g,Ry=/\S/,My=/[a-zA-Z]/;function Ny(r,t,n,s){var a,i,o,d,u,h,m,x,g,f,y,j,b,v,P,w,C,k;ze(3,arguments);var A=String(r),L=String(t),T=Jr(),M=(a=(i=s==null?void 0:s.locale)!==null&&i!==void 0?i:T.locale)!==null&&a!==void 0?a:Tc;if(!M.match)throw new RangeError("locale must contain match property");var O=Wt((o=(d=(u=(h=s==null?void 0:s.firstWeekContainsDate)!==null&&h!==void 0?h:s==null||(m=s.locale)===null||m===void 0||(x=m.options)===null||x===void 0?void 0:x.firstWeekContainsDate)!==null&&u!==void 0?u:T.firstWeekContainsDate)!==null&&d!==void 0?d:(g=T.locale)===null||g===void 0||(f=g.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&o!==void 0?o:1);if(!(O>=1&&O<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var I=Wt((y=(j=(b=(v=s==null?void 0:s.weekStartsOn)!==null&&v!==void 0?v:s==null||(P=s.locale)===null||P===void 0||(w=P.options)===null||w===void 0?void 0:w.weekStartsOn)!==null&&b!==void 0?b:T.weekStartsOn)!==null&&j!==void 0?j:(C=T.locale)===null||C===void 0||(k=C.options)===null||k===void 0?void 0:k.weekStartsOn)!==null&&y!==void 0?y:0);if(!(I>=0&&I<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(L==="")return A===""?Oe(n):new Date(NaN);var z={firstWeekContainsDate:O,weekStartsOn:I,locale:M},N=[new B0],E=L.match(Dy).map(function(Q){var Z=Q[0];if(Z in Ul){var J=Ul[Z];return J(Q,M.formatLong)}return Q}).join("").match(Py),R=[],V=Rd(E),F;try{var B=function(){var Z=F.value;!(s!=null&&s.useAdditionalWeekYearTokens)&&Th(Z)&&co(Z,L,r),!(s!=null&&s.useAdditionalDayOfYearTokens)&&Sh(Z)&&co(Z,L,r);var J=Z[0],ae=ky[J];if(ae){var ue=ae.incompatibleTokens;if(Array.isArray(ue)){var le=R.find(function(Me){return ue.includes(Me.token)||Me.token===J});if(le)throw new RangeError("The format string mustn't contain `".concat(le.fullToken,"` and `").concat(Z,"` at the same time"))}else if(ae.incompatibleTokens==="*"&&R.length>0)throw new RangeError("The format string mustn't contain `".concat(Z,"` and any other token at the same time"));R.push({token:J,fullToken:Z});var pe=ae.run(A,Z,M.match,z);if(!pe)return{v:new Date(NaN)};N.push(pe.setter),A=pe.rest}else{if(J.match(My))throw new RangeError("Format string contains an unescaped latin alphabet character `"+J+"`");if(Z==="''"?Z="'":J==="'"&&(Z=Ly(Z)),A.indexOf(Z)===0)A=A.slice(Z.length);else return{v:new Date(NaN)}}};for(V.s();!(F=V.n()).done;){var $=B();if(yo($)==="object")return $.v}}catch(Q){V.e(Q)}finally{V.f()}if(A.length>0&&Ry.test(A))return new Date(NaN);var Y=N.map(function(Q){return Q.priority}).sort(function(Q,Z){return Z-Q}).filter(function(Q,Z,J){return J.indexOf(Q)===Z}).map(function(Q){return N.filter(function(Z){return Z.priority===Q}).sort(function(Z,J){return J.subPriority-Z.subPriority})}).map(function(Q){return Q[0]}),_=Oe(n);if(isNaN(_.getTime()))return new Date(NaN);var K=yh(_,lo(_)),X={},ne=Rd(Y),oe;try{for(ne.s();!(oe=ne.n()).done;){var ee=oe.value;if(!ee.validate(K,z))return new Date(NaN);var H=ee.set(K,X,z);Array.isArray(H)?(K=H[0],T0(X,H[1])):K=H}}catch(Q){ne.e(Q)}finally{ne.f()}return K}function Ly(r){return r.match(Ay)[1].replace(Iy,"'")}function Md(r){ze(1,arguments);var t=Oe(r);return t.setMinutes(0,0,0),t}function Ey(r,t){ze(2,arguments);var n=Md(r),s=Md(t);return n.getTime()===s.getTime()}function Wy(r,t){ze(2,arguments);var n=Oe(r),s=Oe(t);return n.getFullYear()===s.getFullYear()&&n.getMonth()===s.getMonth()}function Fy(r,t){ze(2,arguments);var n=Oe(r),s=Oe(t);return n.getFullYear()===s.getFullYear()}function zy(r,t){ze(2,arguments);var n=Oe(r).getTime(),s=Oe(t.start).getTime(),a=Oe(t.end).getTime();if(!(s<=a))throw new RangeError("Invalid interval");return n>=s&&n<=a}function _r(r,t){var n;ze(1,arguments);var s=Wt((n=void 0)!==null&&n!==void 0?n:2);if(s!==2&&s!==1&&s!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof r=="string"||Object.prototype.toString.call(r)==="[object String]"))return new Date(NaN);var a=Hy(r),i;if(a.date){var o=By(a.date,s);i=Uy(o.restDateString,o.year)}if(!i||isNaN(i.getTime()))return new Date(NaN);var d=i.getTime(),u=0,h;if(a.time&&(u=_y(a.time),isNaN(u)))return new Date(NaN);if(a.timezone){if(h=Yy(a.timezone),isNaN(h))return new Date(NaN)}else{var m=new Date(d+u),x=new Date(0);return x.setFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()),x.setHours(m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds(),m.getUTCMilliseconds()),x}return new Date(d+u+h)}var Pi={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Oy=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Vy=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,$y=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Hy(r){var t={},n=r.split(Pi.dateTimeDelimiter),s;if(n.length>2)return t;if(/:/.test(n[0])?s=n[0]:(t.date=n[0],s=n[1],Pi.timeZoneDelimiter.test(t.date)&&(t.date=r.split(Pi.timeZoneDelimiter)[0],s=r.substr(t.date.length,r.length))),s){var a=Pi.timezone.exec(s);a?(t.time=s.replace(a[1],""),t.timezone=a[1]):t.time=s}return t}function By(r,t){var n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=r.match(n);if(!s)return{year:NaN,restDateString:""};var a=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?a:i*100,restDateString:r.slice((s[1]||s[2]).length)}}function Uy(r,t){if(t===null)return new Date(NaN);var n=r.match(Oy);if(!n)return new Date(NaN);var s=!!n[4],a=Wa(n[1]),i=Wa(n[2])-1,o=Wa(n[3]),d=Wa(n[4]),u=Wa(n[5])-1;if(s)return Xy(t,d,u)?qy(t,d,u):new Date(NaN);var h=new Date(0);return!Ky(t,i,o)||!Qy(t,a)?new Date(NaN):(h.setUTCFullYear(t,i,Math.max(a,o)),h)}function Wa(r){return r?parseInt(r):1}function _y(r){var t=r.match(Vy);if(!t)return NaN;var n=ul(t[1]),s=ul(t[2]),a=ul(t[3]);return Jy(n,s,a)?n*Io+s*Ao+a*1e3:NaN}function ul(r){return r&&parseFloat(r.replace(",","."))||0}function Yy(r){if(r==="Z")return 0;var t=r.match($y);if(!t)return 0;var n=t[1]==="+"?-1:1,s=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return Zy(s,a)?n*(s*Io+a*Ao):NaN}function qy(r,t,n){var s=new Date(0);s.setUTCFullYear(r,0,4);var a=s.getUTCDay()||7,i=(t-1)*7+n+1-a;return s.setUTCDate(s.getUTCDate()+i),s}var Gy=[31,null,31,30,31,30,31,31,30,31,30,31];function Mh(r){return r%400===0||r%4===0&&r%100!==0}function Ky(r,t,n){return t>=0&&t<=11&&n>=1&&n<=(Gy[t]||(Mh(r)?29:28))}function Qy(r,t){return t>=1&&t<=(Mh(r)?366:365)}function Xy(r,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function Jy(r,t,n){return r===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&r>=0&&r<25}function Zy(r,t){return t>=0&&t<=59}function eb(r,t){ze(2,arguments);var n=Oe(r),s=Wt(t),a=n.getFullYear(),i=n.getDate(),o=new Date(0);o.setFullYear(a,s,15),o.setHours(0,0,0,0);var d=kh(o);return n.setMonth(s,Math.min(i,d)),n}function tb(r,t){ze(2,arguments);var n=Oe(r),s=Wt(t);return n.setDate(s),n}function nb(r,t){ze(2,arguments);var n=Oe(r),s=Wt(t);return n.setHours(s),n}function rb(r,t){ze(2,arguments);var n=Oe(r),s=Wt(t);return n.setMilliseconds(s),n}function sb(r,t){ze(2,arguments);var n=Oe(r),s=Wt(t);return n.setMinutes(s),n}function ab(r,t){ze(2,arguments);var n=Oe(r),s=Wt(t);return n.setSeconds(s),n}function ib(r,t){ze(2,arguments);var n=Oe(r),s=Wt(t);return isNaN(n.getTime())?new Date(NaN):(n.setFullYear(s),n)}const Nd={USD:"$",VND:"",EUR:"",GBP:"",JPY:"",CNY:"",KRW:"",SGD:"S$",THB:"",IDR:"Rp",MYR:"RM",PHP:"",INR:"",AUD:"A$",CAD:"C$",CHF:"CHF",NZD:"NZ$"},ob=()=>{const r=localStorage.getItem("currency-show-full"),t=localStorage.getItem("currency-mask-data");return r===null&&localStorage.setItem("currency-show-full","true"),t===null&&localStorage.setItem("currency-mask-data","false"),{showFull:r===null?!0:r==="true",maskData:t===null?!1:t==="true"}},Ld=()=>{const t=!(localStorage.getItem("currency-show-full")==="true");return localStorage.setItem("currency-show-full",t.toString()),t},Ed=()=>{const t=!(localStorage.getItem("currency-mask-data")==="true");return localStorage.setItem("currency-mask-data",t.toString()),t},_i=r=>{const t=typeof r=="string"?parseFloat(r):r;return t==null||isNaN(t)||Math.abs(t)<1e-8?0:t},G=(r,t="VND",n={},s="en-US")=>{s="en-US";const a=typeof r=="string"?parseFloat(r):r,{compact:i=!1,precision:o=t==="VND"?0:2,showSymbol:d=!0}=n;if(a==null||isNaN(a))return new Intl.NumberFormat(s,{style:"currency",currency:t,minimumFractionDigits:o,maximumFractionDigits:o,notation:i?"compact":"standard"}).format(0);const u=_i(a),h=localStorage.getItem("currency-show-full"),m=h===null?!0:h==="true",x=localStorage.getItem("currency-mask-data");if(x===null?!1:x==="true")return d?`*** ${Nd[t]||t}`:"***";if(Math.abs(u)>=1e6&&!m){const y=u/1e6,j=new Intl.NumberFormat(s,{minimumFractionDigits:0,maximumFractionDigits:1}).format(y);let b="",v="";switch(t){case"VND":b="tr",v="";break;case"USD":b="M",v="$";break;case"EUR":b="M",v="";break;case"GBP":b="M",v="";break;case"JPY":b="M",v="";break;case"CNY":b="M",v="";break;case"KRW":b="M",v="";break;case"SGD":b="M",v="S$";break;case"THB":b="M",v="";break;case"IDR":b="M",v="Rp";break;case"MYR":b="M",v="RM";break;case"PHP":b="M",v="";break;case"INR":b="M",v="";break;default:b="M",v=t;break}return d?`${j}${b} ${v}`:`${j}${b}`}const f=new Intl.NumberFormat(s,{minimumFractionDigits:o,maximumFractionDigits:o,notation:i?"compact":"standard"}).format(u);if(d){const y=Nd[t]||t;return`${f} ${y}`}return f},dn=(r,t=2,n="en-US")=>{n="en-US";const s=typeof r=="string"?parseFloat(r):r;return s==null||isNaN(s)?new Intl.NumberFormat(n,{minimumFractionDigits:t,maximumFractionDigits:t}).format(0):new Intl.NumberFormat(n,{minimumFractionDigits:t,maximumFractionDigits:t}).format(s)},ye=(r,t=2,n="en-US")=>{n="en-US";const s=typeof r=="string"?parseFloat(r):r;return s==null||isNaN(s)?new Intl.NumberFormat(n,{style:"percent",minimumFractionDigits:t,maximumFractionDigits:t}).format(0):new Intl.NumberFormat(n,{style:"percent",minimumFractionDigits:t,maximumFractionDigits:t}).format(s/100)},In=(r,t=1,n="en-US")=>{n="en-US";const s=typeof r=="string"?parseFloat(r):r;return s==null||isNaN(s)?new Intl.NumberFormat(n,{minimumFractionDigits:t,maximumFractionDigits:t}).format(0)+"%":new Intl.NumberFormat(n,{minimumFractionDigits:t,maximumFractionDigits:t}).format(s)+"%"},lb=(r,t=2,n="en-US")=>(n="en-US",r==null||isNaN(r)?new Intl.NumberFormat(n,{minimumFractionDigits:t,maximumFractionDigits:t}).format(0)+"%":new Intl.NumberFormat(n,{minimumFractionDigits:t,maximumFractionDigits:t}).format(r)+"%"),Vn=(r,t=0,n="en-US")=>(n="en-US",r==null||isNaN(r)?new Intl.NumberFormat(n,{minimumFractionDigits:t,maximumFractionDigits:t}).format(0):new Intl.NumberFormat(n,{minimumFractionDigits:t,maximumFractionDigits:t}).format(r)),Gt=(r,t="short",n="en-US")=>{if(n="en-US",!r)return"N/A";const s=typeof r=="string"?new Date(r):r;if(isNaN(s.getTime()))return"Invalid Date";if(typeof t=="string"&&!["short","medium","long","full"].includes(t))return cb(s,t);const a={short:{year:"numeric",month:"short",day:"numeric"},medium:{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"},long:{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},full:{year:"numeric",month:"long",day:"numeric",weekday:"long",hour:"2-digit",minute:"2-digit"}};return new Intl.DateTimeFormat(n,a[t]).format(s)},cb=(r,t)=>{const n=r.getDate().toString().padStart(2,"0"),s=(r.getMonth()+1).toString().padStart(2,"0"),a=r.getFullYear(),i=r.getHours().toString().padStart(2,"0"),o=r.getMinutes().toString().padStart(2,"0"),d=r.getSeconds().toString().padStart(2,"0");let u=t;return u=u.replace(/yyyy/g,a.toString()),u=u.replace(/MM/g,s),u=u.replace(/dd/g,n),u=u.replace(/HH/g,i),u=u.replace(/mm/g,o),u=u.replace(/ss/g,d),u},Pc=(r,t="MMM dd, yyyy")=>{try{const n=typeof r=="string"?_r(r):r;return fn(n,t)}catch{return"Invalid Date"}},db=(r,t="MMM dd, yyyy HH:mm")=>Pc(r,t),vr=({value:r,onChange:t,label:n="Amount",placeholder:s="Enter amount (e.g., 1,000,000)",helperText:a,error:i=!1,required:o=!1,disabled:d=!1,currency:u="VND",showCurrency:h=!0,align:m="right",size:x="medium",fullWidth:g=!0,margin:f="none",variant:y="outlined",onBlur:j,onFocus:b})=>{const[v,P]=p.useState(""),[w,C]=p.useState(!1),k=p.useRef(null);p.useEffect(()=>{w||(r>=0?P(G(r,u)):P(""))},[r,w]),p.useEffect(()=>{if(w&&k.current&&k.current.value){const O=k.current.value.length;k.current.setSelectionRange(O,O)}},[v,w]);const A=O=>{const I=O.target.value;if(I===""){P(""),w||t(0);return}const z=I.replace(/[^\d.-]/g,""),N=parseFloat(z)||0;w||t(N),w?N>=0?P(N.toLocaleString("en-US")):P(""):N>=0?P(G(N,u)):P("")},L=()=>{C(!0),r>=0?P(r.toLocaleString("en-US")):P(""),setTimeout(()=>{k.current&&typeof k.current.select=="function"&&k.current.select()},0),b==null||b()},T=()=>{C(!1);const O=v.replace(/[^\d.-]/g,""),I=parseFloat(O);O.trim()!==""&&(isNaN(I)||(I!==r&&t(I),I>=0?P(G(I,u)):P(""),j==null||j()))},M=()=>{if(a)return a};return e.jsx(Ae,{ref:k,fullWidth:g,label:n,value:v,onChange:A,onFocus:L,onBlur:T,margin:f,required:o,disabled:d,error:i,variant:y,size:x,placeholder:s,autoComplete:"off",inputProps:{style:{textAlign:m}},InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx(Ue,{color:"action"})}),endAdornment:h&&r>=0&&e.jsx(un,{position:"end"})},helperText:M()})},ub=({value:r,onChange:t,existingSources:n=[],label:s,placeholder:a,error:i=!1,required:o=!1,disabled:d=!1,allowNew:u=!0,size:h="medium",fullWidth:m=!0,margin:x="normal",variant:g="outlined",onBlur:f,onFocus:y,onCreateNew:j})=>{const{t:b}=Ne(),[v,P]=p.useState(!1),[w,C]=p.useState(!1),[k,A]=p.useState([]);p.useEffect(()=>{if(w)if(!r)A(n);else{const N=n.filter(E=>E.toLowerCase().includes(r.toLowerCase()));A(N)}},[r,n,w]);const L=N=>{const E=N.target.value.toUpperCase();t(E)},T=()=>{C(!0),y==null||y()},M=()=>{setTimeout(()=>C(!1),200),f==null||f()},O=N=>{t(N),P(!1),C(!1)},I=()=>{P(!0),t(""),C(!1)},z=()=>{v?(P(!1),t("")):(P(!0),t("")),C(!1)};return e.jsxs(l,{sx:{position:"relative"},children:[e.jsx(Ae,{fullWidth:m,label:s||b("fundingSource.inputLabel"),value:r,onChange:L,onFocus:T,onBlur:M,margin:x,required:o,disabled:d,error:i,variant:g,size:h,placeholder:a||b("fundingSource.inputPlaceholder"),inputProps:{style:{textTransform:"uppercase"}},InputProps:{endAdornment:u&&e.jsx(un,{position:"end",children:e.jsx(Ie,{edge:"end",onClick:z,size:"small",disabled:d,children:v?e.jsx(zs,{fontSize:"small"}):e.jsx(xt,{fontSize:"small"})})})}}),!v&&w&&k.length>0&&e.jsxs(Te,{sx:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,maxHeight:200,overflow:"auto",mt:-1,boxShadow:2},children:[k.map(N=>e.jsx(l,{sx:{p:1.5,cursor:"pointer","&:hover":{backgroundColor:"action.hover"},borderBottom:"1px solid",borderColor:"divider"},onClick:()=>O(N),children:e.jsx(D,{variant:"body2",children:N})},N)),u&&e.jsx(l,{sx:{p:1.5,cursor:"pointer","&:hover":{backgroundColor:"action.hover"},borderTop:"1px solid",borderColor:"divider",backgroundColor:"primary.light"},onClick:I,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(xt,{fontSize:"small"}),e.jsx(D,{variant:"body2",sx:{fontStyle:"italic"},children:b("cashflow.fundingSource.enterNewSource")})]})})]})]})},gi=({value:r,onChange:t,label:n="Number",placeholder:s="Enter number",helperText:a,error:i=!1,required:o=!1,disabled:d=!1,min:u,max:h,step:m=1,decimalPlaces:x=0,showThousandsSeparator:g=!0,align:f="right",size:y="medium",fullWidth:j=!0,margin:b="none",variant:v="outlined",onBlur:P,onFocus:w,prefix:C="",suffix:k="",showIcon:A=!0})=>{const[L,T]=p.useState(""),[M,O]=p.useState(!1),I=p.useRef(null),z=B=>{const $=typeof B=="string"?parseFloat(B):B;if($==null||isNaN($))return"";if($===0)return"0";let Y;return g?Y=$.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:x}):Y=$.toFixed(Math.min(x,10)),Y};p.useEffect(()=>{if(!M){const B=typeof r=="string"?parseFloat(r):r;B!=null&&!isNaN(B)?T(z(B)):T("")}},[r,x,g,M]);const N=B=>{const $=B.target.value;if($===""){T(""),t(0);return}let Y=$.replace(/[^\d.-]/g,"");if(Y.startsWith("-")?Y="-"+Y.substring(1).replace(/[^\d.]/g,""):Y=Y.replace(/[^\d.]/g,""),Y.includes(".")){const X=Y.split(".");X[1]&&X[1].length>x&&(Y=X[0]+"."+X[1].substring(0,x))}const _=parseFloat(Y)||0;let K=_;u!==void 0&&_<u&&(K=u),h!==void 0&&_>h&&(K=h),M||t(K),T(M?Y:z(K))},E=()=>{O(!0);const B=typeof r=="string"?parseFloat(r):r;B!=null&&!isNaN(B)?T(B.toString()):T(""),setTimeout(()=>{I.current&&typeof I.current.select=="function"&&I.current.select()},0),w==null||w()},R=()=>{O(!1);const B=parseFloat(L);if(L.trim()===""||isNaN(B))return;let $=B;u!==void 0&&B>0&&B<u&&($=u),h!==void 0&&B>h&&($=h);const Y=typeof r=="string"?parseFloat(r):r;$!==Y&&t($),$!=null&&!isNaN($)?T(z($)):T(""),P==null||P()},V=()=>{if(a)return a},F=()=>{const B={style:{textAlign:f}};return u!==void 0&&(B.min=u),h!==void 0&&(B.max=h),m!==void 0&&(B.step=m),B};return e.jsx(Ae,{ref:I,fullWidth:j,label:n,value:L,onChange:N,onFocus:E,onBlur:R,margin:b,required:o,disabled:d,error:i,variant:v,size:y,placeholder:s,autoComplete:"off",inputProps:F(),InputProps:{startAdornment:A?e.jsx(un,{position:"start",children:e.jsx(Ox,{color:"action"})}):C?e.jsx(un,{position:"start",children:e.jsx(D,{variant:"body2",color:"text.secondary",children:C})}):void 0,endAdornment:k?e.jsx(un,{position:"end",children:e.jsx(D,{variant:"body2",color:"text.secondary",children:k})}):void 0},helperText:V()})},hb=({placement:r="top",size:t="small",color:n="primary"})=>{const[s,a]=p.useState("top"),i=p.useRef(null);p.useEffect(()=>{const u=()=>{if(!i.current)return;const h=i.current.getBoundingClientRect(),m=window.innerHeight,x=window.innerWidth,g=h.top,f=m-h.bottom,y=h.left,j=x-h.right,b=400,v=300;f>=v+20?a("bottom"):g>=v+20?a("top"):j>=b+20?a("right"):y>=b+20?a("left"):a("bottom")};return u(),window.addEventListener("scroll",u),window.addEventListener("resize",u),()=>{window.removeEventListener("scroll",u),window.removeEventListener("resize",u)}},[]);const o=r==="top"?s:r,d=e.jsxs(l,{sx:{maxWidth:600,p:1},children:[e.jsxs(l,{sx:{mb:2},children:[e.jsx(D,{variant:"h6",fontWeight:"bold",color:"primary.main",gutterBottom:!0,children:"FIFO (First In, First Out)"}),e.jsx(D,{variant:"body2",color:"text.secondary",children:'Phng php tnh li/l thc hin trong giao dch  "accounting style"'})]}),e.jsxs(l,{sx:{display:"flex",gap:2,mb:2},children:[e.jsxs(l,{sx:{flex:1},children:[e.jsxs(l,{sx:{mb:2},children:[e.jsx(D,{variant:"body2",fontWeight:"medium",gutterBottom:!0,children:"Nguyn tc hot ng:"}),e.jsx(D,{variant:"body2",sx:{mb:1},children:"Khi bn c phiu, h thng s t ng khp vi cc lnh mua theo th t thi gian (mua trc, bn trc)."})]}),e.jsxs(l,{sx:{mb:2},children:[e.jsx(D,{variant:"body2",fontWeight:"medium",gutterBottom:!0,children:"V d thc t:"}),e.jsxs(lt,{dense:!0,sx:{py:0},children:[e.jsx(Pe,{sx:{px:0,py:.5},children:e.jsx(ve,{primary:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(He,{color:"success",fontSize:"small"}),e.jsx(D,{variant:"body2",children:"Mua 100 c phiu A @ 50,000 VND (01/01)"})]})})}),e.jsx(Pe,{sx:{px:0,py:.5},children:e.jsx(ve,{primary:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(He,{color:"success",fontSize:"small"}),e.jsx(D,{variant:"body2",children:"Mua 50 c phiu A @ 55,000 VND (15/01)"})]})})}),e.jsx(Pe,{sx:{px:0,py:.5},children:e.jsx(ve,{primary:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Bt,{color:"error",fontSize:"small"}),e.jsx(D,{variant:"body2",children:"Bn 80 c phiu A @ 60,000 VND (20/01)"})]})})})]})]})]}),e.jsxs(l,{sx:{flex:1},children:[e.jsxs(l,{sx:{mb:2},children:[e.jsx(D,{variant:"body2",fontWeight:"medium",gutterBottom:!0,children:"Cch tnh FIFO:"}),e.jsxs(lt,{dense:!0,sx:{py:0},children:[e.jsx(Pe,{sx:{px:0,py:.5},children:e.jsx(ve,{primary:e.jsx(D,{variant:"body2",children:" 80 c phiu bn s c khp vi: 80 c phiu mua u tin @ 50,000 VND"})})}),e.jsx(Pe,{sx:{px:0,py:.5},children:e.jsx(ve,{primary:e.jsx(D,{variant:"body2",children:" Li thc hin = (60,000 - 50,000)  80 = 800,000 VND"})})}),e.jsx(Pe,{sx:{px:0,py:.5},children:e.jsx(ve,{primary:e.jsx(D,{variant:"body2",children:" S c phiu cn li: 70 c phiu (20 t ln mua u + 50 t ln mua th 2)"})})})]})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"body2",fontWeight:"medium",gutterBottom:!0,children:"Li ch ca FIFO:"}),e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsx(ce,{label:"n gin, d hiu",size:"small",color:"primary",variant:"outlined",sx:{alignSelf:"flex-start"}}),e.jsx(ce,{label:"Tun th chun k ton",size:"small",color:"secondary",variant:"outlined",sx:{alignSelf:"flex-start"}}),e.jsx(ce,{label:"T ng ha",size:"small",color:"success",variant:"outlined",sx:{alignSelf:"flex-start"}})]}),e.jsxs(l,{sx:{mt:1.5,p:1.5,bgcolor:"grey.50",borderRadius:1,border:"1px solid",borderColor:"grey.200"},children:[e.jsx(D,{variant:"caption",fontWeight:"medium",color:"text.secondary",gutterBottom:!0,children:' "Accounting Style" ngha l:'}),e.jsx(D,{variant:"caption",display:"block",sx:{mt:.5},children:" Tun th chun k ton quc t (IFRS/GAAP)"}),e.jsx(D,{variant:"caption",display:"block",children:" Ph hp vi bo co ti chnh chuyn nghip"}),e.jsx(D,{variant:"caption",display:"block",children:" c cc t chc ti chnh cng nhn"})]})]})]})]})]});return e.jsx(Fe,{title:d,placement:o,arrow:!0,componentsProps:{tooltip:{sx:{bgcolor:"background.paper",color:"text.primary",border:"1px solid",borderColor:"divider",boxShadow:3,maxWidth:"none"}},arrow:{sx:{color:"background.paper","&::before":{border:"1px solid",borderColor:"divider"}}}},children:e.jsx(Ie,{ref:i,size:t,color:n,sx:{"&:hover":{bgcolor:"primary.main",color:"white"}},children:e.jsx(Vx,{})})})},he=p.forwardRef(({children:r,icon:t,endIcon:n,mobileText:s,desktopText:a,forceIconOnly:i=!1,forceTextOnly:o=!1,breakpoint:d="sm",iconSize:u="medium",responsiveSizing:h=!0,sx:m={},...x},g)=>{const f=Je(),y=Nt(f.breakpoints.down(d)),j=i||!o&&y&&(t||n),b=()=>i?null:o?r:y&&s?s:!y&&a?a:r,v=()=>{if(t){if(rt.isValidElement(t)&&h){const C={small:{xs:16,sm:18,md:20},medium:{xs:18,sm:20,md:24},large:{xs:20,sm:24,md:28}};return rt.cloneElement(t,{sx:{fontSize:C[u],...t.props.sx}})}return t}},P=()=>{if(n){if(rt.isValidElement(n)&&h){const C={small:{xs:16,sm:18,md:20},medium:{xs:18,sm:20,md:24},large:{xs:20,sm:24,md:28}};return rt.cloneElement(n,{sx:{fontSize:C[u],...n.props.sx}})}return n}},w=()=>{const C={borderRadius:2,textTransform:"none",fontWeight:500,transition:"all 0.2s ease-in-out",...m};if(!h)return C;const k={...y&&{minWidth:j?"auto":"100px",px:j?1.5:2,py:j?1.5:1,fontSize:"0.75rem","& .MuiButton-startIcon":{marginRight:j?0:.5},"& .MuiButton-endIcon":{marginLeft:j?0:.5}},...!y&&{minWidth:"120px",px:3,py:1,fontSize:"0.875rem","& .MuiButton-startIcon":{marginRight:.5},"& .MuiButton-endIcon":{marginLeft:.5}},"&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(0,0,0,0.15)"}};return{...C,...k}};return e.jsx(ut,{ref:g,...x,startIcon:j?void 0:v(),endIcon:j?P():void 0,sx:w(),children:j?v():b()})});he.displayName="ResponsiveButton";function Nh(r,t){return function(){return r.apply(t,arguments)}}const{toString:mb}=Object.prototype,{getPrototypeOf:Dc}=Object,{iterator:Mo,toStringTag:Lh}=Symbol,No=(r=>t=>{const n=mb.call(t);return r[n]||(r[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Mr=r=>(r=r.toLowerCase(),t=>No(t)===r),Lo=r=>t=>typeof t===r,{isArray:Da}=Array,oi=Lo("undefined");function fi(r){return r!==null&&!oi(r)&&r.constructor!==null&&!oi(r.constructor)&&nr(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const Eh=Mr("ArrayBuffer");function xb(r){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(r):t=r&&r.buffer&&Eh(r.buffer),t}const pb=Lo("string"),nr=Lo("function"),Wh=Lo("number"),yi=r=>r!==null&&typeof r=="object",gb=r=>r===!0||r===!1,Yi=r=>{if(No(r)!=="object")return!1;const t=Dc(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Lh in r)&&!(Mo in r)},fb=r=>{if(!yi(r)||fi(r))return!1;try{return Object.keys(r).length===0&&Object.getPrototypeOf(r)===Object.prototype}catch{return!1}},yb=Mr("Date"),bb=Mr("File"),jb=Mr("Blob"),vb=Mr("FileList"),wb=r=>yi(r)&&nr(r.pipe),Sb=r=>{let t;return r&&(typeof FormData=="function"&&r instanceof FormData||nr(r.append)&&((t=No(r))==="formdata"||t==="object"&&nr(r.toString)&&r.toString()==="[object FormData]"))},Tb=Mr("URLSearchParams"),[Cb,kb,Pb,Db]=["ReadableStream","Request","Response","Headers"].map(Mr),Ab=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function bi(r,t,{allOwnKeys:n=!1}={}){if(r===null||typeof r>"u")return;let s,a;if(typeof r!="object"&&(r=[r]),Da(r))for(s=0,a=r.length;s<a;s++)t.call(null,r[s],s,r);else{if(fi(r))return;const i=n?Object.getOwnPropertyNames(r):Object.keys(r),o=i.length;let d;for(s=0;s<o;s++)d=i[s],t.call(null,r[d],d,r)}}function Fh(r,t){if(fi(r))return null;t=t.toLowerCase();const n=Object.keys(r);let s=n.length,a;for(;s-- >0;)if(a=n[s],t===a.toLowerCase())return a;return null}const Es=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,zh=r=>!oi(r)&&r!==Es;function _l(){const{caseless:r}=zh(this)&&this||{},t={},n=(s,a)=>{const i=r&&Fh(t,a)||a;Yi(t[i])&&Yi(s)?t[i]=_l(t[i],s):Yi(s)?t[i]=_l({},s):Da(s)?t[i]=s.slice():t[i]=s};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&bi(arguments[s],n);return t}const Ib=(r,t,n,{allOwnKeys:s}={})=>(bi(t,(a,i)=>{n&&nr(a)?r[i]=Nh(a,n):r[i]=a},{allOwnKeys:s}),r),Rb=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),Mb=(r,t,n,s)=>{r.prototype=Object.create(t.prototype,s),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:t.prototype}),n&&Object.assign(r.prototype,n)},Nb=(r,t,n,s)=>{let a,i,o;const d={};if(t=t||{},r==null)return t;do{for(a=Object.getOwnPropertyNames(r),i=a.length;i-- >0;)o=a[i],(!s||s(o,r,t))&&!d[o]&&(t[o]=r[o],d[o]=!0);r=n!==!1&&Dc(r)}while(r&&(!n||n(r,t))&&r!==Object.prototype);return t},Lb=(r,t,n)=>{r=String(r),(n===void 0||n>r.length)&&(n=r.length),n-=t.length;const s=r.indexOf(t,n);return s!==-1&&s===n},Eb=r=>{if(!r)return null;if(Da(r))return r;let t=r.length;if(!Wh(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=r[t];return n},Wb=(r=>t=>r&&t instanceof r)(typeof Uint8Array<"u"&&Dc(Uint8Array)),Fb=(r,t)=>{const s=(r&&r[Mo]).call(r);let a;for(;(a=s.next())&&!a.done;){const i=a.value;t.call(r,i[0],i[1])}},zb=(r,t)=>{let n;const s=[];for(;(n=r.exec(t))!==null;)s.push(n);return s},Ob=Mr("HTMLFormElement"),Vb=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,a){return s.toUpperCase()+a}),Wd=(({hasOwnProperty:r})=>(t,n)=>r.call(t,n))(Object.prototype),$b=Mr("RegExp"),Oh=(r,t)=>{const n=Object.getOwnPropertyDescriptors(r),s={};bi(n,(a,i)=>{let o;(o=t(a,i,r))!==!1&&(s[i]=o||a)}),Object.defineProperties(r,s)},Hb=r=>{Oh(r,(t,n)=>{if(nr(r)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=r[n];if(nr(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Bb=(r,t)=>{const n={},s=a=>{a.forEach(i=>{n[i]=!0})};return Da(r)?s(r):s(String(r).split(t)),n},Ub=()=>{},_b=(r,t)=>r!=null&&Number.isFinite(r=+r)?r:t;function Yb(r){return!!(r&&nr(r.append)&&r[Lh]==="FormData"&&r[Mo])}const qb=r=>{const t=new Array(10),n=(s,a)=>{if(yi(s)){if(t.indexOf(s)>=0)return;if(fi(s))return s;if(!("toJSON"in s)){t[a]=s;const i=Da(s)?[]:{};return bi(s,(o,d)=>{const u=n(o,a+1);!oi(u)&&(i[d]=u)}),t[a]=void 0,i}}return s};return n(r,0)},Gb=Mr("AsyncFunction"),Kb=r=>r&&(yi(r)||nr(r))&&nr(r.then)&&nr(r.catch),Vh=((r,t)=>r?setImmediate:t?((n,s)=>(Es.addEventListener("message",({source:a,data:i})=>{a===Es&&i===n&&s.length&&s.shift()()},!1),a=>{s.push(a),Es.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",nr(Es.postMessage)),Qb=typeof queueMicrotask<"u"?queueMicrotask.bind(Es):typeof process<"u"&&process.nextTick||Vh,Xb=r=>r!=null&&nr(r[Mo]),we={isArray:Da,isArrayBuffer:Eh,isBuffer:fi,isFormData:Sb,isArrayBufferView:xb,isString:pb,isNumber:Wh,isBoolean:gb,isObject:yi,isPlainObject:Yi,isEmptyObject:fb,isReadableStream:Cb,isRequest:kb,isResponse:Pb,isHeaders:Db,isUndefined:oi,isDate:yb,isFile:bb,isBlob:jb,isRegExp:$b,isFunction:nr,isStream:wb,isURLSearchParams:Tb,isTypedArray:Wb,isFileList:vb,forEach:bi,merge:_l,extend:Ib,trim:Ab,stripBOM:Rb,inherits:Mb,toFlatObject:Nb,kindOf:No,kindOfTest:Mr,endsWith:Lb,toArray:Eb,forEachEntry:Fb,matchAll:zb,isHTMLForm:Ob,hasOwnProperty:Wd,hasOwnProp:Wd,reduceDescriptors:Oh,freezeMethods:Hb,toObjectSet:Bb,toCamelCase:Vb,noop:Ub,toFiniteNumber:_b,findKey:Fh,global:Es,isContextDefined:zh,isSpecCompliantForm:Yb,toJSONObject:qb,isAsyncFn:Gb,isThenable:Kb,setImmediate:Vh,asap:Qb,isIterable:Xb};function gt(r,t,n,s,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),s&&(this.request=s),a&&(this.response=a,this.status=a.status?a.status:null)}we.inherits(gt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:we.toJSONObject(this.config),code:this.code,status:this.status}}});const $h=gt.prototype,Hh={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{Hh[r]={value:r}});Object.defineProperties(gt,Hh);Object.defineProperty($h,"isAxiosError",{value:!0});gt.from=(r,t,n,s,a,i)=>{const o=Object.create($h);return we.toFlatObject(r,o,function(u){return u!==Error.prototype},d=>d!=="isAxiosError"),gt.call(o,r.message,t,n,s,a),o.cause=r,o.name=r.name,i&&Object.assign(o,i),o};const Jb=null;function Yl(r){return we.isPlainObject(r)||we.isArray(r)}function Bh(r){return we.endsWith(r,"[]")?r.slice(0,-2):r}function Fd(r,t,n){return r?r.concat(t).map(function(a,i){return a=Bh(a),!n&&i?"["+a+"]":a}).join(n?".":""):t}function Zb(r){return we.isArray(r)&&!r.some(Yl)}const ej=we.toFlatObject(we,{},null,function(t){return/^is[A-Z]/.test(t)});function Eo(r,t,n){if(!we.isObject(r))throw new TypeError("target must be an object");t=t||new FormData,n=we.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(j,b){return!we.isUndefined(b[j])});const s=n.metaTokens,a=n.visitor||m,i=n.dots,o=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&we.isSpecCompliantForm(t);if(!we.isFunction(a))throw new TypeError("visitor must be a function");function h(y){if(y===null)return"";if(we.isDate(y))return y.toISOString();if(we.isBoolean(y))return y.toString();if(!u&&we.isBlob(y))throw new gt("Blob is not supported. Use a Buffer instead.");return we.isArrayBuffer(y)||we.isTypedArray(y)?u&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function m(y,j,b){let v=y;if(y&&!b&&typeof y=="object"){if(we.endsWith(j,"{}"))j=s?j:j.slice(0,-2),y=JSON.stringify(y);else if(we.isArray(y)&&Zb(y)||(we.isFileList(y)||we.endsWith(j,"[]"))&&(v=we.toArray(y)))return j=Bh(j),v.forEach(function(w,C){!(we.isUndefined(w)||w===null)&&t.append(o===!0?Fd([j],C,i):o===null?j:j+"[]",h(w))}),!1}return Yl(y)?!0:(t.append(Fd(b,j,i),h(y)),!1)}const x=[],g=Object.assign(ej,{defaultVisitor:m,convertValue:h,isVisitable:Yl});function f(y,j){if(!we.isUndefined(y)){if(x.indexOf(y)!==-1)throw Error("Circular reference detected in "+j.join("."));x.push(y),we.forEach(y,function(v,P){(!(we.isUndefined(v)||v===null)&&a.call(t,v,we.isString(P)?P.trim():P,j,g))===!0&&f(v,j?j.concat(P):[P])}),x.pop()}}if(!we.isObject(r))throw new TypeError("data must be an object");return f(r),t}function zd(r){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(s){return t[s]})}function Ac(r,t){this._pairs=[],r&&Eo(r,this,t)}const Uh=Ac.prototype;Uh.append=function(t,n){this._pairs.push([t,n])};Uh.toString=function(t){const n=t?function(s){return t.call(this,s,zd)}:zd;return this._pairs.map(function(a){return n(a[0])+"="+n(a[1])},"").join("&")};function tj(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function _h(r,t,n){if(!t)return r;const s=n&&n.encode||tj;we.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let i;if(a?i=a(t,n):i=we.isURLSearchParams(t)?t.toString():new Ac(t,n).toString(s),i){const o=r.indexOf("#");o!==-1&&(r=r.slice(0,o)),r+=(r.indexOf("?")===-1?"?":"&")+i}return r}class Od{constructor(){this.handlers=[]}use(t,n,s){return this.handlers.push({fulfilled:t,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){we.forEach(this.handlers,function(s){s!==null&&t(s)})}}const Yh={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},nj=typeof URLSearchParams<"u"?URLSearchParams:Ac,rj=typeof FormData<"u"?FormData:null,sj=typeof Blob<"u"?Blob:null,aj={isBrowser:!0,classes:{URLSearchParams:nj,FormData:rj,Blob:sj},protocols:["http","https","file","blob","url","data"]},Ic=typeof window<"u"&&typeof document<"u",ql=typeof navigator=="object"&&navigator||void 0,ij=Ic&&(!ql||["ReactNative","NativeScript","NS"].indexOf(ql.product)<0),oj=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",lj=Ic&&window.location.href||"http://localhost",cj=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ic,hasStandardBrowserEnv:ij,hasStandardBrowserWebWorkerEnv:oj,navigator:ql,origin:lj},Symbol.toStringTag,{value:"Module"})),On={...cj,...aj};function dj(r,t){return Eo(r,new On.classes.URLSearchParams,{visitor:function(n,s,a,i){return On.isNode&&we.isBuffer(n)?(this.append(s,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function uj(r){return we.matchAll(/\w+|\[(\w*)]/g,r).map(t=>t[0]==="[]"?"":t[1]||t[0])}function hj(r){const t={},n=Object.keys(r);let s;const a=n.length;let i;for(s=0;s<a;s++)i=n[s],t[i]=r[i];return t}function qh(r){function t(n,s,a,i){let o=n[i++];if(o==="__proto__")return!0;const d=Number.isFinite(+o),u=i>=n.length;return o=!o&&we.isArray(a)?a.length:o,u?(we.hasOwnProp(a,o)?a[o]=[a[o],s]:a[o]=s,!d):((!a[o]||!we.isObject(a[o]))&&(a[o]=[]),t(n,s,a[o],i)&&we.isArray(a[o])&&(a[o]=hj(a[o])),!d)}if(we.isFormData(r)&&we.isFunction(r.entries)){const n={};return we.forEachEntry(r,(s,a)=>{t(uj(s),a,n,0)}),n}return null}function mj(r,t,n){if(we.isString(r))try{return(t||JSON.parse)(r),we.trim(r)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(r)}const ji={transitional:Yh,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const s=n.getContentType()||"",a=s.indexOf("application/json")>-1,i=we.isObject(t);if(i&&we.isHTMLForm(t)&&(t=new FormData(t)),we.isFormData(t))return a?JSON.stringify(qh(t)):t;if(we.isArrayBuffer(t)||we.isBuffer(t)||we.isStream(t)||we.isFile(t)||we.isBlob(t)||we.isReadableStream(t))return t;if(we.isArrayBufferView(t))return t.buffer;if(we.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let d;if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1)return dj(t,this.formSerializer).toString();if((d=we.isFileList(t))||s.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Eo(d?{"files[]":t}:t,u&&new u,this.formSerializer)}}return i||a?(n.setContentType("application/json",!1),mj(t)):t}],transformResponse:[function(t){const n=this.transitional||ji.transitional,s=n&&n.forcedJSONParsing,a=this.responseType==="json";if(we.isResponse(t)||we.isReadableStream(t))return t;if(t&&we.isString(t)&&(s&&!this.responseType||a)){const o=!(n&&n.silentJSONParsing)&&a;try{return JSON.parse(t)}catch(d){if(o)throw d.name==="SyntaxError"?gt.from(d,gt.ERR_BAD_RESPONSE,this,null,this.response):d}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:On.classes.FormData,Blob:On.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};we.forEach(["delete","get","head","post","put","patch"],r=>{ji.headers[r]={}});const xj=we.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),pj=r=>{const t={};let n,s,a;return r&&r.split(`
`).forEach(function(o){a=o.indexOf(":"),n=o.substring(0,a).trim().toLowerCase(),s=o.substring(a+1).trim(),!(!n||t[n]&&xj[n])&&(n==="set-cookie"?t[n]?t[n].push(s):t[n]=[s]:t[n]=t[n]?t[n]+", "+s:s)}),t},Vd=Symbol("internals");function Fa(r){return r&&String(r).trim().toLowerCase()}function qi(r){return r===!1||r==null?r:we.isArray(r)?r.map(qi):String(r)}function gj(r){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(r);)t[s[1]]=s[2];return t}const fj=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function hl(r,t,n,s,a){if(we.isFunction(s))return s.call(this,t,n);if(a&&(t=n),!!we.isString(t)){if(we.isString(s))return t.indexOf(s)!==-1;if(we.isRegExp(s))return s.test(t)}}function yj(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,s)=>n.toUpperCase()+s)}function bj(r,t){const n=we.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(r,s+n,{value:function(a,i,o){return this[s].call(this,t,a,i,o)},configurable:!0})})}let rr=class{constructor(t){t&&this.set(t)}set(t,n,s){const a=this;function i(d,u,h){const m=Fa(u);if(!m)throw new Error("header name must be a non-empty string");const x=we.findKey(a,m);(!x||a[x]===void 0||h===!0||h===void 0&&a[x]!==!1)&&(a[x||u]=qi(d))}const o=(d,u)=>we.forEach(d,(h,m)=>i(h,m,u));if(we.isPlainObject(t)||t instanceof this.constructor)o(t,n);else if(we.isString(t)&&(t=t.trim())&&!fj(t))o(pj(t),n);else if(we.isObject(t)&&we.isIterable(t)){let d={},u,h;for(const m of t){if(!we.isArray(m))throw TypeError("Object iterator must return a key-value pair");d[h=m[0]]=(u=d[h])?we.isArray(u)?[...u,m[1]]:[u,m[1]]:m[1]}o(d,n)}else t!=null&&i(n,t,s);return this}get(t,n){if(t=Fa(t),t){const s=we.findKey(this,t);if(s){const a=this[s];if(!n)return a;if(n===!0)return gj(a);if(we.isFunction(n))return n.call(this,a,s);if(we.isRegExp(n))return n.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Fa(t),t){const s=we.findKey(this,t);return!!(s&&this[s]!==void 0&&(!n||hl(this,this[s],s,n)))}return!1}delete(t,n){const s=this;let a=!1;function i(o){if(o=Fa(o),o){const d=we.findKey(s,o);d&&(!n||hl(s,s[d],d,n))&&(delete s[d],a=!0)}}return we.isArray(t)?t.forEach(i):i(t),a}clear(t){const n=Object.keys(this);let s=n.length,a=!1;for(;s--;){const i=n[s];(!t||hl(this,this[i],i,t,!0))&&(delete this[i],a=!0)}return a}normalize(t){const n=this,s={};return we.forEach(this,(a,i)=>{const o=we.findKey(s,i);if(o){n[o]=qi(a),delete n[i];return}const d=t?yj(i):String(i).trim();d!==i&&delete n[i],n[d]=qi(a),s[d]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return we.forEach(this,(s,a)=>{s!=null&&s!==!1&&(n[a]=t&&we.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const s=new this(t);return n.forEach(a=>s.set(a)),s}static accessor(t){const s=(this[Vd]=this[Vd]={accessors:{}}).accessors,a=this.prototype;function i(o){const d=Fa(o);s[d]||(bj(a,o),s[d]=!0)}return we.isArray(t)?t.forEach(i):i(t),this}};rr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);we.reduceDescriptors(rr.prototype,({value:r},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(s){this[n]=s}}});we.freezeMethods(rr);function ml(r,t){const n=this||ji,s=t||n,a=rr.from(s.headers);let i=s.data;return we.forEach(r,function(d){i=d.call(n,i,a.normalize(),t?t.status:void 0)}),a.normalize(),i}function Gh(r){return!!(r&&r.__CANCEL__)}function Aa(r,t,n){gt.call(this,r??"canceled",gt.ERR_CANCELED,t,n),this.name="CanceledError"}we.inherits(Aa,gt,{__CANCEL__:!0});function Kh(r,t,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?r(n):t(new gt("Request failed with status code "+n.status,[gt.ERR_BAD_REQUEST,gt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function jj(r){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return t&&t[1]||""}function vj(r,t){r=r||10;const n=new Array(r),s=new Array(r);let a=0,i=0,o;return t=t!==void 0?t:1e3,function(u){const h=Date.now(),m=s[i];o||(o=h),n[a]=u,s[a]=h;let x=i,g=0;for(;x!==a;)g+=n[x++],x=x%r;if(a=(a+1)%r,a===i&&(i=(i+1)%r),h-o<t)return;const f=m&&h-m;return f?Math.round(g*1e3/f):void 0}}function wj(r,t){let n=0,s=1e3/t,a,i;const o=(h,m=Date.now())=>{n=m,a=null,i&&(clearTimeout(i),i=null),r(...h)};return[(...h)=>{const m=Date.now(),x=m-n;x>=s?o(h,m):(a=h,i||(i=setTimeout(()=>{i=null,o(a)},s-x)))},()=>a&&o(a)]}const mo=(r,t,n=3)=>{let s=0;const a=vj(50,250);return wj(i=>{const o=i.loaded,d=i.lengthComputable?i.total:void 0,u=o-s,h=a(u),m=o<=d;s=o;const x={loaded:o,total:d,progress:d?o/d:void 0,bytes:u,rate:h||void 0,estimated:h&&d&&m?(d-o)/h:void 0,event:i,lengthComputable:d!=null,[t?"download":"upload"]:!0};r(x)},n)},$d=(r,t)=>{const n=r!=null;return[s=>t[0]({lengthComputable:n,total:r,loaded:s}),t[1]]},Hd=r=>(...t)=>we.asap(()=>r(...t)),Sj=On.hasStandardBrowserEnv?((r,t)=>n=>(n=new URL(n,On.origin),r.protocol===n.protocol&&r.host===n.host&&(t||r.port===n.port)))(new URL(On.origin),On.navigator&&/(msie|trident)/i.test(On.navigator.userAgent)):()=>!0,Tj=On.hasStandardBrowserEnv?{write(r,t,n,s,a,i){const o=[r+"="+encodeURIComponent(t)];we.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),we.isString(s)&&o.push("path="+s),we.isString(a)&&o.push("domain="+a),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(r){const t=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Cj(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function kj(r,t){return t?r.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):r}function Qh(r,t,n){let s=!Cj(t);return r&&(s||n==!1)?kj(r,t):t}const Bd=r=>r instanceof rr?{...r}:r;function Bs(r,t){t=t||{};const n={};function s(h,m,x,g){return we.isPlainObject(h)&&we.isPlainObject(m)?we.merge.call({caseless:g},h,m):we.isPlainObject(m)?we.merge({},m):we.isArray(m)?m.slice():m}function a(h,m,x,g){if(we.isUndefined(m)){if(!we.isUndefined(h))return s(void 0,h,x,g)}else return s(h,m,x,g)}function i(h,m){if(!we.isUndefined(m))return s(void 0,m)}function o(h,m){if(we.isUndefined(m)){if(!we.isUndefined(h))return s(void 0,h)}else return s(void 0,m)}function d(h,m,x){if(x in t)return s(h,m);if(x in r)return s(void 0,h)}const u={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:d,headers:(h,m,x)=>a(Bd(h),Bd(m),x,!0)};return we.forEach(Object.keys({...r,...t}),function(m){const x=u[m]||a,g=x(r[m],t[m],m);we.isUndefined(g)&&x!==d||(n[m]=g)}),n}const Xh=r=>{const t=Bs({},r);let{data:n,withXSRFToken:s,xsrfHeaderName:a,xsrfCookieName:i,headers:o,auth:d}=t;t.headers=o=rr.from(o),t.url=_h(Qh(t.baseURL,t.url,t.allowAbsoluteUrls),r.params,r.paramsSerializer),d&&o.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let u;if(we.isFormData(n)){if(On.hasStandardBrowserEnv||On.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((u=o.getContentType())!==!1){const[h,...m]=u?u.split(";").map(x=>x.trim()).filter(Boolean):[];o.setContentType([h||"multipart/form-data",...m].join("; "))}}if(On.hasStandardBrowserEnv&&(s&&we.isFunction(s)&&(s=s(t)),s||s!==!1&&Sj(t.url))){const h=a&&i&&Tj.read(i);h&&o.set(a,h)}return t},Pj=typeof XMLHttpRequest<"u",Dj=Pj&&function(r){return new Promise(function(n,s){const a=Xh(r);let i=a.data;const o=rr.from(a.headers).normalize();let{responseType:d,onUploadProgress:u,onDownloadProgress:h}=a,m,x,g,f,y;function j(){f&&f(),y&&y(),a.cancelToken&&a.cancelToken.unsubscribe(m),a.signal&&a.signal.removeEventListener("abort",m)}let b=new XMLHttpRequest;b.open(a.method.toUpperCase(),a.url,!0),b.timeout=a.timeout;function v(){if(!b)return;const w=rr.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),k={data:!d||d==="text"||d==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:w,config:r,request:b};Kh(function(L){n(L),j()},function(L){s(L),j()},k),b=null}"onloadend"in b?b.onloadend=v:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(v)},b.onabort=function(){b&&(s(new gt("Request aborted",gt.ECONNABORTED,r,b)),b=null)},b.onerror=function(){s(new gt("Network Error",gt.ERR_NETWORK,r,b)),b=null},b.ontimeout=function(){let C=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const k=a.transitional||Yh;a.timeoutErrorMessage&&(C=a.timeoutErrorMessage),s(new gt(C,k.clarifyTimeoutError?gt.ETIMEDOUT:gt.ECONNABORTED,r,b)),b=null},i===void 0&&o.setContentType(null),"setRequestHeader"in b&&we.forEach(o.toJSON(),function(C,k){b.setRequestHeader(k,C)}),we.isUndefined(a.withCredentials)||(b.withCredentials=!!a.withCredentials),d&&d!=="json"&&(b.responseType=a.responseType),h&&([g,y]=mo(h,!0),b.addEventListener("progress",g)),u&&b.upload&&([x,f]=mo(u),b.upload.addEventListener("progress",x),b.upload.addEventListener("loadend",f)),(a.cancelToken||a.signal)&&(m=w=>{b&&(s(!w||w.type?new Aa(null,r,b):w),b.abort(),b=null)},a.cancelToken&&a.cancelToken.subscribe(m),a.signal&&(a.signal.aborted?m():a.signal.addEventListener("abort",m)));const P=jj(a.url);if(P&&On.protocols.indexOf(P)===-1){s(new gt("Unsupported protocol "+P+":",gt.ERR_BAD_REQUEST,r));return}b.send(i||null)})},Aj=(r,t)=>{const{length:n}=r=r?r.filter(Boolean):[];if(t||n){let s=new AbortController,a;const i=function(h){if(!a){a=!0,d();const m=h instanceof Error?h:this.reason;s.abort(m instanceof gt?m:new Aa(m instanceof Error?m.message:m))}};let o=t&&setTimeout(()=>{o=null,i(new gt(`timeout ${t} of ms exceeded`,gt.ETIMEDOUT))},t);const d=()=>{r&&(o&&clearTimeout(o),o=null,r.forEach(h=>{h.unsubscribe?h.unsubscribe(i):h.removeEventListener("abort",i)}),r=null)};r.forEach(h=>h.addEventListener("abort",i));const{signal:u}=s;return u.unsubscribe=()=>we.asap(d),u}},Ij=function*(r,t){let n=r.byteLength;if(n<t){yield r;return}let s=0,a;for(;s<n;)a=s+t,yield r.slice(s,a),s=a},Rj=async function*(r,t){for await(const n of Mj(r))yield*Ij(n,t)},Mj=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const t=r.getReader();try{for(;;){const{done:n,value:s}=await t.read();if(n)break;yield s}}finally{await t.cancel()}},Ud=(r,t,n,s)=>{const a=Rj(r,t);let i=0,o,d=u=>{o||(o=!0,s&&s(u))};return new ReadableStream({async pull(u){try{const{done:h,value:m}=await a.next();if(h){d(),u.close();return}let x=m.byteLength;if(n){let g=i+=x;n(g)}u.enqueue(new Uint8Array(m))}catch(h){throw d(h),h}},cancel(u){return d(u),a.return()}},{highWaterMark:2})},Wo=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Jh=Wo&&typeof ReadableStream=="function",Nj=Wo&&(typeof TextEncoder=="function"?(r=>t=>r.encode(t))(new TextEncoder):async r=>new Uint8Array(await new Response(r).arrayBuffer())),Zh=(r,...t)=>{try{return!!r(...t)}catch{return!1}},Lj=Jh&&Zh(()=>{let r=!1;const t=new Request(On.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!t}),_d=64*1024,Gl=Jh&&Zh(()=>we.isReadableStream(new Response("").body)),xo={stream:Gl&&(r=>r.body)};Wo&&(r=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!xo[t]&&(xo[t]=we.isFunction(r[t])?n=>n[t]():(n,s)=>{throw new gt(`Response type '${t}' is not supported`,gt.ERR_NOT_SUPPORT,s)})})})(new Response);const Ej=async r=>{if(r==null)return 0;if(we.isBlob(r))return r.size;if(we.isSpecCompliantForm(r))return(await new Request(On.origin,{method:"POST",body:r}).arrayBuffer()).byteLength;if(we.isArrayBufferView(r)||we.isArrayBuffer(r))return r.byteLength;if(we.isURLSearchParams(r)&&(r=r+""),we.isString(r))return(await Nj(r)).byteLength},Wj=async(r,t)=>{const n=we.toFiniteNumber(r.getContentLength());return n??Ej(t)},Fj=Wo&&(async r=>{let{url:t,method:n,data:s,signal:a,cancelToken:i,timeout:o,onDownloadProgress:d,onUploadProgress:u,responseType:h,headers:m,withCredentials:x="same-origin",fetchOptions:g}=Xh(r);h=h?(h+"").toLowerCase():"text";let f=Aj([a,i&&i.toAbortSignal()],o),y;const j=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let b;try{if(u&&Lj&&n!=="get"&&n!=="head"&&(b=await Wj(m,s))!==0){let k=new Request(t,{method:"POST",body:s,duplex:"half"}),A;if(we.isFormData(s)&&(A=k.headers.get("content-type"))&&m.setContentType(A),k.body){const[L,T]=$d(b,mo(Hd(u)));s=Ud(k.body,_d,L,T)}}we.isString(x)||(x=x?"include":"omit");const v="credentials"in Request.prototype;y=new Request(t,{...g,signal:f,method:n.toUpperCase(),headers:m.normalize().toJSON(),body:s,duplex:"half",credentials:v?x:void 0});let P=await fetch(y,g);const w=Gl&&(h==="stream"||h==="response");if(Gl&&(d||w&&j)){const k={};["status","statusText","headers"].forEach(M=>{k[M]=P[M]});const A=we.toFiniteNumber(P.headers.get("content-length")),[L,T]=d&&$d(A,mo(Hd(d),!0))||[];P=new Response(Ud(P.body,_d,L,()=>{T&&T(),j&&j()}),k)}h=h||"text";let C=await xo[we.findKey(xo,h)||"text"](P,r);return!w&&j&&j(),await new Promise((k,A)=>{Kh(k,A,{data:C,headers:rr.from(P.headers),status:P.status,statusText:P.statusText,config:r,request:y})})}catch(v){throw j&&j(),v&&v.name==="TypeError"&&/Load failed|fetch/i.test(v.message)?Object.assign(new gt("Network Error",gt.ERR_NETWORK,r,y),{cause:v.cause||v}):gt.from(v,v&&v.code,r,y)}}),Kl={http:Jb,xhr:Dj,fetch:Fj};we.forEach(Kl,(r,t)=>{if(r){try{Object.defineProperty(r,"name",{value:t})}catch{}Object.defineProperty(r,"adapterName",{value:t})}});const Yd=r=>`- ${r}`,zj=r=>we.isFunction(r)||r===null||r===!1,em={getAdapter:r=>{r=we.isArray(r)?r:[r];const{length:t}=r;let n,s;const a={};for(let i=0;i<t;i++){n=r[i];let o;if(s=n,!zj(n)&&(s=Kl[(o=String(n)).toLowerCase()],s===void 0))throw new gt(`Unknown adapter '${o}'`);if(s)break;a[o||"#"+i]=s}if(!s){const i=Object.entries(a).map(([d,u])=>`adapter ${d} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=t?i.length>1?`since :
`+i.map(Yd).join(`
`):" "+Yd(i[0]):"as no adapter specified";throw new gt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:Kl};function xl(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Aa(null,r)}function qd(r){return xl(r),r.headers=rr.from(r.headers),r.data=ml.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),em.getAdapter(r.adapter||ji.adapter)(r).then(function(s){return xl(r),s.data=ml.call(r,r.transformResponse,s),s.headers=rr.from(s.headers),s},function(s){return Gh(s)||(xl(r),s&&s.response&&(s.response.data=ml.call(r,r.transformResponse,s.response),s.response.headers=rr.from(s.response.headers))),Promise.reject(s)})}const tm="1.11.0",Fo={};["object","boolean","number","function","string","symbol"].forEach((r,t)=>{Fo[r]=function(s){return typeof s===r||"a"+(t<1?"n ":" ")+r}});const Gd={};Fo.transitional=function(t,n,s){function a(i,o){return"[Axios v"+tm+"] Transitional option '"+i+"'"+o+(s?". "+s:"")}return(i,o,d)=>{if(t===!1)throw new gt(a(o," has been removed"+(n?" in "+n:"")),gt.ERR_DEPRECATED);return n&&!Gd[o]&&(Gd[o]=!0,console.warn(a(o," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,o,d):!0}};Fo.spelling=function(t){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${t}`),!0)};function Oj(r,t,n){if(typeof r!="object")throw new gt("options must be an object",gt.ERR_BAD_OPTION_VALUE);const s=Object.keys(r);let a=s.length;for(;a-- >0;){const i=s[a],o=t[i];if(o){const d=r[i],u=d===void 0||o(d,i,r);if(u!==!0)throw new gt("option "+i+" must be "+u,gt.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new gt("Unknown option "+i,gt.ERR_BAD_OPTION)}}const Gi={assertOptions:Oj,validators:Fo},Er=Gi.validators;let Fs=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Od,response:new Od}}async request(t,n){try{return await this._request(t,n)}catch(s){if(s instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const i=a.stack?a.stack.replace(/^.+\n/,""):"";try{s.stack?i&&!String(s.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+i):s.stack=i}catch{}}throw s}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Bs(this.defaults,n);const{transitional:s,paramsSerializer:a,headers:i}=n;s!==void 0&&Gi.assertOptions(s,{silentJSONParsing:Er.transitional(Er.boolean),forcedJSONParsing:Er.transitional(Er.boolean),clarifyTimeoutError:Er.transitional(Er.boolean)},!1),a!=null&&(we.isFunction(a)?n.paramsSerializer={serialize:a}:Gi.assertOptions(a,{encode:Er.function,serialize:Er.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Gi.assertOptions(n,{baseUrl:Er.spelling("baseURL"),withXsrfToken:Er.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=i&&we.merge(i.common,i[n.method]);i&&we.forEach(["delete","get","head","post","put","patch","common"],y=>{delete i[y]}),n.headers=rr.concat(o,i);const d=[];let u=!0;this.interceptors.request.forEach(function(j){typeof j.runWhen=="function"&&j.runWhen(n)===!1||(u=u&&j.synchronous,d.unshift(j.fulfilled,j.rejected))});const h=[];this.interceptors.response.forEach(function(j){h.push(j.fulfilled,j.rejected)});let m,x=0,g;if(!u){const y=[qd.bind(this),void 0];for(y.unshift(...d),y.push(...h),g=y.length,m=Promise.resolve(n);x<g;)m=m.then(y[x++],y[x++]);return m}g=d.length;let f=n;for(x=0;x<g;){const y=d[x++],j=d[x++];try{f=y(f)}catch(b){j.call(this,b);break}}try{m=qd.call(this,f)}catch(y){return Promise.reject(y)}for(x=0,g=h.length;x<g;)m=m.then(h[x++],h[x++]);return m}getUri(t){t=Bs(this.defaults,t);const n=Qh(t.baseURL,t.url,t.allowAbsoluteUrls);return _h(n,t.params,t.paramsSerializer)}};we.forEach(["delete","get","head","options"],function(t){Fs.prototype[t]=function(n,s){return this.request(Bs(s||{},{method:t,url:n,data:(s||{}).data}))}});we.forEach(["post","put","patch"],function(t){function n(s){return function(i,o,d){return this.request(Bs(d||{},{method:t,headers:s?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Fs.prototype[t]=n(),Fs.prototype[t+"Form"]=n(!0)});let Vj=class nm{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const s=this;this.promise.then(a=>{if(!s._listeners)return;let i=s._listeners.length;for(;i-- >0;)s._listeners[i](a);s._listeners=null}),this.promise.then=a=>{let i;const o=new Promise(d=>{s.subscribe(d),i=d}).then(a);return o.cancel=function(){s.unsubscribe(i)},o},t(function(i,o,d){s.reason||(s.reason=new Aa(i,o,d),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=s=>{t.abort(s)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new nm(function(a){t=a}),cancel:t}}};function $j(r){return function(n){return r.apply(null,n)}}function Hj(r){return we.isObject(r)&&r.isAxiosError===!0}const Ql={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ql).forEach(([r,t])=>{Ql[t]=r});function rm(r){const t=new Fs(r),n=Nh(Fs.prototype.request,t);return we.extend(n,Fs.prototype,t,{allOwnKeys:!0}),we.extend(n,t,null,{allOwnKeys:!0}),n.create=function(a){return rm(Bs(r,a))},n}const Tn=rm(ji);Tn.Axios=Fs;Tn.CanceledError=Aa;Tn.CancelToken=Vj;Tn.isCancel=Gh;Tn.VERSION=tm;Tn.toFormData=Eo;Tn.AxiosError=gt;Tn.Cancel=Tn.CanceledError;Tn.all=function(t){return Promise.all(t)};Tn.spread=$j;Tn.isAxiosError=Hj;Tn.mergeConfig=Bs;Tn.AxiosHeaders=rr;Tn.formToJSON=r=>qh(we.isHTMLForm(r)?new FormData(r):r);Tn.getAdapter=em.getAdapter;Tn.HttpStatusCode=Ql;Tn.default=Tn;const{Axios:kI,AxiosError:PI,CanceledError:DI,isCancel:AI,CancelToken:II,VERSION:RI,all:MI,Cancel:NI,isAxiosError:LI,spread:EI,toFormData:WI,AxiosHeaders:FI,HttpStatusCode:zI,formToJSON:OI,getAdapter:VI,mergeConfig:$I}=Tn,Kd=[],Bj=r=>{const t=Kd.find(n=>n.url===r);t?(t.count++,t.timestamp=Date.now()):Kd.push({url:r,timestamp:Date.now(),count:1})};class Uj{constructor(){zn(this,"api");this.api=Tn.create({baseURL:"http://localhost:3000",timeout:6e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(t=>{const n=localStorage.getItem("jwt_token");return n&&(t.headers.Authorization=`Bearer ${n}`),t},t=>Promise.reject(t)),this.api.interceptors.response.use(t=>t,t=>{var n,s;if(((n=t.response)==null?void 0:n.status)===401){const a=((s=t.config)==null?void 0:s.url)||"";if(a.includes("/auth/login-or-register")||a.includes("/auth/check-user")||a.includes("/auth/change-password")||a.includes("/auth/set-password"))return Promise.reject(t);const i=window.location.pathname;if(["/home","/welcome","/forget-password","/login"].some(d=>i.startsWith(d)))return Promise.reject(t);localStorage.removeItem("jwt_token"),localStorage.removeItem("user_session"),localStorage.removeItem("current_account"),localStorage.removeItem("isAuthenticated"),window.location.href="/login"}return Promise.reject(t)})}async getHealth(){return(await this.api.get("/health")).data}async get(t,n){return Bj(t),(await this.api.get(t,n)).data}async post(t,n,s){return(await this.api.post(t,n,s)).data}async put(t,n,s){return(await this.api.put(t,n,s)).data}async delete(t,n){return(await this.api.delete(t,n)).data}async getAssets(t){return(await this.api.get(`/api/v1/assets?accountId=${t}`)).data}async createAsset(t,n){return(await this.api.post(`/api/v1/assets?accountId=${n}`,t)).data}async updateAsset(t,n,s){return(await this.api.put(`/api/v1/assets/${t}?accountId=${n}`,s)).data}async deleteAsset(t,n){await this.api.delete(`/api/v1/assets/${t}?accountId=${n}`)}async getPortfolios(t){return(await this.api.get(`/api/v1/portfolios?accountId=${t}`)).data}async getPortfolio(t,n){return(await this.api.get(`/api/v1/portfolios/${t}?accountId=${n}`)).data}async createPortfolio(t,n){const s={...t,accountId:n};return(await this.api.post("/api/v1/portfolios",s)).data}async updatePortfolio(t,n,s){return(await this.api.put(`/api/v1/portfolios/${t}?accountId=${n}`,s)).data}async deletePortfolio(t,n){await this.api.delete(`/api/v1/portfolios/${t}?accountId=${n}`)}async copyPortfolio(t){return(await this.api.post("/api/v1/portfolios/copy",t)).data}async getPublicPortfolios(){return(await this.api.get("/api/v1/portfolios/public-templates")).data}async copyFromPublicPortfolio(t){return(await this.api.post("/api/v1/portfolios/copy-from-public",t)).data}async updatePortfolioVisibility(t,n,s){return(await this.api.put(`/api/v1/portfolios/${t}/visibility?accountId=${n}`,s)).data}async getAllPortfoliosAdmin(){return(await this.api.get("/api/v1/portfolios/admin/all")).data}async deletePortfolioAdmin(t){await this.api.delete(`/api/v1/portfolios/admin/${t}`)}async broadcastNotification(t){return(await this.api.post("/api/v1/notifications/admin/broadcast",t)).data}async getUsers(){try{const t=await this.api.get("/api/v1/users");return Array.isArray(t.data)?t.data:t.data&&Array.isArray(t.data.users)?t.data.users:[]}catch(t){return console.error("Error fetching users:",t),[]}}async getPortfolioPerformance(t){return(await this.api.get(`/api/v1/portfolios/${t}/performance`)).data}async getPortfolioAllocation(t){return(await this.api.get(`/api/v1/portfolios/${t}/analytics/allocation`)).data}async getPortfolioRiskReturn(t,n){const s=new URLSearchParams;n&&s.append("period",n);const a=s.toString(),i=`/api/v1/portfolios/${t}/analytics/risk-return${a?`?${a}`:""}`;return(await this.api.get(i)).data}async getPortfolioRiskMetrics(t){return(await this.api.get(`/api/v1/portfolios/${t}/analytics/risk-metrics`)).data}async getPortfolioDiversificationHeatmap(t){return(await this.api.get(`/api/v1/portfolios/${t}/analytics/diversification-heatmap`)).data}async getPortfolioAllocationTimeline(t,n,s){const a=new URLSearchParams;n&&a.append("months",n.toString()),s&&a.append("granularity",s);const i=a.toString(),o=`/api/v1/portfolios/${t}/analytics/allocation-timeline${i?`?${i}`:""}`;return(await this.api.get(o)).data}async getPortfolioCashFlowAnalysis(t){return(await this.api.get(`/api/v1/portfolios/${t}/analytics/cash-flow-analysis`)).data}async getPortfolioBenchmarkComparison(t,n,s){const a={};return n&&(a.months=n.toString()),s&&(a.twrPeriod=s),(await this.api.get(`/api/v1/portfolios/${t}/analytics/benchmark-comparison`,{params:a})).data}async getPortfolioMWRBenchmarkComparison(t,n,s){const a={};return n&&(a.months=n.toString()),s&&(a.mwrPeriod=s),(await this.api.get(`/api/v1/portfolios/${t}/analytics/mwr-benchmark-comparison`,{params:a})).data}async getPortfolioAssetDetailSummary(t){return(await this.api.get(`/api/v1/portfolios/${t}/analytics/asset-detail-summary`)).data}async getPortfolioPositions(t){return(await this.api.get(`/api/v1/portfolios/${t}/positions`)).data}async getPortfolioAnalyticsPerformance(t,n){return(await this.api.get(`/api/v1/portfolios/${t}/analytics/asset-performance`,{params:{period:n}})).data}async getPortfolioAnalyticsAllocation(t){return(await this.api.get(`/api/v1/portfolios/${t}/analytics/allocation`)).data}async getPortfolioAnalyticsReport(t){return(await this.api.get(`/api/v1/portfolios/${t}/analytics/report`)).data}async getPortfolioCashFlows(t,n){return(await this.api.get(`/api/v1/portfolios/${t}/cash-flows?accountId=${n}`)).data}async createTrade(t,n){return(await this.api.post(`/api/v1/trades?accountId=${n}`,t)).data}async getTradesBySymbol(t,n){const s=new URLSearchParams;return s.append("symbol",t),n!=null&&n.accountId&&s.append("accountId",n.accountId),n!=null&&n.portfolioId&&s.append("portfolioId",n.portfolioId),(n==null?void 0:n.page)!==void 0&&s.append("page",String(n.page)),(n==null?void 0:n.limit)!==void 0&&s.append("limit",String(n.limit)),n!=null&&n.side&&s.append("side",n.side),n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),(await this.api.get(`/api/v1/trades?${s.toString()}`)).data}async getAllTradesForAsset(t,n){const s=new URLSearchParams({accountId:n,assetId:t});return(await this.api.get(`/api/v1/trades?${s}`)).data}async getTrade(t,n){return(await this.api.get(`/api/v1/trades/${t}?accountId=${n}`)).data}async updateTrade(t,n,s){return(await this.api.put(`/api/v1/trades/${t}?accountId=${n}`,s)).data}async deleteTrade(t,n){await this.api.delete(`/api/v1/trades/${t}?accountId=${n}`)}async getTradeDetails(t){return(await this.api.get(`/api/v1/trades/${t}/details`)).data}async getTradeAnalysis(t,n){const s=new URLSearchParams({portfolioId:t});n&&Object.entries(n).forEach(([o,d])=>{d&&s.append(o,d)});const a=`/api/v1/trades/analysis/portfolio?${s}`;return(await this.api.get(a)).data}async getTradingPerformance(t,n){const s=new URLSearchParams({portfolioId:t});return n&&Object.entries(n).forEach(([i,o])=>{o&&s.append(i,o)}),(await this.api.get(`/api/v1/trades/performance/portfolio?${s}`)).data}async getCurrentPositions(t,n){const s=new URLSearchParams;return n&&s.append("marketPrices",JSON.stringify(n)),(await this.api.get(`/api/v1/portfolios/${t}/positions?${s}`)).data}async getPositionByAsset(t,n,s){const a=new URLSearchParams;return s&&a.append("marketPrice",s.toString()),(await this.api.get(`/api/v1/portfolios/${t}/positions/${n}?${a}`)).data}async setRiskTargets(t,n){return(await this.api.post(`/api/v1/assets/${t}/targets`,n)).data}async getRiskTargets(t){return(await this.api.get(`/api/v1/assets/${t}/targets`)).data}async updateRiskTargets(t,n){return(await this.api.put(`/api/v1/assets/${t}/targets`,n)).data}async removeRiskTargets(t){await this.api.delete(`/api/v1/assets/${t}/targets`)}async getPortfolioRiskTargets(t){return(await this.api.get(`/api/v1/assets/targets/portfolio/${t}`)).data}async monitorRiskTargets(t,n){const s=new URLSearchParams;return t&&s.append("portfolioId",t),n&&s.append("marketPrices",JSON.stringify(n)),(await this.api.get(`/api/v1/assets/targets/monitor?${s}`)).data}async getFundInvestors(t){return(await this.api.get(`/api/v1/portfolios/${t}/investors`)).data}async subscribeToFund(t){return(await this.api.post(`/api/v1/portfolios/${t.portfolioId}/investors/subscribe`,t)).data}async redeemFromFund(t){return(await this.api.post(`/api/v1/portfolios/${t.portfolioId}/investors/redeem`,t)).data}async getInvestorHolding(t,n){return(await this.api.get(`/api/v1/portfolios/${t}/investors/${n}`)).data}async getInvestorHoldings(t){return(await this.api.get(`/api/v1/investor-holdings/account/${t}`)).data}async getHoldingDetail(t){return(await this.api.get(`/api/v1/investor-holdings/${t}/detail`)).data}async getTrades(t,n,s){const a=new URLSearchParams;return a.append("portfolioId",t),a.append("accountId",n),s!=null&&s.assetId&&a.append("assetId",s.assetId),s!=null&&s.side&&a.append("side",s.side),s!=null&&s.startDate&&a.append("startDate",s.startDate),s!=null&&s.endDate&&a.append("endDate",s.endDate),(s==null?void 0:s.page)!==void 0&&a.append("page",String(s.page)),(s==null?void 0:s.limit)!==void 0&&a.append("limit",String(s.limit)),(await this.api.get(`/api/v1/trades?${a.toString()}`)).data}async getCashFlowHistory(t,n,s){const a={accountId:n,...s};return(await this.api.get(`/api/v1/portfolios/${t}/cash-flow/history`,{params:a})).data}async convertPortfolioToFund(t,n){const s=n?{snapshotDate:n}:{};return(await this.api.post(`/api/v1/portfolios/${t}/convert-to-fund`,{},{params:s})).data}async convertFundToPortfolio(t,n){return(await this.api.post(`/api/v1/portfolios/${t}/convert-to-portfolio?accountId=${n}`)).data}async updateHoldingTransaction(t,n){return(await this.api.put(`/api/v1/investor-holdings/fund-unit-transactions/${t}`,n)).data}async deleteHoldingTransaction(t){return(await this.api.delete(`/api/v1/investor-holdings/fund-unit-transactions/${t}`)).data}async testConnection(){try{return await this.getHealth(),!0}catch(t){return console.error("API connection test failed:",t),!1}}async refreshNavPerUnit(t){return(await this.api.post(`/api/v1/portfolios/${t}/refresh-nav-per-unit`)).data}async recalculateAllHoldings(t){return(await this.api.post(`/api/v1/investor-holdings/recalculate-all/${t}`)).data}async getPortfolioCashFlowHistory(t,n,s){const a=new URLSearchParams;return a.append("accountId",n),s!=null&&s.page&&a.append("page",s.page.toString()),s!=null&&s.limit&&a.append("limit",s.limit.toString()),s!=null&&s.startDate&&a.append("startDate",s.startDate),s!=null&&s.endDate&&a.append("endDate",s.endDate),s!=null&&s.types&&s.types.length>0&&s.types.forEach(o=>a.append("types",o)),(await this.api.get(`/api/v1/portfolios/${t}/cash-flow/history?${a.toString()}`)).data}async createCashFlow(t,n,s,a){return(await this.api.post(`/api/v1/portfolios/${t}/cash-flow/${s}?accountId=${n}`,a)).data}async updateCashFlow(t,n,s,a){return(await this.api.put(`/api/v1/portfolios/${t}/cash-flow/${s}?accountId=${n}`,a)).data}async deleteCashFlow(t,n,s){await this.api.delete(`/api/v1/portfolios/${t}/cash-flow/${s}?accountId=${n}`)}async cancelCashFlow(t,n,s){return(await this.api.put(`/api/v1/portfolios/${t}/cash-flow/${s}/cancel?accountId=${n}`)).data}async transferCashFlow(t,n,s){return(await this.api.post(`/api/v1/portfolios/${t}/cash-flow/transfer?accountId=${n}`,s)).data}async getDeposits(t,n){const s=new URLSearchParams;return s.append("accountId",t),n!=null&&n.portfolioId&&n.portfolioId!=="ALL"&&s.append("portfolioId",n.portfolioId),(await this.api.get(`/api/v1/deposits?${s.toString()}`)).data}async getDepositAnalytics(t,n){const s=new URLSearchParams;return s.append("accountId",t),n!=null&&n.portfolioId&&n.portfolioId!=="ALL"&&s.append("portfolioId",n.portfolioId),(await this.api.get(`/api/v1/deposits/analytics?${s.toString()}`)).data}async createDeposit(t){return(await this.api.post("/api/v1/deposits",t)).data}async updateDeposit(t,n){return(await this.api.put(`/api/v1/deposits/${t}`,n)).data}async deleteDeposit(t){await this.api.delete(`/api/v1/deposits/${t}`)}async triggerGlobalAssetsSync(){return(await this.api.post("/api/v1/global-assets/auto-sync/trigger")).data}async getPortfolioNAVHistory(t,n,s){const a=new URLSearchParams;return a.append("accountId",n),s!=null&&s.months&&a.append("months",s.months.toString()),s!=null&&s.granularity&&a.append("granularity",s.granularity),(await this.api.get(`/api/v1/portfolios/${t}/nav/history?${a.toString()}`)).data}async getPortfolioReturns(t){return(await this.api.post("/api/v1/portfolios/portfolio-returns",{portfolioIds:t})).data}async getMarketDataStats(){return(await this.api.get("/api/v1/market-data/statistics")).data}async getMarketDataProviders(){return(await this.api.get("/api/v1/market-data/providers")).data}async updatePricesByNation(t){return(await this.api.post(`/api/v1/market-data/update-by-nation/${t}`)).data}async updatePricesByMarket(t){return(await this.api.post(`/api/v1/market-data/update-by-market/${t}`)).data}async testMarketDataProvider(t){return(await this.api.post(`/api/v1/market-data/test-connection/${t}`)).data}async getMarketDataConfig(){return(await this.api.get("/api/v1/market-data/config")).data}async updateMarketDataConfig(t){return(await this.api.post("/api/v1/market-data/config",t)).data}async getHistoricalPrices(t){const n=new URLSearchParams;return t!=null&&t.symbols&&n.append("symbols",t.symbols),t!=null&&t.startDate&&n.append("startDate",t.startDate),t!=null&&t.endDate&&n.append("endDate",t.endDate),(await this.api.get(`/api/v1/market-data/historical-prices?${n.toString()}`)).data}async updateHistoricalPrices(t){return(await this.api.post("/api/v1/market-data/historical-prices/update",t)).data}async getSnapshots(t,n){const s=new URLSearchParams;return n&&s.append("accountId",n),t&&Object.entries(t).forEach(([i,o])=>{o!=null&&s.append(i,o.toString())}),(await this.api.get(`/api/v1/snapshots?${s.toString()}`)).data}async getSnapshotsPaginated(t,n){const s=new URLSearchParams;return n&&s.append("accountId",n),t&&Object.entries(t).forEach(([i,o])=>{o!=null&&s.append(i,o.toString())}),(await this.api.get(`/api/v1/snapshots/paginated?${s.toString()}`)).data}async getPortfolioSnapshotsPaginated(t,n){const s=new URLSearchParams;return s.append("portfolioId",t),n!=null&&n.page&&s.append("page",n.page.toString()),n!=null&&n.limit&&s.append("limit",n.limit.toString()),n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),n!=null&&n.granularity&&s.append("granularity",n.granularity),(n==null?void 0:n.isActive)!==void 0&&s.append("isActive",n.isActive.toString()),n!=null&&n.orderBy&&s.append("orderBy",n.orderBy),n!=null&&n.orderDirection&&s.append("orderDirection",n.orderDirection),(await this.api.get(`/api/v1/portfolio-snapshots?${s.toString()}`)).data}async createSnapshot(t){return(await this.api.post("/api/v1/snapshots",t)).data}async createPortfolioSnapshots(t,n={}){return(await this.api.post("/api/v1/snapshots/portfolio/bulk",{portfolioIds:[t],...n})).data}async createBulkPortfolioSnapshots(t,n={}){return(await this.api.post("/api/v1/snapshots/portfolio/bulk",{portfolioIds:t,...n})).data}async updateSnapshot(t,n){return(await this.api.put(`/api/v1/snapshots/${t}`,n)).data}async deleteSnapshot(t){await this.api.delete(`/api/v1/snapshots/${t}`)}async getSnapshotById(t){return(await this.api.get(`/api/v1/snapshots/${t}`)).data}async getLatestSnapshot(t,n,s){const a=new URLSearchParams;return n&&a.append("assetId",n),s&&a.append("granularity",s),(await this.api.get(`/api/v1/snapshots/latest/${t}?${a.toString()}`)).data}async getSnapshotStatistics(t){return(await this.api.get(`/api/v1/snapshots/statistics/${t}`)).data}async bulkRecalculateSnapshots(t,n,s){const a=new URLSearchParams;return a.append("accountId",n),s&&a.append("snapshotDate",s),(await this.api.post(`/api/v1/snapshots/bulk-recalculate/${t}?${a.toString()}`)).data}async getBulkRecalculateStatus(t,n){return(await this.api.get(`/api/v1/snapshots/bulk-recalculate/${t}/status/${n}`)).data}async deleteSnapshotsByDateRange(t,n,s,a){const i=new URLSearchParams;return i.append("startDate",n),i.append("endDate",s),a&&i.append("granularity",a),(await this.api.delete(`/api/v1/snapshots/portfolio/${t}/date-range?${i.toString()}`)).data}async deleteSnapshotsByDate(t,n,s){const a=new URLSearchParams;return a.append("snapshotDate",n),s&&a.append("granularity",s),(await this.api.delete(`/api/v1/snapshots/portfolio/${t}/date?${a.toString()}`)).data}async getPortfoliosWithSnapshots(t){return(await this.api.get(`/api/v1/snapshots/portfolios?accountId=${t}`)).data}async createPerformanceSnapshots(t){return(await this.api.post("/api/v1/performance-snapshots",t)).data}async getPortfolioPerformanceSnapshots(t,n){const s=new URLSearchParams;return n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),n!=null&&n.granularity&&s.append("granularity",n.granularity),n!=null&&n.page&&s.append("page",n.page.toString()),n!=null&&n.limit&&s.append("limit",n.limit.toString()),(await this.api.get(`/api/v1/performance-snapshots/portfolio/${t}?${s.toString()}`)).data}async getAssetPerformanceSnapshots(t,n){const s=new URLSearchParams;return n!=null&&n.assetId&&s.append("assetId",n.assetId),n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),n!=null&&n.granularity&&s.append("granularity",n.granularity),n!=null&&n.page&&s.append("page",n.page.toString()),n!=null&&n.limit&&s.append("limit",n.limit.toString()),(await this.api.get(`/api/v1/performance-snapshots/asset/${t}?${s.toString()}`)).data}async getPortfolioPerformanceSummary(t,n="1Y"){const s=new URLSearchParams;return s.append("period",n),(await this.api.get(`/api/v1/performance-snapshots/portfolio/${t}/summary?${s.toString()}`)).data}async getAssetPerformanceSummary(t,n){const s=new URLSearchParams;return n!=null&&n.assetId&&s.append("assetId",n.assetId),n!=null&&n.period&&s.append("period",n.period),(await this.api.get(`/api/v1/performance-snapshots/asset/${t}/summary?${s.toString()}`)).data}async getAssetGroupPerformanceSnapshots(t,n){const s=new URLSearchParams;return n!=null&&n.assetType&&s.append("assetType",n.assetType),n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),n!=null&&n.granularity&&s.append("granularity",n.granularity),n!=null&&n.page&&s.append("page",n.page.toString()),n!=null&&n.limit&&s.append("limit",n.limit.toString()),(await this.api.get(`/api/v1/performance-snapshots/group/${t}?${s.toString()}`)).data}async getAssetGroupPerformanceSummary(t,n){const s=new URLSearchParams;return n!=null&&n.assetType&&s.append("assetType",n.assetType),n!=null&&n.period&&s.append("period",n.period),(await this.api.get(`/api/v1/performance-snapshots/group/${t}/summary?${s.toString()}`)).data}async recalculateSnapshot(t){return(await this.api.put(`/api/v1/snapshots/${t}/recalculate`)).data}async hardDeleteSnapshot(t){await this.api.delete(`/api/v1/snapshots/${t}/hard`)}async getSnapshotTimeline(t){const n=new URLSearchParams;return Object.entries(t).forEach(([a,i])=>{i!=null&&n.append(a,i.toString())}),(await this.api.get(`/api/v1/snapshots/timeline?${n.toString()}`)).data}async getAggregatedTimelineData(t,n,s,a){const i=new URLSearchParams;return i.append("portfolioId",t),i.append("startDate",n),i.append("endDate",s),a&&i.append("granularity",a),(await this.api.get(`/api/v1/snapshots/timeline/aggregated?${i.toString()}`)).data}async cleanupOldSnapshots(t){const n=new URLSearchParams;return t&&n.append("portfolioId",t),(await this.api.post(`/api/v1/snapshots/cleanup?${n.toString()}`)).data}async deleteSnapshotsByGranularity(t,n){return(await this.api.delete(`/api/v1/snapshots/portfolio/${t}/granularity/${n}`)).data}async deletePerformanceSnapshotsByDateRange(t,n,s,a){const i=new URLSearchParams;return i.append("startDate",n),i.append("endDate",s),a&&i.append("granularity",a),(await this.api.delete(`/api/v1/performance-snapshots/portfolio/${t}?${i.toString()}`)).data}async exportPerformanceSnapshots(t,n){const s=new URLSearchParams;return n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),n!=null&&n.granularity&&s.append("granularity",n.granularity),(await this.api.get(`/api/v1/performance-snapshots/export/${t}?${s.toString()}`)).data}async getPerformanceDashboardData(t){return(await this.api.get(`/api/v1/performance-snapshots/dashboard/${t}`)).data}async getPerformanceComparison(t,n,s="1Y"){const a=new URLSearchParams;return a.append("benchmarkId",n),a.append("period",s),(await this.api.get(`/api/v1/performance-snapshots/comparison/${t}?${a.toString()}`)).data}async getRiskAnalysis(t,n="1Y"){const s=new URLSearchParams;return s.append("period",n),(await this.api.get(`/api/v1/performance-snapshots/risk-analysis/${t}?${s.toString()}`)).data}async getPerformanceAttribution(t,n="1Y"){const s=new URLSearchParams;return s.append("period",n),(await this.api.get(`/api/v1/performance-snapshots/attribution/${t}?${s.toString()}`)).data}async getPerformanceTrends(t,n,s="1Y"){const a=new URLSearchParams;return a.append("metric",n),a.append("period",s),(await this.api.get(`/api/v1/performance-snapshots/trends/${t}?${a.toString()}`)).data}async getBenchmarkData(t,n,s){const a=new URLSearchParams;return n&&a.append("startDate",n),s&&a.append("endDate",s),(await this.api.get(`/api/v1/performance-snapshots/benchmark/${t}?${a.toString()}`)).data}async getAvailableBenchmarks(){return(await this.api.get("/api/v1/performance-snapshots/benchmarks")).data}async getPerformanceAlerts(t){return(await this.api.get(`/api/v1/performance-snapshots/alerts/${t}`)).data}async createPerformanceAlert(t,n){return(await this.api.post(`/api/v1/performance-snapshots/alerts/${t}`,n)).data}async updatePerformanceAlert(t,n,s){return(await this.api.put(`/api/v1/performance-snapshots/alerts/${t}/${n}`,s)).data}async deletePerformanceAlert(t,n){return(await this.api.delete(`/api/v1/performance-snapshots/alerts/${t}/${n}`)).data}async getAccounts(){return(await this.api.get("/api/v1/accounts")).data}async getAccount(t){return(await this.api.get(`/api/v1/accounts/${t}`)).data}async createAccount(t){return(await this.api.post("/api/v1/accounts",t)).data}async updateAccount(t,n){return(await this.api.put(`/api/v1/accounts/${t}`,n)).data}async deleteAccount(t){await this.api.delete(`/api/v1/accounts/${t}`)}async getPortfolioDeposits(t){return(await this.api.get(`/api/v1/deposits/portfolio/${t}`)).data}async getPortfolioDepositAnalytics(t){return(await this.api.get(`/api/v1/deposits/portfolio/${t}/analytics`)).data}async getPortfolioAssetPerformance(t){return(await this.api.get(`/api/v1/portfolios/${t}/analytics/asset-performance`)).data}async settleDeposit(t,n){return(await this.api.post(`/api/v1/deposits/${t}/settle`,n)).data}async getReportData(t,n){let s=`/api/v1/reports?accountId=${t}`;return n&&n!=="all"&&(s+=`&portfolioId=${n}`),(await this.api.get(s)).data}async getInvestorReport(t,n){return(await this.api.get(`/api/v1/investor-report/${t}?accountId=${n}`)).data}async getInvestorPortfolios(t){return(await this.api.get(`/api/v1/investor-report/portfolios?accountId=${t}`)).data}}const q=new Uj,Qd="86c2ae61-8f69-4608-a5fd-8fecb44ed2c5",pl={id:Qd,accountId:Qd,name:"Test User",email:"tung@example.com",baseCurrency:"USD",isInvestor:!0,isMainAccount:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},Ls=class Ls{constructor(){zn(this,"accountCache",{});zn(this,"currentAccount",null);zn(this,"loading",!1);zn(this,"initialized",!1);zn(this,"listeners",[]);zn(this,"loadingListeners",[]);zn(this,"pendingRequests",{})}static getInstance(){return Ls.instance||(Ls.instance=new Ls),Ls.instance}isValidUUID(t){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)}async fetchAccount(t){try{if(!localStorage.getItem("jwt_token"))return null;if(this.accountCache[t])return this.accountCache[t];if(this.pendingRequests[t]!==void 0)return await this.pendingRequests[t];if(this.setLoading(!0),this.isValidUUID(t)){const s=this.fetchAccountFromAPI(t);this.pendingRequests[t]=s;try{return await s}finally{delete this.pendingRequests[t]}}else return null}catch(n){return console.error("Failed to fetch account:",n),null}finally{this.setLoading(!1)}}async fetchAccountFromAPI(t){const n=await q.getAccount(t);return this.accountCache[t]=n,n}async initialize(){if(this.initialized)return;if(!localStorage.getItem("jwt_token")){this.setCurrentAccount(null),this.initialized=!0;return}const n=localStorage.getItem("currentAccountId");if(n){const s=await this.fetchAccount(n);s?this.setCurrentAccount(s):await this.loadUserMainAccount()}else await this.loadUserMainAccount();this.initialized=!0}async switchAccount(t){localStorage.setItem("currentAccountId",t);const n=await this.fetchAccount(t);n?this.setCurrentAccount(n):this.setCurrentAccount(pl)}getCurrentAccount(){return this.currentAccount}getCurrentAccountId(){var t;return((t=this.currentAccount)==null?void 0:t.accountId)||""}getBaseCurrency(){var t;return((t=this.currentAccount)==null?void 0:t.baseCurrency)||"VND"}getLoading(){return this.loading}getInitialized(){return this.initialized}setCurrentAccount(t){this.currentAccount=t,this.notifyListeners(t)}setLoading(t){this.loading=t,this.notifyLoadingListeners(t)}addAccountListener(t){return this.listeners.push(t),()=>{this.listeners=this.listeners.filter(n=>n!==t)}}addLoadingListener(t){return this.loadingListeners.push(t),()=>{this.loadingListeners=this.loadingListeners.filter(n=>n!==t)}}notifyListeners(t){this.listeners.forEach(n=>n(t))}notifyLoadingListeners(t){this.loadingListeners.forEach(n=>n(t))}async loadUserMainAccount(){try{const t=await q.getAccounts();if(t&&t.length>0){const n=t.find(s=>s.isMainAccount)||t[0];this.setCurrentAccount(n),localStorage.setItem("currentAccountId",n.accountId)}else this.setCurrentAccount(pl)}catch(t){console.error("Failed to load user accounts:",t),this.setCurrentAccount(pl)}}async reloadMainAccount(){localStorage.removeItem("currentAccountId"),this.accountCache={};try{await this.loadUserMainAccount()}catch(t){console.error("Error in loadUserMainAccount:",t)}}};zn(Ls,"instance");let Xl=Ls;const Xn=Xl.getInstance();class _j{constructor(){zn(this,"STORAGE_KEY","user_login_history");zn(this,"MAX_HISTORY",3)}addUserToHistory(t){try{const s=this.getUserHistory().filter(o=>o.username!==t.username),i=[{username:t.username,fullName:t.fullName,email:t.email,avatarText:t.avatarText,lastLogin:new Date().toISOString(),isProfileComplete:t.isProfileComplete||!1},...s].slice(0,this.MAX_HISTORY);localStorage.setItem(this.STORAGE_KEY,JSON.stringify(i))}catch(n){console.error("Failed to add user to history:",n)}}getUserHistory(){try{const t=localStorage.getItem(this.STORAGE_KEY);if(!t)return[];const n=JSON.parse(t);return Array.isArray(n)?n:[]}catch(t){return console.error("Failed to get user history:",t),[]}}removeUserFromHistory(t){try{const s=this.getUserHistory().filter(a=>a.username!==t);localStorage.setItem(this.STORAGE_KEY,JSON.stringify(s))}catch(n){console.error("Failed to remove user from history:",n)}}clearHistory(){try{localStorage.removeItem(this.STORAGE_KEY)}catch(t){console.error("Failed to clear user history:",t)}}getUserFromHistory(t){return this.getUserHistory().find(s=>s.username===t)||null}}const js=new _j;class Yj{async loginOrRegister(t,n,s){return(await q.api.post("/api/v1/auth/login-or-register",{username:t,password:n,deviceInfo:s})).data}async checkUserStatus(t){return(await q.api.get(`/api/v1/auth/check-user/${t}`)).data}async getProfile(){return(await q.api.get("/api/v1/auth/profile")).data}async updateProfile(t){return(await q.api.put("/api/v1/auth/profile",t)).data}async setPassword(t){await q.api.post("/api/v1/auth/set-password",{password:t})}async changePassword(t,n){var s,a,i,o,d,u,h;try{await q.api.post("/api/v1/auth/change-password",{currentPassword:t,newPassword:n})}catch(m){if(((s=m.response)==null?void 0:s.status)===401){const x=((i=(a=m.response)==null?void 0:a.data)==null?void 0:i.message)||"Authentication failed",g=new Error(x);throw g.response=m.response,g}else if(((o=m.response)==null?void 0:o.status)===400){const x=((u=(d=m.response)==null?void 0:d.data)==null?void 0:u.message)||"Invalid request data",g=new Error(x);throw g.response=m.response,g}else if(((h=m.response)==null?void 0:h.status)===404){const x=new Error("User not found");throw x.response=m.response,x}else throw m}}async sendVerificationEmail(){return(await q.api.post("/api/v1/auth/send-verification-email")).data}async verifyEmail(t){return(await q.api.post("/api/v1/auth/verify-email",{token:t})).data}logout(){localStorage.removeItem("user_session"),localStorage.removeItem("current_account"),localStorage.removeItem("isAuthenticated"),localStorage.removeItem("jwt_token")}getCurrentUser(){const t=localStorage.getItem("user_session");return t?JSON.parse(t).user:null}getCurrentAccount(){const t=localStorage.getItem("user_session");return t?JSON.parse(t).account:null}saveUserSession(t){localStorage.setItem("user_session",JSON.stringify(t)),localStorage.setItem("current_account",JSON.stringify(t.account)),localStorage.setItem("isAuthenticated","true"),t.token&&localStorage.setItem("jwt_token",t.token),t.user&&js.addUserToHistory({username:t.user.username,fullName:t.user.fullName,email:t.user.email,avatarText:t.user.avatarText,isProfileComplete:t.user.isProfileComplete})}isAuthenticated(){return localStorage.getItem("isAuthenticated")==="true"}}const Nn=new Yj,sm=p.createContext(void 0);let Xd=!1,gl=0,Jd=null,Zd=!1,es=null;const rs=({children:r})=>{const[t,n]=p.useState(Jd||Xn.getCurrentAccount()),[s,a]=p.useState(Nn.getCurrentUser()),[i,o]=p.useState(Zd||Xn.getLoading()),[d,u]=p.useState(Nn.isAuthenticated());p.useEffect(()=>(gl++,gl===1&&(es=rs),()=>{gl--,es===rs&&(es=null)}),[]),p.useEffect(()=>{(async()=>{d&&(!Xd&&!Xn.getInitialized()&&es===rs?(Xd=!0,await Xn.initialize(),n(Xn.getCurrentAccount()),o(Xn.getLoading())):es!==rs||Xn.getInitialized()&&(n(Xn.getCurrentAccount()),o(Xn.getLoading())))})()},[d]),p.useEffect(()=>{if(es!==rs)return;const v=Xn.addAccountListener(w=>{Jd=w,n(w)}),P=Xn.addLoadingListener(w=>{Zd=w,o(w)});return()=>{v(),P()}},[]),p.useEffect(()=>{const v=()=>{const w=Nn.isAuthenticated(),C=Nn.getCurrentUser();u(k=>k!==w?w:k),a(k=>JSON.stringify(k)!==JSON.stringify(C)?C:k)};v();const P=w=>{(w.key==="isAuthenticated"||w.key==="user_session")&&v()};return window.addEventListener("storage",P),()=>{window.removeEventListener("storage",P)}},[]);const h=async v=>{es===rs&&await Xn.switchAccount(v)},m=()=>Xn.getCurrentAccountId(),x=()=>{localStorage.setItem("_logout_in_progress","true"),Nn.logout(),a(null),u(!1),window.location.href="/login"},g=async()=>{const v=Nn.isAuthenticated(),P=Nn.getCurrentUser();if(u(v),a(P),v&&P&&es===rs)try{await f()}catch(w){console.error("Error in reloadMainAccount:",w)}},f=async()=>{if(es===rs)try{await Xn.reloadMainAccount()}catch(v){console.error("Error in accountManager.reloadMainAccount():",v)}},y=(t==null?void 0:t.isDemoAccount)===!0,j=y,b={currentAccount:t,currentUser:s,isAuthenticated:d,switchAccount:h,getCurrentAccountId:m,reloadMainAccount:f,logout:x,updateAuthState:g,accountId:(t==null?void 0:t.accountId)||"",baseCurrency:(t==null?void 0:t.baseCurrency)||"VND",loading:i,isDemoAccount:y,isReadOnly:j};return e.jsx(sm.Provider,{value:b,children:r})},Ge=()=>{const r=p.useContext(sm);if(r===void 0)throw new Error("useAccount must be used within an AccountProvider");return r};class qj{async getUserRoles(){return await q.get("/api/v1/current-user/roles")}async getUserRolesById(t){return await q.get(`/api/v1/users/${t}/roles`)}async getPermissions(){return await q.get("/api/v1/permissions")}async getPermissionsByCategory(){return await q.get("/api/v1/roles/permissions/categories")}}const Rc=new qj,Zr=()=>{const{currentUser:r}=Ge(),{data:t,isLoading:n,error:s}=yt({queryKey:["currentUserRoles",r==null?void 0:r.userId],queryFn:async()=>{if(!(r!=null&&r.userId))return{userRoles:[],permissions:[]};try{const j=await Rc.getUserRoles();return j&&typeof j=="object"&&j.userRoles&&j.permissions?{userRoles:j.userRoles,permissions:j.permissions}:(console.warn("Unexpected API response structure:",j),{userRoles:[],permissions:[]})}catch(j){throw console.error("Error fetching user roles:",j),j}},enabled:!!(r!=null&&r.userId),staleTime:5*60*1e3,retry:1,refetchOnWindowFocus:!1}),a=(t==null?void 0:t.userRoles)||[],i=(t==null?void 0:t.permissions)||[],o=s?"Failed to load user permissions":null,d=p.useMemo(()=>i.map(j=>({resource:j.resource,action:j.action})),[i]),u=p.useMemo(()=>a.map(b=>b.roleName),[a]),h=j=>d.some(b=>`${b.resource}.${b.action}`===j),m=j=>j.some(b=>h(b)),x=j=>j.every(b=>h(b)),g=j=>u.includes(j);return{permissions:d,roles:u,userRoles:a,userPermissions:i,isLoading:n,error:o,hasPermission:h,hasAnyPermission:m,hasAllPermissions:x,hasRole:g,hasAnyRole:j=>j.some(b=>g(b)),hasAllRoles:j=>j.every(b=>g(b))}},We=({readOnlyTooltip:r,disabled:t,onClick:n,...s})=>{const{isReadOnly:a}=Ge(),{userRoles:i}=Zr(),{t:o}=Ne(),d=t||a&&!i.some(x=>x.roleName==="super_admin"),h=d&&a?r||o("common.readOnlyMode"):"",m=e.jsx("span",{style:{display:"inline-flex"},children:e.jsx(he,{...s,disabled:d,onClick:d?void 0:n})});return h?e.jsx(Fe,{title:h,children:m}):m},tr=({readOnlyTooltip:r,tooltip:t,disabled:n,onClick:s,...a})=>{const{isReadOnly:i}=Ge(),{t:o}=Ne(),{userRoles:d}=Zr(),u=n||i&&!d.some(g=>g.roleName==="super_admin"),m=u&&i?r||o("common.readOnlyMode"):t||"",x=e.jsx("span",{style:{display:"inline-flex"},children:e.jsx(Ie,{...a,disabled:u,onClick:u?void 0:s})});return m?e.jsx(Fe,{title:m,children:x}):x},Gj={radius:{xs:"4px",sm:"6px",md:"8px",lg:"12px",xl:"16px"},width:{thin:"1px",normal:"2px",thick:"3px"},colors:{light:"#e0e0e0",medium:"#bdbdbd",dark:"#757575",primary:"#1976d2",secondary:"#dc004e",success:"#2e7d32",warning:"#ed6c02",error:"#d32f2f",info:"#0288d1"},styles:{card:{border:"1px solid #e0e0e0",borderRadius:"8px"},section:{border:"1px solid #e3f2fd",borderRadius:"8px"},input:{border:"1px solid #bdbdbd",borderRadius:"4px"},button:{border:"1px solid #1976d2",borderRadius:"6px"},alert:{border:"1px solid #ffcdd2",borderRadius:"4px"},chart:{border:"1px solid #e0e0e0",borderRadius:"8px"},table:{border:"1px solid #e0e0e0",borderRadius:"4px"}}},Kj={header:{xs:"1.4rem",sm:"1.4rem",md:"1.6rem",lg:"1.8rem",xl:"2rem"},title:{xs:"1.1rem",sm:"1.1rem",md:"1.1rem",lg:"1.2rem",xl:"1.3rem"},subtitle:{xs:"0.8rem",sm:"0.8rem",md:"0.8rem",lg:"0.9rem",xl:"1.0rem"},body:{xs:"1rem",sm:"1rem",md:"1rem",lg:"1.1rem",xl:"1.2rem"},medium:{xs:"0.875rem",sm:"0.9rem",md:"0.95rem",lg:"1.0rem",xl:"1.05rem"},small:{xs:"0.875rem",sm:"0.875rem",md:"0.875rem",lg:"0.9rem",xl:"1rem"},xSmall:{xs:"0.75rem",sm:"0.75rem",md:"0.7rem",lg:"0.7rem",xl:"0.75rem"},caption:{xs:"0.75rem",sm:"0.75rem",md:"0.75rem",lg:"0.8rem",xl:"0.875rem"},chartTitle:{xs:"0.875rem",sm:"0.875rem",md:"0.875rem",lg:"0.9rem",xl:"1rem"},chartSubtitle:{xs:"0.75rem",sm:"0.75rem",md:"0.75rem",lg:"0.8rem",xl:"0.875rem"},chartLegend:{xs:"0.75rem",sm:"0.75rem",md:"0.75rem",lg:"0.8rem",xl:"0.875rem"},chartTooltip:{xs:"0.75rem",sm:"0.75rem",md:"0.75rem",lg:"0.8rem",xl:"0.875rem"},cardTitle:{xs:"0.875rem",sm:"0.875rem",md:"0.875rem",lg:"0.9rem",xl:"1rem"},cardValue:{xs:"1.1rem",sm:"1.1rem",md:"1rem",lg:"1.1rem",xl:"1.2rem"},cardValueLarge:{xs:"1.3rem",sm:"1.3rem",md:"1.2rem",lg:"1.3rem",xl:"1.4rem"},cardValueMedium:{xs:"1rem",sm:"1.1rem",md:"1.1rem",lg:"0.9rem",xl:"1rem"},cardValueSmall:{xs:"0.875rem",sm:"0.875rem",md:"0.75rem",lg:"0.8rem",xl:"0.875rem"},cardLabel:{xs:"0.75rem",sm:"0.75rem",md:"0.75rem",lg:"0.8rem",xl:"0.875rem"},labelSmall:{xs:"0.75rem",sm:"0.75rem",md:"0.75rem",lg:"0.8rem",xl:"0.875rem"},tab:{xs:"0.875rem",sm:"0.875rem",md:"0.875rem",lg:"0.9rem",xl:"1rem"},button:{xs:"0.875rem",sm:"0.875rem",md:"0.875rem",lg:"0.9rem",xl:"1rem"}},_e=r=>{const t=Kj[r];return{xs:t.xs,sm:t.sm,md:t.md,lg:t.lg,xl:t.xl}},Qj={borders:Gj,palette:{primary:{main:"#1976d2",light:"#42a5f5",dark:"#1565c0",contrastText:"#ffffff"},secondary:{main:"#10b981",light:"#6ee7b7",dark:"#059669",contrastText:"#ffffff"},success:{main:"#22c55e",light:"#86efac",dark:"#16a34a",contrastText:"#ffffff"},warning:{main:"#f59e0b",light:"#fcd34d",dark:"#d97706",contrastText:"#ffffff"},error:{main:"#ef4444",light:"#fca5a5",dark:"#dc2626",contrastText:"#ffffff"},info:{main:"#06b6d4",light:"#67e8f9",dark:"#0891b2",contrastText:"#ffffff"},background:{default:"#fafafa",paper:"#ffffff"},text:{primary:"rgb(56, 63, 75)",secondary:"#9ca3af"},grey:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a"}},typography:{fontFamily:["Open Sans","sans-serif"].join(","),h1:{fontSize:_e("header").md,fontWeight:500,lineHeight:1.2,"@media (min-width:0px)":{fontSize:_e("header").xs},"@media (min-width:600px)":{fontSize:_e("header").sm},"@media (min-width:900px)":{fontSize:_e("header").md},"@media (min-width:1200px)":{fontSize:_e("header").lg},"@media (min-width:1536px)":{fontSize:_e("header").xl}},h2:{fontSize:_e("title").md,fontWeight:500,lineHeight:1.3,"@media (min-width:0px)":{fontSize:_e("title").xs},"@media (min-width:600px)":{fontSize:_e("title").sm},"@media (min-width:900px)":{fontSize:_e("title").md},"@media (min-width:1200px)":{fontSize:_e("title").lg},"@media (min-width:1536px)":{fontSize:_e("title").xl}},h3:{fontSize:_e("subtitle").md,fontWeight:500,lineHeight:1.3,"@media (min-width:0px)":{fontSize:_e("subtitle").xs},"@media (min-width:600px)":{fontSize:_e("subtitle").sm},"@media (min-width:900px)":{fontSize:_e("subtitle").md},"@media (min-width:1200px)":{fontSize:_e("subtitle").lg},"@media (min-width:1536px)":{fontSize:_e("subtitle").xl}},h4:{fontSize:_e("body").md,fontWeight:500,lineHeight:1.4,"@media (min-width:0px)":{fontSize:_e("body").xs},"@media (min-width:600px)":{fontSize:_e("body").sm},"@media (min-width:900px)":{fontSize:_e("body").md},"@media (min-width:1200px)":{fontSize:_e("body").lg},"@media (min-width:1536px)":{fontSize:_e("body").xl}},h5:{fontSize:_e("small").md,fontWeight:500,lineHeight:1.4,"@media (min-width:0px)":{fontSize:_e("small").xs},"@media (min-width:600px)":{fontSize:_e("small").sm},"@media (min-width:900px)":{fontSize:_e("small").md},"@media (min-width:1200px)":{fontSize:_e("small").lg},"@media (min-width:1536px)":{fontSize:_e("small").xl}},h6:{fontSize:_e("cardTitle").md,fontWeight:500,lineHeight:1.2,"@media (min-width:0px)":{fontSize:_e("cardTitle").xs},"@media (min-width:600px)":{fontSize:_e("cardTitle").sm},"@media (min-width:900px)":{fontSize:_e("cardTitle").md},"@media (min-width:1200px)":{fontSize:_e("cardTitle").lg},"@media (min-width:1536px)":{fontSize:_e("cardTitle").xl}},body1:{fontSize:_e("body").md,fontWeight:400,lineHeight:1.5,"@media (min-width:0px)":{fontSize:_e("body").xs},"@media (min-width:600px)":{fontSize:_e("body").sm},"@media (min-width:900px)":{fontSize:_e("body").md},"@media (min-width:1200px)":{fontSize:_e("body").lg},"@media (min-width:1536px)":{fontSize:_e("body").xl}},body2:{fontSize:_e("small").md,fontWeight:400,lineHeight:1.4,"@media (min-width:0px)":{fontSize:_e("small").xs},"@media (min-width:600px)":{fontSize:_e("small").sm},"@media (min-width:900px)":{fontSize:_e("small").md},"@media (min-width:1200px)":{fontSize:_e("small").lg},"@media (min-width:1536px)":{fontSize:_e("small").xl}},caption:{fontSize:_e("caption").md,fontWeight:400,lineHeight:1.3,"@media (min-width:0px)":{fontSize:_e("caption").xs},"@media (min-width:600px)":{fontSize:_e("caption").sm},"@media (min-width:900px)":{fontSize:_e("caption").md},"@media (min-width:1200px)":{fontSize:_e("caption").lg},"@media (min-width:1536px)":{fontSize:_e("caption").xl}}},shape:{borderRadius:12},shadows:["none","0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12)","0px 3px 1px -2px rgba(0,0,0,0.2),0px 2px 2px 0px rgba(0,0,0,0.14),0px 1px 5px 0px rgba(0,0,0,0.12)","0px 3px 3px -2px rgba(0,0,0,0.2),0px 3px 4px 0px rgba(0,0,0,0.14),0px 1px 8px 0px rgba(0,0,0,0.12)","0px 2px 4px -1px rgba(0,0,0,0.2),0px 4px 5px 0px rgba(0,0,0,0.14),0px 1px 10px 0px rgba(0,0,0,0.12)","0px 3px 5px -1px rgba(0,0,0,0.2),0px 5px 8px 0px rgba(0,0,0,0.14),0px 1px 14px 0px rgba(0,0,0,0.12)","0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12)","0px 4px 5px -2px rgba(0,0,0,0.2),0px 7px 10px 1px rgba(0,0,0,0.14),0px 2px 16px 1px rgba(0,0,0,0.12)","0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12)","0px 5px 6px -3px rgba(0,0,0,0.2),0px 9px 12px 1px rgba(0,0,0,0.14),0px 3px 16px 2px rgba(0,0,0,0.12)","0px 6px 6px -3px rgba(0,0,0,0.2),0px 10px 14px 1px rgba(0,0,0,0.14),0px 4px 18px 3px rgba(0,0,0,0.12)","0px 6px 7px -4px rgba(0,0,0,0.2),0px 11px 15px 1px rgba(0,0,0,0.14),0px 4px 20px 3px rgba(0,0,0,0.12)","0px 7px 8px -4px rgba(0,0,0,0.2),0px 12px 17px 2px rgba(0,0,0,0.14),0px 5px 22px 4px rgba(0,0,0,0.12)","0px 7px 8px -4px rgba(0,0,0,0.2),0px 13px 19px 2px rgba(0,0,0,0.14),0px 5px 24px 4px rgba(0,0,0,0.12)","0px 7px 9px -4px rgba(0,0,0,0.2),0px 14px 21px 2px rgba(0,0,0,0.14),0px 5px 26px 4px rgba(0,0,0,0.12)","0px 8px 9px -5px rgba(0,0,0,0.2),0px 15px 22px 2px rgba(0,0,0,0.14),0px 6px 28px 5px rgba(0,0,0,0.12)","0px 8px 10px -5px rgba(0,0,0,0.2),0px 16px 24px 2px rgba(0,0,0,0.14),0px 6px 30px 5px rgba(0,0,0,0.12)","0px 8px 11px -5px rgba(0,0,0,0.2),0px 17px 26px 2px rgba(0,0,0,0.14),0px 6px 32px 5px rgba(0,0,0,0.12)","0px 9px 11px -5px rgba(0,0,0,0.2),0px 18px 28px 2px rgba(0,0,0,0.14),0px 7px 34px 6px rgba(0,0,0,0.12)","0px 9px 12px -6px rgba(0,0,0,0.2),0px 19px 29px 2px rgba(0,0,0,0.14),0px 7px 36px 6px rgba(0,0,0,0.12)","0px 10px 13px -6px rgba(0,0,0,0.2),0px 20px 31px 3px rgba(0,0,0,0.14),0px 8px 38px 7px rgba(0,0,0,0.12)","0px 10px 13px -6px rgba(0,0,0,0.2),0px 21px 33px 3px rgba(0,0,0,0.14),0px 8px 40px 7px rgba(0,0,0,0.12)","0px 10px 14px -6px rgba(0,0,0,0.2),0px 22px 35px 3px rgba(0,0,0,0.14),0px 8px 42px 7px rgba(0,0,0,0.12)","0px 11px 14px -7px rgba(0,0,0,0.2),0px 23px 36px 3px rgba(0,0,0,0.14),0px 9px 44px 8px rgba(0,0,0,0.12)","0px 11px 15px -7px rgba(0,0,0,0.2),0px 24px 38px 3px rgba(0,0,0,0.14),0px 9px 46px 8px rgba(0,0,0,0.12)"],components:{MuiButton:{styleOverrides:{root:{fontSize:_e("button").md,fontWeight:600,textTransform:"none",borderRadius:8,"@media (min-width:0px)":{fontSize:_e("button").xs},"@media (min-width:600px)":{fontSize:_e("button").sm},"@media (min-width:900px)":{fontSize:_e("button").md},"@media (min-width:1200px)":{fontSize:_e("button").lg},"@media (min-width:1536px)":{fontSize:_e("button").xl}}}},MuiCard:{styleOverrides:{root:{borderRadius:16,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out","&:hover":{boxShadow:"0 4px 16px rgba(0,0,0,0.15)",transform:"translateY(-2px)"}}}},MuiCardContent:{styleOverrides:{root:{padding:"16px","&:last-child":{paddingBottom:"16px"}}}},MuiTab:{styleOverrides:{root:{fontSize:_e("tab").md,fontWeight:500,textTransform:"none","@media (min-width:0px)":{fontSize:_e("tab").xs},"@media (min-width:600px)":{fontSize:_e("tab").sm},"@media (min-width:900px)":{fontSize:_e("tab").md},"@media (min-width:1200px)":{fontSize:_e("tab").lg},"@media (min-width:1536px)":{fontSize:_e("tab").xl}}}},MuiTableCell:{styleOverrides:{root:{borderBottom:"1px solid rgba(0, 0, 0, 0.08) !important"},head:{borderBottom:"1px solid rgba(0, 0, 0, 0.12) !important",fontWeight:600}}},MuiTableRow:{styleOverrides:{root:{},hover:{}}},MuiTableBody:{styleOverrides:{root:{"& .MuiTableRow-root:last-child td, & .MuiTableRow-root:last-child th":{borderBottom:"0 none !important"}}}},MuiTableHead:{styleOverrides:{root:{"& .MuiTableCell-root":{borderBottom:"1px solid rgba(0, 0, 0, 0.12) !important"}}}}}},Xj=$x(Qj),Jj=()=>{const r=Je(),t=a=>_e(a),n=(a,i={})=>{const o=t(a);return{fontSize:{xs:o.xs,sm:o.sm,md:o.md,lg:o.lg,xl:o.xl},...i}};return{getFontSize:t,getTypographySx:n,variants:{chartTitle:(a={})=>n("chartTitle",{fontWeight:400,lineHeight:1.3,color:"text.primary",...a}),chartSubtitle:(a={})=>n("chartSubtitle",{fontWeight:400,lineHeight:1.3,color:"rgb(156, 163, 175)",...a}),chartLegend:(a={})=>n("chartLegend",{fontWeight:400,lineHeight:1,color:"rgb(156, 163, 175)",...a}),chartTooltip:(a={})=>n("chartTooltip",{fontWeight:400,lineHeight:1.3,color:"rgb(156, 163, 175)",...a}),cardTitle:(a={})=>n("cardTitle",{fontWeight:600,lineHeight:1.3,...a}),cardValue:(a={})=>n("cardValue",{fontWeight:600,lineHeight:1.2,...a}),cardValueLarge:(a={})=>n("cardValueLarge",{fontWeight:700,lineHeight:1.2,...a}),cardValueMedium:(a={})=>n("cardValueMedium",{fontWeight:500,lineHeight:1.3,...a}),cardValueSmall:(a={})=>n("cardValueSmall",{fontWeight:500,lineHeight:1.3,...a}),cardLabel:(a={})=>n("cardLabel",{fontWeight:400,lineHeight:1.3,color:"rgb(156, 163, 175)",...a}),labelMedium:(a={})=>n("medium",{fontWeight:400,lineHeight:1.3,color:"text.primary",...a}),labelSmall:(a={})=>n("labelSmall",{fontWeight:400,lineHeight:1.3,color:"rgb(156, 163, 175)",...a}),labelXSmall:(a={})=>n("xSmall",{fontWeight:400,lineHeight:1.3,color:"rgb(156, 163, 175)",...a}),cardSubtitle:(a={})=>n("cardLabel",{fontWeight:300,lineHeight:1.3,color:"rgb(156, 163, 175)",...a}),pageHeader:(a={})=>n("header",{fontWeight:300,lineHeight:1.3,color:"#1a1a1a",...a}),pageTitle:(a={})=>n("title",{fontWeight:600,lineHeight:1.3,color:"#1a1a1a",...a}),pageSubtitle:(a={})=>n("subtitle",{fontWeight:400,lineHeight:1.4,color:"rgb(156, 163, 175)",...a}),tabLabel:(a={})=>n("tab",{fontWeight:600,textTransform:"none",...a}),buttonText:(a={})=>n("button",{fontWeight:600,textTransform:"none",...a}),formLabel:(a={})=>n("small",{fontWeight:500,lineHeight:1.4,color:"#333333",...a}),formHelper:(a={})=>n("caption",{fontWeight:400,lineHeight:1.3,color:"rgb(156, 163, 175)",...a}),tableHeader:(a={})=>n("small",{fontWeight:500,lineHeight:1.4,color:"#333333",...a}),tableCell:(a={})=>n("small",{fontWeight:400,lineHeight:1.4,color:"#1a1a1a",...a}),tableHeaderSmall:(a={})=>n("caption",{fontWeight:600,lineHeight:1.4,color:"#333333",fontSize:{xs:"0.625rem",sm:"0.7rem",md:"0.75rem",lg:"0.8rem",xl:"0.875rem"},...a}),tableCellSmall:(a={})=>n("xSmall",{fontWeight:300,lineHeight:1.4,color:"#1a1a1a",fontSize:{xs:"0.625rem",sm:"0.7rem",md:"0.75rem",lg:"0.8rem",xl:"0.875rem"},...a}),tableHeaderXSmall:(a={})=>n("caption",{fontWeight:600,lineHeight:1.2,color:"#333333",fontSize:{xs:"0.625rem",sm:"0.7rem",md:"0.75rem",lg:"0.8rem",xl:"0.875rem"},...a}),tableCellXSmall:(a={})=>n("caption",{fontWeight:400,lineHeight:1.2,color:"#1a1a1a",fontSize:{xs:"0.625rem",sm:"0.7rem",md:"0.75rem",lg:"0.8rem",xl:"0.875rem"},...a}),statusText:(a={})=>n("small",{fontWeight:500,lineHeight:1.3,...a}),errorText:(a={})=>n("small",{fontWeight:400,lineHeight:1.3,color:"#dc2626",...a}),successText:(a={})=>n("small",{fontWeight:400,lineHeight:1.3,color:"#059669",...a})},theme:r}},c=rt.forwardRef(({variant:r,customVariant:t,overrides:n={},sx:s={},ellipsis:a=!0,maxLines:i,desktopOnly:o=!1,mobileOnly:d=!1,children:u,...h},m)=>{const{variants:x,getTypographySx:g}=Jj(),f=()=>{let b={};return t?b=g(t,n):r&&x[r]?b=x[r](n):b=n,o?b={...b,display:{xs:"none",md:"block"}}:d&&(b={...b,display:{xs:"block",md:"none"}}),a&&(i&&i>1?b={...b,display:"-webkit-box",WebkitLineClamp:i,WebkitBoxOrient:"vertical",overflow:"hidden"}:b={...b,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),{...b,...s}},y=r&&x[r],j=t||y?"body2":r;return e.jsx(D,{ref:m,...h,variant:j,sx:f(),children:u})}),Rt=({open:r,onClose:t,title:n,icon:s,children:a,actions:i,loading:o=!1,maxWidth:d="md",fullWidth:u=!0,fullScreen:h=!1,showCloseButton:m=!0,disableCloseOnBackdrop:x=!1,disableCloseOnEscape:g=!1,titleColor:f="primary",size:y="medium",hideHeader:j=!1,autoMobileDetection:b=!0,mobileBreakpoint:v="sm"})=>{const P=Je(),w=Nt(P.breakpoints.down(v)),C=b?w:h,k=b?!0:u,A=()=>{o||t()},L=()=>{switch(f){case"primary":return"primary.main";case"secondary":return"secondary.main";case"error":return"error.main";case"warning":return"warning.main";case"info":return"info.main";case"success":return"success.main";default:return"primary.main"}},M=(()=>{switch(y){case"small":return{titlePadding:2,contentPadding:2,actionsPadding:2};case"medium":return{titlePadding:3,contentPadding:3,actionsPadding:3};case"large":return{titlePadding:4,contentPadding:4,actionsPadding:4};default:return{titlePadding:3,contentPadding:3,actionsPadding:3}}})();return e.jsxs(kt,{open:r,onClose:x?void 0:A,maxWidth:d==="xxl"?"xl":d,fullWidth:k,fullScreen:C,disableEscapeKeyDown:g,PaperProps:{sx:{borderRadius:C?0:2,boxShadow:C?"none":"0 8px 32px rgba(0,0,0,0.12)",width:C?"100%":d==="xs"?"400px":d==="sm"?"500px":d==="md"?"700px!important":d==="lg"?"900px":d==="xl"||d==="xxl"?"100%":"700px!important",minWidth:"auto",maxWidth:C?"100%":d==="xs"?"400px":d==="sm"?"500px":d==="md"?"700px!important":d==="lg"?"900px":d==="xl"?"1200px":d==="xxl"?"1400px":"700px!important"}},children:[!j&&e.jsx(Et,{sx:{p:M.titlePadding,py:1,borderBottom:"1px solid",borderColor:"divider",backgroundColor:"background.paper"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[s&&e.jsx(l,{sx:{display:"flex",alignItems:"center"},children:s}),e.jsx(l,{sx:{fontWeight:500,color:L(),flex:1,fontSize:"1.25rem",lineHeight:1.2,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n})]}),m&&e.jsx(Ie,{onClick:A,disabled:o,size:"small",sx:{color:"text.secondary","&:hover":{backgroundColor:"action.hover",color:"text.primary"},"&:disabled":{color:"text.disabled"}},children:e.jsx(sr,{})})]})}),e.jsx(Pt,{sx:{p:M.contentPadding,py:2,mt:2,backgroundColor:"background.paper"},children:a}),i&&e.jsx(Dt,{sx:{p:M.actionsPadding,py:1,mt:1,borderTop:"1px solid",borderColor:"divider",backgroundColor:"background.paper",gap:1},children:i}),o&&e.jsx(l,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1},children:e.jsx(Ce,{})})]})};var nn=(r=>(r.BUY="BUY",r.SELL="SELL",r))(nn||{}),na=(r=>(r.MARKET="MARKET",r.LIMIT="LIMIT",r.STOP="STOP",r))(na||{}),ra=(r=>(r.MANUAL="MANUAL",r.API="API",r.IMPORT="IMPORT",r))(ra||{}),Ns=(r=>(r.STOCK="STOCK",r.BOND="BOND",r.CRYPTO="CRYPTO",r.COMMODITY="COMMODITY",r.GOLD="GOLD",r.REALESTATE="REALESTATE",r.OTHER="OTHER",r))(Ns||{}),ps=(r=>(r.AUTOMATIC="AUTOMATIC",r.MANUAL="MANUAL",r))(ps||{});const po={STOCK:"C phiu",BOND:"Tri phiu",CRYPTO:"Ti sn s",COMMODITY:"Hng ha",GOLD:"Vng",REALESTATE:"Bt ng sn",OTHER:"Khc"},eu={AUTOMATIC:"T ng",MANUAL:"Th cng"};var Ht=(r=>(r.OWNER="OWNER",r.UPDATE="UPDATE",r.VIEW="VIEW",r.CREATOR="CREATOR",r))(Ht||{});const Jl=({permission:r,size:t="small",variant:n="outlined",showIcon:s=!0,showLabel:a=!0})=>{const o=(d=>{switch(d){case Ht.OWNER:return{label:"Owner",color:"primary",icon:e.jsx(ci,{fontSize:"small"}),tooltip:"You are the owner of this portfolio. You have full control."};case Ht.UPDATE:return{label:"Update",color:"secondary",icon:e.jsx(Tt,{fontSize:"small"}),tooltip:"You can view and update this portfolio."};case Ht.VIEW:return{label:"View",color:"default",icon:e.jsx(Xt,{fontSize:"small"}),tooltip:"You can only view this portfolio."};case Ht.CREATOR:return{label:"Creator",color:"success",icon:e.jsx(ia,{fontSize:"small"}),tooltip:"You are the creator of this portfolio. You can transfer the creation permission to another account."};default:return{label:"Unknown",color:"default",icon:e.jsx(Jt,{fontSize:"small"}),tooltip:"Unknown permission level."}}})(r.permissionType);return e.jsx(Fe,{title:o.tooltip,arrow:!0,children:e.jsx(ce,{icon:s?o.icon:void 0,label:a?o.label:void 0,color:o.color,size:t,variant:n,sx:{fontWeight:500,border:a?{xs:"none!important",sm:"none!important",md:"none!important",lg:"0.5px solid!important"}:"none!important","& .MuiChip-label":{display:{xs:"none",sm:"none",md:"none",lg:"block"}}}})})},gs=({columns:r,data:t,loading:n=!1,emptyMessage:s="Khng c d liu",size:a="small",variant:i="outlined",showBorders:o=!0,hoverable:d=!0,striped:u=!1,className:h="",sx:m={},onRowClick:x,getRowKey:g,...f})=>{const y={border:o?"1px solid rgba(0, 0, 0, 0.08)":"none",borderRadius:2,overflow:"auto",maxWidth:"100%","&::-webkit-scrollbar":{height:8},"&::-webkit-scrollbar-track":{backgroundColor:"rgba(0, 0, 0, 0.05)",borderRadius:2},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0, 0, 0, 0.2)",borderRadius:2,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.3)"}},"& .MuiTable-root":{minWidth:"max-content","& .MuiTableRow-root":{"&:not(:last-child)":{borderBottom:o?"1px solid rgba(0, 0, 0, 0.08)":"none"},"&:hover":d?{backgroundColor:"rgba(0, 0, 0, 0.02)",cursor:x?"pointer":"default"}:{},...u&&{"&:nth-of-type(even)":{backgroundColor:"rgba(0, 0, 0, 0.02)"}}},"& .MuiTableCell-root":{borderBottom:o?"1px solid rgba(0, 0, 0, 0.08)":"none",borderRight:o?"1px solid rgba(0, 0, 0, 0.05)":"none","&:last-child":{borderRight:"none"},color:"rgba(0, 0, 0, 0.87)",fontSize:a==="small"?"0.875rem":"1rem",padding:a==="small"?"8px 12px":"12px 16px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},"& .MuiTableHead-root .MuiTableRow-root":{borderBottom:o?"2px solid rgba(0, 0, 0, 0.08)":"none"},"& .MuiTableHead-root .MuiTableCell-root":{backgroundColor:"rgba(0, 0, 0, 0.02)",borderBottom:o?"1px solid rgba(0, 0, 0, 0.08)":"none",borderRight:o?"1px solid rgba(0, 0, 0, 0.05)":"none",fontWeight:600,fontSize:a==="small"?"0.8rem":"0.9rem","&:last-child":{borderRight:"none"}}},...m},j=(v,P)=>{x&&x(v,P)},b=(v,P)=>g?g(v,P):P;return e.jsxs(l,{sx:{position:"relative"},children:[e.jsx(at,{component:Te,variant:i,className:`responsive-table ${h}`,sx:y,...f,children:e.jsxs(it,{size:a,children:[e.jsx(ct,{children:e.jsx(De,{children:r.map((v,P)=>e.jsx(S,{align:v.align||"left",sx:{...v.headerSx||{},...v.cellSx||{},...v.minWidth&&{minWidth:v.minWidth},...v.maxWidth&&{maxWidth:v.maxWidth},...v.width&&{width:v.width}},children:v.header},v.key||P))})}),e.jsx(ot,{children:n?e.jsx(De,{children:e.jsx(S,{colSpan:r.length,align:"center",sx:{py:4},children:e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(c,{variant:"body2",color:"text.secondary",children:"ang ti..."})})})}):t.length===0?e.jsx(De,{children:e.jsx(S,{colSpan:r.length,align:"center",sx:{py:4},children:e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",children:e.jsx(c,{variant:"body2",color:"text.secondary",children:s})})})}):t.map((v,P)=>e.jsx(De,{onClick:()=>j(v,P),sx:{...x&&{cursor:"pointer"}},children:r.map((w,C)=>e.jsx(S,{align:w.align||"left",sx:{...w.cellSx,minWidth:w.minWidth,maxWidth:w.maxWidth,width:w.width},children:w.render?w.render(v,P):v[w.key]},w.key||C))},b(v,P)))})]})}),e.jsx(l,{sx:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",width:20,height:40,background:"linear-gradient(to left, rgba(0,0,0,0.1), transparent)",pointerEvents:"none",opacity:.6,display:{xs:"block",sm:"none"},zIndex:1}})]})},Ki=({children:r,title:t,subtitle:n,icon:s,variant:a="default",size:i="small",spacing:o="small",hoverable:d=!1,clickable:u=!1,loading:h=!1,error:m=null,actions:x,className:g="",sx:f={},onClick:y,onMouseEnter:j,onMouseLeave:b})=>{const v=Je(),P=Nt(v.breakpoints.down("sm")),w={none:{padding:0,marginBottom:0,borderRadius:0},small:{padding:P?0:1,marginBottom:1,borderRadius:1},medium:{padding:P?.5:2,marginBottom:1.5,borderRadius:2},large:{padding:P?1.5:3,marginBottom:2,borderRadius:3}},C={none:{mb:0},small:{mb:1},medium:{mb:1.5},large:{mb:2}},k={default:{border:"1px solid",borderColor:"divider",boxShadow:"none",bgcolor:"background.paper"},transparent:{border:0,boxShadow:0,bgcolor:"transparent"},outlined:{border:"2px solid",borderColor:"primary.main",boxShadow:"none",bgcolor:"background.paper"},elevated:{border:"none",boxShadow:v.shadows[2],bgcolor:"background.paper"}},A=w[i],L=C[o],T=k[a],M={...A,...L,...T,cursor:u?"pointer":"default",transition:d||u?"all 0.2s ease-in-out":"none","&:hover":d||u?{boxShadow:a==="transparent"?"none":v.shadows[4],transform:u?"translateY(-2px)":"none"}:{boxShadow:"none",transform:"none"},...f},O=()=>{u&&y&&y()};return e.jsxs(se,{className:`responsive-card ${g}`,sx:M,onClick:O,onMouseEnter:j,onMouseLeave:b,children:[(t||n||s||x)&&e.jsx(pa,{title:t?e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[s&&e.jsx(l,{sx:{display:"flex",alignItems:"center"},children:s}),e.jsx(c,{variant:"cardTitle",component:"h3",children:t})]}):void 0,subheader:n?e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",children:n}):void 0,action:x,sx:{p:i==="none"?0:1,pb:1,"& .MuiCardHeader-content":{overflow:"hidden"}}}),e.jsx(me,{sx:{p:A.padding},children:h?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",py:4,children:e.jsx(Ce,{size:24})}):m?e.jsx(je,{severity:"error",sx:{mb:2},children:m}):r})]})},Zj=({open:r,onClose:t,onAccountCreated:n})=>{const{t:s}=Ne(),[a,i]=p.useState({name:"",email:"",baseCurrency:"VND",isInvestor:!1}),[o,d]=p.useState(!1),[u,h]=p.useState(null),m=f=>y=>{const j=f==="isInvestor"?y.target.checked:y.target.value;i(b=>({...b,[f]:j})),h(null)},x=async f=>{var y,j;f.preventDefault(),d(!0),h(null);try{const b={name:a.name,baseCurrency:a.baseCurrency,isInvestor:a.isInvestor,...a.email&&a.email.trim()!==""&&{email:a.email.trim()}},v=await q.api.post("/api/v1/accounts",b),P={id:v.data.accountId,accountId:v.data.accountId,name:v.data.name,email:v.data.email,baseCurrency:v.data.baseCurrency,isInvestor:v.data.isInvestor,createdAt:v.data.createdAt,updatedAt:v.data.updatedAt};n(P),t(),i({name:"",email:"",baseCurrency:"VND",isInvestor:!1})}catch(b){console.error("Error creating account:",b),h(((j=(y=b.response)==null?void 0:y.data)==null?void 0:j.message)||s("createAccountModal.error.createFailed"))}finally{d(!1)}},g=()=>{o||(h(null),i({name:"",email:"",baseCurrency:"VND",isInvestor:!1}),t())};return e.jsxs(Rt,{open:r,onClose:g,title:s("createAccountModal.title"),icon:e.jsx(Ue,{}),loading:o,maxWidth:"sm",size:"medium",actions:e.jsxs(l,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.jsx(he,{onClick:g,disabled:o,color:"inherit",mobileText:"Cancel",desktopText:"Cancel",sx:{width:"auto"},children:s("common.cancel")}),e.jsx(We,{onClick:x,variant:"contained",disabled:o||!a.name,icon:o?e.jsx(Ce,{size:16}):void 0,mobileText:s(o?"createAccountModal.creating":"createAccountModal.create"),desktopText:s(o?"createAccountModal.creating":"createAccountModal.createAccount"),forceTextOnly:!0,sx:{width:"auto"},children:s(o?"createAccountModal.creating":"createAccountModal.createAccount")})]}),children:[u&&e.jsx(je,{severity:"error",sx:{mb:2},children:u}),e.jsxs(l,{component:"form",onSubmit:x,children:[e.jsx(c,{variant:"pageTitle",sx:{mt:2},children:s("createAccountModal.accountInfoTitle")}),e.jsx(Ae,{fullWidth:!0,label:s("createAccountModal.fields.name"),value:a.name,onChange:m("name"),margin:"normal",required:!0,disabled:o,helperText:s("createAccountModal.fields.nameHelper")}),e.jsx(Ae,{fullWidth:!0,label:s("createAccountModal.fields.email"),type:"email",value:a.email,onChange:m("email"),margin:"normal",disabled:o,helperText:s("createAccountModal.fields.emailHelper")}),e.jsxs(l,{sx:{mt:2},children:[e.jsx(an,{control:e.jsx(jn,{checked:a.isInvestor,onChange:m("isInvestor"),disabled:o}),label:e.jsx(c,{variant:"body2",children:s("createAccountModal.fields.canInvest")})}),e.jsx(c,{variant:"caption",color:"text.secondary",display:"block",sx:{mt:.5},children:s("createAccountModal.fields.canInvestHelper")})]})]})]})},ev=({open:r,onClose:t,account:n,onAccountUpdated:s})=>{const{t:a}=Ne(),[i,o]=p.useState({name:"",email:"",baseCurrency:"VND",isInvestor:!1}),[d,u]=p.useState(!1),[h,m]=p.useState(null);p.useEffect(()=>{n&&(o({name:n.name,email:n.email,baseCurrency:n.baseCurrency,isInvestor:n.isInvestor||!1}),m(null))},[n]);const x=y=>j=>{const b=y==="isInvestor"?j.target.checked:j.target.value;o(v=>({...v,[y]:b})),m(null)},g=async y=>{var j,b;if(y.preventDefault(),!!n){u(!0),m(null);try{const v=await q.api.put(`/api/v1/accounts/${n.accountId}`,i),P={id:v.data.accountId,accountId:v.data.accountId,name:v.data.name,email:v.data.email,baseCurrency:v.data.baseCurrency,isInvestor:v.data.isInvestor,isMainAccount:v.data.isMainAccount,createdAt:v.data.createdAt,updatedAt:v.data.updatedAt};s(P),t()}catch(v){console.error("Error updating account:",v),m(((b=(j=v.response)==null?void 0:j.data)==null?void 0:b.message)||a("editAccountModal.error.updateFailed"))}finally{u(!1)}}},f=()=>{d||(m(null),t())};return n?e.jsxs(Rt,{open:r,onClose:f,title:a("editAccountModal.title"),icon:e.jsx(Ue,{}),loading:d,maxWidth:"sm",size:"medium",actions:e.jsxs(l,{sx:{display:"flex",gap:1,justifyContent:"flex-end",width:"100%"},children:[e.jsx(he,{onClick:f,disabled:d,color:"inherit",mobileText:a("common.cancel"),desktopText:a("common.cancel"),sx:{width:"auto"},children:a("common.cancel")}),e.jsx(We,{onClick:g,variant:"contained",disabled:d||!i.name||!i.email,icon:d?e.jsx(Ce,{size:16}):void 0,mobileText:a(d?"editAccountModal.updating":"editAccountModal.update"),desktopText:a(d?"editAccountModal.updating":"editAccountModal.updateAccount"),forceTextOnly:!0,sx:{width:"auto"},children:a(d?"editAccountModal.updating":"editAccountModal.updateAccount")})]}),children:[h&&e.jsx(je,{severity:"error",sx:{mb:2},children:h}),e.jsxs(l,{component:"form",onSubmit:g,children:[e.jsx(Ae,{fullWidth:!0,label:a("editAccountModal.fields.name"),value:i.name,onChange:x("name"),margin:"normal",required:!0,disabled:d,helperText:a("editAccountModal.fields.nameHelper")}),e.jsx(Ae,{fullWidth:!0,label:a("editAccountModal.fields.email"),type:"email",value:i.email,onChange:x("email"),margin:"normal",required:!0,disabled:d,helperText:a("editAccountModal.fields.emailHelper")}),e.jsx(an,{control:e.jsx(jn,{checked:i.isInvestor,onChange:x("isInvestor"),disabled:d}),label:a("editAccountModal.fields.canInvest"),sx:{mt:2}}),e.jsx(l,{sx:{mt:.5},children:e.jsx(l,{component:"span",sx:{fontSize:"0.75rem",color:"text.secondary"},children:a("editAccountModal.fields.canInvestHelper")})})]})]}):null},tv=({onToggle:r,size:t="small",color:n="default"})=>{const[s,a]=p.useState(!1);p.useEffect(()=>{const h=localStorage.getItem("currency-show-full")==="true";a(h),r(h)},[r]);const i=()=>{const u=!s;a(u),localStorage.setItem("currency-show-full",u.toString()),r(u),window.location.reload()},o={small:16,medium:20},d={primary:"primary.main",secondary:"secondary.main",default:"text.secondary"};return e.jsx(Fe,{title:s?"Show compact format (1.5tr )":"Show full format (1,500,000 )",placement:"bottom",arrow:!0,children:e.jsx(Ie,{size:t,onClick:i,sx:{color:d[n],mr:{xs:0,sm:.5},ml:{xs:.5,sm:0},"&:hover":{color:"primary.main",backgroundColor:"primary.light"},transition:"all 0.2s ease-in-out"},children:s?e.jsx(oa,{sx:{fontSize:o[t]}}):e.jsx(Xt,{sx:{fontSize:o[t]}})})})},nv=()=>{const{t:r}=Ne(),t=An(),{currentAccount:n,switchAccount:s}=Ge(),[a,i]=p.useState(null),[o,d]=p.useState([]),[u,h]=p.useState(!1),m=!!a;p.useEffect(()=>{x()},[]);const x=async()=>{try{h(!0);const w=(await q.getAccounts()).sort((C,k)=>C.isDemoAccount&&!k.isDemoAccount?-1:!C.isDemoAccount&&k.isDemoAccount?1:C.isMainAccount&&!k.isMainAccount?-1:!C.isMainAccount&&k.isMainAccount?1:new Date(k.createdAt).getTime()-new Date(C.createdAt).getTime());d(w)}catch(P){console.error("Error loading accounts:",P),d([])}finally{h(!1)}},g=P=>{i(P.currentTarget)},f=()=>{i(null)},y=async P=>{if(P===(n==null?void 0:n.accountId)){f();return}h(!0);try{await s(P),f(),window.location.href="/"}catch(w){console.error("Failed to switch account:",w),h(!1)}},j=()=>{t("/settings?tab=accountManagement"),f()},b=async()=>{await x()},v=P=>P.split(" ").map(w=>w.charAt(0)).join("").toUpperCase().slice(0,2);return e.jsxs(e.Fragment,{children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsx(Fe,{title:u?r("accountSwitcher.switching"):(n==null?void 0:n.name)||r("accountSwitcher.switchAccount"),children:e.jsx("span",{children:e.jsx(he,{onClick:g,variant:"outlined",icon:e.jsx(Ue,{}),mobileText:"",desktopText:"",disabled:u,forceIconOnly:!0,responsiveSizing:!1,sx:{height:35,maxWidth:35,minWidth:35,justifyContent:"center",textTransform:"none",borderRadius:1.5,px:.5,py:.5,mr:{xs:0,sm:.5},ml:{xs:.5,sm:0}},children:u?r("accountSwitcher.switching"):""})})})}),e.jsxs(Gn,{anchorEl:a,open:m,onClose:f,PaperProps:{sx:{minWidth:280,maxHeight:400,borderRadius:2,boxShadow:"0 8px 32px rgba(0,0,0,0.12)"}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[e.jsxs(l,{sx:{px:2,py:1.5,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(D,{variant:"subtitle2",color:"text.secondary",children:r("accountSwitcher.selectAccount")}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(tv,{onToggle:P=>{window.dispatchEvent(new CustomEvent("currency-format-changed",{detail:{showFull:P}}))},size:"small",color:"default"}),e.jsx(Fe,{title:r("accountSwitcher.refreshAccounts"),children:e.jsx(Ie,{size:"small",onClick:b,disabled:u,sx:{color:"text.secondary","&:hover":{color:"primary.main",backgroundColor:"primary.50"},"&.Mui-disabled":{opacity:.6}},children:e.jsx(Mt,{fontSize:"small"})})}),e.jsx(Fe,{title:r("accountSwitcher.manageAccounts"),children:e.jsx(Ie,{size:"small",onClick:j,sx:{color:"text.secondary","&:hover":{color:"primary.main",backgroundColor:"primary.50"}},children:e.jsx(Gr,{fontSize:"small"})})})]})]}),e.jsx(bt,{}),u?e.jsx(l,{sx:{p:2,textAlign:"center"},children:e.jsx(D,{variant:"body2",color:"text.secondary",children:r("accountSwitcher.loadingAccounts")})}):o.length===0?e.jsx(l,{sx:{p:2,textAlign:"center"},children:e.jsx(D,{variant:"body2",color:"text.secondary",children:r("accountSwitcher.noAccounts")})}):o.filter(P=>P).map(P=>e.jsxs(re,{onClick:()=>y(P.accountId),selected:P.accountId===(n==null?void 0:n.accountId),disabled:u,sx:{py:1.5,px:2,...P.isMainAccount&&{backgroundColor:"primary.50","&:hover":{backgroundColor:"primary.100"}},...P.isDemoAccount&&{backgroundColor:"success.50","&:hover":{backgroundColor:"success.100"}},"&.Mui-selected":{backgroundColor:P.isDemoAccount?"success.200":P.isMainAccount?"primary.200":"primary.light","&:hover":{backgroundColor:P.isDemoAccount?"success.200":P.isMainAccount?"primary.200":"primary.light"}},"&.Mui-disabled":{opacity:.6}},children:[e.jsx(tt,{sx:{minWidth:40},children:e.jsxs(l,{sx:{position:"relative"},children:[e.jsx(Vt,{sx:{width:32,height:32,fontSize:"0.875rem",...P.isDemoAccount&&{background:"linear-gradient(135deg, #2e7d32 0%, #1b5e20 100%)",border:"2px solid",borderColor:"success.main"},...P.isMainAccount&&!P.isDemoAccount&&{background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",border:"2px solid",borderColor:"primary.main"}},children:v(P.name)}),(P.isMainAccount||P.isDemoAccount)&&e.jsx(ci,{sx:{position:"absolute",top:-2,right:-2,fontSize:"0.75rem",color:P.isDemoAccount?"success.main":"primary.main",backgroundColor:"white",borderRadius:"50%",p:.25}})]})}),e.jsx(ve,{primary:e.jsxs(l,{component:"span",sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(D,{variant:"body2",noWrap:!0,children:P.name}),P.isDemoAccount&&e.jsx(ce,{label:r("accountSwitcher.demoAccount"),size:"small",color:"success",variant:"filled",sx:{height:20,fontSize:"0.75rem",fontWeight:"bold",background:"linear-gradient(135deg, #2e7d32 0%, #1b5e20 100%)",color:"white","& .MuiChip-label":{px:1}}}),P.isMainAccount&&!P.isDemoAccount&&e.jsx(ce,{label:r("accountSwitcher.mainAccount"),size:"small",color:"primary",variant:"filled",sx:{height:20,fontSize:"0.75rem",fontWeight:"bold",background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",color:"white","& .MuiChip-label":{px:1}}}),P.isInvestor&&e.jsx(ce,{label:r("accountSwitcher.investor"),size:"small",color:"secondary",sx:{height:20,fontSize:"0.75rem"}})]}),secondary:e.jsx(l,{component:"span",sx:{display:"flex",alignItems:"center",gap:1,mt:.5},children:e.jsx(l,{component:"span",sx:{fontSize:"0.75rem",color:"text.secondary"},children:P.email})})})]},P.accountId)),e.jsx(bt,{}),e.jsxs(re,{onClick:j,sx:{py:1.5,px:2},children:[e.jsx(tt,{sx:{minWidth:40},children:e.jsx(Vt,{sx:{width:32,height:32,backgroundColor:"secondary.light"},children:e.jsx(Gr,{sx:{fontSize:"1rem"}})})}),e.jsx(ve,{primary:r("accountSwitcher.manageAccounts"),secondary:r("accountSwitcher.manageAccountsDescription")})]})]})]})},rv=()=>{const{t:r}=Ne(),[t,n]=p.useState([]),[s,a]=p.useState(!1),[i,o]=p.useState(null),[d,u]=p.useState(!1),[h,m]=p.useState(!1),[x,g]=p.useState(null),[f,y]=p.useState(null),[j,b]=p.useState(null),[v,P]=p.useState(null),[w,C]=p.useState(!1),[k,A]=p.useState(null),[L,T]=p.useState(!1),{userRoles:M,isLoading:O}=Zr();p.useEffect(()=>{!O&&M!==null&&M!==void 0&&setTimeout(()=>{I()},100)},[O,M]);const I=async()=>{try{a(!0),o(null);const oe=await q.api.get("/api/v1/accounts");let ee=[];!M||!Array.isArray(M)||!M.some(Q=>Q.roleName.toLowerCase()==="super_admin")?ee=oe.data.filter(Q=>!Q.isDemoAccount):ee=oe.data;const H=ne(ee);n(H)}catch(oe){console.error("Error loading accounts:",oe),o(r("accountManagement.error.loadFailed"))}finally{a(!1)}},z=oe=>{n(ee=>{const H=[oe,...ee];return ne(H)}),u(!1)},N=oe=>{g(oe),m(!0)},E=oe=>{n(ee=>{const H=ee.map(Q=>Q.accountId===oe.accountId?oe:Q);return ne(H)}),m(!1),g(null)},R=async oe=>{const ee=t.find(H=>H.accountId===oe);ee&&(A(ee),C(!0))},V=async()=>{if(k)try{T(!0),await q.api.delete(`/api/v1/accounts/${k.accountId}`),n(oe=>oe.filter(ee=>ee.accountId!==k.accountId)),C(!1),A(null)}catch(oe){console.error("Error deleting account:",oe),o(r("accountManagement.error.deleteFailed"))}finally{T(!1)}},F=()=>{C(!1),A(null)},B=async oe=>{try{await navigator.clipboard.writeText(oe),y(oe),setTimeout(()=>{y(null)},2e3)}catch(ee){console.error("Failed to copy ID:",ee);const H=document.createElement("textarea");H.value=oe,document.body.appendChild(H),H.select(),document.execCommand("copy"),document.body.removeChild(H),y(oe),setTimeout(()=>{y(null)},2e3)}},$=(oe,ee)=>{b(oe.currentTarget),P(ee)},Y=()=>{b(null),P(null)},_=()=>{v&&N(v),Y()},K=()=>{v&&R(v.accountId),Y()},X=oe=>oe.split(" ").map(ee=>ee.charAt(0)).join("").toUpperCase().slice(0,2),ne=oe=>oe.sort((ee,H)=>ee.isMainAccount&&!H.isMainAccount?-1:!ee.isMainAccount&&H.isMainAccount?1:new Date(H.createdAt).getTime()-new Date(ee.createdAt).getTime());return e.jsxs(l,{sx:{p:{xs:0,sm:2}},children:[e.jsx(se,{children:e.jsxs(me,{sx:{p:{xs:0,sm:2}},children:[e.jsx(l,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",mb:2},children:e.jsx(We,{variant:"contained",icon:e.jsx(xt,{}),onClick:()=>u(!0),mobileText:r("accountManagement.create"),desktopText:r("accountManagement.createAccount"),children:r("accountManagement.createAccount")})}),i&&e.jsx(je,{severity:"error",sx:{mb:2},children:i}),s?e.jsx(l,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(Ce,{})}):e.jsx(lt,{children:t.map((oe,ee)=>e.jsxs(rt.Fragment,{children:[e.jsxs(Pe,{sx:{py:.5,px:1,pr:6,...oe.isMainAccount&&{backgroundColor:"primary.50",mb:.25}},children:[e.jsxs(l,{sx:{position:"relative",mr:1.5},children:[e.jsx(Vt,{sx:{width:36,height:36,fontSize:"0.875rem",bgcolor:oe.isMainAccount?"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)":"primary.main"},children:X(oe.name)}),oe.isMainAccount&&e.jsx(ci,{sx:{position:"absolute",top:-2,right:-2,fontSize:"0.75rem",color:"primary.main",backgroundColor:"white",borderRadius:"50%",p:.25}})]}),e.jsx(ve,{sx:{pr:2,maxWidth:"calc(100% - 60px)"},primary:e.jsxs(l,{component:"span",sx:{display:"flex",alignItems:"center",gap:.75,flexWrap:"wrap",mb:.25},children:[e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,fontSize:"0.95rem"},children:oe.name}),e.jsx(c,{variant:"body2",sx:{color:"text.secondary",fontSize:"0.8rem"},children:oe.email}),oe.isMainAccount&&e.jsx(ce,{label:r("accountManagement.main"),size:"small",color:"primary",variant:"filled",sx:{height:18,fontSize:"0.7rem",fontWeight:"bold",background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",color:"white","& .MuiChip-label":{px:.75}}}),oe.isInvestor&&e.jsx(ce,{label:r("accountManagement.investor"),size:"small",color:"secondary",sx:{height:18,fontSize:"0.7rem"}})]}),secondary:e.jsxs(l,{component:"span",sx:{mt:.25},children:[e.jsx(l,{component:"span",sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",fontSize:"0.7rem"},children:e.jsxs(l,{component:"span",sx:{display:"flex",alignItems:"center",gap:.5,color:"text.primary",fontFamily:"monospace",fontWeight:500,backgroundColor:f===oe.accountId?"success.50":"grey.100",px:.75,py:.25,borderRadius:.5,border:"1px solid",borderColor:f===oe.accountId?"success.300":"grey.300",cursor:"pointer",transition:"all 0.2s ease","&:hover":{backgroundColor:f===oe.accountId?"success.100":"grey.200",borderColor:f===oe.accountId?"success.400":"grey.400"}},onClick:()=>B(oe.accountId),title:r("accountManagement.copyIdTooltip"),children:[e.jsxs(l,{component:"span",children:["ID: ",oe.accountId]}),f===oe.accountId?e.jsx(Ou,{sx:{fontSize:"0.75rem",color:"success.main"}}):e.jsx(Os,{sx:{fontSize:"0.75rem",color:"text.secondary"}})]})}),oe.isMainAccount&&e.jsxs(l,{component:"span",sx:{fontSize:"0.7rem",color:"primary.main",fontWeight:"bold",display:"block",mt:.25,backgroundColor:"primary.50",px:.5,py:.25,borderRadius:.5,border:"1px solid",borderColor:"primary.200",width:"100%",maxWidth:"160px"},children:[" ",r("accountManagement.protectedAccount")]})]})}),e.jsx(bo,{sx:{right:8},children:e.jsx(Fe,{title:r("accountManagement.moreActions"),children:e.jsx(Ie,{edge:"end",onClick:H=>$(H,oe),sx:{zIndex:1,backgroundColor:"background.paper","&:hover":{backgroundColor:"action.hover"}},children:e.jsx(wr,{})})})})]}),ee<t.length-1&&e.jsx(bt,{})]},oe.accountId))}),t.length===0&&!s&&e.jsx(l,{sx:{textAlign:"center",py:4},children:e.jsx(c,{variant:"body1",color:"text.secondary",children:r("accountManagement.noAccounts")})})]})}),e.jsx(Zj,{open:d,onClose:()=>u(!1),onAccountCreated:z}),e.jsx(ev,{open:h,onClose:()=>{m(!1),g(null)},account:x,onAccountUpdated:E}),e.jsxs(Gn,{anchorEl:j,open:!!j,onClose:Y,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(re,{onClick:_,children:[e.jsx(tt,{children:e.jsx(Tt,{fontSize:"small"})}),e.jsx(c,{variant:"body2",children:r("common.edit")})]}),v&&!v.isMainAccount&&e.jsxs(re,{onClick:K,sx:{color:"error.main"},children:[e.jsx(tt,{children:e.jsx(pt,{fontSize:"small",color:"error"})}),e.jsx(c,{variant:"body2",children:r("common.delete")})]})]}),e.jsxs(kt,{open:w,onClose:F,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2,boxShadow:"0 8px 32px rgba(0,0,0,0.12)"}},children:[e.jsx(Et,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(l,{sx:{p:1.5,borderRadius:"50%",backgroundColor:"error.50",color:"error.main",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(on,{sx:{fontSize:28}})}),e.jsxs(l,{children:[e.jsx(c,{variant:"h6",sx:{fontWeight:600,color:"error.main"},children:r("accountManagement.deleteConfirm.title")}),e.jsx(c,{variant:"body2",color:"text.secondary",children:r("accountManagement.deleteConfirm.subtitle")})]})]})}),e.jsx(Pt,{children:k&&e.jsxs(l,{children:[e.jsx(Hx,{sx:{mb:3,color:"text.primary"},children:r("accountManagement.deleteConfirm.message",{accountName:k.name,accountEmail:k.email})}),e.jsx(se,{variant:"outlined",sx:{p:2,backgroundColor:"grey.50"},children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Vt,{sx:{bgcolor:"primary.main"},children:X(k.name)}),e.jsxs(l,{flex:1,children:[e.jsx(c,{variant:"subtitle1",sx:{fontWeight:600},children:k.name}),e.jsx(c,{variant:"body2",color:"text.secondary",children:k.email}),e.jsxs(l,{display:"flex",gap:1,mt:1,children:[k.isMainAccount&&e.jsx(ce,{label:r("accountManagement.main"),size:"small",color:"primary",variant:"filled"}),k.isInvestor&&e.jsx(ce,{label:r("accountManagement.investor"),size:"small",color:"secondary"})]})]})]})}),e.jsx(je,{severity:"warning",sx:{mt:2},children:e.jsx(c,{variant:"body2",ellipsis:!1,children:r("accountManagement.deleteConfirm.warning")})})]})}),e.jsxs(Dt,{sx:{p:3,gap:1},children:[e.jsx(he,{onClick:F,disabled:L,children:r("common.cancel")}),e.jsx(We,{onClick:V,disabled:L,variant:"contained",color:"error",icon:L?e.jsx(Ce,{size:16}):e.jsx(pt,{}),forceTextOnly:!0,mobileText:r(L?"accountManagement.deleteConfirm.deleting":"common.delete"),desktopText:r(L?"accountManagement.deleteConfirm.deleting":"common.delete"),children:r(L?"accountManagement.deleteConfirm.deleting":"common.delete")})]})]})]})};class sv{constructor(){zn(this,"baseUrl","/api/v1/portfolios")}async createPermission(t,n){return await q.post(`${this.baseUrl}/${t.portfolioId}/permissions?accountId=${n}`,{accountId:t.accountId,permissionType:t.permissionType})}async getPortfolioPermissions(t,n){return await q.get(`${this.baseUrl}/${t}/permissions?accountId=${n}`)}async getMyAccessiblePortfolios(){return await q.get(`${this.baseUrl}`)}async deletePermission(t,n,s){await q.delete(`${this.baseUrl}/${n}/permissions/${t}?accountId=${s}`)}async checkPermission(t,n){return await q.get(`${this.baseUrl}/${t}/permissions/check`,{params:{action:n}})}async getPortfolioPermissionStats(t,n){return await q.get(`${this.baseUrl}/${t}/permissions/stats?accountId=${n}`)}async transferOwnership(t,n){await q.post(`${this.baseUrl}/${t}/permissions/transfer-ownership`,n)}async getAvailableAccounts(t,n){return await q.get(`${this.baseUrl}/permissions/available-accounts?accountId=${t}`,{params:{search:n}})}}const Qi=new sv,Un=r=>{const t=Kt(),{loading:n,accountId:s}=Ge(),a=s||r;p.useEffect(()=>{a&&(t.invalidateQueries(["portfolios",a]),t.invalidateQueries(["trades",a]),t.invalidateQueries(["portfolio-analytics",a]))},[a,t]);const{data:i,isLoading:o,error:d,refetch:u}=yt(["portfolios",a],()=>a?q.getPortfolios(a):Promise.resolve([]),{enabled:!!a&&!n,staleTime:5*60*1e3,cacheTime:10*60*1e3}),h=jt(g=>q.createPortfolio(g,a),{onSuccess:()=>{t.invalidateQueries(["portfolios",a]),u()}}),m=jt(({id:g,data:f})=>q.updatePortfolio(g,a,f),{onSuccess:()=>{t.invalidateQueries(["portfolios",a]),u()}}),x=jt(g=>q.deletePortfolio(g,a),{onSuccess:()=>{t.invalidateQueries(["portfolios",a]),u()}});return{portfolios:i||[],isLoading:o,error:d,refetch:u,createPortfolio:h.mutate,updatePortfolio:m.mutate,deletePortfolio:x.mutate,isCreating:h.isLoading,isUpdating:m.isLoading,isDeleting:x.isLoading}},av=(r,t=!1)=>{const{accountId:n}=Ge();return yt(["portfolio-permission-stats",r,n],()=>n?Qi.getPortfolioPermissionStats(r,n):Promise.resolve(null),{enabled:!!r&&!!n&&t,staleTime:2*60*1e3,cacheTime:5*60*1e3})},zo=r=>{const t=Kt(),{accountId:n,loading:s}=Ge();p.useEffect(()=>{n&&t.invalidateQueries(["portfolio",r])},[n,t,r]);const{data:a,isLoading:i,error:o,refetch:d}=yt(["portfolio",r,n],()=>q.getPortfolio(r,n),{enabled:!!r&&!!n&&!s,staleTime:2*60*1e3,cacheTime:5*60*1e3}),u=jt(h=>q.updatePortfolio(r,n,h),{onSuccess:()=>{t.invalidateQueries(["portfolio",r]),t.invalidateQueries("portfolios")}});return{portfolio:a,isLoading:i,error:o,refetch:d,updatePortfolio:u.mutate,isUpdating:u.isLoading}},Mc=r=>{const{accountId:t,loading:n}=Ge(),s=Kt();p.useEffect(()=>{t&&(s.invalidateQueries(["portfolio-performance",r]),s.invalidateQueries(["portfolio-allocation",r]),s.invalidateQueries(["portfolio-positions",r]))},[t,s,r]);const{data:a,isLoading:i,error:o}=yt(["portfolio-performance",r,t],()=>q.getPortfolioPerformance(r),{enabled:!!r&&!!t&&!n,staleTime:5*60*1e3}),{data:d,isLoading:u,error:h}=yt(["portfolio-allocation",r,t],()=>q.getPortfolioAllocation(r),{enabled:!!r&&!!t&&!n,staleTime:30*1e3,refetchInterval:!1}),{data:m,isLoading:x,error:g}=yt(["portfolio-positions",r,t],()=>q.getPortfolioPositions(r),{enabled:!!r&&!!t&&!n,staleTime:2*60*1e3});return rt.useEffect(()=>{},[r,a,d,m,i,u,x,o,h,g]),{performanceData:a,allocationData:d,positionsData:m,isLoading:i||u||x,error:o||h||g,refetch:()=>{s.invalidateQueries(["portfolio-performance",r]),s.invalidateQueries(["portfolio-allocation",r]),s.invalidateQueries(["portfolio-positions",r])}}},iv=r=>{const{data:t,isLoading:n,error:s}=yt(["portfolio-asset-performance",r],()=>q.getPortfolioAssetPerformance(r),{enabled:!!r,staleTime:3e4});return{performanceData:t||null,isLoading:n,error:s}},ov=r=>{switch(r){case"trade":return e.jsx(He,{});case"portfolio":return e.jsx(Ue,{});case"system":return e.jsx(Gr,{});case"market":return e.jsx(ar,{});default:return e.jsx(Gr,{})}},lv=r=>{switch(r){case"trade":return"success";case"portfolio":return"info";case"system":return"warning";case"market":return"primary";default:return"info"}},cv=r=>{switch(r){case"trade":return"success";case"portfolio":return"info";case"system":return"warning";case"market":return"info";default:return"info"}},dv=({notification:r,open:t,onClose:n,onAction:s})=>{const[a,i]=p.useState(null),[o,d]=p.useState(!1),u=80,h=r.message.length>u,m=h?r.message.substring(0,u)+"...":r.message;p.useEffect(()=>{if(t){const y=setTimeout(()=>{n()},5e3);i(y)}else a&&(clearTimeout(a),i(null));return()=>{a&&clearTimeout(a)}},[t,n]);const x=()=>{a&&clearTimeout(a),n()},g=()=>{s&&s(),x()},f=()=>{d(!o)};return e.jsx(di,{open:t,autoHideDuration:5e3,onClose:x,anchorOrigin:{vertical:"top",horizontal:"right"},sx:{mt:6,"& .MuiSnackbar-root":{transition:"all 0.2s ease-in-out"}},TransitionProps:{timeout:200},children:e.jsxs(je,{severity:cv(r.type),sx:{minWidth:300,maxWidth:400,"& .MuiAlert-message":{width:"100%",fontSize:"0.875rem"},"& .MuiAlertTitle-root":{fontSize:"0.9rem",fontWeight:600,mb:.5}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:.5},children:[e.jsx(ui,{sx:{mb:0,flex:1},children:r.title}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{icon:ov(r.type),label:r.type.toUpperCase(),size:"small",color:lv(r.type),variant:"outlined",sx:{fontSize:"0.7rem",height:"20px"}}),e.jsx(Ie,{size:"small",onClick:x,sx:{p:.5},children:e.jsx(sr,{fontSize:"small"})})]})]}),e.jsxs(l,{sx:{mt:.5},children:[e.jsx(D,{variant:"body2",sx:{fontSize:"0.8rem",lineHeight:1.3,color:"text.secondary"},children:o?r.message:m}),h&&e.jsx(ut,{size:"small",onClick:f,startIcon:o?e.jsx(Dn,{sx:{fontSize:"0.75rem"}}):e.jsx(ln,{sx:{fontSize:"0.75rem"}}),sx:{mt:.5,p:.25,minWidth:"auto",fontSize:"0.75rem!important",textTransform:"none",height:"20px"},children:o?"Less":"More"})]}),r.actionUrl&&e.jsx(l,{sx:{mt:.5},children:e.jsx(D,{variant:"caption",color:"primary",sx:{cursor:"pointer",textDecoration:"underline",fontSize:"0.7rem!important",fontWeight:500},onClick:g,children:" View"})})]})})},Qr=Object.create(null);Qr.open="0";Qr.close="1";Qr.ping="2";Qr.pong="3";Qr.message="4";Qr.upgrade="5";Qr.noop="6";const Xi=Object.create(null);Object.keys(Qr).forEach(r=>{Xi[Qr[r]]=r});const Zl={type:"error",data:"parser error"},am=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",im=typeof ArrayBuffer=="function",om=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,Nc=({type:r,data:t},n,s)=>am&&t instanceof Blob?n?s(t):tu(t,s):im&&(t instanceof ArrayBuffer||om(t))?n?s(t):tu(new Blob([t]),s):s(Qr[r]+(t||"")),tu=(r,t)=>{const n=new FileReader;return n.onload=function(){const s=n.result.split(",")[1];t("b"+(s||""))},n.readAsDataURL(r)};function nu(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}let fl;function uv(r,t){if(am&&r.data instanceof Blob)return r.data.arrayBuffer().then(nu).then(t);if(im&&(r.data instanceof ArrayBuffer||om(r.data)))return t(nu(r.data));Nc(r,!1,n=>{fl||(fl=new TextEncoder),t(fl.encode(n))})}const ru="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_a=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<ru.length;r++)_a[ru.charCodeAt(r)]=r;const hv=r=>{let t=r.length*.75,n=r.length,s,a=0,i,o,d,u;r[r.length-1]==="="&&(t--,r[r.length-2]==="="&&t--);const h=new ArrayBuffer(t),m=new Uint8Array(h);for(s=0;s<n;s+=4)i=_a[r.charCodeAt(s)],o=_a[r.charCodeAt(s+1)],d=_a[r.charCodeAt(s+2)],u=_a[r.charCodeAt(s+3)],m[a++]=i<<2|o>>4,m[a++]=(o&15)<<4|d>>2,m[a++]=(d&3)<<6|u&63;return h},mv=typeof ArrayBuffer=="function",Lc=(r,t)=>{if(typeof r!="string")return{type:"message",data:lm(r,t)};const n=r.charAt(0);return n==="b"?{type:"message",data:xv(r.substring(1),t)}:Xi[n]?r.length>1?{type:Xi[n],data:r.substring(1)}:{type:Xi[n]}:Zl},xv=(r,t)=>{if(mv){const n=hv(r);return lm(n,t)}else return{base64:!0,data:r}},lm=(r,t)=>{switch(t){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}},cm="",pv=(r,t)=>{const n=r.length,s=new Array(n);let a=0;r.forEach((i,o)=>{Nc(i,!1,d=>{s[o]=d,++a===n&&t(s.join(cm))})})},gv=(r,t)=>{const n=r.split(cm),s=[];for(let a=0;a<n.length;a++){const i=Lc(n[a],t);if(s.push(i),i.type==="error")break}return s};function fv(){return new TransformStream({transform(r,t){uv(r,n=>{const s=n.length;let a;if(s<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,s);else if(s<65536){a=new Uint8Array(3);const i=new DataView(a.buffer);i.setUint8(0,126),i.setUint16(1,s)}else{a=new Uint8Array(9);const i=new DataView(a.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(s))}r.data&&typeof r.data!="string"&&(a[0]|=128),t.enqueue(a),t.enqueue(n)})}})}let yl;function Di(r){return r.reduce((t,n)=>t+n.length,0)}function Ai(r,t){if(r[0].length===t)return r.shift();const n=new Uint8Array(t);let s=0;for(let a=0;a<t;a++)n[a]=r[0][s++],s===r[0].length&&(r.shift(),s=0);return r.length&&s<r[0].length&&(r[0]=r[0].slice(s)),n}function yv(r,t){yl||(yl=new TextDecoder);const n=[];let s=0,a=-1,i=!1;return new TransformStream({transform(o,d){for(n.push(o);;){if(s===0){if(Di(n)<1)break;const u=Ai(n,1);i=(u[0]&128)===128,a=u[0]&127,a<126?s=3:a===126?s=1:s=2}else if(s===1){if(Di(n)<2)break;const u=Ai(n,2);a=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),s=3}else if(s===2){if(Di(n)<8)break;const u=Ai(n,8),h=new DataView(u.buffer,u.byteOffset,u.length),m=h.getUint32(0);if(m>Math.pow(2,21)-1){d.enqueue(Zl);break}a=m*Math.pow(2,32)+h.getUint32(4),s=3}else{if(Di(n)<a)break;const u=Ai(n,a);d.enqueue(Lc(i?u:yl.decode(u),t)),s=0}if(a===0||a>r){d.enqueue(Zl);break}}}})}const dm=4;function kn(r){if(r)return bv(r)}function bv(r){for(var t in kn.prototype)r[t]=kn.prototype[t];return r}kn.prototype.on=kn.prototype.addEventListener=function(r,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(t),this};kn.prototype.once=function(r,t){function n(){this.off(r,n),t.apply(this,arguments)}return n.fn=t,this.on(r,n),this};kn.prototype.off=kn.prototype.removeListener=kn.prototype.removeAllListeners=kn.prototype.removeEventListener=function(r,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+r];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var s,a=0;a<n.length;a++)if(s=n[a],s===t||s.fn===t){n.splice(a,1);break}return n.length===0&&delete this._callbacks["$"+r],this};kn.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+r],s=1;s<arguments.length;s++)t[s-1]=arguments[s];if(n){n=n.slice(0);for(var s=0,a=n.length;s<a;++s)n[s].apply(this,t)}return this};kn.prototype.emitReserved=kn.prototype.emit;kn.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};kn.prototype.hasListeners=function(r){return!!this.listeners(r).length};const Oo=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,n)=>n(t,0),fr=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),jv="arraybuffer";function um(r,...t){return t.reduce((n,s)=>(r.hasOwnProperty(s)&&(n[s]=r[s]),n),{})}const vv=fr.setTimeout,wv=fr.clearTimeout;function Vo(r,t){t.useNativeTimers?(r.setTimeoutFn=vv.bind(fr),r.clearTimeoutFn=wv.bind(fr)):(r.setTimeoutFn=fr.setTimeout.bind(fr),r.clearTimeoutFn=fr.clearTimeout.bind(fr))}const Sv=1.33;function Tv(r){return typeof r=="string"?Cv(r):Math.ceil((r.byteLength||r.size)*Sv)}function Cv(r){let t=0,n=0;for(let s=0,a=r.length;s<a;s++)t=r.charCodeAt(s),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(s++,n+=4);return n}function hm(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function kv(r){let t="";for(let n in r)r.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(r[n]));return t}function Pv(r){let t={},n=r.split("&");for(let s=0,a=n.length;s<a;s++){let i=n[s].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class Dv extends Error{constructor(t,n,s){super(t),this.description=n,this.context=s,this.type="TransportError"}}class Ec extends kn{constructor(t){super(),this.writable=!1,Vo(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,s){return super.emitReserved("error",new Dv(t,n,s)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const n=Lc(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const n=kv(t);return n.length?"?"+n:""}}class Av extends Ec{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const n=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let s=0;this._polling&&(s++,this.once("pollComplete",function(){--s||n()})),this.writable||(s++,this.once("drain",function(){--s||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const n=s=>{if(this.readyState==="opening"&&s.type==="open"&&this.onOpen(),s.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(s)};gv(t,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,pv(t,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=hm()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(t,n)}}let mm=!1;try{mm=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Iv=mm;function Rv(){}class Mv extends Av{constructor(t){if(super(t),typeof location<"u"){const n=location.protocol==="https:";let s=location.port;s||(s=n?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||s!==t.port}}doWrite(t,n){const s=this.request({method:"POST",data:t});s.on("success",n),s.on("error",(a,i)=>{this.onError("xhr post error",a,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(n,s)=>{this.onError("xhr poll error",n,s)}),this.pollXhr=t}}let ua=class Ji extends kn{constructor(t,n,s){super(),this.createRequest=t,Vo(this,s),this._opts=s,this._method=s.method||"GET",this._uri=n,this._data=s.data!==void 0?s.data:null,this._create()}_create(){var t;const n=um(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const s=this._xhr=this.createRequest(n);try{s.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){s.setDisableHeaderCheck&&s.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&s.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{s.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{s.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(s),"withCredentials"in s&&(s.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(s.timeout=this._opts.requestTimeout),s.onreadystatechange=()=>{var a;s.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(s.getResponseHeader("set-cookie"))),s.readyState===4&&(s.status===200||s.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof s.status=="number"?s.status:0)},0))},s.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=Ji.requestsCount++,Ji.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Rv,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ji.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};ua.requestsCount=0;ua.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",su);else if(typeof addEventListener=="function"){const r="onpagehide"in fr?"pagehide":"unload";addEventListener(r,su,!1)}}function su(){for(let r in ua.requests)ua.requests.hasOwnProperty(r)&&ua.requests[r].abort()}const Nv=function(){const r=xm({xdomain:!1});return r&&r.responseType!==null}();class Lv extends Mv{constructor(t){super(t);const n=t&&t.forceBase64;this.supportsBinary=Nv&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new ua(xm,this.uri(),t)}}function xm(r){const t=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Iv))return new XMLHttpRequest}catch{}if(!t)try{return new fr[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const pm=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Ev extends Ec{get name(){return"websocket"}doOpen(){const t=this.uri(),n=this.opts.protocols,s=pm?{}:um(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(s.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,s)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const s=t[n],a=n===t.length-1;Nc(s,this.supportsBinary,i=>{try{this.doWrite(s,i)}catch{}a&&Oo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=hm()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}}const bl=fr.WebSocket||fr.MozWebSocket;class Wv extends Ev{createSocket(t,n,s){return pm?new bl(t,n,s):n?new bl(t,n):new bl(t)}doWrite(t,n){this.ws.send(n)}}class Fv extends Ec{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const n=yv(Number.MAX_SAFE_INTEGER,this.socket.binaryType),s=t.readable.pipeThrough(n).getReader(),a=fv();a.readable.pipeTo(t.writable),this._writer=a.writable.getWriter();const i=()=>{s.read().then(({done:d,value:u})=>{d||(this.onPacket(u),i())}).catch(d=>{})};i();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this._writer.write(o).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){const s=t[n],a=n===t.length-1;this._writer.write(s).then(()=>{a&&Oo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const zv={websocket:Wv,webtransport:Fv,polling:Lv},Ov=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Vv=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ec(r){if(r.length>8e3)throw"URI too long";const t=r,n=r.indexOf("["),s=r.indexOf("]");n!=-1&&s!=-1&&(r=r.substring(0,n)+r.substring(n,s).replace(/:/g,";")+r.substring(s,r.length));let a=Ov.exec(r||""),i={},o=14;for(;o--;)i[Vv[o]]=a[o]||"";return n!=-1&&s!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=$v(i,i.path),i.queryKey=Hv(i,i.query),i}function $v(r,t){const n=/\/{2,9}/g,s=t.replace(n,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&s.splice(0,1),t.slice(-1)=="/"&&s.splice(s.length-1,1),s}function Hv(r,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(s,a,i){a&&(n[a]=i)}),n}const tc=typeof addEventListener=="function"&&typeof removeEventListener=="function",Zi=[];tc&&addEventListener("offline",()=>{Zi.forEach(r=>r())},!1);class Ts extends kn{constructor(t,n){if(super(),this.binaryType=jv,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(n=t,t=null),t){const s=ec(t);n.hostname=s.host,n.secure=s.protocol==="https"||s.protocol==="wss",n.port=s.port,s.query&&(n.query=s.query)}else n.host&&(n.hostname=ec(n.host).host);Vo(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(s=>{const a=s.prototype.name;this.transports.push(a),this._transportsByName[a]=s}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Pv(this.opts.query)),tc&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Zi.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const n=Object.assign({},this.opts.query);n.EIO=dm,n.transport=t,this.id&&(n.sid=this.id);const s=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](s)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&Ts.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",Ts.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let s=0;s<this.writeBuffer.length;s++){const a=this.writeBuffer[s].data;if(a&&(n+=Tv(a)),s>0&&n>this._maxPayload)return this.writeBuffer.slice(0,s);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Oo(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,s){return this._sendPacket("message",t,n,s),this}send(t,n,s){return this._sendPacket("message",t,n,s),this}_sendPacket(t,n,s,a){if(typeof n=="function"&&(a=n,n=void 0),typeof s=="function"&&(a=s,s=null),this.readyState==="closing"||this.readyState==="closed")return;s=s||{},s.compress=s.compress!==!1;const i={type:t,data:n,options:s};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),a&&this.once("flush",a),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},s=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?s():t()}):this.upgrading?s():t()),this}_onError(t){if(Ts.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),tc&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const s=Zi.indexOf(this._offlineEventListener);s!==-1&&Zi.splice(s,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}}Ts.protocol=dm;class Bv extends Ts{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),s=!1;Ts.priorWebsocketSuccess=!1;const a=()=>{s||(n.send([{type:"ping",data:"probe"}]),n.once("packet",x=>{if(!s)if(x.type==="pong"&&x.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;Ts.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{s||this.readyState!=="closed"&&(m(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const g=new Error("probe error");g.transport=n.name,this.emitReserved("upgradeError",g)}}))};function i(){s||(s=!0,m(),n.close(),n=null)}const o=x=>{const g=new Error("probe error: "+x);g.transport=n.name,i(),this.emitReserved("upgradeError",g)};function d(){o("transport closed")}function u(){o("socket closed")}function h(x){n&&x.name!==n.name&&i()}const m=()=>{n.removeListener("open",a),n.removeListener("error",o),n.removeListener("close",d),this.off("close",u),this.off("upgrading",h)};n.once("open",a),n.once("error",o),n.once("close",d),this.once("close",u),this.once("upgrading",h),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{s||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const n=[];for(let s=0;s<t.length;s++)~this.transports.indexOf(t[s])&&n.push(t[s]);return n}}let Uv=class extends Bv{constructor(t,n={}){const s=typeof t=="object"?t:n;(!s.transports||s.transports&&typeof s.transports[0]=="string")&&(s.transports=(s.transports||["polling","websocket","webtransport"]).map(a=>zv[a]).filter(a=>!!a)),super(t,s)}};function _v(r,t="",n){let s=r;n=n||typeof location<"u"&&location,r==null&&(r=n.protocol+"//"+n.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=n.protocol+r:r=n.host+r),/^(https?|wss?):\/\//.test(r)||(typeof n<"u"?r=n.protocol+"//"+r:r="https://"+r),s=ec(r)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const i=s.host.indexOf(":")!==-1?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+i+":"+s.port+t,s.href=s.protocol+"://"+i+(n&&n.port===s.port?"":":"+s.port),s}const Yv=typeof ArrayBuffer=="function",qv=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,gm=Object.prototype.toString,Gv=typeof Blob=="function"||typeof Blob<"u"&&gm.call(Blob)==="[object BlobConstructor]",Kv=typeof File=="function"||typeof File<"u"&&gm.call(File)==="[object FileConstructor]";function Wc(r){return Yv&&(r instanceof ArrayBuffer||qv(r))||Gv&&r instanceof Blob||Kv&&r instanceof File}function eo(r,t){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let n=0,s=r.length;n<s;n++)if(eo(r[n]))return!0;return!1}if(Wc(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return eo(r.toJSON(),!0);for(const n in r)if(Object.prototype.hasOwnProperty.call(r,n)&&eo(r[n]))return!0;return!1}function Qv(r){const t=[],n=r.data,s=r;return s.data=nc(n,t),s.attachments=t.length,{packet:s,buffers:t}}function nc(r,t){if(!r)return r;if(Wc(r)){const n={_placeholder:!0,num:t.length};return t.push(r),n}else if(Array.isArray(r)){const n=new Array(r.length);for(let s=0;s<r.length;s++)n[s]=nc(r[s],t);return n}else if(typeof r=="object"&&!(r instanceof Date)){const n={};for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=nc(r[s],t));return n}return r}function Xv(r,t){return r.data=rc(r.data,t),delete r.attachments,r}function rc(r,t){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<t.length)return t[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let n=0;n<r.length;n++)r[n]=rc(r[n],t);else if(typeof r=="object")for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&(r[n]=rc(r[n],t));return r}const Jv=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Zv=5;var Ct;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(Ct||(Ct={}));class e1{constructor(t){this.replacer=t}encode(t){return(t.type===Ct.EVENT||t.type===Ct.ACK)&&eo(t)?this.encodeAsBinary({type:t.type===Ct.EVENT?Ct.BINARY_EVENT:Ct.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===Ct.BINARY_EVENT||t.type===Ct.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(n+=t.nsp+","),t.id!=null&&(n+=t.id),t.data!=null&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){const n=Qv(t),s=this.encodeAsString(n.packet),a=n.buffers;return a.unshift(s),a}}function au(r){return Object.prototype.toString.call(r)==="[object Object]"}class Fc extends kn{constructor(t){super(),this.reviver=t}add(t){let n;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);const s=n.type===Ct.BINARY_EVENT;s||n.type===Ct.BINARY_ACK?(n.type=s?Ct.EVENT:Ct.ACK,this.reconstructor=new t1(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(Wc(t)||t.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(t),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let n=0;const s={type:Number(t.charAt(0))};if(Ct[s.type]===void 0)throw new Error("unknown packet type "+s.type);if(s.type===Ct.BINARY_EVENT||s.type===Ct.BINARY_ACK){const i=n+1;for(;t.charAt(++n)!=="-"&&n!=t.length;);const o=t.substring(i,n);if(o!=Number(o)||t.charAt(n)!=="-")throw new Error("Illegal attachments");s.attachments=Number(o)}if(t.charAt(n+1)==="/"){const i=n+1;for(;++n&&!(t.charAt(n)===","||n===t.length););s.nsp=t.substring(i,n)}else s.nsp="/";const a=t.charAt(n+1);if(a!==""&&Number(a)==a){const i=n+1;for(;++n;){const o=t.charAt(n);if(o==null||Number(o)!=o){--n;break}if(n===t.length)break}s.id=Number(t.substring(i,n+1))}if(t.charAt(++n)){const i=this.tryParse(t.substr(n));if(Fc.isPayloadValid(s.type,i))s.data=i;else throw new Error("invalid payload")}return s}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,n){switch(t){case Ct.CONNECT:return au(n);case Ct.DISCONNECT:return n===void 0;case Ct.CONNECT_ERROR:return typeof n=="string"||au(n);case Ct.EVENT:case Ct.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&Jv.indexOf(n[0])===-1);case Ct.ACK:case Ct.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class t1{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const n=Xv(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const n1=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Fc,Encoder:e1,get PacketType(){return Ct},protocol:Zv},Symbol.toStringTag,{value:"Module"}));function Cr(r,t,n){return r.on(t,n),function(){r.off(t,n)}}const r1=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class fm extends kn{constructor(t,n,s){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,s&&s.auth&&(this.auth=s.auth),this._opts=Object.assign({},s),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Cr(t,"open",this.onopen.bind(this)),Cr(t,"packet",this.onpacket.bind(this)),Cr(t,"error",this.onerror.bind(this)),Cr(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var s,a,i;if(r1.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const o={type:Ct.EVENT,data:n};if(o.options={},o.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const m=this.ids++,x=n.pop();this._registerAckCallback(m,x),o.id=m}const d=(a=(s=this.io.engine)===null||s===void 0?void 0:s.transport)===null||a===void 0?void 0:a.writable,u=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!d||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,n){var s;const a=(s=this.flags.timeout)!==null&&s!==void 0?s:this._opts.ackTimeout;if(a===void 0){this.acks[t]=n;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let d=0;d<this.sendBuffer.length;d++)this.sendBuffer[d].id===t&&this.sendBuffer.splice(d,1);n.call(this,new Error("operation has timed out"))},a),o=(...d)=>{this.io.clearTimeoutFn(i),n.apply(this,d)};o.withError=!0,this.acks[t]=o}emitWithAck(t,...n){return new Promise((s,a)=>{const i=(o,d)=>o?a(o):s(d);i.withError=!0,n.push(i),this.emit(t,...n)})}_addToQueue(t){let n;typeof t[t.length-1]=="function"&&(n=t.pop());const s={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((a,...i)=>s!==this._queue[0]?void 0:(a!==null?s.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(a)):(this._queue.shift(),n&&n(null,...i)),s.pending=!1,this._drainQueue())),this._queue.push(s),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!t||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:Ct.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(s=>String(s.id)===t)){const s=this.acks[t];delete this.acks[t],s.withError&&s.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case Ct.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Ct.EVENT:case Ct.BINARY_EVENT:this.onevent(t);break;case Ct.ACK:case Ct.BINARY_ACK:this.onack(t);break;case Ct.DISCONNECT:this.ondisconnect();break;case Ct.CONNECT_ERROR:this.destroy();const s=new Error(t.data.message);s.data=t.data.data,this.emitReserved("connect_error",s);break}}onevent(t){const n=t.data||[];t.id!=null&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const s of n)s.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const n=this;let s=!1;return function(...a){s||(s=!0,n.packet({type:Ct.ACK,id:t,data:a}))}}onack(t){const n=this.acks[t.id];typeof n=="function"&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Ct.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const n=this._anyListeners;for(let s=0;s<n.length;s++)if(t===n[s])return n.splice(s,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const n=this._anyOutgoingListeners;for(let s=0;s<n.length;s++)if(t===n[s])return n.splice(s,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const s of n)s.apply(this,t.data)}}}function Ia(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}Ia.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*r);r=Math.floor(t*10)&1?r+n:r-n}return Math.min(r,this.max)|0};Ia.prototype.reset=function(){this.attempts=0};Ia.prototype.setMin=function(r){this.ms=r};Ia.prototype.setMax=function(r){this.max=r};Ia.prototype.setJitter=function(r){this.jitter=r};class sc extends kn{constructor(t,n){var s;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(n=t,t=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,Vo(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((s=n.randomizationFactor)!==null&&s!==void 0?s:.5),this.backoff=new Ia({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=t;const a=n.parser||n1;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(n=this.backoff)===null||n===void 0||n.setMin(t),this)}randomizationFactor(t){var n;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(n=this.backoff)===null||n===void 0||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(n=this.backoff)===null||n===void 0||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Uv(this.uri,this.opts);const n=this.engine,s=this;this._readyState="opening",this.skipReconnect=!1;const a=Cr(n,"open",function(){s.onopen(),t&&t()}),i=d=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",d),t?t(d):this.maybeReconnectOnOpen()},o=Cr(n,"error",i);if(this._timeout!==!1){const d=this._timeout,u=this.setTimeoutFn(()=>{a(),i(new Error("timeout")),n.close()},d);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(a),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Cr(t,"ping",this.onping.bind(this)),Cr(t,"data",this.ondata.bind(this)),Cr(t,"error",this.onerror.bind(this)),Cr(t,"close",this.onclose.bind(this)),Cr(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(n){this.onclose("parse error",n)}}ondecoded(t){Oo(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let s=this.nsps[t];return s?this._autoConnect&&!s.active&&s.connect():(s=new fm(this,t,n),this.nsps[t]=s),s}_destroy(t){const n=Object.keys(this.nsps);for(const s of n)if(this.nsps[s].active)return;this._close()}_packet(t){const n=this.encoder.encode(t);for(let s=0;s<n.length;s++)this.engine.write(n[s],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var s;this.cleanup(),(s=this.engine)===null||s===void 0||s.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const s=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(a=>{a?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",a)):t.onreconnect()}))},n);this.opts.autoUnref&&s.unref(),this.subs.push(()=>{this.clearTimeoutFn(s)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const za={};function to(r,t){typeof r=="object"&&(t=r,r=void 0),t=t||{};const n=_v(r,t.path||"/socket.io"),s=n.source,a=n.id,i=n.path,o=za[a]&&i in za[a].nsps,d=t.forceNew||t["force new connection"]||t.multiplex===!1||o;let u;return d?u=new sc(s,t):(za[a]||(za[a]=new sc(s,t)),u=za[a]),n.query&&!t.query&&(t.query=n.queryKey),u.socket(n.path,t)}Object.assign(to,{Manager:sc,Socket:fm,io:to,connect:to});const ym=p.createContext(void 0),s1=({children:r})=>{const[t,n]=p.useState([]),[s,a]=p.useState(0),[i,o]=p.useState(null),[d,u]=p.useState(!1),[h,m]=p.useState(null),[x,g]=p.useState(!1),f=k=>{i&&i.disconnect(),m(k);const A=q.api.defaults.baseURL||"http://localhost:3000",L=to(`${A}/notifications`,{transports:["websocket"]});L.on("connect",()=>{u(!0),L.emit("join-user-room",{userId:k})}),L.on("disconnect",()=>{u(!1)}),L.on("notification",T=>{j(T)}),o(L)},y=()=>{i&&(i.disconnect(),o(null),u(!1))},j=k=>{n(A=>[k,...A]),k.isRead||a(A=>A+1)},b=async k=>{try{const A=k||h;if(!A){console.warn("No user ID available for fetching notifications");return}const L=await q.get(`/api/v1/notifications/user/${A}?limit=50&offset=0`);n(L.notifications||[]),a(L.unreadCount||0)}catch(A){console.error("Error fetching notifications:",A)}},v=async(k,A)=>{try{const L=A||h;if(!L){console.warn("No user ID available for marking notification as read");return}await q.put(`/api/v1/notifications/${k}/read?userId=${L}`),n(T=>T.map(M=>M.id===k?{...M,isRead:!0}:M)),a(T=>Math.max(0,T-1))}catch(L){console.error("Error marking notification as read:",L)}},P=async k=>{try{const A=k||h;if(!A){console.warn("No user ID available for marking all notifications as read");return}await q.put(`/api/v1/notifications/user/${A}/read-all`),n(L=>L.map(T=>({...T,isRead:!0}))),a(0)}catch(A){console.error("Error marking all notifications as read:",A)}},w=async(k,A)=>{try{const L=A||h;if(!L){console.warn("No user ID available for deleting notification");return}await q.delete(`/api/v1/notifications/${k}?userId=${L}`),n(T=>{const M=T.find(I=>I.id===k),O=T.filter(I=>I.id!==k);return M&&!M.isRead&&a(I=>Math.max(0,I-1)),O})}catch(L){console.error("Error deleting notification:",L)}};p.useEffect(()=>()=>{i&&i.disconnect()},[i]);const C={notifications:t,unreadCount:s,socket:i,isConnected:d,currentUserId:h,isFullscreenOpen:x,addNotification:j,markAsRead:v,markAllAsRead:P,deleteNotification:w,fetchNotifications:b,connectSocket:f,disconnectSocket:y,setFullscreenOpen:g};return e.jsx(ym.Provider,{value:C,children:r})},zc=()=>{const r=p.useContext(ym);if(r===void 0)throw new Error("useNotifications must be used within a NotificationProvider");return r},iu=r=>{switch(r){case"trade":return e.jsx(He,{fontSize:"small"});case"portfolio":return e.jsx(Ue,{fontSize:"small"});case"system":return e.jsx(Gr,{fontSize:"small"});case"market":return e.jsx(ar,{fontSize:"small"});default:return e.jsx(Gr,{fontSize:"small"})}},Ii=r=>{switch(r){case"trade":return"success";case"portfolio":return"info";case"system":return"warning";case"market":return"primary";default:return"default"}},ou=r=>{const t=new Date(r),s=Math.floor((new Date().getTime()-t.getTime())/(1e3*60));return s<1?"Just now":s<60?`${s}m ago`:s<1440?`${Math.floor(s/60)}h ago`:t.toLocaleDateString()},a1=()=>{const{notifications:r,unreadCount:t,markAsRead:n,markAllAsRead:s,deleteNotification:a,isFullscreenOpen:i,setFullscreenOpen:o}=zc(),[d,u]=p.useState(null),[h,m]=p.useState(null),x=!!d,g=A=>{u(A.currentTarget)},f=()=>{u(null),m(null)},y=()=>{o(!0),u(null)},j=()=>{o(!1),m(null)},b=async A=>{A.isRead||await n(A.id)},v=async A=>{await a(A.id)},P=async()=>{await s()},w=A=>{A.actionUrl&&(window.location.href=A.actionUrl)},C=async A=>{if(h===A)m(null);else{m(A);const L=r.find(T=>T.id===A);L&&!L.isRead&&await n(A)}},k=r.slice(0,10);return e.jsxs(e.Fragment,{children:[e.jsx(Ie,{color:"inherit",onClick:g,sx:{mr:{xs:0,sm:1},ml:{xs:.5,sm:0}},children:e.jsx(Bx,{badgeContent:t,color:"error",children:e.jsx(Vi,{})})}),e.jsx(Ux,{open:x,anchorEl:d,onClose:f,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:400,maxHeight:500,mt:1,maxWidth:"90vw"}},children:e.jsxs(Te,{sx:{p:1.5},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1.5,children:[e.jsx(D,{variant:"h6",sx:{fontSize:"1.1rem",fontWeight:600},children:"Notifications"}),e.jsxs(l,{children:[e.jsx(Ie,{size:"small",onClick:y,title:"View all notifications",sx:{mr:1},children:e.jsx(_x,{})}),t>0&&e.jsx(ut,{size:"small",startIcon:e.jsx(Ti,{}),onClick:P,sx:{mr:1},children:"Mark all read"}),e.jsx(Ie,{size:"small",onClick:f,children:e.jsx(sr,{})})]})]}),e.jsx(bt,{sx:{mb:1.5}}),k.length===0?e.jsxs(l,{textAlign:"center",py:3,children:[e.jsx(Vi,{sx:{fontSize:36,color:"text.secondary",mb:1.5}}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"No notifications yet"})]}):e.jsx(lt,{sx:{maxHeight:350,overflow:"auto",py:0},children:k.map(A=>e.jsxs(rt.Fragment,{children:[e.jsx(Pe,{sx:{bgcolor:A.isRead?"transparent":"action.hover",borderRadius:1,mb:.5,flexDirection:"column",alignItems:"stretch",py:.75,px:1,cursor:"default","&:hover":{bgcolor:"action.selected",transform:"translateY(-1px)",boxShadow:1},transition:"all 0.2s ease-in-out"},children:e.jsxs(l,{display:"flex",alignItems:"flex-start",gap:.75,mb:.75,children:[e.jsx(l,{sx:{color:`${Ii(A.type)}.main`,mt:.25},children:iu(A.type)}),e.jsxs(l,{flex:1,minWidth:0,children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:.75,mb:.25,children:[e.jsx(D,{variant:"subtitle2",sx:{fontWeight:A.isRead?"normal":"bold",flex:1,minWidth:0,fontSize:"0.875rem"},children:A.title}),e.jsx(ce,{label:A.type.toUpperCase(),size:"small",color:Ii(A.type),variant:"outlined",sx:{fontSize:"0.7rem",height:20}})]}),e.jsxs(l,{children:[h===A.id?e.jsxs(l,{children:[e.jsx(D,{variant:"body2",color:"text.primary",sx:{wordBreak:"break-word",lineHeight:1.4,fontSize:"0.75rem",mb:1},children:A.message}),A.actionUrl&&e.jsxs(l,{sx:{p:1,bgcolor:"action.hover",borderRadius:1,border:"1px solid",borderColor:"divider"},children:[e.jsx(D,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:.5},children:"Quick Action:"}),e.jsxs(Al,{href:A.actionUrl,onClick:L=>{L.preventDefault(),w(A)},sx:{fontSize:"0.8rem",fontWeight:500,textDecoration:"none",color:"primary.main","&:hover":{textDecoration:"underline",color:"primary.dark"},display:"inline-flex",alignItems:"center",gap:.5},children:[" ",A.actionUrl]})]})]}):e.jsx(D,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:1,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:1.3,fontSize:"0.8rem",cursor:"pointer","&:hover":{color:"text.primary"}},onClick:async L=>{L.stopPropagation(),await C(A.id)},children:A.message}),h!==A.id&&A.message.length>80&&e.jsx(ut,{size:"small",onClick:async L=>{L.stopPropagation(),await C(A.id)},startIcon:e.jsx(ln,{sx:{fontSize:"0.75rem"}}),sx:{p:.25,minWidth:"auto",fontSize:"0.75rem!important",textTransform:"none",mt:.25,minHeight:"auto",height:"20px"},children:"More"}),h===A.id&&e.jsxs(l,{sx:{display:"flex",gap:.25,mt:.5},children:[e.jsx(ut,{size:"small",onClick:async L=>{L.stopPropagation(),await C(A.id)},startIcon:e.jsx(Dn,{sx:{fontSize:"0.75rem"}}),sx:{p:.25,minWidth:"auto",fontSize:"0.75rem!important",textTransform:"none",minHeight:"auto",height:"20px"},children:"Less"}),A.actionUrl&&e.jsx(ut,{size:"small",onClick:L=>{L.stopPropagation(),w(A)},sx:{p:.25,minWidth:"auto",fontSize:"0.75rem!important",textTransform:"none",minHeight:"auto",height:"20px",color:"primary.main","&:hover":{color:"primary.dark",bgcolor:"primary.light"}},children:" Go"})]})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mt:.5,children:[e.jsx(D,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:ou(A.createdAt)}),e.jsxs(l,{display:"flex",gap:.25,children:[!A.isRead&&e.jsx(Ie,{size:"small",onClick:L=>{L.stopPropagation(),b(A)},title:"Mark as read",sx:{p:.5,minWidth:"auto"},children:e.jsx(Ti,{sx:{fontSize:"0.875rem"}})}),e.jsx(Ie,{size:"small",onClick:L=>{L.stopPropagation(),v(A)},title:"Delete",color:"error",sx:{p:.5,minWidth:"auto"},children:e.jsx(pt,{sx:{fontSize:"0.875rem"}})})]})]})]})]})}),e.jsx(bt,{sx:{my:.25}})]},A.id))})]})}),e.jsxs(kt,{open:i,onClose:j,maxWidth:"lg",fullWidth:!0,fullScreen:!0,PaperProps:{sx:{bgcolor:"background.default"}},children:[e.jsx(hc,{position:"static",color:"primary",children:e.jsxs(no,{children:[e.jsxs(D,{variant:"h6",component:"div",sx:{flexGrow:1},children:["All Notifications (",r.length,")"]}),e.jsx(Ie,{color:"inherit",onClick:j,title:"Close fullscreen",children:e.jsx(Yx,{})})]})}),e.jsx(Pt,{sx:{p:0,bgcolor:"background.default"},children:r.length===0?e.jsxs(l,{textAlign:"center",py:8,sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[e.jsx(Vi,{sx:{fontSize:64,color:"text.secondary"}}),e.jsx(D,{variant:"h6",color:"text.secondary",children:"No notifications yet"}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"You'll see notifications here when they arrive"})]}):e.jsx(lt,{sx:{py:0},children:r.map((A,L)=>e.jsxs(rt.Fragment,{children:[e.jsx(Pe,{sx:{bgcolor:A.isRead?"transparent":"action.hover",borderRadius:1,mb:.5,flexDirection:"column",alignItems:"stretch",py:1.5,px:2,cursor:"default","&:hover":{bgcolor:"action.selected",transform:"translateY(-1px)",boxShadow:2},transition:"all 0.2s ease-in-out"},children:e.jsxs(l,{display:"flex",alignItems:"flex-start",gap:1,mb:1,children:[e.jsx(l,{sx:{color:`${Ii(A.type)}.main`,mt:.25},children:iu(A.type)}),e.jsxs(l,{flex:1,minWidth:0,children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:.5,children:[e.jsx(D,{variant:"h6",sx:{fontWeight:A.isRead?"normal":"bold",flex:1,minWidth:0,fontSize:"1rem"},children:A.title}),e.jsx(ce,{label:A.type.toUpperCase(),size:"small",color:Ii(A.type),variant:"outlined",sx:{fontSize:"0.75rem",height:24}})]}),e.jsxs(l,{children:[h===A.id?e.jsxs(l,{children:[e.jsx(D,{variant:"body1",color:"text.primary",sx:{wordBreak:"break-word",lineHeight:1.5,fontSize:"0.9rem",mb:1.5},children:A.message}),A.actionUrl&&e.jsxs(l,{sx:{p:1.5,bgcolor:"action.hover",borderRadius:1,border:"1px solid",borderColor:"divider"},children:[e.jsx(D,{variant:"body2",color:"text.secondary",sx:{display:"block",mb:.5},children:"Quick Action:"}),e.jsxs(Al,{href:A.actionUrl,onClick:T=>{T.preventDefault(),w(A)},sx:{fontSize:"0.9rem",fontWeight:500,textDecoration:"none",color:"primary.main","&:hover":{textDecoration:"underline",color:"primary.dark"},display:"inline-flex",alignItems:"center",gap:.5},children:[" ",A.actionUrl]})]})]}):e.jsx(D,{variant:"body1",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",wordBreak:"break-word",lineHeight:1.4,fontSize:"0.9rem",cursor:"pointer","&:hover":{color:"text.primary"}},onClick:async T=>{T.stopPropagation(),await C(A.id)},children:A.message}),h!==A.id&&A.message.length>100&&e.jsx(ut,{size:"small",onClick:async T=>{T.stopPropagation(),await C(A.id)},startIcon:e.jsx(ln,{}),sx:{p:.5,minWidth:"auto",fontSize:"0.8rem!important",textTransform:"none",mt:.5,minHeight:"auto",height:"24px"},children:"More"}),h===A.id&&e.jsxs(l,{sx:{display:"flex",gap:.5,mt:1},children:[e.jsx(ut,{size:"small",onClick:async T=>{T.stopPropagation(),await C(A.id)},startIcon:e.jsx(Dn,{}),sx:{p:.5,minWidth:"auto",fontSize:"0.8rem!important",textTransform:"none",minHeight:"auto",height:"24px"},children:"Less"}),A.actionUrl&&e.jsx(ut,{size:"small",onClick:T=>{T.stopPropagation(),w(A)},sx:{p:.5,minWidth:"auto",fontSize:"0.8rem!important",textTransform:"none",minHeight:"auto",height:"24px",color:"primary.main","&:hover":{color:"primary.dark",bgcolor:"primary.light"}},children:" Go"})]})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mt:1,children:[e.jsx(D,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.8rem"},children:ou(A.createdAt)}),e.jsxs(l,{display:"flex",gap:.5,children:[!A.isRead&&e.jsx(Ie,{size:"small",onClick:T=>{T.stopPropagation(),b(A)},title:"Mark as read",sx:{p:.5,minWidth:"auto"},children:e.jsx(Ti,{sx:{fontSize:"1rem"}})}),e.jsx(Ie,{size:"small",onClick:T=>{T.stopPropagation(),v(A)},title:"Delete",color:"error",sx:{p:.5,minWidth:"auto"},children:e.jsx(pt,{sx:{fontSize:"1rem"}})})]})]})]})]})}),L<r.length-1&&e.jsx(bt,{sx:{my:.5}})]},A.id))})}),e.jsxs(Dt,{sx:{p:2,bgcolor:"background.default"},children:[e.jsx(ut,{onClick:P,startIcon:e.jsx(Ti,{}),disabled:t===0,variant:"outlined",sx:{mr:1},children:"Mark all as read"}),e.jsx(ut,{onClick:j,variant:"contained",color:"primary",children:"Close"})]})]})]})},i1=({userId:r})=>{const{connectSocket:t,disconnectSocket:n,notifications:s,fetchNotifications:a}=zc(),[i,o]=p.useState(null),[d,u]=p.useState(!1),h=p.useRef(!1),m=p.useRef(new Set),x=p.useRef([]),g=p.useRef(0);p.useEffect(()=>(h.current||(m.current.clear(),x.current=[],t(r),a(r),h.current=!0),()=>{n(),h.current=!1}),[r]),p.useEffect(()=>{const j=Date.now(),b=5e3;if(s.filter(P=>{const w=new Date(P.createdAt).getTime(),C=j-w<b,k=!P.isRead,A=!m.current.has(P.id);return C&&k&&A}).forEach(P=>{x.current.find(w=>w.id===P.id)||(x.current.push(P),m.current.add(P.id))}),x.current.length>0&&!d&&j-g.current>2e3){const P=x.current.shift();o(P),u(!0),g.current=j}},[s,d]);const f=()=>{u(!1),setTimeout(()=>{if(o(null),x.current.length>0){const j=x.current.shift();setTimeout(()=>{o(j),u(!0)},100)}},300)},y=()=>{i!=null&&i.actionUrl&&(window.location.href=i.actionUrl),f()};return e.jsx(e.Fragment,{children:i&&e.jsx(dv,{notification:i,open:d,onClose:f,onAction:y})})},o1=({variant:r="select",size:t="small",showLabel:n=!0})=>{const{i18n:s,t:a}=Ne(),i=Je(),o=Nt(i.breakpoints.down("md")),d=h=>{const m=h.target.value;s.changeLanguage(m),localStorage.setItem("i18nextLng",m)},u=[{code:"en",name:a("language.english"),flag:""},{code:"vi",name:a("language.vietnamese"),flag:""}];return o?null:r==="buttons"?e.jsx(l,{display:"flex",gap:1,children:u.map(h=>e.jsxs(l,{onClick:()=>{s.changeLanguage(h.code),localStorage.setItem("i18nextLng",h.code)},sx:{display:"flex",alignItems:"center",gap:.5,padding:"4px 8px",borderRadius:1,cursor:"pointer",backgroundColor:s.language===h.code?"primary.main":"transparent",color:s.language===h.code?"primary.contrastText":"text.primary","&:hover":{backgroundColor:s.language===h.code?"primary.dark":"action.hover"},transition:"all 0.2s ease-in-out"},children:[e.jsx(D,{variant:"body2",children:h.flag}),e.jsx(D,{variant:"body2",fontSize:"0.75rem",children:h.name})]},h.code))}):e.jsxs(nt,{size:t,sx:{minWidth:120},children:[n&&e.jsx(st,{id:"language-select-label",children:e.jsxs(l,{display:"flex",alignItems:"center",gap:.5,children:[e.jsx(Vu,{fontSize:"small"}),a("navigation.language")]})}),e.jsx(Ze,{labelId:"language-select-label",value:s.language,onChange:d,label:n?a("navigation.language"):void 0,sx:{"& .MuiSelect-select":{display:"flex",alignItems:"center",gap:.5}},children:u.map(h=>e.jsx(re,{value:h.code,children:e.jsxs(l,{display:"flex",alignItems:"center",gap:.5,children:[e.jsx(D,{variant:"body2",children:h.flag}),e.jsx(D,{variant:"body2",children:h.name})]})},h.code))})]})},l1=({size:r="small"})=>{const t=Je(),{t:n}=Ne(),[s]=p.useState(ob()),a=()=>{s.showFull?Ld():s.maskData?(Ed(),Ld()):Ed(),setTimeout(()=>{window.location.reload()},100)},i=()=>s.maskData?"mask":s.showFull?"full":"compact",o=()=>{switch(i()){case"mask":return e.jsx(oa,{});case"full":return e.jsx(Xt,{});case"compact":return e.jsx(ed,{});default:return e.jsx(ed,{})}},d=()=>{switch(i()){case"mask":return n("dataDisplay.toggle.masked");case"full":return n("dataDisplay.toggle.full");case"compact":return n("dataDisplay.toggle.compact");default:return n("dataDisplay.toggle.title")}},u=()=>{var m,x,g,f;switch(i()){case"mask":return((m=t.palette.warning)==null?void 0:m.main)||"#ed6c02";case"full":return((x=t.palette.success)==null?void 0:x.main)||"#2e7d32";case"compact":return((g=t.palette.primary)==null?void 0:g.main)||"#1976d2";default:return((f=t.palette.text)==null?void 0:f.secondary)||"#666666"}};return e.jsx(Fe,{title:d(),placement:"top",arrow:!0,children:e.jsx(Ie,{size:r,onClick:a,sx:{color:u(),background:U(u(),.1),"&:hover":{background:U(u(),.2),transform:"scale(1.05)",boxShadow:`0 2px 8px ${U(u(),.3)}`},transition:"all 0.2s ease-in-out",borderRadius:2,width:r==="small"?36:r==="medium"?40:44,height:r==="small"?36:r==="medium"?40:44},children:o()})})};function c1(r){return typeof r=="string"}function d1(r,t,n){return r===void 0||c1(r)?t:{...t,ownerState:{...t.ownerState,...n}}}function u1(r,t=[]){if(r===void 0)return{};const n={};return Object.keys(r).filter(s=>s.match(/^on[A-Z]/)&&typeof r[s]=="function"&&!t.includes(s)).forEach(s=>{n[s]=r[s]}),n}function Oc(r,t,n){return typeof r=="function"?r(t,n):r}function h1(...r){const t=p.useRef(void 0),n=p.useCallback(s=>{const a=r.map(i=>{if(i==null)return null;if(typeof i=="function"){const o=i,d=o(s);return typeof d=="function"?d:()=>{o(null)}}return i.current=s,()=>{i.current=null}});return()=>{a.forEach(i=>i==null?void 0:i())}},r);return p.useMemo(()=>r.every(s=>s==null)?null:s=>{t.current&&(t.current(),t.current=void 0),s!=null&&(t.current=n(s))},r)}function lu(r){if(r===void 0)return{};const t={};return Object.keys(r).filter(n=>!(n.match(/^on[A-Z]/)&&typeof r[n]=="function")).forEach(n=>{t[n]=r[n]}),t}function m1(r){const{getSlotProps:t,additionalProps:n,externalSlotProps:s,externalForwardedProps:a,className:i}=r;if(!t){const f=Wn(n==null?void 0:n.className,i,a==null?void 0:a.className,s==null?void 0:s.className),y={...n==null?void 0:n.style,...a==null?void 0:a.style,...s==null?void 0:s.style},j={...n,...a,...s};return f.length>0&&(j.className=f),Object.keys(y).length>0&&(j.style=y),{props:j,internalRef:void 0}}const o=u1({...a,...s}),d=lu(s),u=lu(a),h=t(o),m=Wn(h==null?void 0:h.className,n==null?void 0:n.className,i,a==null?void 0:a.className,s==null?void 0:s.className),x={...h==null?void 0:h.style,...n==null?void 0:n.style,...a==null?void 0:a.style,...s==null?void 0:s.style},g={...h,...n,...u,...d};return m.length>0&&(g.className=m),Object.keys(x).length>0&&(g.style=x),{props:g,internalRef:h.ref}}function Pn(r){var x;const{elementType:t,externalSlotProps:n,ownerState:s,skipResolvingSlotProps:a=!1,...i}=r,o=a?{}:Oc(n,s),{props:d,internalRef:u}=m1({...i,externalSlotProps:o}),h=h1(u,o==null?void 0:o.ref,(x=r.additionalProps)==null?void 0:x.ref);return d1(t,{...d,ref:h},s)}const Oa=(r,t)=>r.length!==t.length?!1:t.every(n=>r.includes(n)),x1=({openTo:r,defaultOpenTo:t,views:n,defaultViews:s})=>{const a=n??s;let i;if(r!=null)i=r;else if(a.includes(t))i=t;else if(a.length>0)i=a[0];else throw new Error("MUI: The `views` prop must contain at least one view");return{views:a,openTo:i}},go=(r,t,n)=>{let s=t;return s=r.setHours(s,r.getHours(n)),s=r.setMinutes(s,r.getMinutes(n)),s=r.setSeconds(s,r.getSeconds(n)),s},Ja=({date:r,disableFuture:t,disablePast:n,maxDate:s,minDate:a,isDateDisabled:i,utils:o,timezone:d})=>{const u=go(o,o.dateWithTimezone(void 0,d),r);n&&o.isBefore(a,u)&&(a=u),t&&o.isAfter(s,u)&&(s=u);let h=r,m=r;for(o.isBefore(r,a)&&(h=a,m=null),o.isAfter(r,s)&&(m&&(m=s),h=null);h||m;){if(h&&o.isAfter(h,s)&&(h=null),m&&o.isBefore(m,a)&&(m=null),h){if(!i(h))return h;h=o.addDays(h,1)}if(m){if(!i(m))return m;m=o.addDays(m,-1)}}return null},p1=(r,t)=>t==null||!r.isValid(t)?null:t,Sr=(r,t,n)=>t==null||!r.isValid(t)?n:t,g1=(r,t,n)=>!r.isValid(t)&&t!=null&&!r.isValid(n)&&n!=null?!0:r.isEqual(t,n),Vc=(r,t)=>{const s=[r.startOfYear(t)];for(;s.length<12;){const a=s[s.length-1];s.push(r.addMonths(a,1))}return s},bm=(r,t,n)=>n==="date"?r.startOfDay(r.dateWithTimezone(void 0,t)):r.dateWithTimezone(void 0,t),f1=["year","month","day"],cu=r=>f1.includes(r),$c=(r,{format:t,views:n},s)=>{if(t!=null)return t;const a=r.formats;return Oa(n,["year"])?a.year:Oa(n,["month"])?a.month:Oa(n,["day"])?a.dayOfMonth:Oa(n,["month","year"])?`${a.month} ${a.year}`:Oa(n,["day","month"])?`${a.month} ${a.dayOfMonth}`:s?/en/.test(r.getCurrentLocaleCode())?a.normalDateWithWeekday:a.normalDate:a.keyboardDate},y1=(r,t)=>{const n=r.startOfWeek(t);return[0,1,2,3,4,5,6].map(s=>r.addDays(n,s))},b1=["hours","minutes","seconds"],j1=r=>b1.includes(r),du=(r,t)=>t.getHours(r)*3600+t.getMinutes(r)*60+t.getSeconds(r),v1=(r,t)=>(n,s)=>r?t.isAfter(n,s):du(n,t)>du(s,t),Fr={year:1,month:2,day:3,hours:4,minutes:5,seconds:6,milliseconds:7},w1=r=>Math.max(...r.map(t=>{var n;return(n=Fr[t.type])!=null?n:1})),Va=(r,t,n)=>{if(t===Fr.year)return r.startOfYear(n);if(t===Fr.month)return r.startOfMonth(n);if(t===Fr.day)return r.startOfDay(n);let s=n;return t<Fr.minutes&&(s=r.setMinutes(s,0)),t<Fr.seconds&&(s=r.setSeconds(s,0)),t<Fr.milliseconds&&(s=r.setMilliseconds(s,0)),s},S1=({props:r,utils:t,granularity:n,timezone:s,getTodayDate:a})=>{var i;let o=a?a():Va(t,n,bm(t,s));r.minDate!=null&&t.isAfterDay(r.minDate,o)&&(o=Va(t,n,r.minDate)),r.maxDate!=null&&t.isBeforeDay(r.maxDate,o)&&(o=Va(t,n,r.maxDate));const d=v1((i=r.disableIgnoringDatePartForTimeValidation)!=null?i:!1,t);return r.minTime!=null&&d(r.minTime,o)&&(o=Va(t,n,r.disableIgnoringDatePartForTimeValidation?r.minTime:go(t,o,r.minTime))),r.maxTime!=null&&d(o,r.maxTime)&&(o=Va(t,n,r.disableIgnoringDatePartForTimeValidation?r.maxTime:go(t,o,r.maxTime))),o},jm=(r,t)=>{const n=r.formatTokenMap[t];if(n==null)throw new Error([`MUI: The token "${t}" is not supported by the Date and Time Pickers.`,"Please try using another token or open an issue on https://github.com/mui/mui-x/issues/new/choose if you think it should be supported."].join(`
`));return typeof n=="string"?{type:n,contentType:n==="meridiem"?"letter":"digit",maxLength:void 0}:{type:n.sectionType,contentType:n.contentType,maxLength:n.maxLength}},T1=r=>{switch(r){case"ArrowUp":return 1;case"ArrowDown":return-1;case"PageUp":return 5;case"PageDown":return-5;default:return 0}},$o=(r,t,n)=>{const s=[],a=r.dateWithTimezone(void 0,t),i=r.startOfWeek(a),o=r.endOfWeek(a);let d=i;for(;r.isBefore(d,o);)s.push(d),d=r.addDays(d,1);return s.map(u=>r.formatByString(u,n))},vm=(r,t,n,s)=>{switch(n){case"month":return Vc(r,r.dateWithTimezone(void 0,t)).map(a=>r.formatByString(a,s));case"weekDay":return $o(r,t,s);case"meridiem":{const a=r.dateWithTimezone(void 0,t);return[r.startOfDay(a),r.endOfDay(a)].map(i=>r.formatByString(i,s))}default:return[]}},wm=(r,t,n)=>{let s=t;for(s=Number(s).toString();s.length<n;)s=`0${s}`;return s},Sm=(r,t,n,s,a)=>{if(a.type==="day"&&a.contentType==="digit-with-letter"){const o=r.setDate(s.longestMonth,n);return r.formatByString(o,a.format)}const i=n.toString();return a.hasLeadingZerosInInput?wm(r,i,a.maxLength):i},C1=(r,t,n,s,a,i,o)=>{const d=T1(s),u=s==="Home",h=s==="End",m=n.value===""||u||h,x=()=>{const f=a[n.type]({currentDate:i,format:n.format,contentType:n.contentType}),y=P=>Sm(r,t,P,f,n),j=n.type==="minutes"&&o!=null&&o.minutesStep?o.minutesStep:1;let v=parseInt(n.value,10)+d*j;if(m){if(n.type==="year"&&!h&&!u)return r.formatByString(r.dateWithTimezone(void 0,t),n.format);d>0||u?v=f.minimum:v=f.maximum}return v%j!==0&&((d<0||u)&&(v+=j-(j+v)%j),(d>0||h)&&(v-=v%j)),v>f.maximum?y(f.minimum+(v-f.maximum-1)%(f.maximum-f.minimum+1)):v<f.minimum?y(f.maximum-(f.minimum-v-1)%(f.maximum-f.minimum+1)):y(v)},g=()=>{const f=vm(r,t,n.type,n.format);if(f.length===0)return n.value;if(m)return d>0||u?f[0]:f[f.length-1];const j=(f.indexOf(n.value)+f.length+d)%f.length;return f[j]};return n.contentType==="digit"||n.contentType==="digit-with-letter"?x():g()},Hc=(r,t)=>{let n=r.value||r.placeholder;const s=t==="non-input"?r.hasLeadingZerosInFormat:r.hasLeadingZerosInInput;return t==="non-input"&&r.hasLeadingZerosInInput&&!r.hasLeadingZerosInFormat&&(n=Number(n).toString()),["input-rtl","input-ltr"].includes(t)&&r.contentType==="digit"&&!s&&n.length===1&&(n=`${n}`),t==="input-rtl"&&(n=`${n}`),n},aa=r=>r.replace(/[\u2066\u2067\u2068\u2069]/g,""),Tm=(r,t)=>{let n=0,s=t?1:0;const a=[];for(let i=0;i<r.length;i+=1){const o=r[i],d=Hc(o,t?"input-rtl":"input-ltr"),u=`${o.startSeparator}${d}${o.endSeparator}`,h=aa(u).length,m=u.length,x=aa(d),g=s+d.indexOf(x[0])+o.startSeparator.length,f=g+x.length;a.push(be({},o,{start:n,end:n+h,startInInput:g,endInInput:f})),n+=h,s+=m}return a},k1=(r,t,n,s,a)=>{switch(s.type){case"year":return n.fieldYearPlaceholder({digitAmount:r.formatByString(r.dateWithTimezone(void 0,t),a).length,format:a});case"month":return n.fieldMonthPlaceholder({contentType:s.contentType,format:a});case"day":return n.fieldDayPlaceholder({format:a});case"weekDay":return n.fieldWeekDayPlaceholder({contentType:s.contentType,format:a});case"hours":return n.fieldHoursPlaceholder({format:a});case"minutes":return n.fieldMinutesPlaceholder({format:a});case"seconds":return n.fieldSecondsPlaceholder({format:a});case"meridiem":return n.fieldMeridiemPlaceholder({format:a});default:return a}},uu=(r,t,n,s)=>r.formatByString(r.parse(t,n),s),Cm=(r,t,n)=>r.formatByString(r.dateWithTimezone(void 0,t),n).length===4,km=(r,t,n,s,a)=>{if(n!=="digit")return!1;const i=r.dateWithTimezone(void 0,t);switch(s){case"year":return Cm(r,t,a)?r.formatByString(r.setYear(i,1),a)==="0001":r.formatByString(r.setYear(i,2001),a)==="01";case"month":return r.formatByString(r.startOfYear(i),a).length>1;case"day":return r.formatByString(r.startOfMonth(i),a).length>1;case"weekDay":return r.formatByString(r.startOfWeek(i),a).length>1;case"hours":return r.formatByString(r.setHours(i,1),a).length>1;case"minutes":return r.formatByString(r.setMinutes(i,1),a).length>1;case"seconds":return r.formatByString(r.setSeconds(i,1),a).length>1;default:throw new Error("Invalid section type")}},P1=(r,t)=>{const n=[],{start:s,end:a}=r.escapedCharacters,i=new RegExp(`(\\${s}[^\\${a}]*\\${a})+`,"g");let o=null;for(;o=i.exec(t);)n.push({start:o.index,end:i.lastIndex-1});return n},hu=(r,t,n,s,a,i,o,d)=>{let u="";const h=[],m=r.date(),x=w=>{if(w==="")return null;const C=jm(r,w),k=km(r,t,C.contentType,C.type,w),A=o?k:C.contentType==="digit",L=a!=null&&r.isValid(a);let T=L?r.formatByString(a,w):"",M=null;if(A)if(k)M=T===""?r.formatByString(m,w).length:T.length;else{if(C.maxLength==null)throw new Error(`MUI: The token ${w} should have a 'maxDigitNumber' property on it's adapter`);M=C.maxLength,L&&(T=wm(r,T,M))}return h.push(be({},C,{format:w,maxLength:M,value:T,placeholder:k1(r,t,n,C,w),hasLeadingZeros:k,hasLeadingZerosInFormat:k,hasLeadingZerosInInput:A,startSeparator:h.length===0?u:"",endSeparator:"",modified:!1})),null};let g=10,f=s,y=r.expandFormat(s);for(;y!==f;)if(f=y,y=r.expandFormat(f),g-=1,g<0)throw new Error("MUI: The format expansion seems to be  enter in an infinite loop. Please open an issue with the format passed to the picker component");const j=y,b=P1(r,j),v=new RegExp(`^(${Object.keys(r.formatTokenMap).sort((w,C)=>C.length-w.length).join("|")})`,"g");let P="";for(let w=0;w<j.length;w+=1){const C=b.find(M=>M.start<=w&&M.end>=w),k=j[w],A=C!=null,L=`${P}${j.slice(w)}`,T=v.test(L);!A&&k.match(/([A-Za-z]+)/)&&T?(P=L.slice(0,v.lastIndex),w+=v.lastIndex-1):A&&(C==null?void 0:C.start)===w||(C==null?void 0:C.end)===w||(x(P),P="",h.length===0?u+=k:h[h.length-1].endSeparator+=k)}return x(P),h.map(w=>{const C=k=>{let A=k;return d&&A!==null&&A.includes(" ")&&(A=`${A}`),i==="spacious"&&["/",".","-"].includes(A)&&(A=` ${A} `),A};return w.startSeparator=C(w.startSeparator),w.endSeparator=C(w.endSeparator),w})},D1=(r,t)=>{const n=t.some(d=>d.type==="day"),s=[],a=[];for(let d=0;d<t.length;d+=1){const u=t[d];n&&u.type==="weekDay"||(s.push(u.format),a.push(Hc(u,"non-input")))}const i=s.join(" "),o=a.join(" ");return r.parse(o,i)},A1=(r,t)=>{const s=r.map(a=>{const i=Hc(a,t?"input-rtl":"input-ltr");return`${a.startSeparator}${i}${a.endSeparator}`}).join("");return t?`${s}`:s},I1=(r,t)=>{const n=r.dateWithTimezone(void 0,t),s=r.endOfYear(n),a=r.endOfDay(n),{maxDaysInMonth:i,longestMonth:o}=Vc(r,n).reduce((d,u)=>{const h=r.getDaysInMonth(u);return h>d.maxDaysInMonth?{maxDaysInMonth:h,longestMonth:u}:d},{maxDaysInMonth:0,longestMonth:null});return{year:({format:d})=>({minimum:0,maximum:Cm(r,t,d)?9999:99}),month:()=>({minimum:1,maximum:r.getMonth(s)+1}),day:({currentDate:d})=>({minimum:1,maximum:d!=null&&r.isValid(d)?r.getDaysInMonth(d):i,longestMonth:o}),weekDay:({format:d,contentType:u})=>{if(u==="digit"){const h=$o(r,t,d).map(Number);return{minimum:Math.min(...h),maximum:Math.max(...h)}}return{minimum:1,maximum:7}},hours:({format:d})=>{const u=r.getHours(a);return r.formatByString(r.endOfDay(n),d)!==u.toString()?{minimum:1,maximum:Number(r.formatByString(r.startOfDay(n),d))}:{minimum:0,maximum:u}},minutes:()=>({minimum:0,maximum:r.getMinutes(a)}),seconds:()=>({minimum:0,maximum:r.getSeconds(a)}),meridiem:()=>({minimum:0,maximum:0})}},R1=(r,t,n,s,a)=>{switch(n.type){case"year":return r.setYear(a,r.getYear(s));case"month":return r.setMonth(a,r.getMonth(s));case"weekDay":{const i=$o(r,t,n.format),o=r.formatByString(s,n.format),d=i.indexOf(o),h=i.indexOf(n.value)-d;return r.addDays(s,h)}case"day":return r.setDate(a,r.getDate(s));case"meridiem":{const i=r.getHours(s)<12,o=r.getHours(a);return i&&o>=12?r.addHours(a,-12):!i&&o<12?r.addHours(a,12):a}case"hours":return r.setHours(a,r.getHours(s));case"minutes":return r.setMinutes(a,r.getMinutes(s));case"seconds":return r.setSeconds(a,r.getSeconds(s));default:return a}},mu={year:1,month:2,day:3,weekDay:4,hours:5,minutes:6,seconds:7,meridiem:8},xu=(r,t,n,s,a,i)=>[...s].sort((o,d)=>mu[o.type]-mu[d.type]).reduce((o,d)=>!i||d.modified?R1(r,t,d,n,o):o,a),M1=()=>navigator.userAgent.toLowerCase().indexOf("android")>-1,N1=(r,t)=>{const n={};if(!t)return r.forEach((u,h)=>{const m=h===0?null:h-1,x=h===r.length-1?null:h+1;n[h]={leftIndex:m,rightIndex:x}}),{neighbors:n,startIndex:0,endIndex:r.length-1};const s={},a={};let i=0,o=0,d=r.length-1;for(;d>=0;){o=r.findIndex((u,h)=>{var m;return h>=i&&((m=u.endSeparator)==null?void 0:m.includes(" "))&&u.endSeparator!==" / "}),o===-1&&(o=r.length-1);for(let u=o;u>=i;u-=1)a[u]=d,s[d]=u,d-=1;i=o+1}return r.forEach((u,h)=>{const m=a[h],x=m===0?null:s[m-1],g=m===r.length-1?null:s[m+1];n[h]={leftIndex:x,rightIndex:g}}),{neighbors:n,startIndex:s[0],endIndex:s[r.length-1]}},L1=["value","referenceDate"],os={emptyValue:null,getTodayValue:bm,getInitialReferenceValue:r=>{let{value:t,referenceDate:n}=r,s=Ot(r,L1);return t!=null&&s.utils.isValid(t)?t:n??S1(s)},cleanValue:p1,areValuesEqual:g1,isSameError:(r,t)=>r===t,hasError:r=>r!=null,defaultErrorState:null,getTimezone:(r,t)=>t==null||!r.isValid(t)?null:r.getTimezone(t),setTimezone:(r,t,n)=>n==null?null:r.setTimezone(n,t)},E1={updateReferenceValue:(r,t,n)=>t==null||!r.isValid(t)?n:t,getSectionsFromValue:(r,t,n,s,a)=>!r.isValid(t)&&!!n?n:Tm(a(t),s),getValueStrFromSections:A1,getActiveDateManager:(r,t)=>({date:t.value,referenceDate:t.referenceValue,getSections:n=>n,getNewValuesFromNewActiveDate:n=>({value:n,referenceValue:n==null||!r.isValid(n)?t.referenceValue:n})}),parseValueStr:(r,t,n)=>n(r.trim(),t)},W1=["localeText"],ac=p.createContext(null),hr=function(t){var n;const{localeText:s}=t,a=Ot(t,W1),{utils:i,localeText:o}=(n=p.useContext(ac))!=null?n:{utils:void 0,localeText:void 0},d=Rn({props:a,name:"MuiLocalizationProvider"}),{children:u,dateAdapter:h,dateFormats:m,dateLibInstance:x,adapterLocale:g,localeText:f}=d,y=p.useMemo(()=>be({},f,o,s),[f,o,s]),j=p.useMemo(()=>{if(!h)return i||null;const P=new h({locale:g,formats:m,instance:x});if(!P.isMUIAdapter)throw new Error(["MUI: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/getting-started/#installation"].join(`
`));return P},[h,g,m,x,i]),b=p.useMemo(()=>j?{minDate:j.date("1900-01-01T00:00:00.000"),maxDate:j.date("2099-12-31T00:00:00.000")}:null,[j]),v=p.useMemo(()=>({utils:j,defaultDates:b,localeText:y}),[b,j,y]);return e.jsx(ac.Provider,{value:v,children:u})},F1=r=>({components:{MuiLocalizationProvider:{defaultProps:{localeText:be({},r)}}}}),Pm={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"open previous view",openNextView:"open next view",calendarViewSwitchingButtonAriaLabel:r=>r==="year"?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",clockLabelText:(r,t,n)=>`Select ${r}. ${t===null?"No time selected":`Selected time is ${n.format(t,"fullTime")}`}`,hoursClockNumberText:r=>`${r} hours`,minutesClockNumberText:r=>`${r} minutes`,secondsClockNumberText:r=>`${r} seconds`,selectViewText:r=>`Select ${r}`,calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:r=>`Week ${r}`,calendarWeekNumberText:r=>`${r}`,openDatePickerDialogue:(r,t)=>r!==null&&t.isValid(r)?`Choose date, selected date is ${t.format(r,"fullDate")}`:"Choose date",openTimePickerDialogue:(r,t)=>r!==null&&t.isValid(r)?`Choose time, selected time is ${t.format(r,"fullTime")}`:"Choose time",fieldClearLabel:"Clear value",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:r=>"Y".repeat(r.digitAmount),fieldMonthPlaceholder:r=>r.contentType==="letter"?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:r=>r.contentType==="letter"?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa"},z1=Pm;F1(Pm);const Us=()=>{const r=p.useContext(ac);if(r===null)throw new Error(["MUI: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join(`
`));if(r.utils===null)throw new Error(["MUI: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join(`
`));const t=p.useMemo(()=>be({},z1,r.localeText),[r.localeText]);return p.useMemo(()=>be({},r,{localeText:t}),[r,t])},tn=()=>Us().utils,vi=()=>Us().defaultDates,Ds=()=>Us().localeText,Ho=r=>{const t=tn(),n=p.useRef();return n.current===void 0&&(n.current=t.dateWithTimezone(void 0,r)),n.current};function O1(r){return Kn("MuiPickersToolbar",r)}Qn("MuiPickersToolbar",["root","content"]);const V1=r=>{const{classes:t,isLandscape:n}=r;return Hn({root:["root"],content:["content"],penIconButton:["penIconButton",n&&"penIconButtonLandscape"]},O1,t)},$1=vt("div",{name:"MuiPickersToolbar",slot:"Root",overridesResolver:(r,t)=>t.root})(({theme:r,ownerState:t})=>be({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",padding:r.spacing(2,3)},t.isLandscape&&{height:"auto",maxWidth:160,padding:16,justifyContent:"flex-start",flexWrap:"wrap"})),H1=vt("div",{name:"MuiPickersToolbar",slot:"Content",overridesResolver:(r,t)=>t.content})(({ownerState:r})=>{var t;return{display:"flex",flexWrap:"wrap",width:"100%",justifyContent:r.isLandscape?"flex-start":"space-between",flexDirection:r.isLandscape?(t=r.landscapeDirection)!=null?t:"column":"row",flex:1,alignItems:r.isLandscape?"flex-start":"center"}}),B1=p.forwardRef(function(t,n){const s=Rn({props:t,name:"MuiPickersToolbar"}),{children:a,className:i,toolbarTitle:o,hidden:d,titleId:u}=s,h=s,m=V1(h);return d?null:e.jsxs($1,{ref:n,className:Wn(m.root,i),ownerState:h,children:[e.jsx(D,{color:"text.secondary",variant:"overline",id:u,children:o}),e.jsx(H1,{className:m.content,ownerState:h,children:a})]})});function U1(r){return Kn("MuiDatePickerToolbar",r)}Qn("MuiDatePickerToolbar",["root","title"]);const _1=["value","isLandscape","onChange","toolbarFormat","toolbarPlaceholder","views","className"],Y1=r=>{const{classes:t}=r;return Hn({root:["root"],title:["title"]},U1,t)},q1=vt(B1,{name:"MuiDatePickerToolbar",slot:"Root",overridesResolver:(r,t)=>t.root})({}),G1=vt(D,{name:"MuiDatePickerToolbar",slot:"Title",overridesResolver:(r,t)=>t.title})(({ownerState:r})=>be({},r.isLandscape&&{margin:"auto 16px auto auto"})),K1=p.forwardRef(function(t,n){const s=Rn({props:t,name:"MuiDatePickerToolbar"}),{value:a,isLandscape:i,toolbarFormat:o,toolbarPlaceholder:d="",views:u,className:h}=s,m=Ot(s,_1),x=tn(),g=Ds(),f=Y1(s),y=p.useMemo(()=>{if(!a)return d;const b=$c(x,{format:o,views:u},!0);return x.formatByString(a,b)},[a,o,d,x,u]),j=s;return e.jsx(q1,be({ref:n,toolbarTitle:g.datePickerToolbarTitle,isLandscape:i,className:Wn(f.root,h)},m,{children:e.jsx(G1,{variant:"h4",align:i?"left":"center",ownerState:j,className:f.title,children:y})}))}),Dm=r=>{if(r!==void 0)return Object.keys(r).reduce((t,n)=>be({},t,{[`${n.slice(0,1).toLowerCase()}${n.slice(1)}`]:r[n]}),{})};function Am(r,t){var n,s,a,i;const o=tn(),d=vi(),u=Rn({props:r,name:t}),h=p.useMemo(()=>{var x;return((x=u.localeText)==null?void 0:x.toolbarTitle)==null?u.localeText:be({},u.localeText,{datePickerToolbarTitle:u.localeText.toolbarTitle})},[u.localeText]),m=(n=u.slots)!=null?n:Dm(u.components);return be({},u,{localeText:h},x1({views:u.views,openTo:u.openTo,defaultViews:["year","day"],defaultOpenTo:"day"}),{disableFuture:(s=u.disableFuture)!=null?s:!1,disablePast:(a=u.disablePast)!=null?a:!1,minDate:Sr(o,u.minDate,d.minDate),maxDate:Sr(o,u.maxDate,d.maxDate),slots:be({toolbar:K1},m),slotProps:(i=u.slotProps)!=null?i:u.componentsProps})}const Q1=Ps(e.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),X1=Ps(e.jsx("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"}),"ArrowLeft"),J1=Ps(e.jsx("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"}),"ArrowRight"),Z1=Ps(e.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}),"Calendar");Ps(e.jsxs(p.Fragment,{children:[e.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),e.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Clock");Ps(e.jsx("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"}),"DateRange");Ps(e.jsxs(p.Fragment,{children:[e.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),e.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}),"Time");const ew=Ps(e.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Clear");function tw(r){return Kn("MuiPickersArrowSwitcher",r)}Qn("MuiPickersArrowSwitcher",["root","spacer","button"]);const nw=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel"],rw=["ownerState"],sw=["ownerState"],aw=vt("div",{name:"MuiPickersArrowSwitcher",slot:"Root",overridesResolver:(r,t)=>t.root})({display:"flex"}),iw=vt("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer",overridesResolver:(r,t)=>t.spacer})(({theme:r})=>({width:r.spacing(3)})),pu=vt(Ie,{name:"MuiPickersArrowSwitcher",slot:"Button",overridesResolver:(r,t)=>t.button})(({ownerState:r})=>be({},r.hidden&&{visibility:"hidden"})),ow=r=>{const{classes:t}=r;return Hn({root:["root"],spacer:["spacer"],button:["button"]},tw,t)},lw=p.forwardRef(function(t,n){var s,a,i,o;const u=Je().direction==="rtl",h=Rn({props:t,name:"MuiPickersArrowSwitcher"}),{children:m,className:x,slots:g,slotProps:f,isNextDisabled:y,isNextHidden:j,onGoToNext:b,nextLabel:v,isPreviousDisabled:P,isPreviousHidden:w,onGoToPrevious:C,previousLabel:k}=h,A=Ot(h,nw),L=h,T=ow(L),M={isDisabled:y,isHidden:j,goTo:b,label:v},O={isDisabled:P,isHidden:w,goTo:C,label:k},I=(s=g==null?void 0:g.previousIconButton)!=null?s:pu,z=Pn({elementType:I,externalSlotProps:f==null?void 0:f.previousIconButton,additionalProps:{size:"medium",title:O.label,"aria-label":O.label,disabled:O.isDisabled,edge:"end",onClick:O.goTo},ownerState:be({},L,{hidden:O.isHidden}),className:T.button}),N=(a=g==null?void 0:g.nextIconButton)!=null?a:pu,E=Pn({elementType:N,externalSlotProps:f==null?void 0:f.nextIconButton,additionalProps:{size:"medium",title:M.label,"aria-label":M.label,disabled:M.isDisabled,edge:"start",onClick:M.goTo},ownerState:be({},L,{hidden:M.isHidden}),className:T.button}),R=(i=g==null?void 0:g.leftArrowIcon)!=null?i:X1,V=Pn({elementType:R,externalSlotProps:f==null?void 0:f.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:void 0}),F=Ot(V,rw),B=(o=g==null?void 0:g.rightArrowIcon)!=null?o:J1,$=Pn({elementType:B,externalSlotProps:f==null?void 0:f.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:void 0}),Y=Ot($,sw);return e.jsxs(aw,be({ref:n,className:Wn(T.root,x),ownerState:L},A,{children:[e.jsx(I,be({},z,{children:u?e.jsx(B,be({},Y)):e.jsx(R,be({},F))})),m?e.jsx(D,{variant:"subtitle1",component:"span",children:m}):e.jsx(iw,{className:T.spacer,ownerState:L}),e.jsx(N,be({},E,{children:u?e.jsx(R,be({},F)):e.jsx(B,be({},Y))}))]}))}),li=36,Bo=2,Uo=320,cw=280,Bc=334,dw=vt(kt)({[`& .${td.container}`]:{outline:0},[`& .${td.paper}`]:{outline:0,minWidth:Uo}}),uw=vt(Pt)({"&:first-of-type":{padding:0}});function hw(r){var t,n;const{children:s,onDismiss:a,open:i,slots:o,slotProps:d}=r,u=(t=o==null?void 0:o.dialog)!=null?t:dw,h=(n=o==null?void 0:o.mobileTransition)!=null?n:Xr;return e.jsx(u,be({open:i,onClose:a},d==null?void 0:d.dialog,{TransitionComponent:h,TransitionProps:d==null?void 0:d.mobileTransition,PaperComponent:o==null?void 0:o.mobilePaper,PaperProps:d==null?void 0:d.mobilePaper,children:e.jsx(uw,{children:s})}))}function mw(r){return Kn("MuiPickersPopper",r)}Qn("MuiPickersPopper",["root","paper"]);function xw(r,t){return Array.isArray(t)?t.every(n=>r.indexOf(n)!==-1):r.indexOf(t)!==-1}const pw=(r,t)=>n=>{(n.key==="Enter"||n.key===" ")&&(r(n),n.preventDefault(),n.stopPropagation())},fo=(r=document)=>{const t=r.activeElement;return t?t.shadowRoot?fo(t.shadowRoot):t:null},gw="@media (pointer: fine)",fw="@media (prefers-reduced-motion: reduce)",ha=typeof navigator<"u"&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),gu=ha&&ha[1]?parseInt(ha[1],10):null,fu=ha&&ha[2]?parseInt(ha[2],10):null,yw=gu&&gu<10||fu&&fu<13||!1,Im=()=>Nt(fw,{defaultMatches:!1})||yw,bw=["PaperComponent","popperPlacement","ownerState","children","paperSlotProps","paperClasses","onPaperClick","onPaperTouchStart"],jw=r=>{const{classes:t}=r;return Hn({root:["root"],paper:["paper"]},mw,t)},vw=vt(Gx,{name:"MuiPickersPopper",slot:"Root",overridesResolver:(r,t)=>t.root})(({theme:r})=>({zIndex:r.zIndex.modal})),ww=vt(Te,{name:"MuiPickersPopper",slot:"Paper",overridesResolver:(r,t)=>t.paper})(({ownerState:r})=>be({outline:0,transformOrigin:"top center"},r.placement.includes("top")&&{transformOrigin:"bottom center"}));function Sw(r,t){return t.documentElement.clientWidth<r.clientX||t.documentElement.clientHeight<r.clientY}function Tw(r,t){const n=p.useRef(!1),s=p.useRef(!1),a=p.useRef(null),i=p.useRef(!1);p.useEffect(()=>{if(!r)return;function u(){i.current=!0}return document.addEventListener("mousedown",u,!0),document.addEventListener("touchstart",u,!0),()=>{document.removeEventListener("mousedown",u,!0),document.removeEventListener("touchstart",u,!0),i.current=!1}},[r]);const o=et(u=>{if(!i.current)return;const h=s.current;s.current=!1;const m=el(a.current);if(!a.current||"clientX"in u&&Sw(u,m))return;if(n.current){n.current=!1;return}let x;u.composedPath?x=u.composedPath().indexOf(a.current)>-1:x=!m.documentElement.contains(u.target)||a.current.contains(u.target),!x&&!h&&t(u)}),d=()=>{s.current=!0};return p.useEffect(()=>{if(r){const u=el(a.current),h=()=>{n.current=!0};return u.addEventListener("touchstart",o),u.addEventListener("touchmove",h),()=>{u.removeEventListener("touchstart",o),u.removeEventListener("touchmove",h)}}},[r,o]),p.useEffect(()=>{if(r){const u=el(a.current);return u.addEventListener("click",o),()=>{u.removeEventListener("click",o),s.current=!1}}},[r,o]),[a,d,d]}const Cw=p.forwardRef((r,t)=>{const{PaperComponent:n,popperPlacement:s,ownerState:a,children:i,paperSlotProps:o,paperClasses:d,onPaperClick:u,onPaperTouchStart:h}=r,m=Ot(r,bw),x=be({},a,{placement:s}),g=Pn({elementType:n,externalSlotProps:o,additionalProps:{tabIndex:-1,elevation:8,ref:t},className:d,ownerState:x});return e.jsx(n,be({},m,g,{onClick:f=>{var y;u(f),(y=g.onClick)==null||y.call(g,f)},onTouchStart:f=>{var y;h(f),(y=g.onTouchStart)==null||y.call(g,f)},ownerState:x,children:i}))});function kw(r){var t,n,s,a;const i=Rn({props:r,name:"MuiPickersPopper"}),{anchorEl:o,children:d,containerRef:u=null,shouldRestoreFocus:h,onBlur:m,onDismiss:x,open:g,role:f,placement:y,slots:j,slotProps:b,reduceAnimations:v}=i;p.useEffect(()=>{function $(Y){g&&(Y.key==="Escape"||Y.key==="Esc")&&x()}return document.addEventListener("keydown",$),()=>{document.removeEventListener("keydown",$)}},[x,g]);const P=p.useRef(null);p.useEffect(()=>{f==="tooltip"||h&&!h()||(g?P.current=fo(document):P.current&&P.current instanceof HTMLElement&&setTimeout(()=>{P.current instanceof HTMLElement&&P.current.focus()}))},[g,f,h]);const[w,C,k]=Tw(g,m??x),A=p.useRef(null),L=Vs(A,u),T=Vs(L,w),M=i,O=jw(M),I=Im(),z=v??I,N=$=>{$.key==="Escape"&&($.stopPropagation(),x())},E=((t=j==null?void 0:j.desktopTransition)!=null?t:z)?Xr:Rs,R=(n=j==null?void 0:j.desktopTrapFocus)!=null?n:qx,V=(s=j==null?void 0:j.desktopPaper)!=null?s:ww,F=(a=j==null?void 0:j.popper)!=null?a:vw,B=Pn({elementType:F,externalSlotProps:b==null?void 0:b.popper,additionalProps:{transition:!0,role:f,open:g,anchorEl:o,placement:y,onKeyDown:N},className:O.root,ownerState:i});return e.jsx(F,be({},B,{children:({TransitionProps:$,placement:Y})=>e.jsx(R,be({open:g,disableAutoFocus:!0,disableRestoreFocus:!0,disableEnforceFocus:f==="tooltip",isEnabled:()=>!0},b==null?void 0:b.desktopTrapFocus,{children:e.jsx(E,be({},$,b==null?void 0:b.desktopTransition,{children:e.jsx(Cw,{PaperComponent:V,ownerState:M,popperPlacement:Y,ref:T,onPaperClick:C,onPaperTouchStart:k,paperClasses:O.paper,paperSlotProps:b==null?void 0:b.desktopPaper,children:d})}))}))}))}const Uc=({timezone:r,value:t,defaultValue:n,onChange:s,valueManager:a})=>{var i,o;const d=tn(),u=p.useRef(n),h=(i=t??u.current)!=null?i:a.emptyValue,m=p.useMemo(()=>a.getTimezone(d,h),[d,a,h]),x=et(j=>m==null?j:a.setTimezone(d,m,j)),g=(o=r??m)!=null?o:"default",f=p.useMemo(()=>a.setTimezone(d,g,h),[a,d,g,h]),y=et((j,...b)=>{const v=x(j);s==null||s(v,...b)});return{value:f,handleValueChange:y,timezone:g}},_c=({name:r,timezone:t,value:n,defaultValue:s,onChange:a,valueManager:i})=>{const[o,d]=Cs({name:r,state:"value",controlled:n,default:s??i.emptyValue}),u=et((h,...m)=>{d(h),a==null||a(h,...m)});return Uc({timezone:t,value:o,defaultValue:void 0,onChange:u,valueManager:i})};function Rm(r,t,n,s){const{value:a,onError:i}=r,o=Us(),d=p.useRef(s),u=t({adapter:o,value:a,props:r});return p.useEffect(()=>{i&&!n(u,d.current)&&i(u,a),d.current=u},[n,i,d,u,a]),u}const Pw=r=>{const t=tn(),n=Ds(),s=Us(),i=Je().direction==="rtl",{valueManager:o,fieldValueManager:d,validator:u,internalProps:h,internalProps:{value:m,defaultValue:x,referenceDate:g,onChange:f,format:y,formatDensity:j="dense",selectedSections:b,onSelectedSectionsChange:v,shouldRespectLeadingZeros:P=!1,timezone:w}}=r,{timezone:C,value:k,handleValueChange:A}=Uc({timezone:w,value:m,defaultValue:x,onChange:f,valueManager:o}),L=p.useMemo(()=>I1(t,C),[t,C]),T=p.useCallback((X,ne=null)=>d.getSectionsFromValue(t,X,ne,i,oe=>hu(t,C,n,y,oe,j,P,i)),[d,y,n,i,P,t,j,C]),M=p.useMemo(()=>d.getValueStrFromSections(T(o.emptyValue),i),[d,T,o.emptyValue,i]),[O,I]=p.useState(()=>{const X=T(k),ne={sections:X,value:k,referenceValue:o.emptyValue,tempValueStrAndroid:null},oe=w1(X),ee=o.getInitialReferenceValue({referenceDate:g,value:k,utils:t,props:h,granularity:oe,timezone:C});return be({},ne,{referenceValue:ee})}),[z,N]=Cs({controlled:b,default:null,name:"useField",state:"selectedSectionIndexes"}),E=X=>{N(X),v==null||v(X),I(ne=>be({},ne,{selectedSectionQuery:null}))},R=p.useMemo(()=>{if(z==null)return null;if(z==="all")return{startIndex:0,endIndex:O.sections.length-1,shouldSelectBoundarySelectors:!0};if(typeof z=="number")return{startIndex:z,endIndex:z};if(typeof z=="string"){const X=O.sections.findIndex(ne=>ne.type===z);return{startIndex:X,endIndex:X}}return z},[z,O.sections]),V=({value:X,referenceValue:ne,sections:oe})=>{if(I(H=>be({},H,{sections:oe,value:X,referenceValue:ne,tempValueStrAndroid:null})),o.areValuesEqual(t,O.value,X))return;const ee={validationError:u({adapter:s,value:X,props:be({},h,{value:X,timezone:C})})};A(X,ee)},F=(X,ne)=>{const oe=[...O.sections];return oe[X]=be({},oe[X],{value:ne,modified:!0}),Tm(oe,i)},B=()=>{V({value:o.emptyValue,referenceValue:O.referenceValue,sections:T(o.emptyValue)})},$=()=>{if(R==null)return;const X=O.sections[R.startIndex],ne=d.getActiveDateManager(t,O,X),ee=ne.getSections(O.sections).filter(J=>J.value!=="").length===(X.value===""?0:1),H=F(R.startIndex,""),Q=ee?null:t.date(new Date("")),Z=ne.getNewValuesFromNewActiveDate(Q);(Q!=null&&!t.isValid(Q))!=(ne.date!=null&&!t.isValid(ne.date))?V(be({},Z,{sections:H})):I(J=>be({},J,Z,{sections:H,tempValueStrAndroid:null}))},Y=X=>{const ne=(H,Q)=>{const Z=t.parse(H,y);if(Z==null||!t.isValid(Z))return null;const J=hu(t,C,n,y,Z,j,P,i);return xu(t,C,Z,J,Q,!1)},oe=d.parseValueStr(X,O.referenceValue,ne),ee=d.updateReferenceValue(t,oe,O.referenceValue);V({value:oe,referenceValue:ee,sections:T(oe,O.sections)})},_=({activeSection:X,newSectionValue:ne,shouldGoToNextSection:oe})=>{oe&&R&&R.startIndex<O.sections.length-1?E(R.startIndex+1):R&&R.startIndex!==R.endIndex&&E(R.startIndex);const ee=d.getActiveDateManager(t,O,X),H=F(R.startIndex,ne),Q=ee.getSections(H),Z=D1(t,Q);let J,ae;if(Z!=null&&t.isValid(Z)){const ue=xu(t,C,Z,Q,ee.referenceDate,!0);J=ee.getNewValuesFromNewActiveDate(ue),ae=!0}else J=ee.getNewValuesFromNewActiveDate(Z),ae=(Z!=null&&!t.isValid(Z))!=(ee.date!=null&&!t.isValid(ee.date));return ae?V(be({},J,{sections:H})):I(ue=>be({},ue,J,{sections:H,tempValueStrAndroid:null}))},K=X=>I(ne=>be({},ne,{tempValueStrAndroid:X}));return p.useEffect(()=>{const X=T(O.value);I(ne=>be({},ne,{sections:X}))},[y,t.locale]),p.useEffect(()=>{let X=!1;o.areValuesEqual(t,O.value,k)?X=o.getTimezone(t,O.value)!==o.getTimezone(t,k):X=!0,X&&I(ne=>be({},ne,{value:k,referenceValue:d.updateReferenceValue(t,k,ne.referenceValue),sections:T(k)}))},[k]),{state:O,selectedSectionIndexes:R,setSelectedSections:E,clearValue:B,clearActiveSection:$,updateSectionValue:_,updateValueFromValueStr:Y,setTempAndroidValueStr:K,sectionsValueBoundaries:L,placeholder:M,timezone:C}},Dw=5e3,qs=r=>r.saveQuery!=null,Aw=({sections:r,updateSectionValue:t,sectionsValueBoundaries:n,setTempAndroidValueStr:s,timezone:a})=>{const i=tn(),[o,d]=p.useState(null),u=et(()=>d(null));p.useEffect(()=>{var f;o!=null&&((f=r[o.sectionIndex])==null?void 0:f.type)!==o.sectionType&&u()},[r,o,u]),p.useEffect(()=>{if(o!=null){const f=setTimeout(()=>u(),Dw);return()=>{window.clearTimeout(f)}}return()=>{}},[o,u]);const h=({keyPressed:f,sectionIndex:y},j,b)=>{const v=f.toLowerCase(),P=r[y];if(o!=null&&(!b||b(o.value))&&o.sectionIndex===y){const C=`${o.value}${v}`,k=j(C,P);if(!qs(k))return d({sectionIndex:y,value:C,sectionType:P.type}),k}const w=j(v,P);return qs(w)&&!w.saveQuery?(u(),null):(d({sectionIndex:y,value:v,sectionType:P.type}),qs(w)?null:w)},m=f=>{const y=(v,P,w)=>{const C=P.filter(k=>k.toLowerCase().startsWith(w));return C.length===0?{saveQuery:!1}:{sectionValue:C[0],shouldGoToNextSection:C.length===1}},j=(v,P,w,C)=>{const k=A=>vm(i,a,P.type,A);if(P.contentType==="letter")return y(P.format,k(P.format),v);if(w&&C!=null&&jm(i,w).contentType==="letter"){const A=k(w),L=y(w,A,v);return qs(L)?{saveQuery:!1}:be({},L,{sectionValue:C(L.sectionValue,A)})}return{saveQuery:!1}};return h(f,(v,P)=>{switch(P.type){case"month":{const w=C=>uu(i,C,i.formats.month,P.format);return j(v,P,i.formats.month,w)}case"weekDay":{const w=(C,k)=>k.indexOf(C).toString();return j(v,P,i.formats.weekday,w)}case"meridiem":return j(v,P);default:return{saveQuery:!1}}})},x=f=>{const y=(b,v)=>{const P=+`${b}`,w=n[v.type]({currentDate:null,format:v.format,contentType:v.contentType});if(P>w.maximum)return{saveQuery:!1};if(P<w.minimum)return{saveQuery:!0};const C=+`${b}0`>w.maximum||b.length===w.maximum.toString().length;return{sectionValue:Sm(i,a,P,w,v),shouldGoToNextSection:C}};return h(f,(b,v)=>{if(v.contentType==="digit"||v.contentType==="digit-with-letter")return y(b,v);if(v.type==="month"){km(i,a,"digit","month","MM");const P=y(b,{type:v.type,format:"MM",hasLeadingZerosInInput:!0,contentType:"digit",maxLength:2});if(qs(P))return P;const w=uu(i,P.sectionValue,"MM",v.format);return be({},P,{sectionValue:w})}if(v.type==="weekDay"){const P=y(b,v);if(qs(P))return P;const w=$o(i,a,v.format)[Number(P.sectionValue)-1];return be({},P,{sectionValue:w})}return{saveQuery:!1}},b=>!Number.isNaN(Number(b)))};return{applyCharacterEditing:et(f=>{const y=r[f.sectionIndex],b=f.keyPressed!==" "&&!Number.isNaN(Number(f.keyPressed))?x(f):m(f);b==null?s(null):t({activeSection:y,newSectionValue:b.sectionValue,shouldGoToNextSection:b.shouldGoToNextSection})}),resetCharacterQuery:u}},Iw=["onClick","onKeyDown","onFocus","onBlur","onMouseUp","onPaste","error","clearable","onClear","disabled"],Rw=r=>{const t=tn(),{state:n,selectedSectionIndexes:s,setSelectedSections:a,clearValue:i,clearActiveSection:o,updateSectionValue:d,updateValueFromValueStr:u,setTempAndroidValueStr:h,sectionsValueBoundaries:m,placeholder:x,timezone:g}=Pw(r),{inputRef:f,internalProps:y,internalProps:{readOnly:j=!1,unstableFieldRef:b,minutesStep:v},forwardedProps:{onClick:P,onKeyDown:w,onFocus:C,onBlur:k,onMouseUp:A,onPaste:L,error:T,clearable:M,onClear:O,disabled:I},fieldValueManager:z,valueManager:N,validator:E}=r,R=Ot(r.forwardedProps,Iw),{applyCharacterEditing:V,resetCharacterQuery:F}=Aw({sections:n.sections,updateSectionValue:d,sectionsValueBoundaries:m,setTempAndroidValueStr:h,timezone:g}),B=p.useRef(null),$=Vs(f,B),Y=p.useRef(void 0),K=Je().direction==="rtl",X=p.useMemo(()=>N1(n.sections,K),[n.sections,K]),ne=()=>{var ie;if(j){a(null);return}const Se=(ie=B.current.selectionStart)!=null?ie:0;let Ve;Se<=n.sections[0].startInInput||Se>=n.sections[n.sections.length-1].endInInput?Ve=1:Ve=n.sections.findIndex(xe=>xe.startInInput-xe.startSeparator.length>Se);const Re=Ve===-1?n.sections.length-1:Ve-1;a(Re)},oe=et((ie,...Se)=>{ie.isDefaultPrevented()||(P==null||P(ie,...Se),ne())}),ee=et(ie=>{A==null||A(ie),ie.preventDefault()}),H=et((...ie)=>{C==null||C(...ie);const Se=B.current;window.clearTimeout(Y.current),Y.current=setTimeout(()=>{!Se||Se!==B.current||s!=null||j||(Se.value.length&&Number(Se.selectionEnd)-Number(Se.selectionStart)===Se.value.length?a("all"):ne())})}),Q=et((...ie)=>{k==null||k(...ie),a(null)}),Z=et(ie=>{if(L==null||L(ie),j){ie.preventDefault();return}const Se=ie.clipboardData.getData("text");if(s&&s.startIndex===s.endIndex){const Ve=n.sections[s.startIndex],Re=/^[a-zA-Z]+$/.test(Se),xe=/^[0-9]+$/.test(Se),te=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(Se);if(Ve.contentType==="letter"&&Re||Ve.contentType==="digit"&&xe||Ve.contentType==="digit-with-letter"&&te){F(),d({activeSection:Ve,newSectionValue:Se,shouldGoToNextSection:!0}),ie.preventDefault();return}if(Re||xe){ie.preventDefault();return}}ie.preventDefault(),F(),u(Se)}),J=et(ie=>{if(j)return;const Se=ie.target.value;if(Se===""){F(),i();return}const Ve=ie.nativeEvent.data,Re=Ve&&Ve.length>1,xe=Re?Ve:Se,te=aa(xe);if(s==null||Re){u(Re?Ve:te);return}let Ee;if(s.startIndex===0&&s.endIndex===n.sections.length-1&&te.length===1)Ee=te;else{const Ke=aa(z.getValueStrFromSections(n.sections,K));let Qt=-1,cn=-1;for(let _t=0;_t<Ke.length;_t+=1)Qt===-1&&Ke[_t]!==te[_t]&&(Qt=_t),cn===-1&&Ke[Ke.length-_t-1]!==te[te.length-_t-1]&&(cn=_t);const Ut=n.sections[s.startIndex];if(Qt<Ut.start||Ke.length-cn-1>Ut.end)return;const mt=te.length-Ke.length+Ut.end-aa(Ut.endSeparator||"").length;Ee=te.slice(Ut.start+aa(Ut.startSeparator||"").length,mt)}if(Ee.length===0){M1()?h(xe):(F(),o());return}V({keyPressed:Ee,sectionIndex:s.startIndex})}),ae=et(ie=>{switch(w==null||w(ie),!0){case(ie.key==="a"&&(ie.ctrlKey||ie.metaKey)):{ie.preventDefault(),a("all");break}case ie.key==="ArrowRight":{if(ie.preventDefault(),s==null)a(X.startIndex);else if(s.startIndex!==s.endIndex)a(s.endIndex);else{const Se=X.neighbors[s.startIndex].rightIndex;Se!==null&&a(Se)}break}case ie.key==="ArrowLeft":{if(ie.preventDefault(),s==null)a(X.endIndex);else if(s.startIndex!==s.endIndex)a(s.startIndex);else{const Se=X.neighbors[s.startIndex].leftIndex;Se!==null&&a(Se)}break}case ie.key==="Delete":{if(ie.preventDefault(),j)break;s==null||s.startIndex===0&&s.endIndex===n.sections.length-1?i():o(),F();break}case["ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(ie.key):{if(ie.preventDefault(),j||s==null)break;const Se=n.sections[s.startIndex],Ve=z.getActiveDateManager(t,n,Se),Re=C1(t,g,Se,ie.key,m,Ve.date,{minutesStep:v});d({activeSection:Se,newSectionValue:Re,shouldGoToNextSection:!1});break}}});ga(()=>{if(!B.current)return;if(s==null){B.current.scrollLeft&&(B.current.scrollLeft=0);return}const ie=n.sections[s.startIndex],Se=n.sections[s.endIndex];let Ve=ie.startInInput,Re=Se.endInInput;if(s.shouldSelectBoundarySelectors&&(Ve-=ie.startSeparator.length,Re+=Se.endSeparator.length),Ve!==B.current.selectionStart||Re!==B.current.selectionEnd){const xe=B.current.scrollTop;B.current===fo(document)&&B.current.setSelectionRange(Ve,Re),B.current.scrollTop=xe}});const ue=Rm(be({},y,{value:n.value,timezone:g}),E,N.isSameError,N.defaultErrorState),le=p.useMemo(()=>T!==void 0?T:N.hasError(ue),[N,ue,T]);p.useEffect(()=>{!le&&!s&&F()},[n.referenceValue,s,le]),p.useEffect(()=>(B.current&&B.current===document.activeElement&&a("all"),()=>window.clearTimeout(Y.current)),[]),p.useEffect(()=>{n.tempValueStrAndroid!=null&&s!=null&&(F(),o())},[n.tempValueStrAndroid]);const pe=p.useMemo(()=>{var ie;return(ie=n.tempValueStrAndroid)!=null?ie:z.getValueStrFromSections(n.sections,K)},[n.sections,z,n.tempValueStrAndroid,K]),Me=p.useMemo(()=>s==null||n.sections[s.startIndex].contentType==="letter"?"text":"numeric",[s,n.sections]),Le=B.current&&B.current===fo(document),qe=N.areValuesEqual(t,n.value,N.emptyValue),de=!Le&&qe;p.useImperativeHandle(b,()=>({getSections:()=>n.sections,getActiveSectionIndex:()=>{var ie,Se,Ve;const Re=(ie=B.current.selectionStart)!=null?ie:0,xe=(Se=B.current.selectionEnd)!=null?Se:0,te=!!((Ve=B.current)!=null&&Ve.readOnly);if(Re===0&&xe===0||te)return null;const Ee=Re<=n.sections[0].startInInput?1:n.sections.findIndex(Ke=>Ke.startInInput-Ke.startSeparator.length>Re);return Ee===-1?n.sections.length-1:Ee-1},setSelectedSections:ie=>a(ie)}));const fe=et((ie,...Se)=>{var Ve;ie.preventDefault(),O==null||O(ie,...Se),i(),B==null||(Ve=B.current)==null||Ve.focus(),a(0)});return be({placeholder:x,autoComplete:"off",disabled:!!I},R,{value:de?"":pe,inputMode:Me,readOnly:j,onClick:oe,onFocus:H,onBlur:Q,onPaste:Z,onChange:J,onKeyDown:ae,onMouseUp:ee,onClear:fe,error:le,ref:$,clearable:!!(M&&!qe&&!j&&!I)})},Mw=({open:r,onOpen:t,onClose:n})=>{const s=p.useRef(typeof r=="boolean").current,[a,i]=p.useState(!1);p.useEffect(()=>{if(s){if(typeof r!="boolean")throw new Error("You must not mix controlling and uncontrolled mode for `open` prop");i(r)}},[s,r]);const o=p.useCallback(d=>{s||i(d),d&&t&&t(),!d&&n&&n()},[s,t,n]);return{isOpen:a,setIsOpen:o}},Nw=r=>{const{action:t,hasChanged:n,dateState:s,isControlled:a}=r,i=!a&&!s.hasBeenModifiedSinceMount;return t.name==="setValueFromField"?!0:t.name==="setValueFromAction"?i&&["accept","today","clear"].includes(t.pickerAction)?!0:n(s.lastPublishedValue):t.name==="setValueFromView"&&t.selectionState!=="shallow"||t.name==="setValueFromShortcut"?i?!0:n(s.lastPublishedValue):!1},Lw=r=>{const{action:t,hasChanged:n,dateState:s,isControlled:a,closeOnSelect:i}=r,o=!a&&!s.hasBeenModifiedSinceMount;return t.name==="setValueFromAction"?o&&["accept","today","clear"].includes(t.pickerAction)?!0:n(s.lastCommittedValue):t.name==="setValueFromView"&&t.selectionState==="finish"&&i?o?!0:n(s.lastCommittedValue):t.name==="setValueFromShortcut"?t.changeImportance==="accept"&&n(s.lastCommittedValue):!1},Ew=r=>{const{action:t,closeOnSelect:n}=r;return t.name==="setValueFromAction"?!0:t.name==="setValueFromView"?t.selectionState==="finish"&&n:t.name==="setValueFromShortcut"?t.changeImportance==="accept":!1},Ww=({props:r,valueManager:t,valueType:n,wrapperVariant:s,validator:a})=>{const{onAccept:i,onChange:o,value:d,defaultValue:u,closeOnSelect:h=s==="desktop",selectedSections:m,onSelectedSectionsChange:x,timezone:g}=r,{current:f}=p.useRef(u),{current:y}=p.useRef(d!==void 0),j=tn(),b=Us(),[v,P]=Cs({controlled:m,default:null,name:"usePickerValue",state:"selectedSections"}),{isOpen:w,setIsOpen:C}=Mw(r),[k,A]=p.useState(()=>{let H;return d!==void 0?H=d:f!==void 0?H=f:H=t.emptyValue,{draft:H,lastPublishedValue:H,lastCommittedValue:H,lastControlledValue:d,hasBeenModifiedSinceMount:!1}}),{timezone:L,handleValueChange:T}=Uc({timezone:g,value:d,defaultValue:f,onChange:o,valueManager:t});Rm(be({},r,{value:k.draft,timezone:L}),a,t.isSameError,t.defaultErrorState);const M=et(H=>{const Q={action:H,dateState:k,hasChanged:ue=>!t.areValuesEqual(j,H.value,ue),isControlled:y,closeOnSelect:h},Z=Nw(Q),J=Lw(Q),ae=Ew(Q);if(A(ue=>be({},ue,{draft:H.value,lastPublishedValue:Z?H.value:ue.lastPublishedValue,lastCommittedValue:J?H.value:ue.lastCommittedValue,hasBeenModifiedSinceMount:!0})),Z){const le={validationError:H.name==="setValueFromField"?H.context.validationError:a({adapter:b,value:H.value,props:be({},r,{value:H.value,timezone:L})})};H.name==="setValueFromShortcut"&&H.shortcut!=null&&(le.shortcut=H.shortcut),T(H.value,le)}J&&i&&i(H.value),ae&&C(!1)});if(d!==void 0&&(k.lastControlledValue===void 0||!t.areValuesEqual(j,k.lastControlledValue,d))){const H=t.areValuesEqual(j,k.draft,d);A(Q=>be({},Q,{lastControlledValue:d},H?{}:{lastCommittedValue:d,lastPublishedValue:d,draft:d,hasBeenModifiedSinceMount:!0}))}const O=et(()=>{M({value:t.emptyValue,name:"setValueFromAction",pickerAction:"clear"})}),I=et(()=>{M({value:k.lastPublishedValue,name:"setValueFromAction",pickerAction:"accept"})}),z=et(()=>{M({value:k.lastPublishedValue,name:"setValueFromAction",pickerAction:"dismiss"})}),N=et(()=>{M({value:k.lastCommittedValue,name:"setValueFromAction",pickerAction:"cancel"})}),E=et(()=>{M({value:t.getTodayValue(j,L,n),name:"setValueFromAction",pickerAction:"today"})}),R=et(()=>C(!0)),V=et(()=>C(!1)),F=et((H,Q="partial")=>M({name:"setValueFromView",value:H,selectionState:Q})),B=et((H,Q,Z)=>M({name:"setValueFromShortcut",value:H,changeImportance:Q??"accept",shortcut:Z})),$=et((H,Q)=>M({name:"setValueFromField",value:H,context:Q})),Y=et(H=>{P(H),x==null||x(H)}),_={onClear:O,onAccept:I,onDismiss:z,onCancel:N,onSetToday:E,onOpen:R,onClose:V},K={value:k.draft,onChange:$,selectedSections:v,onSelectedSectionsChange:Y},X=p.useMemo(()=>t.cleanValue(j,k.draft),[j,t,k.draft]),ne={value:X,onChange:F,onClose:V,open:w,onSelectedSectionsChange:Y},ee=be({},_,{value:X,onChange:F,onSelectShortcut:B,isValid:H=>{const Q=a({adapter:b,value:H,props:be({},r,{value:H,timezone:L})});return!t.hasError(Q)}});return{open:w,fieldProps:K,viewProps:ne,layoutProps:ee,actions:_}};function Mm({onChange:r,onViewChange:t,openTo:n,view:s,views:a,autoFocus:i,focusedView:o,onFocusedViewChange:d}){var u,h;const m=p.useRef(n),x=p.useRef(a),g=p.useRef(a.includes(n)?n:a[0]),[f,y]=Cs({name:"useViews",state:"view",controlled:s,default:g.current}),j=p.useRef(i?f:null),[b,v]=Cs({name:"useViews",state:"focusedView",controlled:o,default:j.current});p.useEffect(()=>{(m.current&&m.current!==n||x.current&&x.current.some(M=>!a.includes(M)))&&(y(a.includes(n)?n:a[0]),x.current=a,m.current=n)},[n,y,f,a]);const P=a.indexOf(f),w=(u=a[P-1])!=null?u:null,C=(h=a[P+1])!=null?h:null,k=et((M,O)=>{v(O?M:I=>M===I?null:I),d==null||d(M,O)}),A=et(M=>{k(M,!0),M!==f&&(y(M),t&&t(M))}),L=et(()=>{C&&A(C)}),T=et((M,O,I)=>{const z=O==="finish",N=I?a.indexOf(I)<a.length-1:!!C;if(r(M,z&&N?"partial":O,I),I&&I!==f){const R=a[a.indexOf(I)+1];R&&A(R)}else z&&L()});return{view:f,setView:A,focusedView:b,setFocusedView:k,nextView:C,previousView:w,defaultView:a.includes(n)?n:a[0],goToNextView:L,setValueAndGoToNextView:T}}const Fw=["className","sx"],zw=({props:r,propsFromPickerValue:t,additionalViewProps:n,inputRef:s,autoFocusView:a})=>{const{onChange:i,open:o,onSelectedSectionsChange:d,onClose:u}=t,{view:h,views:m,openTo:x,onViewChange:g,viewRenderers:f,timezone:y}=r,j=Ot(r,Fw),{view:b,setView:v,defaultView:P,focusedView:w,setFocusedView:C,setValueAndGoToNextView:k}=Mm({view:h,views:m,openTo:x,onChange:i,onViewChange:g,autoFocus:a}),{hasUIView:A,viewModeLookup:L}=p.useMemo(()=>m.reduce((E,R)=>{let V;return f[R]!=null?V="UI":V="field",E.viewModeLookup[R]=V,V==="UI"&&(E.hasUIView=!0),E},{hasUIView:!1,viewModeLookup:{}}),[f,m]),T=p.useMemo(()=>m.reduce((E,R)=>f[R]!=null&&j1(R)?E+1:E,0),[f,m]),M=L[b],O=et(()=>M==="UI"),[I,z]=p.useState(M==="UI"?b:null);return I!==b&&L[b]==="UI"&&z(b),ga(()=>{M==="field"&&o&&(u(),setTimeout(()=>{s==null||s.current.focus(),d(b)}))},[b]),ga(()=>{if(!o)return;let E=b;M==="field"&&I!=null&&(E=I),E!==P&&L[E]==="UI"&&L[P]==="UI"&&(E=P),E!==b&&v(E),C(E,!0)},[o]),{hasUIView:A,shouldRestoreFocus:O,layoutProps:{views:m,view:I,onViewChange:v},renderCurrentView:()=>{if(I==null)return null;const E=f[I];return E==null?null:E(be({},j,n,t,{views:m,timezone:y,onChange:k,view:I,onViewChange:v,focusedView:w,onFocusedViewChange:C,showViewSwitcher:T>1,timeViewsCount:T}))}}};function yu(){return typeof window>"u"?"portrait":window.screen&&window.screen.orientation&&window.screen.orientation.angle?Math.abs(window.screen.orientation.angle)===90?"landscape":"portrait":window.orientation&&Math.abs(Number(window.orientation))===90?"landscape":"portrait"}const Ow=(r,t)=>{const[n,s]=p.useState(yu);return ga(()=>{const i=()=>{s(yu())};return window.addEventListener("orientationchange",i),()=>{window.removeEventListener("orientationchange",i)}},[]),xw(r,["hours","minutes","seconds"])?!1:(t||n)==="landscape"},Vw=({props:r,propsFromPickerValue:t,propsFromPickerViews:n,wrapperVariant:s})=>{const{orientation:a}=r,i=Ow(n.views,a);return{layoutProps:be({},n,t,{isLandscape:i,wrapperVariant:s,disabled:r.disabled,readOnly:r.readOnly})}},Nm=({props:r,valueManager:t,valueType:n,wrapperVariant:s,inputRef:a,additionalViewProps:i,validator:o,autoFocusView:d})=>{const u=Ww({props:r,valueManager:t,valueType:n,wrapperVariant:s,validator:o}),h=zw({props:r,inputRef:a,additionalViewProps:i,autoFocusView:d,propsFromPickerValue:u.viewProps}),m=Vw({props:r,wrapperVariant:s,propsFromPickerValue:u.layoutProps,propsFromPickerViews:h.layoutProps});return{open:u.open,actions:u.actions,fieldProps:u.fieldProps,renderCurrentView:h.renderCurrentView,hasUIView:h.hasUIView,shouldRestoreFocus:h.shouldRestoreFocus,layoutProps:m.layoutProps}};function Lm(r){return Kn("MuiPickersLayout",r)}const jl=Qn("MuiPickersLayout",["root","landscape","contentWrapper","toolbar","actionBar","tabs","shortcuts"]),$w=["onAccept","onClear","onCancel","onSetToday","actions"];function Hw(r){const{onAccept:t,onClear:n,onCancel:s,onSetToday:a,actions:i}=r,o=Ot(r,$w),d=Ds();if(i==null||i.length===0)return null;const u=i==null?void 0:i.map(h=>{switch(h){case"clear":return e.jsx(ut,{onClick:n,children:d.clearButtonLabel},h);case"cancel":return e.jsx(ut,{onClick:s,children:d.cancelButtonLabel},h);case"accept":return e.jsx(ut,{onClick:t,children:d.okButtonLabel},h);case"today":return e.jsx(ut,{onClick:a,children:d.todayButtonLabel},h);default:return null}});return e.jsx(Dt,be({},o,{children:u}))}const Bw=["items","changeImportance","isLandscape","onChange","isValid"],Uw=["getValue"];function _w(r){const{items:t,changeImportance:n,onChange:s,isValid:a}=r,i=Ot(r,Bw);if(t==null||t.length===0)return null;const o=t.map(d=>{let{getValue:u}=d,h=Ot(d,Uw);const m=u({isValid:a});return{label:h.label,onClick:()=>{s(m,n,h)},disabled:!a(m)}});return e.jsx(lt,be({dense:!0,sx:[{maxHeight:Bc,maxWidth:200,overflow:"auto"},...Array.isArray(i.sx)?i.sx:[i.sx]]},i,{children:o.map(d=>e.jsx(Pe,{children:e.jsx(ce,be({},d))},d.label))}))}function Yw(r){return r.view!==null}const qw=r=>{const{classes:t,isLandscape:n}=r;return Hn({root:["root",n&&"landscape"],contentWrapper:["contentWrapper"],toolbar:["toolbar"],actionBar:["actionBar"],tabs:["tabs"],landscape:["landscape"],shortcuts:["shortcuts"]},Lm,t)},Gw=r=>{var t,n;const{wrapperVariant:s,onAccept:a,onClear:i,onCancel:o,onSetToday:d,view:u,views:h,onViewChange:m,value:x,onChange:g,onSelectShortcut:f,isValid:y,isLandscape:j,disabled:b,readOnly:v,children:P,components:w,componentsProps:C,slots:k,slotProps:A}=r,L=k??Dm(w),T=A??C,M=qw(r),O=(t=L==null?void 0:L.actionBar)!=null?t:Hw,I=Pn({elementType:O,externalSlotProps:T==null?void 0:T.actionBar,additionalProps:{onAccept:a,onClear:i,onCancel:o,onSetToday:d,actions:s==="desktop"?[]:["cancel","accept"],className:M.actionBar},ownerState:be({},r,{wrapperVariant:s})}),z=e.jsx(O,be({},I)),N=L==null?void 0:L.toolbar,E=Pn({elementType:N,externalSlotProps:T==null?void 0:T.toolbar,additionalProps:{isLandscape:j,onChange:g,value:x,view:u,onViewChange:m,views:h,disabled:b,readOnly:v,className:M.toolbar},ownerState:be({},r,{wrapperVariant:s})}),R=Yw(E)&&N?e.jsx(N,be({},E)):null,V=P,F=L==null?void 0:L.tabs,B=u&&F?e.jsx(F,be({view:u,onViewChange:m,className:M.tabs},T==null?void 0:T.tabs)):null,$=(n=L==null?void 0:L.shortcuts)!=null?n:_w,Y=Pn({elementType:$,externalSlotProps:T==null?void 0:T.shortcuts,additionalProps:{isValid:y,isLandscape:j,onChange:f,className:M.shortcuts},ownerState:{isValid:y,isLandscape:j,onChange:f,className:M.shortcuts,wrapperVariant:s}}),_=u&&$?e.jsx($,be({},Y)):null;return{toolbar:R,content:V,tabs:B,actionBar:z,shortcuts:_}},Kw=r=>{const{isLandscape:t,classes:n}=r;return Hn({root:["root",t&&"landscape"],contentWrapper:["contentWrapper"]},Lm,n)},Em=vt("div",{name:"MuiPickersLayout",slot:"Root",overridesResolver:(r,t)=>t.root})(({theme:r,ownerState:t})=>({display:"grid",gridAutoColumns:"max-content auto max-content",gridAutoRows:"max-content auto max-content",[`& .${jl.toolbar}`]:t.isLandscape?{gridColumn:r.direction==="rtl"?3:1,gridRow:"2 / 3"}:{gridColumn:"2 / 4",gridRow:1},[`.${jl.shortcuts}`]:t.isLandscape?{gridColumn:"2 / 4",gridRow:1}:{gridColumn:r.direction==="rtl"?3:1,gridRow:"2 / 3"},[`& .${jl.actionBar}`]:{gridColumn:"1 / 4",gridRow:3}}));Em.propTypes={as:ge.elementType,ownerState:ge.shape({isLandscape:ge.bool.isRequired}).isRequired,sx:ge.oneOfType([ge.arrayOf(ge.oneOfType([ge.func,ge.object,ge.bool])),ge.func,ge.object])};const Qw=vt("div",{name:"MuiPickersLayout",slot:"ContentWrapper",overridesResolver:(r,t)=>t.contentWrapper})({gridColumn:2,gridRow:2,display:"flex",flexDirection:"column"}),Wm=function(t){const n=Rn({props:t,name:"MuiPickersLayout"}),{toolbar:s,content:a,tabs:i,actionBar:o,shortcuts:d}=Gw(n),{sx:u,className:h,isLandscape:m,ref:x,wrapperVariant:g}=n,f=n,y=Kw(f);return e.jsxs(Em,{ref:x,sx:u,className:Wn(h,y.root),ownerState:f,children:[m?d:s,m?s:d,e.jsx(Qw,{className:y.contentWrapper,children:g==="desktop"?e.jsxs(p.Fragment,{children:[a,i]}):e.jsxs(p.Fragment,{children:[i,a]})}),o]})};function Xw(r,{disableFuture:t,maxDate:n,timezone:s}){const a=tn();return p.useMemo(()=>{const i=a.dateWithTimezone(void 0,s),o=a.startOfMonth(t&&a.isBefore(i,n)?i:n);return!a.isAfter(o,r)},[t,n,r,a,s])}function Jw(r,{disablePast:t,minDate:n,timezone:s}){const a=tn();return p.useMemo(()=>{const i=a.dateWithTimezone(void 0,s),o=a.startOfMonth(t&&a.isAfter(i,n)?i:n);return!a.isBefore(o,r)},[t,n,r,a,s])}const Fm=["disablePast","disableFuture","minDate","maxDate","shouldDisableDate","shouldDisableMonth","shouldDisableYear"],Zw=["disablePast","disableFuture","minTime","maxTime","shouldDisableClock","shouldDisableTime","minutesStep","ampm","disableIgnoringDatePartForTimeValidation"],eS=["minDateTime","maxDateTime"],tS=[...Fm,...Zw,...eS],zm=r=>tS.reduce((t,n)=>(r.hasOwnProperty(n)&&(t[n]=r[n]),t),{}),nS=["value","defaultValue","referenceDate","format","formatDensity","onChange","timezone","readOnly","onError","shouldRespectLeadingZeros","selectedSections","onSelectedSectionsChange","unstableFieldRef"],rS=(r,t)=>{const n=be({},r),s={},a=i=>{n.hasOwnProperty(i)&&(s[i]=n[i],delete n[i])};return nS.forEach(a),Fm.forEach(a),{forwardedProps:n,internalProps:s}},_o=({props:r,value:t,adapter:n})=>{if(t===null)return null;const{shouldDisableDate:s,shouldDisableMonth:a,shouldDisableYear:i,disablePast:o,disableFuture:d,timezone:u}=r,h=n.utils.dateWithTimezone(void 0,u),m=Sr(n.utils,r.minDate,n.defaultDates.minDate),x=Sr(n.utils,r.maxDate,n.defaultDates.maxDate);switch(!0){case!n.utils.isValid(t):return"invalidDate";case!!(s&&s(t)):return"shouldDisableDate";case!!(a&&a(t)):return"shouldDisableMonth";case!!(i&&i(t)):return"shouldDisableYear";case!!(d&&n.utils.isAfterDay(t,h)):return"disableFuture";case!!(o&&n.utils.isBeforeDay(t,h)):return"disablePast";case!!(m&&n.utils.isBeforeDay(t,m)):return"minDate";case!!(x&&n.utils.isAfterDay(t,x)):return"maxDate";default:return null}};function sS(r){return Kn("MuiPickersDay",r)}const Is=Qn("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]),aS=["autoFocus","className","day","disabled","disableHighlightToday","disableMargin","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","outsideCurrentMonth","selected","showDaysOutsideCurrentMonth","children","today","isFirstVisibleCell","isLastVisibleCell"],iS=r=>{const{selected:t,disableMargin:n,disableHighlightToday:s,today:a,disabled:i,outsideCurrentMonth:o,showDaysOutsideCurrentMonth:d,classes:u}=r,h=o&&!d;return Hn({root:["root",t&&!h&&"selected",i&&"disabled",!n&&"dayWithMargin",!s&&a&&"today",o&&d&&"dayOutsideMonth",h&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},sS,u)},Om=({theme:r,ownerState:t})=>be({},r.typography.caption,{width:li,height:li,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:r.transitions.create("background-color",{duration:r.transitions.duration.short}),color:(r.vars||r).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.primary.mainChannel} / ${r.vars.palette.action.hoverOpacity})`:U(r.palette.primary.main,r.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:r.vars?`rgba(${r.vars.palette.primary.mainChannel} / ${r.vars.palette.action.focusOpacity})`:U(r.palette.primary.main,r.palette.action.focusOpacity),[`&.${Is.selected}`]:{willChange:"background-color",backgroundColor:(r.vars||r).palette.primary.dark}},[`&.${Is.selected}`]:{color:(r.vars||r).palette.primary.contrastText,backgroundColor:(r.vars||r).palette.primary.main,fontWeight:r.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(r.vars||r).palette.primary.dark}},[`&.${Is.disabled}:not(.${Is.selected})`]:{color:(r.vars||r).palette.text.disabled},[`&.${Is.disabled}&.${Is.selected}`]:{opacity:.6}},!t.disableMargin&&{margin:`0 ${Bo}px`},t.outsideCurrentMonth&&t.showDaysOutsideCurrentMonth&&{color:(r.vars||r).palette.text.secondary},!t.disableHighlightToday&&t.today&&{[`&:not(.${Is.selected})`]:{border:`1px solid ${(r.vars||r).palette.text.secondary}`}}),Vm=(r,t)=>{const{ownerState:n}=r;return[t.root,!n.disableMargin&&t.dayWithMargin,!n.disableHighlightToday&&n.today&&t.today,!n.outsideCurrentMonth&&n.showDaysOutsideCurrentMonth&&t.dayOutsideMonth,n.outsideCurrentMonth&&!n.showDaysOutsideCurrentMonth&&t.hiddenDaySpacingFiller]},oS=vt(Kx,{name:"MuiPickersDay",slot:"Root",overridesResolver:Vm})(Om),lS=vt("div",{name:"MuiPickersDay",slot:"Root",overridesResolver:Vm})(({theme:r,ownerState:t})=>be({},Om({theme:r,ownerState:t}),{opacity:0,pointerEvents:"none"})),$a=()=>{},cS=p.forwardRef(function(t,n){const s=Rn({props:t,name:"MuiPickersDay"}),{autoFocus:a=!1,className:i,day:o,disabled:d=!1,disableHighlightToday:u=!1,disableMargin:h=!1,isAnimating:m,onClick:x,onDaySelect:g,onFocus:f=$a,onBlur:y=$a,onKeyDown:j=$a,onMouseDown:b=$a,onMouseEnter:v=$a,outsideCurrentMonth:P,selected:w=!1,showDaysOutsideCurrentMonth:C=!1,children:k,today:A=!1}=s,L=Ot(s,aS),T=be({},s,{autoFocus:a,disabled:d,disableHighlightToday:u,disableMargin:h,selected:w,showDaysOutsideCurrentMonth:C,today:A}),M=iS(T),O=tn(),I=p.useRef(null),z=Vs(I,n);ga(()=>{a&&!d&&!m&&!P&&I.current.focus()},[a,d,m,P]);const N=R=>{b(R),P&&R.preventDefault()},E=R=>{d||g(o),P&&R.currentTarget.focus(),x&&x(R)};return P&&!C?e.jsx(lS,{className:Wn(M.root,M.hiddenDaySpacingFiller,i),ownerState:T,role:L.role}):e.jsx(oS,be({className:Wn(M.root,i),ref:z,centerRipple:!0,disabled:d,tabIndex:w?0:-1,onKeyDown:R=>j(R,o),onFocus:R=>f(R,o),onBlur:R=>y(R,o),onMouseEnter:R=>v(R,o),onClick:E,onMouseDown:N},L,{ownerState:T,children:k||O.format(o,"dayOfMonth")}))}),dS=p.memo(cS),uS=r=>Kn("MuiPickersSlideTransition",r),pr=Qn("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),hS=["children","className","reduceAnimations","slideDirection","transKey","classes"],mS=r=>{const{classes:t,slideDirection:n}=r,s={root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:[`slideEnter-${n}`],exitActive:[`slideExitActiveLeft-${n}`]};return Hn(s,uS,t)},xS=vt($u,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(r,t)=>[t.root,{[`.${pr["slideEnter-left"]}`]:t["slideEnter-left"]},{[`.${pr["slideEnter-right"]}`]:t["slideEnter-right"]},{[`.${pr.slideEnterActive}`]:t.slideEnterActive},{[`.${pr.slideExit}`]:t.slideExit},{[`.${pr["slideExitActiveLeft-left"]}`]:t["slideExitActiveLeft-left"]},{[`.${pr["slideExitActiveLeft-right"]}`]:t["slideExitActiveLeft-right"]}]})(({theme:r})=>{const t=r.transitions.create("transform",{duration:r.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},[`& .${pr["slideEnter-left"]}`]:{willChange:"transform",transform:"translate(100%)",zIndex:1},[`& .${pr["slideEnter-right"]}`]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},[`& .${pr.slideEnterActive}`]:{transform:"translate(0%)",transition:t},[`& .${pr.slideExit}`]:{transform:"translate(0%)"},[`& .${pr["slideExitActiveLeft-left"]}`]:{willChange:"transform",transform:"translate(-100%)",transition:t,zIndex:0},[`& .${pr["slideExitActiveLeft-right"]}`]:{willChange:"transform",transform:"translate(100%)",transition:t,zIndex:0}}});function pS(r){const t=Rn({props:r,name:"MuiPickersSlideTransition"}),{children:n,className:s,reduceAnimations:a,transKey:i}=t,o=Ot(t,hS),d=mS(t),u=Je();if(a)return e.jsx("div",{className:Wn(d.root,s),children:n});const h={exit:d.exit,enterActive:d.enterActive,enter:d.enter,exitActive:d.exitActive};return e.jsx(xS,{className:Wn(d.root,s),childFactory:m=>p.cloneElement(m,{classNames:h}),role:"presentation",children:e.jsx(Qx,be({mountOnEnter:!0,unmountOnExit:!0,timeout:u.transitions.duration.complex,classNames:h},o,{children:n}),i)})}const $m=({shouldDisableDate:r,shouldDisableMonth:t,shouldDisableYear:n,minDate:s,maxDate:a,disableFuture:i,disablePast:o,timezone:d})=>{const u=Us();return p.useCallback(h=>_o({adapter:u,value:h,props:{shouldDisableDate:r,shouldDisableMonth:t,shouldDisableYear:n,minDate:s,maxDate:a,disableFuture:i,disablePast:o,timezone:d}})!==null,[u,r,t,n,s,a,i,o,d])},gS=r=>Kn("MuiDayCalendar",r);Qn("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]);const fS=["parentProps","day","focusableDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"],yS=["ownerState"],bS=r=>{const{classes:t}=r;return Hn({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},gS,t)},Hm=(li+Bo*2)*6,jS=vt("div",{name:"MuiDayCalendar",slot:"Root",overridesResolver:(r,t)=>t.root})({}),vS=vt("div",{name:"MuiDayCalendar",slot:"Header",overridesResolver:(r,t)=>t.header})({display:"flex",justifyContent:"center",alignItems:"center"}),wS=vt(D,{name:"MuiDayCalendar",slot:"WeekDayLabel",overridesResolver:(r,t)=>t.weekDayLabel})(({theme:r})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(r.vars||r).palette.text.secondary})),SS=vt(D,{name:"MuiDayCalendar",slot:"WeekNumberLabel",overridesResolver:(r,t)=>t.weekNumberLabel})(({theme:r})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:r.palette.text.disabled})),TS=vt(D,{name:"MuiDayCalendar",slot:"WeekNumber",overridesResolver:(r,t)=>t.weekNumber})(({theme:r})=>be({},r.typography.caption,{width:li,height:li,padding:0,margin:`0 ${Bo}px`,color:r.palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})),CS=vt("div",{name:"MuiDayCalendar",slot:"LoadingContainer",overridesResolver:(r,t)=>t.loadingContainer})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:Hm}),kS=vt(pS,{name:"MuiDayCalendar",slot:"SlideTransition",overridesResolver:(r,t)=>t.slideTransition})({minHeight:Hm}),PS=vt("div",{name:"MuiDayCalendar",slot:"MonthContainer",overridesResolver:(r,t)=>t.monthContainer})({overflow:"hidden"}),DS=vt("div",{name:"MuiDayCalendar",slot:"WeekContainer",overridesResolver:(r,t)=>t.weekContainer})({margin:`${Bo}px 0`,display:"flex",justifyContent:"center"});function AS(r){var t,n,s;let{parentProps:a,day:i,focusableDay:o,selectedDays:d,isDateDisabled:u,currentMonthNumber:h,isViewFocused:m}=r,x=Ot(r,fS);const{disabled:g,disableHighlightToday:f,isMonthSwitchingAnimating:y,showDaysOutsideCurrentMonth:j,components:b,componentsProps:v,slots:P,slotProps:w,timezone:C}=a,k=tn(),A=Ho(C),L=o!==null&&k.isSameDay(i,o),T=d.some(F=>k.isSameDay(F,i)),M=k.isSameDay(i,A),O=(t=(n=P==null?void 0:P.day)!=null?n:b==null?void 0:b.Day)!=null?t:dS,I=Pn({elementType:O,externalSlotProps:(s=w==null?void 0:w.day)!=null?s:v==null?void 0:v.day,additionalProps:be({disableHighlightToday:f,showDaysOutsideCurrentMonth:j,role:"gridcell",isAnimating:y,"data-timestamp":k.toJsDate(i).valueOf()},x),ownerState:be({},a,{day:i,selected:T})}),z=Ot(I,yS),N=p.useMemo(()=>g||u(i),[g,u,i]),E=p.useMemo(()=>k.getMonth(i)!==h,[k,i,h]),R=p.useMemo(()=>{const F=k.startOfMonth(k.setMonth(i,h));return j?k.isSameDay(i,k.startOfWeek(F)):k.isSameDay(i,F)},[h,i,j,k]),V=p.useMemo(()=>{const F=k.endOfMonth(k.setMonth(i,h));return j?k.isSameDay(i,k.endOfWeek(F)):k.isSameDay(i,F)},[h,i,j,k]);return e.jsx(O,be({},z,{day:i,disabled:N,autoFocus:m&&L,today:M,outsideCurrentMonth:E,isFirstVisibleCell:R,isLastVisibleCell:V,selected:T,tabIndex:L?0:-1,"aria-selected":T,"aria-current":M?"date":void 0}))}function IS(r){const t=Rn({props:r,name:"MuiDayCalendar"}),{onFocusedDayChange:n,className:s,currentMonth:a,selectedDays:i,focusedDay:o,loading:d,onSelectedDaysChange:u,onMonthSwitchingAnimationEnd:h,readOnly:m,reduceAnimations:x,renderLoading:g=()=>e.jsx("span",{children:"..."}),slideDirection:f,TransitionProps:y,disablePast:j,disableFuture:b,minDate:v,maxDate:P,shouldDisableDate:w,shouldDisableMonth:C,shouldDisableYear:k,dayOfWeekFormatter:A,hasFocus:L,onFocusedViewChange:T,gridLabelId:M,displayWeekNumber:O,fixedWeekNumber:I,autoFocus:z,timezone:N}=t,E=Ho(N),R=tn(),V=bS(t),B=Je().direction==="rtl",$=A||((de,fe)=>R.format(fe,"weekdayShort").charAt(0).toUpperCase()),Y=$m({shouldDisableDate:w,shouldDisableMonth:C,shouldDisableYear:k,minDate:v,maxDate:P,disablePast:j,disableFuture:b,timezone:N}),_=Ds(),[K,X]=Cs({name:"DayCalendar",state:"hasFocus",controlled:L,default:z??!1}),[ne,oe]=p.useState(()=>o||E),ee=et(de=>{m||u(de)}),H=de=>{Y(de)||(n(de),oe(de),T==null||T(!0),X(!0))},Q=et((de,fe)=>{switch(de.key){case"ArrowUp":H(R.addDays(fe,-7)),de.preventDefault();break;case"ArrowDown":H(R.addDays(fe,7)),de.preventDefault();break;case"ArrowLeft":{const ie=R.addDays(fe,B?1:-1),Se=R.addMonths(fe,B?1:-1),Ve=Ja({utils:R,date:ie,minDate:B?ie:R.startOfMonth(Se),maxDate:B?R.endOfMonth(Se):ie,isDateDisabled:Y,timezone:N});H(Ve||ie),de.preventDefault();break}case"ArrowRight":{const ie=R.addDays(fe,B?-1:1),Se=R.addMonths(fe,B?-1:1),Ve=Ja({utils:R,date:ie,minDate:B?R.startOfMonth(Se):ie,maxDate:B?ie:R.endOfMonth(Se),isDateDisabled:Y,timezone:N});H(Ve||ie),de.preventDefault();break}case"Home":H(R.startOfWeek(fe)),de.preventDefault();break;case"End":H(R.endOfWeek(fe)),de.preventDefault();break;case"PageUp":H(R.addMonths(fe,1)),de.preventDefault();break;case"PageDown":H(R.addMonths(fe,-1)),de.preventDefault();break}}),Z=et((de,fe)=>H(fe)),J=et((de,fe)=>{K&&R.isSameDay(ne,fe)&&(T==null||T(!1))}),ae=R.getMonth(a),ue=p.useMemo(()=>i.filter(de=>!!de).map(de=>R.startOfDay(de)),[R,i]),le=ae,pe=p.useMemo(()=>p.createRef(),[le]),Me=R.startOfWeek(E),Le=p.useMemo(()=>{const de=R.startOfMonth(a),fe=R.endOfMonth(a);return Y(ne)||R.isAfterDay(ne,fe)||R.isBeforeDay(ne,de)?Ja({utils:R,date:ne,minDate:de,maxDate:fe,disablePast:j,disableFuture:b,isDateDisabled:Y,timezone:N}):ne},[a,b,j,ne,Y,R,N]),qe=p.useMemo(()=>{const de=R.setTimezone(a,N),fe=R.getWeekArray(de);let ie=R.addMonths(de,1);for(;I&&fe.length<I;){const Se=R.getWeekArray(ie),Ve=R.isSameDay(fe[fe.length-1][0],Se[0][0]);Se.slice(Ve?1:0).forEach(Re=>{fe.length<I&&fe.push(Re)}),ie=R.addMonths(ie,1)}return fe},[a,I,R,N]);return e.jsxs(jS,{role:"grid","aria-labelledby":M,className:V.root,children:[e.jsxs(vS,{role:"row",className:V.header,children:[O&&e.jsx(SS,{variant:"caption",role:"columnheader","aria-label":_.calendarWeekNumberHeaderLabel,className:V.weekNumberLabel,children:_.calendarWeekNumberHeaderText}),y1(R,E).map((de,fe)=>{var ie;const Se=R.format(de,"weekdayShort");return e.jsx(wS,{variant:"caption",role:"columnheader","aria-label":R.format(R.addDays(Me,fe),"weekday"),className:V.weekDayLabel,children:(ie=$==null?void 0:$(Se,de))!=null?ie:Se},Se+fe.toString())})]}),d?e.jsx(CS,{className:V.loadingContainer,children:g()}):e.jsx(kS,be({transKey:le,onExited:h,reduceAnimations:x,slideDirection:f,className:Wn(s,V.slideTransition)},y,{nodeRef:pe,children:e.jsx(PS,{ref:pe,role:"rowgroup",className:V.monthContainer,children:qe.map((de,fe)=>e.jsxs(DS,{role:"row",className:V.weekContainer,"aria-rowindex":fe+1,children:[O&&e.jsx(TS,{className:V.weekNumber,role:"rowheader","aria-label":_.calendarWeekNumberAriaLabelText(R.getWeekNumber(de[0])),children:_.calendarWeekNumberText(R.getWeekNumber(de[0]))}),de.map((ie,Se)=>e.jsx(AS,{parentProps:t,day:ie,selectedDays:ue,focusableDay:Le,onKeyDown:Q,onFocus:Z,onBlur:J,onDaySelect:ee,isDateDisabled:Y,currentMonthNumber:ae,isViewFocused:K,"aria-colindex":Se+1},ie.toString()))]},`week-${de[0]}`))})}))]})}const RS=(r,t,n)=>(s,a)=>{switch(a.type){case"changeMonth":return be({},s,{slideDirection:a.direction,currentMonth:a.newMonth,isMonthSwitchingAnimating:!r});case"finishMonthSwitchingAnimation":return be({},s,{isMonthSwitchingAnimating:!1});case"changeFocusedDay":{if(s.focusedDay!=null&&a.focusedDay!=null&&n.isSameDay(a.focusedDay,s.focusedDay))return s;const i=a.focusedDay!=null&&!t&&!n.isSameMonth(s.currentMonth,a.focusedDay);return be({},s,{focusedDay:a.focusedDay,isMonthSwitchingAnimating:i&&!r&&!a.withoutMonthSwitchingAnimation,currentMonth:i?n.startOfMonth(a.focusedDay):s.currentMonth,slideDirection:a.focusedDay!=null&&n.isAfterDay(a.focusedDay,s.currentMonth)?"left":"right"})}default:throw new Error("missing support")}},MS=r=>{const{value:t,referenceDate:n,defaultCalendarMonth:s,disableFuture:a,disablePast:i,disableSwitchToMonthOnDayFocus:o=!1,maxDate:d,minDate:u,onMonthChange:h,reduceAnimations:m,shouldDisableDate:x,timezone:g}=r,f=tn(),y=p.useRef(RS(!!m,o,f)).current,j=p.useMemo(()=>{let L=null;return n?L=n:s&&(L=f.startOfMonth(s)),os.getInitialReferenceValue({value:t,utils:f,timezone:g,props:r,referenceDate:L,granularity:Fr.day})},[]),[b,v]=p.useReducer(y,{isMonthSwitchingAnimating:!1,focusedDay:j,currentMonth:f.startOfMonth(j),slideDirection:"left"}),P=p.useCallback(L=>{v(be({type:"changeMonth"},L)),h&&h(L.newMonth)},[h]),w=p.useCallback(L=>{const T=L;f.isSameMonth(T,b.currentMonth)||P({newMonth:f.startOfMonth(T),direction:f.isAfterDay(T,b.currentMonth)?"left":"right"})},[b.currentMonth,P,f]),C=$m({shouldDisableDate:x,minDate:u,maxDate:d,disableFuture:a,disablePast:i,timezone:g}),k=p.useCallback(()=>{v({type:"finishMonthSwitchingAnimation"})},[]),A=et((L,T)=>{C(L)||v({type:"changeFocusedDay",focusedDay:L,withoutMonthSwitchingAnimation:T})});return{referenceDate:j,calendarState:b,changeMonth:w,changeFocusedDay:A,isDateDisabled:C,onMonthSwitchingAnimationEnd:k,handleChangeMonth:P}},NS=["props","getOpenDialogAriaText"],LS=["ownerState"],ES=["ownerState"],WS=r=>{var t,n,s,a,i;let{props:o,getOpenDialogAriaText:d}=r,u=Ot(r,NS);const{slots:h,slotProps:m,className:x,sx:g,format:f,formatDensity:y,timezone:j,name:b,label:v,inputRef:P,readOnly:w,disabled:C,autoFocus:k,localeText:A,reduceAnimations:L}=o,T=tn(),M=p.useRef(null),O=p.useRef(null),I=mc(),z=(t=m==null||(n=m.toolbar)==null?void 0:n.hidden)!=null?t:!1,{open:N,actions:E,hasUIView:R,layoutProps:V,renderCurrentView:F,shouldRestoreFocus:B,fieldProps:$}=Nm(be({},u,{props:o,inputRef:M,autoFocusView:!0,additionalViewProps:{},wrapperVariant:"desktop"})),Y=(s=h.inputAdornment)!=null?s:un,_=Pn({elementType:Y,externalSlotProps:m==null?void 0:m.inputAdornment,additionalProps:{position:"end"},ownerState:o}),K=Ot(_,LS),X=(a=h.openPickerButton)!=null?a:Ie,ne=Pn({elementType:X,externalSlotProps:m==null?void 0:m.openPickerButton,additionalProps:{disabled:C||w,onClick:N?E.onClose:E.onOpen,"aria-label":d($.value,T),edge:K.position},ownerState:o}),oe=Ot(ne,ES),ee=h.openPickerIcon,H=h.field,Q=Pn({elementType:H,externalSlotProps:m==null?void 0:m.field,additionalProps:be({},$,z&&{id:I},{readOnly:w,disabled:C,className:x,sx:g,format:f,formatDensity:y,timezone:j,label:v,name:b,autoFocus:k&&!o.open,focused:N?!0:void 0}),ownerState:o});R&&(Q.InputProps=be({},Q.InputProps,{ref:O},!o.disableOpenPicker&&{[`${K.position}Adornment`]:e.jsx(Y,be({},K,{children:e.jsx(X,be({},oe,{children:e.jsx(ee,be({},m==null?void 0:m.openPickerIcon))}))}))}));const Z=be({textField:h.textField,clearIcon:h.clearIcon,clearButton:h.clearButton},Q.slots),J=(i=h.layout)!=null?i:Wm,ae=Vs(M,Q.inputRef,P);let ue=I;z&&(v?ue=`${I}-label`:ue=void 0);const le=be({},m,{toolbar:be({},m==null?void 0:m.toolbar,{titleId:I}),popper:be({"aria-labelledby":ue},m==null?void 0:m.popper)});return{renderPicker:()=>e.jsxs(hr,{localeText:A,children:[e.jsx(H,be({},Q,{slots:Z,slotProps:le,inputRef:ae})),e.jsx(kw,be({role:"dialog",placement:"bottom-start",anchorEl:O.current},E,{open:N,slots:h,slotProps:le,shouldRestoreFocus:B,reduceAnimations:L,children:e.jsx(J,be({},V,le==null?void 0:le.layout,{slots:h,slotProps:le,children:F()}))}))]})}},FS=r=>{var t,n,s;const a=tn(),i=vi();return be({},r,{disablePast:(t=r.disablePast)!=null?t:!1,disableFuture:(n=r.disableFuture)!=null?n:!1,format:(s=r.format)!=null?s:a.formats.keyboardDate,minDate:Sr(a,r.minDate,i.minDate),maxDate:Sr(a,r.maxDate,i.maxDate)})},zS=({props:r,inputRef:t})=>{const n=FS(r),{forwardedProps:s,internalProps:a}=rS(n);return Rw({inputRef:t,forwardedProps:s,internalProps:a,valueManager:os,fieldValueManager:E1,validator:_o})},OS=["ownerState"],VS=({clearable:r,fieldProps:t,InputProps:n,onClear:s,slots:a,slotProps:i,components:o,componentsProps:d})=>{var u,h,m,x,g,f;const y=Ds(),j=(u=(h=a==null?void 0:a.clearButton)!=null?h:o==null?void 0:o.ClearButton)!=null?u:Ie,b=Pn({elementType:j,externalSlotProps:(m=i==null?void 0:i.clearButton)!=null?m:d==null?void 0:d.clearButton,ownerState:{},className:"clearButton",additionalProps:{title:y.fieldClearLabel}}),v=Ot(b,OS),P=(x=(g=a==null?void 0:a.clearIcon)!=null?g:o==null?void 0:o.ClearIcon)!=null?x:ew,w=Pn({elementType:P,externalSlotProps:(f=i==null?void 0:i.clearIcon)!=null?f:d==null?void 0:d.clearIcon,ownerState:{}}),C=be({},n,{endAdornment:e.jsxs(p.Fragment,{children:[r&&e.jsx(un,{position:"end",sx:{marginRight:n!=null&&n.endAdornment?-1:-1.5},children:e.jsx(j,be({},v,{onClick:s,children:e.jsx(P,be({fontSize:"small"},w))}))}),n==null?void 0:n.endAdornment]})}),k=be({},t,{sx:[{"& .clearButton":{opacity:1},"@media (pointer: fine)":{"& .clearButton":{opacity:0},"&:hover, &:focus-within":{".clearButton":{opacity:1}}}},...Array.isArray(t.sx)?t.sx:[t.sx]]});return{InputProps:C,fieldProps:k}},$S=["components","componentsProps","slots","slotProps","InputProps","inputProps"],HS=["inputRef"],BS=["ref","onPaste","onKeyDown","inputMode","readOnly","clearable","onClear"],Bm=p.forwardRef(function(t,n){var s,a,i;const o=Rn({props:t,name:"MuiDateField"}),{components:d,componentsProps:u,slots:h,slotProps:m,InputProps:x,inputProps:g}=o,f=Ot(o,$S),y=o,j=(s=(a=h==null?void 0:h.textField)!=null?a:d==null?void 0:d.TextField)!=null?s:Ae,b=Pn({elementType:j,externalSlotProps:(i=m==null?void 0:m.textField)!=null?i:u==null?void 0:u.textField,externalForwardedProps:f,ownerState:y}),{inputRef:v}=b,P=Ot(b,HS);P.inputProps=be({},g,P.inputProps),P.InputProps=be({},x,P.InputProps);const w=zS({props:P,inputRef:v}),{ref:C,onPaste:k,onKeyDown:A,inputMode:L,readOnly:T,clearable:M,onClear:O}=w,I=Ot(w,BS),{InputProps:z,fieldProps:N}=VS({onClear:O,clearable:M,fieldProps:I,InputProps:I.InputProps,slots:h,slotProps:m,components:d,componentsProps:u});return e.jsx(j,be({ref:n},N,{InputProps:be({},z,{readOnly:T}),inputProps:be({},I.inputProps,{inputMode:L,onPaste:k,onKeyDown:A,ref:C})}))}),US=r=>Kn("MuiPickersFadeTransitionGroup",r);Qn("MuiPickersFadeTransitionGroup",["root"]);const _S=r=>{const{classes:t}=r;return Hn({root:["root"]},US,t)},YS=vt($u,{name:"MuiPickersFadeTransitionGroup",slot:"Root",overridesResolver:(r,t)=>t.root})({display:"block",position:"relative"});function Um(r){const t=Rn({props:r,name:"MuiPickersFadeTransitionGroup"}),{children:n,className:s,reduceAnimations:a,transKey:i}=t,o=_S(t),d=Je();return a?n:e.jsx(YS,{className:Wn(o.root,s),children:e.jsx(Xr,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:d.transitions.duration.enteringScreen,enter:d.transitions.duration.enteringScreen,exit:0},children:n},i)})}function qS(r){return Kn("MuiPickersMonth",r)}const Ri=Qn("MuiPickersMonth",["root","monthButton","disabled","selected"]),GS=["autoFocus","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","aria-label","monthsPerRow"],KS=r=>{const{disabled:t,selected:n,classes:s}=r;return Hn({root:["root"],monthButton:["monthButton",t&&"disabled",n&&"selected"]},qS,s)},QS=vt("div",{name:"MuiPickersMonth",slot:"Root",overridesResolver:(r,t)=>[t.root]})(({ownerState:r})=>({flexBasis:r.monthsPerRow===3?"33.3%":"25%",display:"flex",alignItems:"center",justifyContent:"center"})),XS=vt("button",{name:"MuiPickersMonth",slot:"MonthButton",overridesResolver:(r,t)=>[t.monthButton,{[`&.${Ri.disabled}`]:t.disabled},{[`&.${Ri.selected}`]:t.selected}]})(({theme:r})=>be({color:"unset",backgroundColor:"transparent",border:0,outline:0},r.typography.subtitle1,{margin:"8px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.hoverOpacity})`:U(r.palette.action.active,r.palette.action.hoverOpacity)},"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.hoverOpacity})`:U(r.palette.action.active,r.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${Ri.disabled}`]:{color:(r.vars||r).palette.text.secondary},[`&.${Ri.selected}`]:{color:(r.vars||r).palette.primary.contrastText,backgroundColor:(r.vars||r).palette.primary.main,"&:focus, &:hover":{backgroundColor:(r.vars||r).palette.primary.dark}}})),JS=p.memo(function(t){const n=Rn({props:t,name:"MuiPickersMonth"}),{autoFocus:s,children:a,disabled:i,selected:o,value:d,tabIndex:u,onClick:h,onKeyDown:m,onFocus:x,onBlur:g,"aria-current":f,"aria-label":y}=n,j=Ot(n,GS),b=p.useRef(null),v=KS(n);return ga(()=>{if(s){var P;(P=b.current)==null||P.focus()}},[s]),e.jsx(QS,be({className:v.root,ownerState:n},j,{children:e.jsx(XS,{ref:b,disabled:i,type:"button",role:"radio",tabIndex:i?-1:u,"aria-current":f,"aria-checked":o,"aria-label":y,onClick:P=>h(P,d),onKeyDown:P=>m(P,d),onFocus:P=>x(P,d),onBlur:P=>g(P,d),className:v.monthButton,ownerState:n,children:a})}))});function ZS(r){return Kn("MuiMonthCalendar",r)}Qn("MuiMonthCalendar",["root"]);const eT=["className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","autoFocus","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId"],tT=r=>{const{classes:t}=r;return Hn({root:["root"]},ZS,t)};function nT(r,t){const n=tn(),s=vi(),a=Rn({props:r,name:t});return be({disableFuture:!1,disablePast:!1},a,{minDate:Sr(n,a.minDate,s.minDate),maxDate:Sr(n,a.maxDate,s.maxDate)})}const rT=vt("div",{name:"MuiMonthCalendar",slot:"Root",overridesResolver:(r,t)=>t.root})({display:"flex",flexWrap:"wrap",alignContent:"stretch",padding:"0 4px",width:Uo,boxSizing:"border-box"}),sT=p.forwardRef(function(t,n){const s=nT(t,"MuiMonthCalendar"),{className:a,value:i,defaultValue:o,referenceDate:d,disabled:u,disableFuture:h,disablePast:m,maxDate:x,minDate:g,onChange:f,shouldDisableMonth:y,readOnly:j,disableHighlightToday:b,autoFocus:v=!1,onMonthFocus:P,hasFocus:w,onFocusedViewChange:C,monthsPerRow:k=3,timezone:A,gridLabelId:L}=s,T=Ot(s,eT),{value:M,handleValueChange:O,timezone:I}=_c({name:"MonthCalendar",timezone:A,value:i,defaultValue:o,onChange:f,valueManager:os}),z=Ho(I),N=Hu(),E=tn(),R=p.useMemo(()=>os.getInitialReferenceValue({value:M,utils:E,props:s,timezone:I,referenceDate:d,granularity:Fr.month}),[]),V=s,F=tT(V),B=p.useMemo(()=>E.getMonth(z),[E,z]),$=p.useMemo(()=>M!=null?E.getMonth(M):b?null:E.getMonth(R),[M,E,b,R]),[Y,_]=p.useState(()=>$||B),[K,X]=Cs({name:"MonthCalendar",state:"hasFocus",controlled:w,default:v??!1}),ne=et(ae=>{X(ae),C&&C(ae)}),oe=p.useCallback(ae=>{const ue=E.startOfMonth(m&&E.isAfter(z,g)?z:g),le=E.startOfMonth(h&&E.isBefore(z,x)?z:x),pe=E.startOfMonth(ae);return E.isBefore(pe,ue)||E.isAfter(pe,le)?!0:y?y(pe):!1},[h,m,x,g,z,y,E]),ee=et((ae,ue)=>{if(j)return;const le=E.setMonth(M??R,ue);O(le)}),H=et(ae=>{oe(E.setMonth(M??R,ae))||(_(ae),ne(!0),P&&P(ae))});p.useEffect(()=>{_(ae=>$!==null&&ae!==$?$:ae)},[$]);const Q=et((ae,ue)=>{switch(ae.key){case"ArrowUp":H((12+ue-3)%12),ae.preventDefault();break;case"ArrowDown":H((12+ue+3)%12),ae.preventDefault();break;case"ArrowLeft":H((12+ue+(N.direction==="ltr"?-1:1))%12),ae.preventDefault();break;case"ArrowRight":H((12+ue+(N.direction==="ltr"?1:-1))%12),ae.preventDefault();break}}),Z=et((ae,ue)=>{H(ue)}),J=et((ae,ue)=>{Y===ue&&ne(!1)});return e.jsx(rT,be({ref:n,className:Wn(F.root,a),ownerState:V,role:"radiogroup","aria-labelledby":L},T,{children:Vc(E,M??R).map(ae=>{const ue=E.getMonth(ae),le=E.format(ae,"monthShort"),pe=E.format(ae,"month"),Me=ue===$,Le=u||oe(ae);return e.jsx(JS,{selected:Me,value:ue,onClick:ee,onKeyDown:Q,autoFocus:K&&ue===Y,disabled:Le,tabIndex:ue===Y?0:-1,onFocus:Z,onBlur:J,"aria-current":B===ue?"date":void 0,"aria-label":pe,monthsPerRow:k,children:le},le)})}))});function aT(r){return Kn("MuiPickersYear",r)}const Mi=Qn("MuiPickersYear",["root","yearButton","selected","disabled"]),iT=["autoFocus","className","children","disabled","selected","value","tabIndex","onClick","onKeyDown","onFocus","onBlur","aria-current","yearsPerRow"],oT=r=>{const{disabled:t,selected:n,classes:s}=r;return Hn({root:["root"],yearButton:["yearButton",t&&"disabled",n&&"selected"]},aT,s)},lT=vt("div",{name:"MuiPickersYear",slot:"Root",overridesResolver:(r,t)=>[t.root]})(({ownerState:r})=>({flexBasis:r.yearsPerRow===3?"33.3%":"25%",display:"flex",alignItems:"center",justifyContent:"center"})),cT=vt("button",{name:"MuiPickersYear",slot:"YearButton",overridesResolver:(r,t)=>[t.yearButton,{[`&.${Mi.disabled}`]:t.disabled},{[`&.${Mi.selected}`]:t.selected}]})(({theme:r})=>be({color:"unset",backgroundColor:"transparent",border:0,outline:0},r.typography.subtitle1,{margin:"6px 0",height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.focusOpacity})`:U(r.palette.action.active,r.palette.action.focusOpacity)},"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.hoverOpacity})`:U(r.palette.action.active,r.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${Mi.disabled}`]:{color:(r.vars||r).palette.text.secondary},[`&.${Mi.selected}`]:{color:(r.vars||r).palette.primary.contrastText,backgroundColor:(r.vars||r).palette.primary.main,"&:focus, &:hover":{backgroundColor:(r.vars||r).palette.primary.dark}}})),dT=p.memo(function(t){const n=Rn({props:t,name:"MuiPickersYear"}),{autoFocus:s,className:a,children:i,disabled:o,selected:d,value:u,tabIndex:h,onClick:m,onKeyDown:x,onFocus:g,onBlur:f,"aria-current":y}=n,j=Ot(n,iT),b=p.useRef(null),v=oT(n);return p.useEffect(()=>{s&&b.current.focus()},[s]),e.jsx(lT,be({className:Wn(v.root,a),ownerState:n},j,{children:e.jsx(cT,{ref:b,disabled:o,type:"button",role:"radio",tabIndex:o?-1:h,"aria-current":y,"aria-checked":d,onClick:P=>m(P,u),onKeyDown:P=>x(P,u),onFocus:P=>g(P,u),onBlur:P=>f(P,u),className:v.yearButton,ownerState:n,children:i})}))});function uT(r){return Kn("MuiYearCalendar",r)}Qn("MuiYearCalendar",["root"]);const hT=["autoFocus","className","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsPerRow","timezone","gridLabelId"],mT=r=>{const{classes:t}=r;return Hn({root:["root"]},uT,t)};function xT(r,t){var n;const s=tn(),a=vi(),i=Rn({props:r,name:t});return be({disablePast:!1,disableFuture:!1},i,{yearsPerRow:(n=i.yearsPerRow)!=null?n:3,minDate:Sr(s,i.minDate,a.minDate),maxDate:Sr(s,i.maxDate,a.maxDate)})}const pT=vt("div",{name:"MuiYearCalendar",slot:"Root",overridesResolver:(r,t)=>t.root})({display:"flex",flexDirection:"row",flexWrap:"wrap",overflowY:"auto",height:"100%",padding:"0 4px",width:Uo,maxHeight:cw,boxSizing:"border-box",position:"relative"}),gT=p.forwardRef(function(t,n){const s=xT(t,"MuiYearCalendar"),{autoFocus:a,className:i,value:o,defaultValue:d,referenceDate:u,disabled:h,disableFuture:m,disablePast:x,maxDate:g,minDate:f,onChange:y,readOnly:j,shouldDisableYear:b,disableHighlightToday:v,onYearFocus:P,hasFocus:w,onFocusedViewChange:C,yearsPerRow:k,timezone:A,gridLabelId:L}=s,T=Ot(s,hT),{value:M,handleValueChange:O,timezone:I}=_c({name:"YearCalendar",timezone:A,value:o,defaultValue:d,onChange:y,valueManager:os}),z=Ho(I),N=Hu(),E=tn(),R=p.useMemo(()=>os.getInitialReferenceValue({value:M,utils:E,props:s,timezone:I,referenceDate:u,granularity:Fr.year}),[]),V=s,F=mT(V),B=p.useMemo(()=>E.getYear(z),[E,z]),$=p.useMemo(()=>M!=null?E.getYear(M):v?null:E.getYear(R),[M,E,v,R]),[Y,_]=p.useState(()=>$||B),[K,X]=Cs({name:"YearCalendar",state:"hasFocus",controlled:w,default:a??!1}),ne=et(le=>{X(le),C&&C(le)}),oe=p.useCallback(le=>{if(x&&E.isBeforeYear(le,z)||m&&E.isAfterYear(le,z)||f&&E.isBeforeYear(le,f)||g&&E.isAfterYear(le,g))return!0;if(!b)return!1;const pe=E.startOfYear(le);return b(pe)},[m,x,g,f,z,b,E]),ee=et((le,pe)=>{if(j)return;const Me=E.setYear(M??R,pe);O(Me)}),H=et(le=>{oe(E.setYear(M??R,le))||(_(le),ne(!0),P==null||P(le))});p.useEffect(()=>{_(le=>$!==null&&le!==$?$:le)},[$]);const Q=et((le,pe)=>{switch(le.key){case"ArrowUp":H(pe-k),le.preventDefault();break;case"ArrowDown":H(pe+k),le.preventDefault();break;case"ArrowLeft":H(pe+(N.direction==="ltr"?-1:1)),le.preventDefault();break;case"ArrowRight":H(pe+(N.direction==="ltr"?1:-1)),le.preventDefault();break}}),Z=et((le,pe)=>{H(pe)}),J=et((le,pe)=>{Y===pe&&ne(!1)}),ae=p.useRef(null),ue=Vs(n,ae);return p.useEffect(()=>{if(a||ae.current===null)return;const le=ae.current.querySelector('[tabindex="0"]');if(!le)return;const pe=le.offsetHeight,Me=le.offsetTop,Le=ae.current.clientHeight,qe=ae.current.scrollTop,de=Me+pe;pe>Le||Me<qe||(ae.current.scrollTop=de-Le/2-pe/2)},[a]),e.jsx(pT,be({ref:ue,className:Wn(F.root,i),ownerState:V,role:"radiogroup","aria-labelledby":L},T,{children:E.getYearRange(f,g).map(le=>{const pe=E.getYear(le),Me=pe===$,Le=h||oe(le);return e.jsx(dT,{selected:Me,value:pe,onClick:ee,onKeyDown:Q,autoFocus:K&&pe===Y,disabled:Le,tabIndex:pe===Y?0:-1,onFocus:Z,onBlur:J,"aria-current":B===pe?"date":void 0,yearsPerRow:k,children:E.format(le,"year")},E.format(le,"year"))})}))}),fT=r=>Kn("MuiPickersCalendarHeader",r),yT=Qn("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]),bT=["slots","slotProps","components","componentsProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","timezone"],jT=["ownerState"],vT=r=>{const{classes:t}=r;return Hn({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},fT,t)},wT=vt("div",{name:"MuiPickersCalendarHeader",slot:"Root",overridesResolver:(r,t)=>t.root})({display:"flex",alignItems:"center",marginTop:16,marginBottom:8,paddingLeft:24,paddingRight:12,maxHeight:30,minHeight:30}),ST=vt("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer",overridesResolver:(r,t)=>t.labelContainer})(({theme:r})=>be({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},r.typography.body1,{fontWeight:r.typography.fontWeightMedium})),TT=vt("div",{name:"MuiPickersCalendarHeader",slot:"Label",overridesResolver:(r,t)=>t.label})({marginRight:6}),CT=vt(Ie,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton",overridesResolver:(r,t)=>t.switchViewButton})(({ownerState:r})=>be({marginRight:"auto"},r.view==="year"&&{[`.${yT.switchViewIcon}`]:{transform:"rotate(180deg)"}})),kT=vt(Q1,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon",overridesResolver:(r,t)=>t.switchViewIcon})(({theme:r})=>({willChange:"transform",transition:r.transitions.create("transform"),transform:"rotate(0deg)"})),PT=p.forwardRef(function(t,n){var s,a,i,o;const d=Ds(),u=tn(),h=Rn({props:t,name:"MuiPickersCalendarHeader"}),{slots:m,slotProps:x,components:g,currentMonth:f,disabled:y,disableFuture:j,disablePast:b,maxDate:v,minDate:P,onMonthChange:w,onViewChange:C,view:k,reduceAnimations:A,views:L,labelId:T,className:M,timezone:O}=h,I=Ot(h,bT),z=h,N=vT(h),E=(s=(a=m==null?void 0:m.switchViewButton)!=null?a:g==null?void 0:g.SwitchViewButton)!=null?s:CT,R=Pn({elementType:E,externalSlotProps:x==null?void 0:x.switchViewButton,additionalProps:{size:"small","aria-label":d.calendarViewSwitchingButtonAriaLabel(k)},ownerState:z,className:N.switchViewButton}),V=(i=(o=m==null?void 0:m.switchViewIcon)!=null?o:g==null?void 0:g.SwitchViewIcon)!=null?i:kT,F=Pn({elementType:V,externalSlotProps:x==null?void 0:x.switchViewIcon,ownerState:void 0,className:N.switchViewIcon}),B=Ot(F,jT),$=()=>w(u.addMonths(f,1),"left"),Y=()=>w(u.addMonths(f,-1),"right"),_=Xw(f,{disableFuture:j,maxDate:v,timezone:O}),K=Jw(f,{disablePast:b,minDate:P,timezone:O}),X=()=>{if(!(L.length===1||!C||y))if(L.length===2)C(L.find(ne=>ne!==k)||L[0]);else{const ne=L.indexOf(k)!==0?0:1;C(L[ne])}};return L.length===1&&L[0]==="year"?null:e.jsxs(wT,be({},I,{ownerState:z,className:Wn(M,N.root),ref:n,children:[e.jsxs(ST,{role:"presentation",onClick:X,ownerState:z,"aria-live":"polite",className:N.labelContainer,children:[e.jsx(Um,{reduceAnimations:A,transKey:u.format(f,"monthAndYear"),children:e.jsx(TT,{id:T,ownerState:z,className:N.label,children:u.format(f,"monthAndYear")})}),L.length>1&&!y&&e.jsx(E,be({},R,{children:e.jsx(V,be({},B))}))]}),e.jsx(Xr,{in:k==="day",children:e.jsx(lw,{slots:m,slotProps:x,onGoToPrevious:Y,isPreviousDisabled:K,previousLabel:d.previousMonth,onGoToNext:$,isNextDisabled:_,nextLabel:d.nextMonth})})]}))}),DT=vt("div")({overflow:"hidden",width:Uo,maxHeight:Bc,display:"flex",flexDirection:"column",margin:"0 auto"}),AT=r=>Kn("MuiDateCalendar",r);Qn("MuiDateCalendar",["root","viewTransitionContainer"]);const IT=["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","defaultCalendarMonth","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","components","componentsProps","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsPerRow","monthsPerRow","timezone"],RT=r=>{const{classes:t}=r;return Hn({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},AT,t)};function MT(r,t){var n,s,a,i,o,d,u;const h=tn(),m=vi(),x=Im(),g=Rn({props:r,name:t});return be({},g,{loading:(n=g.loading)!=null?n:!1,disablePast:(s=g.disablePast)!=null?s:!1,disableFuture:(a=g.disableFuture)!=null?a:!1,openTo:(i=g.openTo)!=null?i:"day",views:(o=g.views)!=null?o:["year","day"],reduceAnimations:(d=g.reduceAnimations)!=null?d:x,renderLoading:(u=g.renderLoading)!=null?u:()=>e.jsx("span",{children:"..."}),minDate:Sr(h,g.minDate,m.minDate),maxDate:Sr(h,g.maxDate,m.maxDate)})}const NT=vt(DT,{name:"MuiDateCalendar",slot:"Root",overridesResolver:(r,t)=>t.root})({display:"flex",flexDirection:"column",height:Bc}),LT=vt(Um,{name:"MuiDateCalendar",slot:"ViewTransitionContainer",overridesResolver:(r,t)=>t.viewTransitionContainer})({}),ET=p.forwardRef(function(t,n){var s,a,i;const o=tn(),d=mc(),u=MT(t,"MuiDateCalendar"),{autoFocus:h,onViewChange:m,value:x,defaultValue:g,referenceDate:f,disableFuture:y,disablePast:j,defaultCalendarMonth:b,onChange:v,onYearChange:P,onMonthChange:w,reduceAnimations:C,shouldDisableDate:k,shouldDisableMonth:A,shouldDisableYear:L,view:T,views:M,openTo:O,className:I,disabled:z,readOnly:N,minDate:E,maxDate:R,disableHighlightToday:V,focusedView:F,onFocusedViewChange:B,showDaysOutsideCurrentMonth:$,fixedWeekNumber:Y,dayOfWeekFormatter:_,components:K,componentsProps:X,slots:ne,slotProps:oe,loading:ee,renderLoading:H,displayWeekNumber:Q,yearsPerRow:Z,monthsPerRow:J,timezone:ae}=u,ue=Ot(u,IT),{value:le,handleValueChange:pe,timezone:Me}=_c({name:"DateCalendar",timezone:ae,value:x,defaultValue:g,onChange:v,valueManager:os}),{view:Le,setView:qe,focusedView:de,setFocusedView:fe,goToNextView:ie,setValueAndGoToNextView:Se}=Mm({view:T,views:M,openTo:O,onChange:pe,onViewChange:m,autoFocus:h,focusedView:F,onFocusedViewChange:B}),{referenceDate:Ve,calendarState:Re,changeFocusedDay:xe,changeMonth:te,handleChangeMonth:Ee,isDateDisabled:Ke,onMonthSwitchingAnimationEnd:Qt}=MS({value:le,defaultCalendarMonth:b,referenceDate:f,reduceAnimations:C,onMonthChange:w,minDate:E,maxDate:R,shouldDisableDate:k,disablePast:j,disableFuture:y,timezone:Me}),cn=z&&le||E,Ut=z&&le||R,xr=`${d}-grid-label`,mt=de!==null,_t=(s=(a=ne==null?void 0:ne.calendarHeader)!=null?a:K==null?void 0:K.CalendarHeader)!=null?s:PT,us=Pn({elementType:_t,externalSlotProps:(i=oe==null?void 0:oe.calendarHeader)!=null?i:X==null?void 0:X.calendarHeader,additionalProps:{views:M,view:Le,currentMonth:Re.currentMonth,onViewChange:qe,onMonthChange:(hn,Lr)=>Ee({newMonth:hn,direction:Lr}),minDate:cn,maxDate:Ut,disabled:z,disablePast:j,disableFuture:y,reduceAnimations:C,timezone:Me,labelId:xr,slots:ne,slotProps:oe},ownerState:u}),ke=et(hn=>{const Lr=o.startOfMonth(hn),Ma=o.endOfMonth(hn),hs=Ke(hn)?Ja({utils:o,date:hn,minDate:o.isBefore(E,Lr)?Lr:E,maxDate:o.isAfter(R,Ma)?Ma:R,disablePast:j,disableFuture:y,isDateDisabled:Ke,timezone:Me}):hn;hs?(Se(hs,"finish"),w==null||w(Lr)):(ie(),te(Lr)),xe(hs,!0)}),$e=et(hn=>{const Lr=o.startOfYear(hn),Ma=o.endOfYear(hn),hs=Ke(hn)?Ja({utils:o,date:hn,minDate:o.isBefore(E,Lr)?Lr:E,maxDate:o.isAfter(R,Ma)?Ma:R,disablePast:j,disableFuture:y,isDateDisabled:Ke,timezone:Me}):hn;hs?(Se(hs,"finish"),P==null||P(hs)):(ie(),te(Lr)),xe(hs,!0)}),Qe=et(hn=>pe(hn&&go(o,hn,le??Ve),"finish",Le));p.useEffect(()=>{le!=null&&o.isValid(le)&&te(le)},[le]);const Fn=u,Nr=RT(Fn),Xo={disablePast:j,disableFuture:y,maxDate:R,minDate:E},Jo={disableHighlightToday:V,readOnly:N,disabled:z,timezone:Me,gridLabelId:xr},Zo=p.useRef(Le);p.useEffect(()=>{Zo.current!==Le&&(de===Zo.current&&fe(Le,!0),Zo.current=Le)},[de,fe,Le]);const Ex=p.useMemo(()=>[le],[le]);return e.jsxs(NT,be({ref:n,className:Wn(Nr.root,I),ownerState:Fn},ue,{children:[e.jsx(_t,be({},us)),e.jsx(LT,{reduceAnimations:C,className:Nr.viewTransitionContainer,transKey:Le,ownerState:Fn,children:e.jsxs("div",{children:[Le==="year"&&e.jsx(gT,be({},Xo,Jo,{value:le,onChange:$e,shouldDisableYear:L,hasFocus:mt,onFocusedViewChange:hn=>fe("year",hn),yearsPerRow:Z,referenceDate:Ve})),Le==="month"&&e.jsx(sT,be({},Xo,Jo,{hasFocus:mt,className:I,value:le,onChange:ke,shouldDisableMonth:A,onFocusedViewChange:hn=>fe("month",hn),monthsPerRow:J,referenceDate:Ve})),Le==="day"&&e.jsx(IS,be({},Re,Xo,Jo,{onMonthSwitchingAnimationEnd:Qt,onFocusedDayChange:xe,reduceAnimations:C,selectedDays:Ex,onSelectedDaysChange:Qe,shouldDisableDate:k,shouldDisableMonth:A,shouldDisableYear:L,hasFocus:mt,onFocusedViewChange:hn=>fe("day",hn),showDaysOutsideCurrentMonth:$,fixedWeekNumber:Y,dayOfWeekFormatter:_,displayWeekNumber:Q,components:K,componentsProps:X,slots:ne,slotProps:oe,loading:ee,renderLoading:H}))]})})]}))}),ma=({view:r,onViewChange:t,views:n,focusedView:s,onFocusedViewChange:a,value:i,defaultValue:o,referenceDate:d,onChange:u,className:h,classes:m,disableFuture:x,disablePast:g,minDate:f,maxDate:y,shouldDisableDate:j,shouldDisableMonth:b,shouldDisableYear:v,reduceAnimations:P,onMonthChange:w,monthsPerRow:C,onYearChange:k,yearsPerRow:A,defaultCalendarMonth:L,components:T,componentsProps:M,slots:O,slotProps:I,loading:z,renderLoading:N,disableHighlightToday:E,readOnly:R,disabled:V,showDaysOutsideCurrentMonth:F,dayOfWeekFormatter:B,sx:$,autoFocus:Y,fixedWeekNumber:_,displayWeekNumber:K,timezone:X})=>e.jsx(ET,{view:r,onViewChange:t,views:n.filter(cu),focusedView:s&&cu(s)?s:null,onFocusedViewChange:a,value:i,defaultValue:o,referenceDate:d,onChange:u,className:h,classes:m,disableFuture:x,disablePast:g,minDate:f,maxDate:y,shouldDisableDate:j,shouldDisableMonth:b,shouldDisableYear:v,reduceAnimations:P,onMonthChange:w,monthsPerRow:C,onYearChange:k,yearsPerRow:A,defaultCalendarMonth:L,components:T,componentsProps:M,slots:O,slotProps:I,loading:z,renderLoading:N,disableHighlightToday:E,readOnly:R,disabled:V,showDaysOutsideCurrentMonth:F,dayOfWeekFormatter:B,sx:$,autoFocus:Y,fixedWeekNumber:_,displayWeekNumber:K,timezone:X}),_m=p.forwardRef(function(t,n){var s,a,i,o;const d=Ds(),u=tn(),h=Am(t,"MuiDesktopDatePicker"),m=be({day:ma,month:ma,year:ma},h.viewRenderers),x=be({},h,{viewRenderers:m,format:$c(u,h,!1),yearsPerRow:(s=h.yearsPerRow)!=null?s:4,slots:be({openPickerIcon:Z1,field:Bm},h.slots),slotProps:be({},h.slotProps,{field:f=>{var y;return be({},Oc((y=h.slotProps)==null?void 0:y.field,f),zm(h),{ref:n})},toolbar:be({hidden:!0},(a=h.slotProps)==null?void 0:a.toolbar)})}),{renderPicker:g}=WS({props:x,valueManager:os,valueType:"date",getOpenDialogAriaText:(i=(o=x.localeText)==null?void 0:o.openDatePickerDialogue)!=null?i:d.openDatePickerDialogue,validator:_o});return g()});_m.propTypes={autoFocus:ge.bool,className:ge.string,closeOnSelect:ge.bool,components:ge.object,componentsProps:ge.object,dayOfWeekFormatter:ge.func,defaultCalendarMonth:ge.any,defaultValue:ge.any,disabled:ge.bool,disableFuture:ge.bool,disableHighlightToday:ge.bool,disableOpenPicker:ge.bool,disablePast:ge.bool,displayWeekNumber:ge.bool,fixedWeekNumber:ge.number,format:ge.string,formatDensity:ge.oneOf(["dense","spacious"]),inputRef:Bu,label:ge.node,loading:ge.bool,localeText:ge.object,maxDate:ge.any,minDate:ge.any,monthsPerRow:ge.oneOf([3,4]),name:ge.string,onAccept:ge.func,onChange:ge.func,onClose:ge.func,onError:ge.func,onMonthChange:ge.func,onOpen:ge.func,onSelectedSectionsChange:ge.func,onViewChange:ge.func,onYearChange:ge.func,open:ge.bool,openTo:ge.oneOf(["day","month","year"]),orientation:ge.oneOf(["landscape","portrait"]),readOnly:ge.bool,reduceAnimations:ge.bool,referenceDate:ge.any,renderLoading:ge.func,selectedSections:ge.oneOfType([ge.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),ge.number,ge.shape({endIndex:ge.number.isRequired,startIndex:ge.number.isRequired})]),shouldDisableDate:ge.func,shouldDisableMonth:ge.func,shouldDisableYear:ge.func,showDaysOutsideCurrentMonth:ge.bool,slotProps:ge.object,slots:ge.object,sx:ge.oneOfType([ge.arrayOf(ge.oneOfType([ge.func,ge.object,ge.bool])),ge.func,ge.object]),timezone:ge.string,value:ge.any,view:ge.oneOf(["day","month","year"]),viewRenderers:ge.shape({day:ge.func,month:ge.func,year:ge.func}),views:ge.arrayOf(ge.oneOf(["day","month","year"]).isRequired),yearsPerRow:ge.oneOf([3,4])};const WT=["props","getOpenDialogAriaText"],FT=r=>{var t,n,s;let{props:a,getOpenDialogAriaText:i}=r,o=Ot(r,WT);const{slots:d,slotProps:u,className:h,sx:m,format:x,formatDensity:g,timezone:f,name:y,label:j,inputRef:b,readOnly:v,disabled:P,localeText:w}=a,C=tn(),k=p.useRef(null),A=mc(),L=(t=u==null||(n=u.toolbar)==null?void 0:n.hidden)!=null?t:!1,{open:T,actions:M,layoutProps:O,renderCurrentView:I,fieldProps:z}=Nm(be({},o,{props:a,inputRef:k,autoFocusView:!0,additionalViewProps:{},wrapperVariant:"mobile"})),N=d.field,E=Pn({elementType:N,externalSlotProps:u==null?void 0:u.field,additionalProps:be({},z,L&&{id:A},!(P||v)&&{onClick:M.onOpen,onKeyDown:pw(M.onOpen)},{readOnly:v??!0,disabled:P,className:h,sx:m,format:x,formatDensity:g,timezone:f,label:j,name:y}),ownerState:a});E.inputProps=be({},E.inputProps,{"aria-label":i(z.value,C)});const R=be({textField:d.textField},E.slots),V=(s=d.layout)!=null?s:Wm,F=Vs(k,E.inputRef,b);let B=A;L&&(j?B=`${A}-label`:B=void 0);const $=be({},u,{toolbar:be({},u==null?void 0:u.toolbar,{titleId:A}),mobilePaper:be({"aria-labelledby":B},u==null?void 0:u.mobilePaper)});return{renderPicker:()=>e.jsxs(hr,{localeText:w,children:[e.jsx(N,be({},E,{slots:R,slotProps:$,inputRef:F})),e.jsx(hw,be({},M,{open:T,slots:d,slotProps:$,children:e.jsx(V,be({},O,$==null?void 0:$.layout,{slots:d,slotProps:$,children:I()}))}))]})}},Ym=p.forwardRef(function(t,n){var s,a,i;const o=Ds(),d=tn(),u=Am(t,"MuiMobileDatePicker"),h=be({day:ma,month:ma,year:ma},u.viewRenderers),m=be({},u,{viewRenderers:h,format:$c(d,u,!1),slots:be({field:Bm},u.slots),slotProps:be({},u.slotProps,{field:g=>{var f;return be({},Oc((f=u.slotProps)==null?void 0:f.field,g),zm(u),{ref:n})},toolbar:be({hidden:!1},(s=u.slotProps)==null?void 0:s.toolbar)})}),{renderPicker:x}=FT({props:m,valueManager:os,valueType:"date",getOpenDialogAriaText:(a=(i=m.localeText)==null?void 0:i.openDatePickerDialogue)!=null?a:o.openDatePickerDialogue,validator:_o});return x()});Ym.propTypes={autoFocus:ge.bool,className:ge.string,closeOnSelect:ge.bool,components:ge.object,componentsProps:ge.object,dayOfWeekFormatter:ge.func,defaultCalendarMonth:ge.any,defaultValue:ge.any,disabled:ge.bool,disableFuture:ge.bool,disableHighlightToday:ge.bool,disableOpenPicker:ge.bool,disablePast:ge.bool,displayWeekNumber:ge.bool,fixedWeekNumber:ge.number,format:ge.string,formatDensity:ge.oneOf(["dense","spacious"]),inputRef:Bu,label:ge.node,loading:ge.bool,localeText:ge.object,maxDate:ge.any,minDate:ge.any,monthsPerRow:ge.oneOf([3,4]),name:ge.string,onAccept:ge.func,onChange:ge.func,onClose:ge.func,onError:ge.func,onMonthChange:ge.func,onOpen:ge.func,onSelectedSectionsChange:ge.func,onViewChange:ge.func,onYearChange:ge.func,open:ge.bool,openTo:ge.oneOf(["day","month","year"]),orientation:ge.oneOf(["landscape","portrait"]),readOnly:ge.bool,reduceAnimations:ge.bool,referenceDate:ge.any,renderLoading:ge.func,selectedSections:ge.oneOfType([ge.oneOf(["all","day","hours","meridiem","minutes","month","seconds","weekDay","year"]),ge.number,ge.shape({endIndex:ge.number.isRequired,startIndex:ge.number.isRequired})]),shouldDisableDate:ge.func,shouldDisableMonth:ge.func,shouldDisableYear:ge.func,showDaysOutsideCurrentMonth:ge.bool,slotProps:ge.object,slots:ge.object,sx:ge.oneOfType([ge.arrayOf(ge.oneOfType([ge.func,ge.object,ge.bool])),ge.func,ge.object]),timezone:ge.string,value:ge.any,view:ge.oneOf(["day","month","year"]),viewRenderers:ge.shape({day:ge.func,month:ge.func,year:ge.func}),views:ge.arrayOf(ge.oneOf(["day","month","year"]).isRequired),yearsPerRow:ge.oneOf([3,4])};const zT=["desktopModeMediaQuery"],ls=p.forwardRef(function(t,n){const s=Rn({props:t,name:"MuiDatePicker"}),{desktopModeMediaQuery:a=gw}=s,i=Ot(s,zT);return Nt(a,{defaultMatches:!0})?e.jsx(_m,be({ref:n},i)):e.jsx(Ym,be({ref:n},i))});var ic={exports:{}};(function(r,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(u,h){switch(u){case"P":return h.date({width:"short"});case"PP":return h.date({width:"medium"});case"PPP":return h.date({width:"long"});case"PPPP":default:return h.date({width:"full"})}},s=function(u,h){switch(u){case"p":return h.time({width:"short"});case"pp":return h.time({width:"medium"});case"ppp":return h.time({width:"long"});case"pppp":default:return h.time({width:"full"})}},a=function(u,h){var m=u.match(/(P+)(p+)?/)||[],x=m[1],g=m[2];if(!g)return n(u,h);var f;switch(x){case"P":f=h.dateTime({width:"short"});break;case"PP":f=h.dateTime({width:"medium"});break;case"PPP":f=h.dateTime({width:"long"});break;case"PPPP":default:f=h.dateTime({width:"full"});break}return f.replace("{{date}}",n(x,h)).replace("{{time}}",s(g,h))},i={p:s,P:a},o=i;t.default=o,r.exports=t.default})(ic,ic.exports);var OT=ic.exports;const VT=th(OT),$T={y:{sectionType:"year",contentType:"digit",maxLength:4},yy:"year",yyy:{sectionType:"year",contentType:"digit",maxLength:4},yyyy:"year",M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMMM:{sectionType:"month",contentType:"letter"},MMM:{sectionType:"month",contentType:"letter"},L:{sectionType:"month",contentType:"digit",maxLength:2},LL:"month",LLL:{sectionType:"month",contentType:"letter"},LLLL:{sectionType:"month",contentType:"letter"},d:{sectionType:"day",contentType:"digit",maxLength:2},dd:"day",do:{sectionType:"day",contentType:"digit-with-letter"},E:{sectionType:"weekDay",contentType:"letter"},EE:{sectionType:"weekDay",contentType:"letter"},EEE:{sectionType:"weekDay",contentType:"letter"},EEEE:{sectionType:"weekDay",contentType:"letter"},EEEEE:{sectionType:"weekDay",contentType:"letter"},i:{sectionType:"weekDay",contentType:"digit",maxLength:1},ii:"weekDay",iii:{sectionType:"weekDay",contentType:"letter"},iiii:{sectionType:"weekDay",contentType:"letter"},e:{sectionType:"weekDay",contentType:"digit",maxLength:1},ee:"weekDay",eee:{sectionType:"weekDay",contentType:"letter"},eeee:{sectionType:"weekDay",contentType:"letter"},eeeee:{sectionType:"weekDay",contentType:"letter"},eeeeee:{sectionType:"weekDay",contentType:"letter"},c:{sectionType:"weekDay",contentType:"digit",maxLength:1},cc:"weekDay",ccc:{sectionType:"weekDay",contentType:"letter"},cccc:{sectionType:"weekDay",contentType:"letter"},ccccc:{sectionType:"weekDay",contentType:"letter"},cccccc:{sectionType:"weekDay",contentType:"letter"},a:"meridiem",aa:"meridiem",aaa:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},HT={year:"yyyy",month:"LLLL",monthShort:"MMM",dayOfMonth:"d",weekday:"EEEE",weekdayShort:"EEEEEE",hours24h:"HH",hours12h:"hh",meridiem:"aa",minutes:"mm",seconds:"ss",fullDate:"PP",fullDateWithWeekday:"PPPP",keyboardDate:"P",shortDate:"MMM d",normalDate:"d MMMM",normalDateWithWeekday:"EEE, MMM d",monthAndYear:"LLLL yyyy",monthAndDate:"MMMM d",fullTime:"p",fullTime12h:"hh:mm aa",fullTime24h:"HH:mm",fullDateTime:"PP p",fullDateTime12h:"PP hh:mm aa",fullDateTime24h:"PP HH:mm",keyboardDateTime:"P p",keyboardDateTime12h:"P hh:mm aa",keyboardDateTime24h:"P HH:mm"};class BT{constructor(t){this.isMUIAdapter=!0,this.isTimezoneCompatible=!1,this.lib="date-fns",this.locale=void 0,this.formats=void 0,this.formatTokenMap=$T,this.escapedCharacters={start:"'",end:"'"},this.longFormatters=void 0,this.date=i=>typeof i>"u"?new Date:i===null?null:new Date(i),this.dateWithTimezone=i=>this.date(i),this.getTimezone=()=>"default",this.setTimezone=i=>i,this.toJsDate=i=>i,this.getCurrentLocaleCode=()=>{var i;return((i=this.locale)==null?void 0:i.code)||"en-US"},this.is12HourCycleInCurrentLocale=()=>this.locale?/a/.test(this.locale.formatLong.time({width:"short"})):!0,this.expandFormat=i=>{const o=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;return i.match(o).map(d=>{const u=d[0];if(u==="p"||u==="P"){const h=this.longFormatters[u];return h(d,this.locale.formatLong)}return d}).join("")},this.getFormatHelperText=i=>this.expandFormat(i).replace(/(aaa|aa|a)/g,"(a|p)m").toLocaleLowerCase(),this.isNull=i=>i===null,this.formatNumber=i=>i,this.getMeridiemText=i=>i==="am"?"AM":"PM";const{locale:n,formats:s,longFormatters:a}=t;this.locale=n,this.formats=be({},HT,s),this.longFormatters=a}}class Ar extends BT{constructor({locale:t,formats:n}={}){if(typeof Bi!="function")throw new Error(["MUI: The `date-fns` package v3.x is not compatible with this adapter.","Please, install v2.x of the package or use the `AdapterDateFnsV3` instead."].join(`
`));super({locale:t??Tc,formats:n,longFormatters:VT}),this.parseISO=s=>_r(s),this.toISO=s=>C0(s,{format:"extended"}),this.parse=(s,a)=>s===""?null:Ny(s,a,new Date,{locale:this.locale}),this.isValid=s=>ph(this.date(s)),this.format=(s,a)=>this.formatByString(s,this.formats[a]),this.formatByString=(s,a)=>fn(s,a,{locale:this.locale}),this.getDiff=(s,a,i)=>{switch(i){case"years":return Af(s,this.date(a));case"quarters":return kf(s,this.date(a));case"months":return fh(s,this.date(a));case"weeks":return Df(s,this.date(a));case"days":return gh(s,this.date(a));case"hours":return Sf(s,this.date(a));case"minutes":return Tf(s,this.date(a));case"seconds":return Pf(s,this.date(a));default:return Ro(s,this.date(a))}},this.isEqual=(s,a)=>s===null&&a===null?!0:F0(s,a),this.isSameYear=(s,a)=>Fy(s,a),this.isSameMonth=(s,a)=>Wy(s,a),this.isSameDay=(s,a)=>yf(s,a),this.isSameHour=(s,a)=>Ey(s,a),this.isAfter=(s,a)=>dl(s,a),this.isAfterYear=(s,a)=>dl(s,ll(a)),this.isAfterDay=(s,a)=>dl(s,Hl(a)),this.isBefore=(s,a)=>Ea(s,a),this.isBeforeYear=(s,a)=>Ea(s,ki(a)),this.isBeforeDay=(s,a)=>Ea(s,Sa(a)),this.isWithinRange=(s,[a,i])=>zy(s,{start:a,end:i}),this.startOfYear=s=>ki(s),this.startOfMonth=s=>kd(s),this.startOfWeek=s=>Ws(s,{locale:this.locale}),this.startOfDay=s=>Sa(s),this.endOfYear=s=>ll(s),this.endOfMonth=s=>Bl(s),this.endOfWeek=s=>cl(s,{locale:this.locale}),this.endOfDay=s=>Hl(s),this.addYears=(s,a)=>Sd(s,a),this.addMonths=(s,a)=>Ui(s,a),this.addWeeks=(s,a)=>gf(s,a),this.addDays=(s,a)=>Bi(s,a),this.addHours=(s,a)=>cf(s,a),this.addMinutes=(s,a)=>xf(s,a),this.addSeconds=(s,a)=>pf(s,a),this.getYear=s=>W0(s),this.getMonth=s=>I0(s),this.getDate=s=>k0(s),this.getHours=s=>P0(s),this.getMinutes=s=>A0(s),this.getSeconds=s=>R0(s),this.getMilliseconds=s=>D0(s),this.setYear=(s,a)=>ib(s,a),this.setMonth=(s,a)=>eb(s,a),this.setDate=(s,a)=>tb(s,a),this.setHours=(s,a)=>nb(s,a),this.setMinutes=(s,a)=>sb(s,a),this.setSeconds=(s,a)=>ab(s,a),this.setMilliseconds=(s,a)=>rb(s,a),this.getDaysInMonth=s=>kh(s),this.getNextMonth=s=>Ui(s,1),this.getPreviousMonth=s=>Ui(s,-1),this.getMonthArray=s=>{const i=[ki(s)];for(;i.length<12;){const o=i[i.length-1];i.push(this.getNextMonth(o))}return i},this.mergeDateAndTime=(s,a)=>this.setSeconds(this.setMinutes(this.setHours(s,this.getHours(a)),this.getMinutes(a)),this.getSeconds(a)),this.getWeekdays=()=>{const s=new Date;return If({start:Ws(s,{locale:this.locale}),end:cl(s,{locale:this.locale})}).map(a=>this.formatByString(a,"EEEEEE"))},this.getWeekArray=s=>{const a=Ws(kd(s),{locale:this.locale}),i=cl(Bl(s),{locale:this.locale});let o=0,d=a;const u=[];for(;Ea(d,i);){const h=Math.floor(o/7);u[h]=u[h]||[],u[h].push(d),d=Bi(d,1),o+=1}return u},this.getWeekNumber=s=>E0(s,{locale:this.locale}),this.getYearRange=(s,a)=>{const i=ki(s),o=ll(a),d=[];let u=i;for(;Ea(u,o);)d.push(u),u=Sd(u,1);return d}}}class UT{constructor(){}async makeRequest(t,n,s){try{return(await q.api.request({method:t,url:n,data:s})).data}catch(a){throw this.handleServiceError(a)}}async createAsset(t,n){return this.makeRequest("POST",`/api/v1/assets?accountId=${n}`,t)}async bulkCreateAssets(t,n){return this.makeRequest("POST",`/api/v1/assets/bulk-create?accountId=${n}`,{globalAssetIds:t})}async getAssets(t={},n){const s=new URLSearchParams;s.append("accountId",n),Object.entries(t).forEach(([i,o])=>{o!=null&&o!==""&&s.append(i,o.toString())});const a=`/api/v1/assets?${s.toString()}`;return this.makeRequest("GET",a)}async getAssetById(t){return this.makeRequest("GET",`/api/v1/assets/${t}`)}async updateAsset(t,n,s){return await this.makeRequest("PUT",`/api/v1/assets/${t}?accountId=${s}`,n)}async deleteAsset(t,n){await this.makeRequest("DELETE",`/api/v1/assets/${t}?accountId=${n}`)}async getAssetsByPortfolio(t,n={}){const s=new URLSearchParams;Object.entries(n).forEach(([i,o])=>{o!=null&&o!==""&&s.append(i,o.toString())});const a=`/api/v1/assets/portfolio/${t}?${s.toString()}`;return this.makeRequest("GET",a)}async searchAssets(t,n){const s=new URLSearchParams;s.append("q",t),n&&s.append("portfolioId",n);const a=`/api/v1/assets/search?${s.toString()}`;return(await this.makeRequest("GET",a)).data}async getAssetStatistics(t){return(await this.makeRequest("GET",`/api/v1/assets/portfolio/${t}/statistics`)).data}async getAssetAnalytics(t){return(await this.makeRequest("GET",`/api/v1/assets/portfolio/${t}/analytics`)).data}async getAssetPerformance(t,n="ALL"){const s=new URLSearchParams;s.append("period",n);const a=`/api/v1/assets/portfolio/${t}/performance?${s.toString()}`;return(await this.makeRequest("GET",a)).data}async getAssetAllocation(t){return(await this.makeRequest("GET",`/api/v1/assets/portfolio/${t}/allocation`)).data}async getAssetTypes(){return(await this.makeRequest("GET","/api/v1/assets/types")).types}async getAssetRiskMetrics(t){return(await this.makeRequest("GET",`/api/v1/assets/portfolio/${t}/risk`)).data}async getRecentAssets(t,n){const s=new URLSearchParams;t&&s.append("limit",t.toString()),n&&s.append("portfolioId",n);const a=`/api/v1/assets/recent?${s.toString()}`;return(await this.makeRequest("GET",a)).data}async getAssetsByValueRange(t,n,s){const a=new URLSearchParams;a.append("minValue",t.toString()),a.append("maxValue",n.toString()),s&&a.append("portfolioId",s);const i=`/api/v1/assets/value-range?${a.toString()}`;return(await this.makeRequest("GET",i)).data}async checkAssetExists(t){return(await this.makeRequest("GET",`/api/v1/assets/${t}/exists`)).data.exists}async getAssetCount(t){return(await this.makeRequest("GET",`/api/v1/assets/portfolio/${t}/count`)).data.count}async getTradeCount(t){return await this.makeRequest("GET",`/api/v1/assets/${t}/trades/count`)}async getAssetPortfolioInfo(t,n){try{const s=await this.makeRequest("GET",`/api/v1/assets/${t}/trades/count?accountId=${n}`);return{portfolios:s.portfolios||[],tradingCount:s.count||0}}catch(s){return console.error("Error getting asset portfolio info:",s),{portfolios:[],tradingCount:0}}}async deleteAllTrades(t){return(await this.makeRequest("DELETE",`/api/v1/assets/${t}/trades`)).deletedCount}async forceDeleteAsset(t){await this.makeRequest("DELETE",`/api/v1/assets/${t}/force`)}handleServiceError(t){return t instanceof Error?{message:t.message,status:0,code:"NETWORK_ERROR"}:t}}const vs=new UT;function qm(r,t){return!r||r===0?0:(t-r)/r*100}function Gm(r){const{initialValue:t,currentValue:n,createdAt:s}=r,a=new Date(s),i=new Date,o=qm(t,n),d=Math.max(1,Math.floor((i.getTime()-a.getTime())/(1e3*60*60*24))),u=ws(o,d,1),h=ws(o,d,7),m=ws(o,d,30),x=ws(o,d,365);return{daily:Math.round(u*100)/100,weekly:Math.round(h*100)/100,monthly:Math.round(m*100)/100,yearly:Math.round(x*100)/100}}function ws(r,t,n){if(t<n)return r;const s=t/n;return r/s}function Ni(r,t){const n=Gm(r),s=YT(t);return{daily:Math.round(n.daily*s.daily*100)/100,weekly:Math.round(n.weekly*s.weekly*100)/100,monthly:Math.round(n.monthly*s.monthly*100)/100,yearly:Math.round(n.yearly*s.yearly*100)/100}}function _T(r){return{GOLD:.8,VFF:1.2,VESAF:1.1,SSISCA:1,HPG:1.3,VCB:.9}[r.toUpperCase()]||1}function YT(r){const t=_T(r),n=new Date,s=n.getHours(),a=n.getDay(),i=s>=9&&s<=15?1+(t-1)*.5:.8,o=a>=1&&a<=5?1+(t-1)*.3:.9,d=1+(t-1)*.2,u=1+(t-1)*.1;return{daily:i,weekly:o,monthly:d,yearly:u}}function Li(r,t){if(!t||t.length===0)return Gm(r);const{currentValue:n}=r,s=t.filter(m=>m.side==="BUY").reduce((m,x)=>m+x.quantity*x.price,0),a=t.filter(m=>m.side==="SELL").reduce((m,x)=>m+x.quantity*x.price,0),i=s-a,o=qm(i,n),d=new Date(r.createdAt),h=Math.max(1,Math.floor((new Date().getTime()-d.getTime())/(1e3*60*60*24)));return{daily:ws(o,h,1),weekly:ws(o,h,7),monthly:ws(o,h,30),yearly:ws(o,h,365)}}const Yc=(r={})=>{const{initialFilters:t={},autoFetch:n=!0}=r,{accountId:s}=Ge(),[a,i]=p.useState([]),[o,d]=p.useState(!1),[u,h]=p.useState(null),m=()=>{try{const I=localStorage.getItem("assets-filters");if(I){const z=JSON.parse(I);if(z.createdBy===s)return z}}catch(I){console.warn("Failed to load stored filters:",I)}return{}},[x,g]=p.useState({createdBy:s,search:"",type:void 0,minValue:void 0,maxValue:void 0,limit:10,page:1,sortBy:"name",sortOrder:"ASC",...m(),...t}),[f,y]=p.useState({page:1,limit:10,total:0,totalPages:0}),j=p.useCallback(async I=>{d(!0),h(null);try{const N=await vs.getAssets(I,s),E=R=>{const V={initialValue:R.initialValue||0,currentValue:R.currentQuantity&&R.currentPrice?R.currentQuantity*R.currentPrice:0,createdAt:R.createdAt,updatedAt:R.updatedAt};let F;return R.trades&&R.trades.length>0?F=Li(V,R.trades):F=Ni(V,R.symbol),{...R,createdAt:R.createdAt,updatedAt:R.updatedAt,isActive:R.isActive??!0,initialValue:R.initialValue,initialQuantity:R.initialQuantity,currentValue:R.currentQuantity&&R.currentPrice?R.currentQuantity*R.currentPrice:0,currentQuantity:R.currentQuantity,hasTrades:R.hasTrades,displayName:R.displayName,totalValue:R.totalValue||(R.currentQuantity&&R.currentPrice?R.currentQuantity*R.currentPrice:0),totalQuantity:R.totalQuantity||R.currentQuantity||0,currentPrice:R.currentPrice||0,avgCost:R.avgCost||0,quantity:R.hasTrades?R.currentQuantity||0:R.initialQuantity||0,performance:F}};if(Array.isArray(N)){const R=N.map(E);i(R),y({page:1,limit:R.length,total:R.length,totalPages:1})}else{const R=(N.data||[]).map(E);i(R);const V=N.total||0,F=N.limit||10,B=Math.ceil(V/F),$={page:N.page||I.page||1,limit:F,total:V,totalPages:B};y($)}}catch(z){console.error("Error fetching assets:",z),h(z instanceof Error?z.message:"Failed to fetch assets"),i([]),y({page:1,limit:10,total:0,totalPages:0})}finally{d(!1)}},[s]),b=p.useCallback(I=>{g(I);try{localStorage.setItem("assets-filters",JSON.stringify(I))}catch(z){console.warn("Failed to save filters to localStorage:",z)}n&&j(I)},[n,j,x]),v=p.useCallback((I,z)=>{const N={...x,[I]:z};b(N)},[x,b]),P=p.useCallback(()=>{b({createdBy:s,portfolioId:void 0,search:"",type:void 0,minValue:void 0,maxValue:void 0,limit:10,page:1,sortBy:"name",sortOrder:"ASC"})},[b,s]),w=p.useCallback(()=>{j(x)},[x,j]),C=p.useCallback(async()=>{d(!0),h(null);try{await j(x)}catch(I){console.error("forceRefresh error:",I);const z=I instanceof Error?I.message:"Failed to refresh assets";h(z)}finally{d(!1)}},[x,j]),k=p.useCallback(I=>{const z={...x,page:I};b(z)},[x,b]),A=p.useCallback(I=>{const z={...x,limit:I,page:1};b(z)},[x,b]),L=p.useCallback((I,z)=>{const N={...x,sortBy:I,sortOrder:z};b(N)},[x,b]),T=p.useCallback(async(I,z)=>{try{d(!0),h(null);const N={...z},E=await vs.updateAsset(I,N,s),R={initialValue:E.initialValue||0,currentValue:E.currentQuantity&&E.currentPrice?E.currentQuantity*E.currentPrice:0,createdAt:E.createdAt,updatedAt:E.updatedAt};let V;E.trades&&E.trades.length>0?V=Li(R,E.trades):V=Ni(R,E.symbol);const F={...E,totalValue:E.totalValue||(E.currentQuantity&&E.currentPrice?E.currentQuantity*E.currentPrice:0),totalQuantity:E.totalQuantity||E.currentQuantity||0,quantity:E.hasTrades?E.currentQuantity||0:E.initialQuantity||0,performance:V};return i(B=>B.map(Y=>Y.id===I?{...Y,...F}:Y)),F}catch(N){console.error("Error in updateAsset:",N);const E=N instanceof Error?N.message:"Failed to update asset";throw h(E),N}finally{d(!1)}},[]),M=p.useCallback(async I=>{try{d(!0),h(null);const z=await vs.createAsset(I,s),N={initialValue:z.initialValue||0,currentValue:z.currentQuantity&&z.currentPrice?z.currentQuantity*z.currentPrice:0,createdAt:z.createdAt,updatedAt:z.updatedAt};let E;z.trades&&z.trades.length>0?E=Li(N,z.trades):E=Ni(N,z.symbol);const R={...z,totalValue:z.totalValue||(z.currentQuantity&&z.currentPrice?z.currentQuantity*z.currentPrice:0),totalQuantity:z.totalQuantity||z.currentQuantity||0,quantity:z.hasTrades?z.currentQuantity||0:z.initialQuantity||0,performance:E};return i(V=>[R,...V]),R}catch(z){const N=z instanceof Error?z.message:"Failed to create asset";throw h(N),z}finally{d(!1)}},[]),O=p.useCallback(async I=>{try{d(!0),h(null),await vs.deleteAsset(I,s),i(z=>z.filter(N=>N.id!==I)),y(z=>({...z,total:Math.max(0,z.total-1)}))}catch(z){const N=z instanceof Error?z.message:"Failed to delete asset";throw h(N),z}finally{d(!1)}},[x,j]);return p.useEffect(()=>{s&&x.createdBy!==s&&g(I=>({...I,createdBy:s}))},[s]),p.useEffect(()=>{n&&j(x)},[n,j,x]),p.useEffect(()=>{const I=setInterval(()=>{if(a.length>0){const z=a.map(N=>{const E={initialValue:N.initialValue||0,currentValue:N.currentQuantity&&N.currentPrice?N.currentQuantity*N.currentPrice:0,createdAt:N.createdAt,updatedAt:N.updatedAt};let R;return N.trades&&N.trades.length>0?R=Li(E,N.trades):R=Ni(E,N.symbol),{...N,totalValue:N.totalValue||(N.currentQuantity&&N.currentPrice?N.currentQuantity*N.currentPrice:0),totalQuantity:N.totalQuantity||N.currentQuantity||0,quantity:N.hasTrades?N.currentQuantity||0:N.initialQuantity||0,performance:R}});i(z)}},3e5);return()=>clearInterval(I)},[a]),{assets:a,loading:o,error:u,filters:x,pagination:f,setFilters:b,updateFilter:v,clearFilters:P,refresh:w,forceRefresh:C,goToPage:k,setPageSize:A,setSorting:L,updateAsset:T,createAsset:M,deleteAsset:O}},qT=({value:r,onChange:t,error:n=!1,helperText:s,disabled:a=!1,placeholder:i,label:o,required:d=!1,showCreateOption:u=!0,onCreateAsset:h,currency:m="VND"})=>{const{t:x}=Ne(),{accountId:g}=Ge(),[f,y]=p.useState(""),[j,b]=p.useState(null),[v,P]=p.useState(!1),[w,C]=p.useState(!1),k=p.useRef(r),A=p.useRef(null),L=p.useRef(!1),T=p.useRef(""),{assets:M,loading:O,error:I,pagination:z,updateFilter:N}=Yc({initialFilters:{createdBy:g,limit:50,page:1,sortBy:"name",sortOrder:"ASC"},autoFetch:!0}),E=p.useRef(N);E.current=N,p.useEffect(()=>{if(T.current===f)return;L.current||(L.current=!0),T.current=f;const _=setTimeout(()=>{f.trim()===""?(E.current("search",""),E.current("page",1)):(E.current("search",f),E.current("page",1))},300);return()=>clearTimeout(_)},[f]),p.useEffect(()=>{P(z.page<z.totalPages)},[z]),p.useEffect(()=>{f.trim()===""&&P(z.page<z.totalPages)},[f,z]),p.useEffect(()=>{var _;if(k.current!==r)if(k.current=r,r&&M.length>0){const K=M.find(X=>X.id===r);K&&K.id!==((_=A.current)==null?void 0:_.id)&&(b(K),A.current=K)}else!r&&A.current&&(b(null),A.current=null)},[r,M]),p.useEffect(()=>{if(r&&!j&&M.length>0&&!O){const _=M.find(K=>K.id===r);_&&(b(_),A.current=_)}},[r,j,M,O]);const R=p.useCallback(async()=>{if(v&&!w){C(!0);try{E.current("page",z.page+1)}finally{C(!1)}}},[v,w,z.page]),V=p.useCallback((_,K)=>{(K==null?void 0:K.id)!==(j==null?void 0:j.id)&&(b(K),t((K==null?void 0:K.id)||null))},[t,j==null?void 0:j.id]),F=p.useCallback((_,K)=>{y(K)},[]),B=p.useMemo(()=>({id:"__load_more__",symbol:"",name:x("asset.autocomplete.loadMore"),label:x("asset.autocomplete.loadMore"),type:"LOAD_MORE",currentPrice:0,currentQuantity:0,totalValue:0,unrealizedPl:0,realizedPl:0,performance:0,createdAt:new Date,updatedAt:new Date}),[x]),$=p.useMemo(()=>{const _=M.map(K=>({...K,label:`${K.symbol||"N/A"} - ${K.name}`}));return v&&_.push(B),_},[M,v,B]),Y=p.useCallback(_=>{if(_.id==="__load_more__"){R();return}V(null,_)},[R,V]);return e.jsxs(l,{children:[e.jsx(jo,{value:j,onChange:V,inputValue:f,onInputChange:F,options:$,getOptionLabel:_=>_.label||`${_.symbol||"N/A"} - ${_.name}`,isOptionEqualToValue:(_,K)=>_.id===(K==null?void 0:K.id),loading:O,disabled:a,renderInput:_=>e.jsx(Ae,{..._,label:d?`${o||x("asset.autocomplete.label")} *`:o||x("asset.autocomplete.label"),placeholder:i||x("asset.autocomplete.placeholder"),error:n,helperText:s,InputProps:{..._.InputProps,endAdornment:e.jsxs(e.Fragment,{children:[O?e.jsx(Ce,{color:"inherit",size:20}):null,_.InputProps.endAdornment]})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}),renderOption:(_,K)=>K.id==="__load_more__"?p.createElement("li",{..._,key:"load-more",style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",cursor:"pointer"},onClick:()=>Y(K)},w?e.jsx(Ce,{size:20}):e.jsx(he,{variant:"text",icon:e.jsx(ln,{}),onClick:()=>Y(K),disabled:w,mobileText:x("asset.autocomplete.loadMore"),desktopText:x("asset.autocomplete.loadMore"),children:x("asset.autocomplete.loadMore")})):p.createElement("li",{..._,key:K.id,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px"}},e.jsxs(l,{children:[e.jsx(D,{variant:"body1",fontWeight:"medium",children:K.symbol||"N/A"}),e.jsx(D,{variant:"body2",color:"text.secondary",children:K.name})]}),e.jsxs(l,{display:"flex",flexDirection:"column",alignItems:"flex-end",children:[e.jsx(ce,{label:K.type,size:"small",color:"primary",variant:"outlined"}),K.currentPrice&&K.currentPrice>0&&e.jsx(D,{variant:"caption",color:"text.secondary",sx:{mt:.5},children:G(K.currentPrice,m)})]})),noOptionsText:O?e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"center",py:2,children:[e.jsx(Ce,{size:20}),e.jsx(D,{variant:"body2",sx:{ml:1},children:x("asset.autocomplete.loading")})]}):f?e.jsxs(l,{textAlign:"center",py:2,children:[e.jsx(D,{variant:"body2",color:"text.secondary",children:x("asset.autocomplete.noResults",{searchTerm:f})}),u&&h&&e.jsx(he,{variant:"text",size:"small",onClick:h,icon:e.jsx(ln,{}),mobileText:x("asset.autocomplete.create"),desktopText:x("asset.autocomplete.createNew"),sx:{mt:1},children:x("asset.autocomplete.createNew")})]}):e.jsxs(l,{textAlign:"center",py:2,children:[e.jsx(D,{variant:"body2",color:"text.secondary",children:x("asset.autocomplete.noAssets")}),u&&h&&e.jsx(he,{variant:"text",size:"small",onClick:h,icon:e.jsx(ln,{}),mobileText:x("asset.autocomplete.create"),desktopText:x("asset.autocomplete.createNew"),sx:{mt:1},children:x("asset.autocomplete.createNew")})]}),ListboxProps:{style:{maxHeight:"300px"}}}),I&&e.jsx(je,{severity:"error",sx:{mt:1},children:I}),j&&j.currentPrice&&j.currentPrice>0&&e.jsxs(D,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:[x("asset.autocomplete.currentPrice"),": ",G(j.currentPrice,m)]})]})},GT=()=>{const[r,t]=p.useState([]),[n,s]=p.useState(!0),[a,i]=p.useState(null),o=p.useCallback(async()=>{try{s(!0),i(null);const u=await vs.getAssetTypes();t(u)}catch(u){const h=u instanceof Error?u.message:"Failed to fetch asset types";i(h),console.error("Error fetching asset types:",u)}finally{s(!1)}},[]),d=p.useCallback(async()=>{await o()},[o]);return p.useEffect(()=>{o()},[o]),{assetTypes:r,loading:n,error:a,refresh:d}};class KT{constructor(){zn(this,"baseUrl","/api/v1/global-assets")}async getGlobalAssets(t={}){const n=new URLSearchParams;Object.entries(t).forEach(([a,i])=>{i!=null&&i!==""&&n.append(a,i.toString())});const s=await fetch(`${this.baseUrl}?${n.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error(`Failed to fetch global assets: ${s.statusText}`);return await s.json()}async getGlobalAssetById(t){try{const n=await fetch(`${this.baseUrl}/${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok){if(n.status===404)return null;throw new Error(`Failed to fetch global asset: ${n.statusText}`)}return await n.json()}catch{return null}}async getGlobalAssetBySymbol(t){try{const n=await fetch(`${this.baseUrl}/symbol/${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok){if(n.status===404)return null;throw new Error(`Failed to fetch global asset by symbol: ${n.statusText}`)}return await n.json()}catch{return null}}async getSupportedNations(){const t=await fetch(`${this.baseUrl}/nations/list`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok)throw new Error(`Failed to fetch supported nations: ${t.statusText}`);return await t.json()}async getNationConfig(t){const n=await fetch(`${this.baseUrl}/nations/${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error(`Failed to fetch nation config: ${n.statusText}`);return await n.json()}async validateSymbolFormat(t,n,s){const a=new URLSearchParams({symbol:n,type:s}),i=await fetch(`${this.baseUrl}/nations/${t}/validate-symbol?${a.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error(`Failed to validate symbol format: ${i.statusText}`);return await i.json()}}const Km=new KT,QT=({onSubmit:r,onCancel:t,userId:n,currentUserId:s,globalAsset:a,initialData:i,submitText:o="Create Asset",asset:d,mode:u="create",loading:h=!1,className:m="",standalone:x=!0})=>{var ee;const{t:g}=Ne(),{accountId:f}=Ge(),y=s||n||f,j=u==="edit"||i&&i.symbol,{assetTypes:b,loading:v,error:P}=GT(),[w,C]=p.useState(!0),[k,A]=p.useState(!1),[L,T]=p.useState(null),[M,O]=p.useState([]),I=()=>{a&&(B(H=>({...H,type:a.type||H.type,priceMode:a.priceMode||H.priceMode})),O([]))},z=p.useRef(null),[N,E]=p.useState(!1);p.useEffect(()=>{N&&z.current&&(z.current.focus(),E(!1))},[N]),rt.useEffect(()=>{if(j&&a){const H=a.createdBy===f;C(H)}else if(!j)if(L){const H=L.createdBy===f;C(H)}else C(!0)},[j,a,L,f]),rt.useEffect(()=>{if(j&&d&&a){const H=R(d,a);O(H)}else O([])},[j,d,a]);const R=(H,Q)=>{const Z=[];return Q&&(H.type!==Q.type&&Z.push(`Loi: "${po[H.type]}" khc vi h thng "${po[Q.type]}"`),H.priceMode!==Q.priceMode&&Z.push(`Ch  gi: "${eu[H.priceMode]}" khc vi h thng "${eu[Q.priceMode]}"`)),Z},V=async H=>{if(!H||H.length<3){T(null);return}A(!0),E(!0);try{const Q=await Km.getGlobalAssetBySymbol(H);if(T(Q),Q){B(J=>{var ae,ue;return{...J,name:Q.name||J.name,type:Q.type||J.type,description:Q.description||J.description,priceMode:Q.priceMode||J.priceMode,currentValue:((ae=Q.assetPrice)==null?void 0:ae.currentPrice)||J.currentValue,manualPrice:((ue=Q.assetPrice)==null?void 0:ue.currentPrice)||J.manualPrice}});const Z=Q.createdBy===f;C(Z)}else C(!0)}catch{T(null),C(!0)}finally{A(!1)}},[F,B]=p.useState({name:"",symbol:"",type:((ee=b[0])==null?void 0:ee.value)||Ns.STOCK,description:"",priceMode:ps.AUTOMATIC,manualPrice:void 0,initialValue:void 0,initialQuantity:void 0,currentValue:void 0,currentQuantity:void 0,createdBy:y,updatedBy:y,...i});rt.useEffect(()=>{j&&d&&d.currentPrice&&B(H=>({...H,manualPrice:d.currentPrice}))},[j,d]);const[$,Y]=p.useState({}),_=()=>{var Q,Z;const H={};return(Q=F.name)!=null&&Q.trim()||(H.name=g("asset.form.validation.nameRequired")),!j&&!((Z=F.symbol)!=null&&Z.trim())?H.symbol=g("asset.form.validation.symbolRequired"):!j&&F.symbol&&!/^[A-Z0-9-]+$/.test(F.symbol)&&(H.symbol=g("asset.form.validation.symbolInvalidFormat")),F.type||(H.type=g("asset.form.validation.typeRequired")),F.priceMode||(H.priceMode=g("asset.form.validation.priceModeRequired")),F.priceMode===ps.MANUAL&&(!F.manualPrice||F.manualPrice<=0)&&(H.manualPrice=g("asset.form.validation.manualPriceRequired")),Y(H),Object.keys(H).length===0},K=H=>{H.preventDefault(),_()&&r(F)},X=H=>Q=>{if(H==="initialValue"||H==="initialQuantity"||H==="currentValue"||H==="currentQuantity")return;let Z=Q.target.value;H==="symbol"&&(Z=Z.replace(/[^A-Za-z0-9-]/g,""),Z=Z.toUpperCase()),B(J=>({...J,[H]:Z})),$[H]&&Y(J=>({...J,[H]:""}))},ne=()=>{!j&&F.symbol&&F.symbol.length>=3&&V(F.symbol)},oe=e.jsxs(l,{component:"form",onSubmit:K,sx:{pt:2},children:[e.jsxs(W,{container:!0,spacing:3,children:[!j&&e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(Ae,{ref:z,fullWidth:!0,label:g("asset.form.fields.symbol"),value:F.symbol,onChange:X("symbol"),onBlur:ne,placeholder:g("asset.form.fields.symbolPlaceholder"),error:!!$.symbol,helperText:g(L?"asset.form.fields.symbolFoundInSystem":"asset.form.fields.symbolHelper"),required:!0,disabled:k}),k&&e.jsx(je,{severity:"info",sx:{mt:1},children:g("asset.form.loading.fetchingGlobalAsset")})]}),j&&e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(Ae,{fullWidth:!0,label:g("asset.form.fields.symbol"),value:F.symbol||"",disabled:!0,helperText:g("asset.form.fields.symbolDisabledHelper")})}),j&&M.length>0&&e.jsx(W,{item:!0,xs:12,children:e.jsxs(je,{severity:"warning",sx:{mb:2},children:[e.jsx(l,{sx:{fontWeight:600,mb:1},children:g("asset.form.warning.differencesWithGlobalAsset")}),e.jsx(l,{component:"ul",sx:{margin:0,paddingLeft:2},children:M.map((H,Q)=>e.jsx(l,{component:"li",sx:{fontSize:"0.875rem"},children:H},Q))}),e.jsx(l,{sx:{fontSize:"0.75rem",mt:1,fontStyle:"italic",mb:2},children:g("asset.form.warning.differencesExplanation")}),e.jsx(he,{variant:"outlined",size:"small",onClick:I,sx:{borderColor:"warning.main",color:"warning.main","&:hover":{borderColor:"warning.dark",backgroundColor:"warning.light",color:"warning.dark"}},forceTextOnly:!0,mobileText:g("asset.form.actions.syncWithGlobalAsset"),desktopText:g("asset.form.actions.syncWithGlobalAsset"),children:g("asset.form.actions.syncWithGlobalAsset")})]})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(Ae,{fullWidth:!0,label:g("asset.form.fields.name"),value:F.name,onChange:X("name"),error:!!$.name,helperText:$.name,required:!0})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsxs(nt,{fullWidth:!0,error:!!$.type,children:[e.jsx(st,{children:g("asset.form.fields.type")}),e.jsx(Ze,{value:F.type,onChange:X("type"),label:g("asset.form.fields.type"),disabled:!!(v||!w&&(j||L)),children:v?e.jsxs(re,{disabled:!0,children:[e.jsx(Ce,{size:20,sx:{mr:1}}),g("asset.form.loading.types")]}):P?e.jsx(re,{disabled:!0,children:g("asset.form.error.typesLoadFailed")}):b.map(H=>e.jsx(re,{value:H.value,children:H.label},H.value))}),$.type&&e.jsx(je,{severity:"error",sx:{mt:1},children:$.type}),P&&e.jsx(je,{severity:"warning",sx:{mt:1},children:P})]})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsxs(nt,{fullWidth:!0,error:!!$.priceMode,children:[e.jsx(st,{children:g("asset.form.fields.priceMode")}),e.jsxs(Ze,{value:F.priceMode,onChange:X("priceMode"),label:g("asset.form.fields.priceMode"),disabled:!w||L&&!j,children:[e.jsx(re,{value:ps.AUTOMATIC,children:e.jsxs(l,{children:[e.jsx(l,{sx:{fontWeight:600,fontSize:"0.925rem"},children:g("asset.form.priceMode.automatic")}),e.jsx(l,{sx:{fontSize:"0.75rem",color:"text.secondary"},children:g("asset.form.priceMode.automaticDescription")})]})}),e.jsx(re,{value:ps.MANUAL,children:e.jsxs(l,{children:[e.jsx(l,{sx:{fontWeight:600,fontSize:"0.925rem"},children:g("asset.form.priceMode.manual")}),e.jsx(l,{sx:{fontSize:"0.75rem",color:"text.secondary"},children:g("asset.form.priceMode.manualDescription")})]})})]}),$.priceMode&&e.jsx(je,{severity:"error",sx:{mt:1},children:$.priceMode})]})}),e.jsx(W,{item:!0,xs:12,sm:6,sx:{display:{xs:"none",sm:"block"}},children:e.jsx(Ae,{fullWidth:!0,label:g("asset.form.fields.description"),value:F.description,onChange:X("description"),multiline:!0,rows:1,placeholder:g("asset.form.fields.descriptionPlaceholder")})}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(vr,{value:F.manualPrice||0,onChange:H=>{B(Q=>({...Q,manualPrice:H})),$.manualPrice&&Y(Q=>({...Q,manualPrice:""}))},label:g("asset.form.fields.manualPrice"),placeholder:g("asset.form.fields.manualPricePlaceholder"),helperText:F.priceMode===ps.MANUAL?g("asset.form.fields.manualPriceHelper"):"",error:!!$.manualPrice,currency:"VND",showCurrency:!0,align:"right",disabled:!w||L&&!j}),$.manualPrice&&e.jsx(je,{severity:"error",sx:{mt:1},children:$.manualPrice})]})]}),e.jsxs(l,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:4,pt:2,borderTop:1,borderColor:"divider"},children:[t&&e.jsx(he,{type:"button",variant:"outlined",onClick:t,size:"large",forceTextOnly:!0,mobileText:g("common.cancel"),desktopText:g("common.cancel"),children:g("common.cancel")}),e.jsx(We,{type:"submit",variant:"contained",size:"large",disabled:h,icon:h?e.jsx(Ce,{size:20}):void 0,forceTextOnly:!0,mobileText:h?g("common.processing"):o,desktopText:h?g("common.processing"):o,children:h?g("common.processing"):o})]})]});return x?e.jsxs(se,{sx:{maxWidth:800,mx:"auto"},children:[e.jsx(pa,{title:e.jsx(c,{variant:"h5",component:"h2",children:o}),action:t&&e.jsx(Ie,{onClick:t,"aria-label":"Close form",sx:{color:"text.secondary"},children:e.jsx(sr,{})}),sx:{pb:1}}),e.jsx(bt,{}),e.jsx(me,{children:oe})]}):oe},Qm=({open:r,onClose:t,onSubmit:n,onCancel:s,loading:a=!1,error:i=null,editingAsset:o,globalAsset:d,accountId:u})=>{const{t:h}=Ne(),m=!!o,x=h(m?"asset.modal.editTitle":"asset.modal.createTitle");return e.jsxs(Rt,{open:r,onClose:t,title:x,loading:a,maxWidth:"md",size:"medium",titleColor:"primary",children:[i&&e.jsx(je,{severity:"error",sx:{mb:3,borderRadius:2,"& .MuiAlert-message":{width:"100%"}},children:i}),e.jsx(l,{children:e.jsx(QT,{userId:u,currentUserId:u,globalAsset:d,asset:o||void 0,initialData:o?{name:o.name||"",symbol:o.symbol||"",type:o.type,description:o.description||"",priceMode:o.priceMode||ps.AUTOMATIC,initialValue:o.initialValue||void 0,initialQuantity:o.initialQuantity||void 0,currentValue:o.currentValue||void 0,currentQuantity:o.currentQuantity||void 0,createdBy:o.createdBy||u,updatedBy:o.updatedBy||u}:void 0,submitText:h(m?"asset.modal.updateAsset":"asset.modal.createAsset"),mode:m?"edit":"create",onSubmit:n,onCancel:s,loading:a,standalone:!1})})]})};let Ya=null,oc=null;const XT=r=>{Ya=r},JT=r=>{oc=r},ZT=(r,t="VND")=>r!=null&&r.baseCurrency?r.baseCurrency:Ya!=null&&Ya.baseCurrency?Ya.baseCurrency:oc||t,eC=(r,t)=>{p.useEffect(()=>{XT(r)},[r]),p.useEffect(()=>{JT(null)},[t])};function Wr(r,t={}){const{includeTime:n=!0,output:s}=t;if(typeof r=="string"||r===null||r===void 0){const a=tC(r);return s==="iso"||s==="iso-string"?bu(a,n):a}return r instanceof Date?bu(r,n):new Date}function tC(r){if(!r)return new Date;const t=r.split("T")[0],[n,s,a]=t.split("-").map(Number);if(isNaN(n)||isNaN(s)||isNaN(a)){const o=new Date(r),d=new Date(o.getFullYear(),o.getMonth(),o.getDate());return isNaN(d.getTime())?new Date:d}const i=new Date(n,s-1,a);return isNaN(i.getTime())?new Date:i}function bu(r,t){if(isNaN(r.getTime()))return new Date().toISOString();const n=r.getFullYear(),s=r.getMonth(),a=r.getDate();if(!t)return`${n}-${String(s+1).padStart(2,"0")}-${String(a).padStart(2,"0")}T00:00:00.000Z`;const i=new Date,o=i.getHours(),d=i.getMinutes(),u=i.getSeconds(),h=i.getMilliseconds();return new Date(n,s,a,o,d,u,h).toISOString()}const ju=r=>{const t={};return r.portfolioId||(t.portfolioId="Portfolio is required"),r.assetId||(t.assetId="Asset is required"),r.tradeDate||(t.tradeDate="Trade date is required"),r.side||(t.side="Trade side is required"),(!r.quantity||r.quantity<=0)&&(t.quantity="Quantity must be positive"),(r.price===void 0||r.price===null||r.price<0)&&(t.price="Price must be non-negative"),r.fee&&r.fee<0&&(t.fee="Fee cannot be negative"),r.tax&&r.tax<0&&(t.tax="Tax cannot be negative"),t},Ca=({onSubmit:r,initialData:t,isLoading:n=!1,error:s,mode:a="create",defaultPortfolioId:i,showSubmitButton:o=!0,formRef:d,isModal:u=!1,onAssetCreated:h,open:m,onClose:x,title:g,icon:f,actions:y,maxWidth:j="md",size:b="medium"})=>{const{t:v}=Ne(),{accountId:P,currentAccount:w}=Ge(),{portfolios:C,isLoading:k,error:A}=Un(P),[L,T]=p.useState(!1),[M,O]=p.useState(null),[I,z]=p.useState(!1),[N,E]=p.useState(()=>{const te=t!=null&&t.tradeDate?Wr(t.tradeDate,{output:"iso-string"}):Wr(new Date);return{portfolioId:(t==null?void 0:t.portfolioId)||i||"",assetId:(t==null?void 0:t.assetId)||"",tradeDate:te,side:(t==null?void 0:t.side)||nn.BUY,quantity:(t==null?void 0:t.quantity)||0,price:(t==null?void 0:t.price)||0,fee:(t==null?void 0:t.fee)||0,tax:(t==null?void 0:t.tax)||0,tradeType:(t==null?void 0:t.tradeType)||na.MARKET,source:(t==null?void 0:t.source)||ra.MANUAL,exchange:(t==null?void 0:t.exchange)||"",fundingSource:(t==null?void 0:t.fundingSource)||"",notes:(t==null?void 0:t.notes)||""}}),[R,V]=p.useState({}),[F,B]=p.useState(!1),[$,Y]=p.useState(!1),[_,K]=p.useState(0),[X,ne]=p.useState(!1),[oe,ee]=p.useState(!1),H=N.quantity,Q=N.price,Z=N.fee||0,J=N.tax||0,ae=N.portfolioId,ue=N.side,le=C==null?void 0:C.find(te=>te.portfolioId===ae);eC(w,null);const pe=ZT(le,"VND"),Me=p.useMemo(()=>{const te=Number(H)||0,Ee=Number(Q)||0,Ke=Number(Z)||0,Qt=Number(J)||0,cn=ue,Ut=te*Ee,xr=cn===nn.SELL?Ut-Ke-Qt:Ut+Ke+Qt;return{value:Ut,cost:xr,fee:Ke,tax:Qt}},[H,Q,Z,J,ue]);p.useEffect(()=>{if(t&&a==="edit"){const te=t.tradeDate?Wr(t.tradeDate,{output:"iso"}):Wr(new Date);E({portfolioId:t.portfolioId||"",assetId:t.assetId||"",tradeDate:te,side:t.side||nn.BUY,quantity:t.quantity||0,price:t.price||0,fee:t.fee||0,tax:t.tax||0,tradeType:t.tradeType||na.MARKET,source:t.source||ra.MANUAL,exchange:t.exchange||"",fundingSource:t.fundingSource||"",notes:t.notes||""})}},[t,a]),p.useEffect(()=>{u&&m===!1&&a==="create"&&(E({portfolioId:i||"",assetId:"",tradeDate:Wr(new Date),side:nn.BUY,quantity:0,price:0,fee:0,tax:0,tradeType:na.MARKET,source:ra.MANUAL,exchange:"",fundingSource:"",notes:""}),V({}),B(!1),Y(!1),K(te=>te+1))},[m,u,a,i]),p.useEffect(()=>{i&&i!==N.portfolioId&&E(te=>({...te,portfolioId:i}))},[i]),p.useEffect(()=>{m&&i&&!N.portfolioId&&E(te=>({...te,portfolioId:i}))},[m,i,N.portfolioId]),p.useEffect(()=>{u&&m===!0&&a==="create"&&(E({portfolioId:i||"",assetId:"",tradeDate:new Date().toISOString(),side:nn.BUY,quantity:0,price:0,fee:0,tax:0,tradeType:na.MARKET,source:ra.MANUAL,exchange:"",fundingSource:"",notes:""}),V({}),B(!1),Y(!1),K(te=>te+1))},[m,u,a,i]),p.useEffect(()=>{le&&le.fundingSource&&E(te=>({...te,fundingSource:le.fundingSource||""}))},[le]),p.useEffect(()=>{if(!$||!(N.quantity||N.price))return;const Ee=setTimeout(()=>{const Ke=ju(N);V(Ke),B(Object.keys(Ke).length===0)},300);return()=>clearTimeout(Ee)},[N,$]);const Le=p.useCallback(()=>{const te=ju(N);return V(te),B(Object.keys(te).length===0),Object.keys(te).length===0},[N]);p.useEffect(()=>{t!=null&&t.assetId&&a==="edit"&&_===0&&K(1)},[t==null?void 0:t.assetId,a,_]);const qe=p.useCallback((te,Ee)=>{["tradeDate","side","quantity","price","fee","tax"].includes(te)&&Y(!0),E(Qt=>({...Qt,[te]:Ee}))},[]),de=p.useCallback(async()=>{try{if(!Le()){Y(!0);return}const Ee=Wr(N.tradeDate,{output:"iso-string"}),Ke={portfolioId:N.portfolioId,assetId:N.assetId,tradeDate:Ee,side:N.side,quantity:N.quantity,price:N.price,fee:N.fee||0,tax:N.tax||0,tradeType:N.tradeType||na.MARKET,source:N.source||ra.MANUAL,exchange:N.exchange||"",fundingSource:N.fundingSource||"",notes:N.notes||""};await r(Ke)}catch(te){console.error("Error submitting trade form:",te)}},[N,r,Le]),fe=p.useCallback(()=>{T(!0),O(null)},[]),ie=p.useCallback(()=>{T(!1),O(null),z(!1)},[]),Se=async te=>{z(!0),O(null);try{const Ee=await vs.createAsset(te,P);h&&h(Ee),ie()}catch(Ee){console.error("Error creating asset:",Ee),O(Ee instanceof Error?Ee.message:`An error occurred while creating asset. Asset symbol "${te.symbol}" maybe duplicated or already exists for this user.`)}finally{z(!1)}},Ve=p.useCallback(te=>te===nn.BUY?"success":"error",[]),Re=p.useMemo(()=>e.jsxs(l,{sx:{display:"flex",gap:2},children:[e.jsx(he,{onClick:x,disabled:n,children:v("common.cancel")}),e.jsx(We,{onClick:de,variant:"contained",disabled:n,forceTextOnly:!0,icon:a==="create"?e.jsx(xt,{}):e.jsx(Tt,{}),children:v(n?"trading.form.processing":a==="create"?"common.add":"common.update")})]}),[x,n,a,v,de]),xe=p.useMemo(()=>e.jsxs(hr,{dateAdapter:Ar,children:[s&&e.jsx(je,{severity:"error",sx:{mb:3,borderRadius:2,"& .MuiAlert-message":{width:"100%"}},children:s}),e.jsxs("form",{ref:d,onSubmit:te=>{te.preventDefault(),de()},children:[e.jsxs(l,{mb:u?.5:1.5,mt:u?.5:1.5,children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:1},children:v("trading.form.basicInformation")}),e.jsx(an,{control:e.jsx(jn,{checked:N.side===nn.BUY,onChange:te=>qe("side",te.target.checked?nn.BUY:nn.SELL),color:"primary"}),label:e.jsx(c,{variant:"body2",sx:{fontWeight:500},children:N.side===nn.BUY?v("trading.form.buy"):v("trading.form.sell")}),sx:{ml:1}})]}),e.jsxs(W,{container:!0,spacing:2,children:[(!i||i==="")&&e.jsx(W,{item:!0,xs:12,md:12,children:!(C!=null&&C.length)&&!k?e.jsxs(je,{severity:"info",sx:{mb:2},children:[e.jsx(D,{variant:"body2",sx:{mb:1},children:v("trading.form.noPortfoliosAvailable")}),e.jsx(ut,{variant:"outlined",size:"small",onClick:()=>window.location.href="/portfolios",sx:{mt:1},children:v("trading.form.createPortfolioFirst")})]}):e.jsxs(nt,{fullWidth:!0,error:!!R.portfolioId,disabled:n,required:!0,children:[e.jsxs(st,{id:"portfolio-select-label",children:[v("trading.form.portfolio")," *"]}),e.jsxs(Ze,{labelId:"portfolio-select-label",value:N.portfolioId,onChange:te=>qe("portfolioId",te.target.value),label:`${v("trading.form.portfolio")} *`,sx:{borderRadius:2},children:[e.jsx(re,{value:"",children:e.jsx("em",{children:v("trading.form.selectPortfolio")})}),C==null?void 0:C.map(te=>e.jsx(re,{value:te.portfolioId,children:te.name},te.portfolioId))]})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(qT,{value:N.assetId,onChange:te=>qe("assetId",te||""),error:!!R.assetId,disabled:n,label:v("trading.form.asset"),required:!0,placeholder:v("trading.form.searchAsset"),currency:pe,showCreateOption:!0,onCreateAsset:fe},_)}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(ls,{label:`${v("trading.form.tradeDate")} *`,disabled:n,value:Wr(N.tradeDate),onChange:te=>{try{te&&!isNaN(te.getTime())?qe("tradeDate",Wr(te)):qe("tradeDate",Wr(new Date))}catch{qe("tradeDate",Wr(new Date))}},slotProps:{textField:{fullWidth:!0,error:!!R.tradeDate,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}}})})]})]}),e.jsx(l,{children:e.jsxs(W,{container:!0,spacing:2,sx:{mt:2},children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(gi,{value:N.quantity||0,onChange:te=>qe("quantity",te),label:`${v("trading.form.quantity")} *`,error:!!R.quantity,disabled:n,decimalPlaces:5,min:1e-5,step:1e-5})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(l,{sx:{position:"relative"},children:e.jsx(vr,{value:N.price||0,onChange:te=>qe("price",te),label:`${v("trading.form.pricePerUnit")} (${pe})`,error:!!R.price,disabled:n,currency:pe})})})]})}),e.jsxs(l,{mb:u?.5:1.5,children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",cursor:"pointer",mb:0,mt:1,"&:hover":{bgcolor:"action.hover",borderRadius:1},p:1,borderRadius:1},onClick:()=>ne(!X),children:[e.jsx(c,{variant:"cardLabel",sx:{flexGrow:1,color:"primary.main"},children:v("trading.form.additionalInformation")}),e.jsx(l,{sx:{transform:X?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease-in-out"},children:""})]}),e.jsx(qr,{in:X,timeout:"auto",unmountOnExit:!0,children:e.jsxs(W,{container:!0,spacing:1,sx:{mt:0},children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(vr,{value:N.fee||0,onChange:te=>qe("fee",te),label:`${v("trading.form.tradingFee")} (${pe})`,error:!!R.fee,disabled:n,currency:pe})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(vr,{value:N.tax||0,onChange:te=>qe("tax",te),label:`${v("trading.form.tax")} (${pe})`,error:!!R.tax,disabled:n,currency:pe})})]})})]}),e.jsxs(l,{children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",cursor:"pointer",mb:0,mt:1,"&:hover":{bgcolor:"action.hover",borderRadius:1},p:1,borderRadius:1},onClick:()=>ee(!oe),children:[e.jsx(c,{variant:"cardLabel",sx:{flexGrow:1,color:"primary.main"},children:v("trading.form.exchangeFunding")}),e.jsx(l,{sx:{transform:oe?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease-in-out"},children:""})]}),e.jsx(qr,{in:oe,timeout:"auto",unmountOnExit:!0,children:e.jsxs(W,{container:!0,spacing:1,sx:{mt:0},children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(Ae,{value:N.exchange,onChange:te=>qe("exchange",te.target.value.toUpperCase()),label:v("trading.form.exchangePlatform"),fullWidth:!0,error:!!R.exchange,disabled:n,placeholder:v("trading.form.enterExchangePlatform"),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},inputProps:{style:{textTransform:"uppercase"}}})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(Ae,{value:N.fundingSource,onChange:te=>qe("fundingSource",te.target.value.toUpperCase()),label:v("trading.form.fundingSource"),fullWidth:!0,error:!!R.fundingSource,disabled:n,placeholder:v("trading.form.enterFundingSource"),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}},inputProps:{style:{textTransform:"uppercase"}}})})]})})]}),N.assetId&&N.quantity>0&&N.price>0&&e.jsx(Xr,{in:!0,timeout:600,children:e.jsx(l,{sx:{mt:3},children:e.jsxs(Ki,{variant:"transparent",size:"small",spacing:"none",hoverable:!1,title:v("trading.form.tradeSummary"),children:[e.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"}},children:[e.jsxs(l,{sx:{flex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",py:{xs:1,sm:2},mx:2,borderBottom:1,borderColor:"grey.300"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:0}},children:[e.jsx(mr,{sx:{fontSize:20,color:"info.main",mr:1}}),e.jsx(c,{variant:"body1",fontWeight:500,children:v("trading.form.totalValue")}),e.jsx(c,{variant:"caption",color:"text.secondary",children:"(1)"})]}),e.jsx(c,{variant:"h6",fontWeight:600,color:"info.main",children:G(Me.value,pe)})]}),e.jsxs(l,{sx:{flex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",py:{xs:1,sm:2},mx:2,borderBottom:1,borderColor:"grey.300"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:0}},children:[e.jsx(Zt,{sx:{fontSize:20,color:"warning.main",mr:1}}),e.jsx(c,{variant:"body1",fontWeight:500,children:v("trading.form.feesTaxes")}),e.jsx(c,{variant:"caption",color:"text.secondary",children:"(2)"})]}),e.jsx(c,{variant:"h6",fontWeight:600,color:"warning.main",children:G(Me.fee+Me.tax,pe)})]})]}),e.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"}},children:[e.jsxs(l,{sx:{flex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",py:{xs:1,sm:2},mx:2,borderBottom:1,borderColor:"grey.300"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:0}},children:[e.jsx(mr,{sx:{fontSize:20,color:"primary.main",mr:1}}),e.jsx(c,{variant:"body1",fontWeight:500,children:ue===nn.SELL?v("trading.form.amountReceived"):v("trading.form.amountPaid")}),e.jsx(c,{variant:"caption",color:"text.secondary",children:ue===nn.SELL?" (1-2)":" (1+2)"})]}),e.jsx(c,{variant:"h6",fontWeight:600,color:"primary.main",children:G(Me.cost,pe)})]}),e.jsxs(l,{sx:{flex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",py:{xs:1,sm:2},mx:2,borderBottom:1,borderColor:"grey.300"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:0}},children:[ue===nn.BUY?e.jsx(He,{sx:{fontSize:20,color:"success.main",mr:1}}):e.jsx(Bt,{sx:{fontSize:20,color:"error.main",mr:1}}),e.jsx(c,{variant:"body1",fontWeight:500,children:v("trading.form.tradeSide")})]}),e.jsx(ce,{label:ue,color:Ve(ue),icon:ue===nn.BUY?e.jsx(He,{sx:{fontSize:16}}):e.jsx(Bt,{sx:{fontSize:16}}),size:"small",sx:{fontWeight:600}})]})]})]})})}),o&&e.jsx(l,{display:"flex",justifyContent:"flex-end",sx:{mt:2},children:e.jsx(We,{type:"submit",variant:"contained",disabled:!F||n,icon:n?e.jsx(Ce,{size:20}):a==="create"?e.jsx(xt,{}):e.jsx(Tt,{}),mobileText:v(n?"trading.form.processing":a==="create"?"trading.form.create":"trading.form.update"),desktopText:v(n?"trading.form.processing":a==="create"?"trading.form.createTrade":"trading.form.updateTrade"),sx:{textTransform:"none",fontWeight:600,px:3},children:v(n?"trading.form.processing":a==="create"?"trading.form.createTrade":"trading.form.updateTrade")})})]}),e.jsx(Qm,{open:L,onClose:ie,onSubmit:Se,onCancel:ie,loading:I,error:M,accountId:P})]}),[s,N,R,n,a,v,pe,_,qe,fe,Me,ue,Ve,L,ie,Se,I,M,P,k,A,i,C]);if(k)return e.jsx(hr,{dateAdapter:Ar,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:u?1:2,mb:3,children:[e.jsx(Ce,{size:20}),e.jsx(D,{variant:"h5",children:v("trading.form.loadingTradeForm")})]})})})});if(!(C!=null&&C.length)&&!k&&!u)return e.jsx(hr,{dateAdapter:Ar,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(je,{severity:"error",sx:{mb:3},children:v("trading.form.noPortfoliosAvailable")}),e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mt:2},children:A?`${v("trading.form.error")}: ${A}`:v("trading.form.noPortfoliosFoundError")})]})})});if(m!==void 0&&x){const te=v(a==="create"?"trading.form.createTrade":"trading.form.updateTrade"),Ee=a==="create"?e.jsx(xt,{}):e.jsx(Tt,{});return e.jsx(Rt,{open:m,onClose:x,title:g||te,icon:f||Ee,maxWidth:j,size:b,loading:n,actions:y||Re,children:xe})}return xe};let nC={data:""},rC=r=>typeof window=="object"?((r?r.querySelector("#_goober"):window._goober)||Object.assign((r||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:r||nC,sC=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,aC=/\/\*[^]*?\*\/|  +/g,vu=/\n+/g,fs=(r,t)=>{let n="",s="",a="";for(let i in r){let o=r[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":s+=i[1]=="f"?fs(o,i):i+"{"+fs(o,i[1]=="k"?"":t)+"}":typeof o=="object"?s+=fs(o,t?t.replace(/([^,])+/g,d=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,u=>/&/.test(u)?u.replace(/&/g,d):d?d+" "+u:u)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=fs.p?fs.p(i,o):i+":"+o+";")}return n+(t&&a?t+"{"+a+"}":a)+s},ts={},Xm=r=>{if(typeof r=="object"){let t="";for(let n in r)t+=n+Xm(r[n]);return t}return r},iC=(r,t,n,s,a)=>{let i=Xm(r),o=ts[i]||(ts[i]=(u=>{let h=0,m=11;for(;h<u.length;)m=101*m+u.charCodeAt(h++)>>>0;return"go"+m})(i));if(!ts[o]){let u=i!==r?r:(h=>{let m,x,g=[{}];for(;m=sC.exec(h.replace(aC,""));)m[4]?g.shift():m[3]?(x=m[3].replace(vu," ").trim(),g.unshift(g[0][x]=g[0][x]||{})):g[0][m[1]]=m[2].replace(vu," ").trim();return g[0]})(r);ts[o]=fs(a?{["@keyframes "+o]:u}:u,n?"":"."+o)}let d=n&&ts.g?ts.g:null;return n&&(ts.g=ts[o]),((u,h,m,x)=>{x?h.data=h.data.replace(x,u):h.data.indexOf(u)===-1&&(h.data=m?u+h.data:h.data+u)})(ts[o],t,s,d),o},oC=(r,t,n)=>r.reduce((s,a,i)=>{let o=t[i];if(o&&o.call){let d=o(n),u=d&&d.props&&d.props.className||/^go/.test(d)&&d;o=u?"."+u:d&&typeof d=="object"?d.props?"":fs(d,""):d===!1?"":d}return s+a+(o??"")},"");function Yo(r){let t=this||{},n=r.call?r(t.p):r;return iC(n.unshift?n.raw?oC(n,[].slice.call(arguments,1),t.p):n.reduce((s,a)=>Object.assign(s,a&&a.call?a(t.p):a),{}):n,rC(t.target),t.g,t.o,t.k)}let Jm,lc,cc;Yo.bind({g:1});let cs=Yo.bind({k:1});function lC(r,t,n,s){fs.p=t,Jm=r,lc=n,cc=s}function As(r,t){let n=this||{};return function(){let s=arguments;function a(i,o){let d=Object.assign({},i),u=d.className||a.className;n.p=Object.assign({theme:lc&&lc()},d),n.o=/ *go\d+/.test(u),d.className=Yo.apply(n,s)+(u?" "+u:"");let h=r;return r[0]&&(h=d.as||r,delete d.as),cc&&h[0]&&cc(d),Jm(h,d)}return a}}var cC=r=>typeof r=="function",dc=(r,t)=>cC(r)?r(t):r,dC=(()=>{let r=0;return()=>(++r).toString()})(),uC=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");r=!t||t.matches}return r}})(),hC=20,Zm="default",ex=(r,t)=>{let{toastLimit:n}=r.settings;switch(t.type){case 0:return{...r,toasts:[t.toast,...r.toasts].slice(0,n)};case 1:return{...r,toasts:r.toasts.map(o=>o.id===t.toast.id?{...o,...t.toast}:o)};case 2:let{toast:s}=t;return ex(r,{type:r.toasts.find(o=>o.id===s.id)?1:0,toast:s});case 3:let{toastId:a}=t;return{...r,toasts:r.toasts.map(o=>o.id===a||a===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return t.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(o=>o.id!==t.toastId)};case 5:return{...r,pausedAt:t.time};case 6:let i=t.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},mC=[],xC={toasts:[],pausedAt:void 0,settings:{toastLimit:hC}},xa={},tx=(r,t=Zm)=>{xa[t]=ex(xa[t]||xC,r),mC.forEach(([n,s])=>{n===t&&s(xa[t])})},nx=r=>Object.keys(xa).forEach(t=>tx(r,t)),pC=r=>Object.keys(xa).find(t=>xa[t].toasts.some(n=>n.id===r)),qc=(r=Zm)=>t=>{tx(t,r)},gC=(r,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...n,id:(n==null?void 0:n.id)||dC()}),wi=r=>(t,n)=>{let s=gC(t,r,n);return qc(s.toasterId||pC(s.id))({type:2,toast:s}),s.id},wt=(r,t)=>wi("blank")(r,t);wt.error=wi("error");wt.success=wi("success");wt.loading=wi("loading");wt.custom=wi("custom");wt.dismiss=(r,t)=>{let n={type:3,toastId:r};t?qc(t)(n):nx(n)};wt.dismissAll=r=>wt.dismiss(void 0,r);wt.remove=(r,t)=>{let n={type:4,toastId:r};t?qc(t)(n):nx(n)};wt.removeAll=r=>wt.remove(void 0,r);wt.promise=(r,t,n)=>{let s=wt.loading(t.loading,{...n,...n==null?void 0:n.loading});return typeof r=="function"&&(r=r()),r.then(a=>{let i=t.success?dc(t.success,a):void 0;return i?wt.success(i,{id:s,...n,...n==null?void 0:n.success}):wt.dismiss(s),a}).catch(a=>{let i=t.error?dc(t.error,a):void 0;i?wt.error(i,{id:s,...n,...n==null?void 0:n.error}):wt.dismiss(s)}),r};var fC=cs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,yC=cs`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,bC=cs`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,jC=As("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${fC} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${yC} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${bC} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,vC=cs`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,wC=As("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${vC} 1s linear infinite;
`,SC=cs`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,TC=cs`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,CC=As("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${SC} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${TC} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,kC=As("div")`
  position: absolute;
`,PC=As("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,DC=cs`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,AC=As("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${DC} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,IC=({toast:r})=>{let{icon:t,type:n,iconTheme:s}=r;return t!==void 0?typeof t=="string"?p.createElement(AC,null,t):t:n==="blank"?null:p.createElement(PC,null,p.createElement(wC,{...s}),n!=="loading"&&p.createElement(kC,null,n==="error"?p.createElement(jC,{...s}):p.createElement(CC,{...s})))},RC=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,MC=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,NC="0%{opacity:0;} 100%{opacity:1;}",LC="0%{opacity:1;} 100%{opacity:0;}",EC=As("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,WC=As("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,FC=(r,t)=>{let n=r.includes("top")?1:-1,[s,a]=uC()?[NC,LC]:[RC(n),MC(n)];return{animation:t?`${cs(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${cs(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}};p.memo(({toast:r,position:t,style:n,children:s})=>{let a=r.height?FC(r.position||t||"top-center",r.visible):{opacity:0},i=p.createElement(IC,{toast:r}),o=p.createElement(WC,{...r.ariaProps},dc(r.message,r));return p.createElement(EC,{className:r.className,style:{...a,...n,...r.style}},typeof s=="function"?s({icon:i,message:o}):p.createElement(p.Fragment,null,i,o))});lC(p.createElement);Yo`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`;const Gc=(r,t)=>{const{accountId:n,loading:s}=Ge(),a=Kt();return p.useEffect(()=>{n&&a.invalidateQueries(["trades"])},[n,a]),yt(["trades",r,t,n],()=>q.getTrades(r,n,t),{enabled:!!r&&!!n&&!s,staleTime:2*60*1e3})},Kc=()=>{const r=Kt(),{accountId:t}=Ge();return jt(n=>q.createTrade(n,t),{onSuccess:n=>{r.invalidateQueries("trades"),r.invalidateQueries("portfolios"),wt.success("Trade created successfully!")},onError:n=>{var s,a;wt.error(((a=(s=n.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to create trade")}})},zC=()=>{const r=Kt(),{accountId:t}=Ge();return jt(({id:n,data:s})=>q.updateTrade(n,t,s),{onSuccess:()=>{r.invalidateQueries("trades"),r.invalidateQueries("portfolios"),wt.success("Trade updated successfully!")},onError:n=>{var s,a;wt.error(((a=(s=n.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to update trade")}})},OC=()=>{const r=Kt(),{accountId:t}=Ge();return jt(n=>q.deleteTrade(n,t),{onSuccess:()=>{r.invalidateQueries("trades"),r.invalidateQueries("portfolios"),wt.success("Trade deleted successfully!")},onError:n=>{var s,a;wt.error(((a=(s=n.response)==null?void 0:s.data)==null?void 0:a.message)||"Failed to delete trade")}})},VC=r=>{const{accountId:t}=Ge();return yt(["tradeDetails",r],()=>q.getTrade(r,t),{enabled:!!r&&!!t,staleTime:2*60*1e3})},$C=(r,t)=>{const n=["tradeAnalysis",r,(t==null?void 0:t.timeframe)||"ALL",(t==null?void 0:t.granularity)||"monthly"];return yt(n,()=>q.getTradeAnalysis(r,t),{enabled:!!r,staleTime:0,cacheTime:0})};function Si(r,t,n){return t===void 0&&(t={}),n===void 0&&(n={}),function(s,a,i){try{return Promise.resolve(function(o,d){try{var u=(t.context,Promise.resolve(r[n.mode==="sync"?"validateSync":"validate"](s,Object.assign({abortEarly:!1},t,{context:a}))).then(function(h){return i.shouldUseNativeValidation&&og({},i),{values:n.raw?s:h,errors:{}}}))}catch(h){return d(h)}return u&&u.then?u.then(void 0,d):u}(0,function(o){if(!o.inner)throw o;return{values:{},errors:lg((d=o,u=!i.shouldUseNativeValidation&&i.criteriaMode==="all",(d.inner||[]).reduce(function(h,m){if(h[m.path]||(h[m.path]={message:m.message,type:m.type}),u){var x=h[m.path].types,g=x&&x[m.type];h[m.path]=cg(m.path,u,h,m.type,g?[].concat(g,m.message):m.message)}return h},{})),i)};var d,u}))}catch(o){return Promise.reject(o)}}}const Qc=({open:r,onClose:t,onSubmit:n,portfolioId:s,initialData:a,isEdit:i=!1,standalone:o=!0,hideButtons:d=!1})=>{const{t:u}=Ne(),[h,m]=p.useState(""),x=mi({portfolioId:sn().required(u("deposit.form.validation.portfolioIdRequired")),bankName:sn().required(u("deposit.form.validation.bankNameRequired")).max(100,u("deposit.form.validation.bankNameMaxLength")),accountNumber:sn().optional().max(50,u("deposit.form.validation.accountNumberMaxLength")),principal:Ka().required(u("deposit.form.validation.principalRequired")).min(0,u("deposit.form.validation.principalMin")),interestRate:Ka().required(u("deposit.form.validation.interestRateRequired")).min(0,u("deposit.form.validation.interestRateMin")).max(100,u("deposit.form.validation.interestRateMax")),startDate:sn().required(u("deposit.form.validation.startDateRequired")),endDate:sn().required(u("deposit.form.validation.endDateRequired")),termMonths:Ka().optional(),notes:sn().max(500,u("deposit.form.validation.notesMaxLength"))}),{control:g,handleSubmit:f,reset:y,formState:{errors:j,isSubmitting:b}}=xi({resolver:Si(x),defaultValues:{portfolioId:s||"",bankName:"",accountNumber:"",principal:0,interestRate:0,startDate:new Date().toISOString().split("T")[0],endDate:"",termMonths:0,notes:""}}),v=rt.useRef(null);p.useEffect(()=>{r&&(y(a?{...a,portfolioId:a.portfolioId||s,bankName:a.bankName||"",accountNumber:a.accountNumber||"",principal:a.principal||0,interestRate:a.interestRate||0,startDate:a.startDate||new Date().toISOString().split("T")[0],endDate:a.endDate||"",termMonths:a.termMonths||0,notes:a.notes||""}:{portfolioId:s||"",bankName:"",accountNumber:"",principal:0,interestRate:0,startDate:new Date().toISOString().split("T")[0],endDate:"",termMonths:0,notes:""}),m(""))},[r,a,s,y]);const P=async C=>{var k,A;try{m("");const L=new Date(C.startDate),T=new Date(C.endDate);if(L>=T){m(u("deposit.form.validation.endDateAfterStart"));return}const M=T.getTime()-L.getTime();if(Math.ceil(M/(1e3*60*60*24))>3650){m(u("deposit.form.validation.termTooLong"));return}const I={...C,accountNumber:((k=C.accountNumber)==null?void 0:k.trim())||void 0,notes:((A=C.notes)==null?void 0:A.trim())||void 0};await n(I),t()}catch(L){m(L instanceof Error?L.message:u("deposit.form.validation.errorOccurred"))}},w=e.jsxs("form",{ref:v,onSubmit:f(P),children:[h&&e.jsx(je,{severity:"error",sx:{mb:2},children:h}),e.jsx("button",{type:"submit",style:{display:"none"}}),e.jsxs(W,{container:!0,spacing:2,sx:{mt:0},children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(mn,{name:"bankName",control:g,render:({field:C})=>{var k;return e.jsx(Ae,{...C,fullWidth:!0,label:u("deposit.form.bankName"),error:!!j.bankName,helperText:(k=j.bankName)==null?void 0:k.message,required:!0})}})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(mn,{name:"accountNumber",control:g,render:({field:C})=>{var k;return e.jsx(Ae,{...C,fullWidth:!0,label:u("deposit.form.accountNumber"),error:!!j.accountNumber,helperText:(k=j.accountNumber)==null?void 0:k.message})}})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(mn,{name:"principal",control:g,render:({field:C})=>{var k;return e.jsx(vr,{value:C.value||0,onChange:A=>C.onChange(A),label:u("deposit.form.principal"),placeholder:u("deposit.form.principalPlaceholder"),helperText:(k=j.principal)==null?void 0:k.message,error:!!j.principal,currency:"VND",showCurrency:!0,align:"right",required:!0,disabled:b})}})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(mn,{name:"interestRate",control:g,render:({field:C})=>{var k;return e.jsx(gi,{value:C.value||0,onChange:A=>C.onChange(A),label:u("deposit.form.interestRate"),placeholder:u("deposit.form.interestRatePlaceholder"),helperText:(k=j.interestRate)==null?void 0:k.message,error:!!j.interestRate,decimalPlaces:2,min:0,max:100,step:.01,showThousandsSeparator:!1,align:"right",required:!0,disabled:b})}})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(mn,{name:"startDate",control:g,render:({field:C})=>{var k;return e.jsx(Ae,{...C,fullWidth:!0,label:u("deposit.form.startDate"),type:"date",InputLabelProps:{shrink:!0},error:!!j.startDate,helperText:(k=j.startDate)==null?void 0:k.message,required:!0})}})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(mn,{name:"endDate",control:g,render:({field:C})=>{var k;return e.jsx(Ae,{...C,fullWidth:!0,label:u("deposit.form.endDate"),type:"date",InputLabelProps:{shrink:!0},error:!!j.endDate,helperText:(k=j.endDate)==null?void 0:k.message,required:!0})}})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(mn,{name:"notes",control:g,render:({field:C})=>{var k;return e.jsx(Ae,{...C,fullWidth:!0,label:u("deposit.form.notes"),multiline:!0,rows:2,error:!!j.notes,helperText:(k=j.notes)==null?void 0:k.message})}})})]})]});return o?e.jsx(Rt,{open:r,onClose:t,title:u(i?"deposit.form.editTitle":"deposit.form.createTitle"),icon:e.jsx(Ue,{}),maxWidth:"md",fullWidth:!0,loading:b,actions:d?void 0:e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:t,disabled:b,children:u("deposit.form.cancel")}),e.jsx(We,{variant:"contained",disabled:b,icon:e.jsx(Ga,{}),forceTextOnly:!0,mobileText:u("deposit.form.save"),desktopText:u("deposit.form.save"),onClick:()=>{if(v.current){const C=v.current.querySelector('button[type="submit"]');C&&C.click()}},children:u(b?"deposit.form.processing":i?"deposit.form.update":"deposit.form.create")})]}),children:w}):w},rx=({onSubmit:r,onCancel:t,dialogType:n,editingCashFlow:s,loading:a,error:i,portfolioFundingSource:o="",hideButtons:d=!1,showToggle:u=!1,onTypeChange:h})=>{const{t:m}=Ne(),[x,g]=p.useState(n==="deposit"),[f,y]=p.useState({amount:"",description:"",reference:"",currency:"VND",flowDate:"",status:"COMPLETED",fundingSource:""}),j=()=>new Date().toISOString().slice(0,10),b=()=>{y({amount:"",description:"",reference:"",currency:"VND",flowDate:j(),status:"COMPLETED",fundingSource:o})},v=w=>{const C=w.target.checked;g(C),h&&h(C?"deposit":"withdrawal")};p.useEffect(()=>{if(s){const w=s.flowDate.includes("T")?s.flowDate.split("T")[0]:s.flowDate;y({amount:s.amount.toString(),description:s.description||"",reference:s.reference||"",currency:s.currency||"VND",flowDate:w,status:s.status||"COMPLETED",fundingSource:s.fundingSource||""}),g(s.type==="DEPOSIT")}else b(),g(n==="deposit")},[s,o,n]);const P=async w=>{w.preventDefault();const C={...f,type:x?"DEPOSIT":"WITHDRAWAL"};await r(C)};return e.jsxs(l,{component:"form",onSubmit:P,sx:{pt:0},children:[d&&e.jsx("button",{type:"submit",style:{display:"none"}}),s&&e.jsxs(je,{severity:"info",sx:{mb:2},children:[e.jsxs(c,{variant:"tableCell",children:[e.jsx("strong",{children:"Editing:"})," ",s.description]}),e.jsxs(c,{variant:"formHelper",children:["Original Amount: ",G(s.amount)," | Type: ",s.type," | Status: ",s.status]})]}),i&&e.jsxs(je,{severity:"error",sx:{mb:2},children:[e.jsxs(c,{variant:"tableCell",children:[e.jsx("strong",{children:"Error:"})," ",i]}),e.jsx(c,{variant:"formHelper",sx:{mt:1,display:"block"},children:"Please check your input and try again."})]}),u&&!s&&e.jsxs(l,{sx:{mb:0,display:"flex",justifyContent:"flex-end",alignItems:"center",gap:1},children:[e.jsx(c,{variant:"tableCell",color:"text.secondary",children:x?m("cashflow.deposit","Np"):m("cashflow.withdrawal","Rt")}),e.jsx(jn,{checked:x,onChange:v,size:"medium",sx:{"& .MuiSwitch-thumb":{backgroundColor:x?"#4caf50":"#f44336",width:20,height:20},"& .MuiSwitch-track":{backgroundColor:x?"#4caf50":"#f44336",opacity:.3,height:14}}})]}),e.jsxs(W,{container:!0,spacing:1,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{pr:{md:1}},children:[e.jsx(vr,{value:parseFloat(f.amount)||0,onChange:w=>y({...f,amount:w.toString()}),label:m("cashflow.form.amount"),placeholder:m("cashflow.form.amountPlaceholder"),required:!0,currency:f.currency,margin:"normal",error:!!(f.amount&&(parseFloat(f.amount)<=0||isNaN(parseFloat(f.amount))))}),e.jsx(Ae,{fullWidth:!0,label:m("cashflow.form.fundingSource"),value:f.fundingSource,onChange:w=>y({...f,fundingSource:w.target.value.toUpperCase()}),margin:"normal",placeholder:m("cashflow.form.fundingSourcePlaceholder"),inputProps:{style:{textTransform:"uppercase"}}})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{pl:{md:1}},children:[e.jsx(Ae,{fullWidth:!0,label:m("cashflow.form.flowDate"),type:"date",value:f.flowDate,onChange:w=>y({...f,flowDate:w.target.value}),margin:"normal",InputLabelProps:{shrink:!0}}),e.jsx(Ae,{fullWidth:!0,label:m("cashflow.form.description"),value:f.description,onChange:w=>y({...f,description:w.target.value}),margin:"normal",multiline:!0,rows:1})]})})]}),!d&&e.jsxs(l,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:4,pt:2,borderTop:1,borderColor:"divider"},children:[t&&e.jsx(he,{type:"button",variant:"outlined",onClick:t,size:"large",forceTextOnly:!0,mobileText:m("common.cancel"),desktopText:m("common.cancel"),children:m("common.cancel")}),e.jsx(We,{type:"submit",variant:"contained",size:"large",disabled:a,icon:a?e.jsx(xt,{}):void 0,forceTextOnly:!0,mobileText:m(a?"common.processing":s?"common.update":"common.create"),desktopText:m(a?"common.processing":s?"common.update":"common.create"),children:m(a?"common.processing":s?"common.update":"common.create")})]})]})},sx=({onSubmit:r,loading:t=!1,initialData:n,onDataChange:s,hideSubmitButton:a=!1,showActions:i=!1,onCancel:o,portfolioId:d})=>{const{t:u}=Ne(),{accountId:h}=Ge(),{portfolios:m,isLoading:x}=Un(h),g=p.useRef(null),[f,y]=p.useState([]),[j,b]=p.useState(!1),[,v]=p.useState(null),P=p.useRef(!1),w=p.useRef(""),C=p.useMemo(()=>{const R=f.map(V=>V.fundingSource).filter(V=>V!=null&&V.trim()!=="");return Array.from(new Set(R)).sort()},[f]),k=p.useMemo(()=>{const R=(m==null?void 0:m.flatMap(V=>V.fundingSource?[V.fundingSource]:[]))||[];return Array.from(new Set(R.filter(V=>V!=null&&V.trim()!==""))).sort()},[m]),A=C.length>0?C:k;p.useEffect(()=>{const R=d!==w.current;h&&d&&(!P.current||R)&&(P.current=!0,w.current=d,(async()=>{b(!0),v(null);try{const F=await q.getCashFlowHistory(d,h);y(F.data)}catch(F){console.error("Failed to load cashflows:",F),v(F instanceof Error?F.message:"Failed to load funding sources"),y([])}finally{b(!1)}})())},[h,d]);const L=t||x||j,[T,M]=p.useState({fromSource:"",toSource:"",amount:0,description:"",transferDate:""}),O=()=>new Date().toISOString().slice(0,10);p.useEffect(()=>{const V={...{fromSource:"",toSource:"",amount:0,description:"",transferDate:O()},...n};M(V),s&&s(V)},[n,s]),p.useEffect(()=>{s&&s(T)},[T,s]);const I=async R=>{R.preventDefault(),await r(T)},z=R=>{const V={...T,...R};M(V)},N=()=>T.fromSource&&T.toSource&&T.amount>0&&T.fromSource!==T.toSource,E=async()=>{g.current&&g.current.requestSubmit()};return e.jsxs(l,{component:"form",ref:g,onSubmit:I,sx:{pt:0},children:[!a&&e.jsx("button",{type:"submit",style:{display:"none"}}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{pr:{md:1.5}},children:[e.jsxs(nt,{fullWidth:!0,margin:"normal",required:!0,children:[e.jsx(st,{children:u("cashflow.transfer.fromSource")}),e.jsx(Ze,{value:T.fromSource,label:u("cashflow.transfer.fromSource"),onChange:R=>z({fromSource:R.target.value}),disabled:L,children:A.map(R=>e.jsx(re,{value:R,children:R},R))})]}),e.jsx(ub,{value:T.toSource,onChange:R=>z({toSource:R}),existingSources:A,label:u("cashflow.transfer.toSource"),placeholder:u("cashflow.transfer.toSourcePlaceholder"),required:!0,allowNew:!0,disabled:L}),e.jsx(Ae,{fullWidth:!0,label:u("cashflow.transfer.date"),type:"date",value:T.transferDate,onChange:R=>z({transferDate:R.target.value}),margin:"normal",InputLabelProps:{shrink:!0},disabled:L})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{pl:{md:1.5}},children:[e.jsx(vr,{value:T.amount,onChange:R=>z({amount:R}),label:u("cashflow.transfer.amount"),placeholder:u("cashflow.transfer.amountPlaceholder"),required:!0,margin:"normal",error:!!(T.amount&&T.amount<=0),disabled:L}),e.jsx(Ae,{fullWidth:!0,label:u("cashflow.transfer.description"),value:T.description,onChange:R=>z({description:R.target.value}),margin:"normal",multiline:!0,rows:3,placeholder:u("cashflow.transfer.descriptionPlaceholder",{from:T.fromSource||u("cashflow.transfer.source"),to:T.toSource||u("cashflow.transfer.destination")}),disabled:L})]})})]}),T.fromSource&&T.toSource&&e.jsxs(je,{severity:"info",sx:{mt:2},children:[e.jsxs(c,{variant:"tableCell",sx:{fontWeight:"bold"},children:[u("cashflow.transfer.summary"),":"]}),e.jsx(c,{variant:"tableCell",children:u("cashflow.transfer.summaryText",{amount:G(T.amount),from:T.fromSource,to:T.toSource})}),e.jsx(c,{variant:"formHelper",sx:{mt:1,display:"block"},children:u("cashflow.transfer.summaryHelper")})]}),i&&e.jsxs(l,{sx:{display:"flex",gap:1,mt:3,justifyContent:"flex-end"},children:[o&&e.jsx(he,{onClick:o,mobileText:u("common.cancel"),desktopText:u("common.cancel"),children:u("common.cancel")}),e.jsx(We,{onClick:E,variant:"contained",color:"secondary",icon:e.jsx(yr,{}),mobileText:u(L?"cashflow.transfer.transferring":"cashflow.transfer.transfer"),desktopText:u(L?"cashflow.transfer.transferring":"cashflow.transfer.transferCash"),disabled:L||!N(),children:u(L?"cashflow.transfer.transferring":"cashflow.transfer.transferCash")})]})]})},HC=({open:r,onClose:t,portfolioId:n})=>{const{t:s}=Ne(),a=Je(),{accountId:i}=Ge(),{portfolios:o}=Un(i),d=Nt(a.breakpoints.down("md")),[u,h]=p.useState(null),[m,x]=p.useState(!1),[g,f]=p.useState(null),[y,j]=p.useState(0),[b,v]=p.useState(null),[P,w]=p.useState(null),[C,k]=p.useState("");p.useEffect(()=>{r||(h(null),f(null),j(0),v(null),w(null),k(""))},[r]),p.useEffect(()=>{var E,R;if(r&&((R=(E=A[y])==null?void 0:E.forms)==null?void 0:R.length)>0){const V=A[y].forms[0];v(V.id),h(V.id),f(null)}},[y,r]),p.useEffect(()=>{r&&!n&&(o==null?void 0:o.length)>0&&!C&&k(o[0].portfolioId)},[r,n,o,C]);const A=[{id:"trading",label:s("genericForm.tabs.trading","Mua/Bn"),icon:e.jsx(yr,{}),forms:[{id:"trading",title:s("genericForm.options.trading.title","Mua/Bn ti sn"),description:s("genericForm.options.trading.description","Mua/Bn c phiu, tri phiu, vng..."),icon:e.jsx(yr,{}),color:"#2e7d32",category:"trading"}]},{id:"cashflow",label:s("genericForm.tabs.cashflow","Np/Rt tin"),icon:e.jsx(He,{}),forms:[{id:"cash_flow",title:s("genericForm.options.cashFlow.title","Np/Rt tin"),description:s("genericForm.options.cashFlow.description","Np hoc rt tin t danh mc"),icon:e.jsx(Ue,{}),color:"#2e7d32",category:"cashflow"}]},{id:"deposit",label:s("genericForm.tabs.deposit","Tin gi"),icon:e.jsx(qt,{}),forms:[{id:"bank_deposit",title:s("genericForm.options.bankDeposit.title","Tin gi ngn hng"),description:s("genericForm.options.bankDeposit.description","To tin gi ngn hng vi li sut"),icon:e.jsx(qt,{}),color:"#1976d2",category:"deposit"}]},{id:"transfer",label:s("genericForm.tabs.transfer","Chuyn tin"),icon:e.jsx(yr,{}),forms:[{id:"bank_transfer",title:s("genericForm.options.bankTransfer.title","Chuyn tin"),description:s("genericForm.options.bankTransfer.description","Chuyn tin gia cc ngun vn"),icon:e.jsx(yr,{}),color:"#9c27b0",category:"transfer"}]}],L=E=>{h(E),f(null)},T=(E,R)=>{j(R)},M=async E=>{try{x(!0),f(null),await q.createDeposit(E),t()}catch(R){f(R instanceof Error?R.message:"Failed to create deposit")}finally{x(!1)}},O=async E=>{try{x(!0),f(null),await q.createTrade(E,i),t()}catch(R){f(R instanceof Error?R.message:"Failed to create trade")}finally{x(!1)}},I=()=>{if(u){if(P){const E=P.querySelector('button[type="submit"]');if(E){E.click();return}}switch(u){case"trading":const E=P==null?void 0:P.querySelector("form");if(E){const F=new Event("submit",{bubbles:!0,cancelable:!0});E.dispatchEvent(F)}break;case"cash_flow":const R=P==null?void 0:P.querySelector("form");if(R){const F=new Event("submit",{bubbles:!0,cancelable:!0});R.dispatchEvent(F)}break;case"bank_deposit":break;case"bank_transfer":const V=P==null?void 0:P.querySelector("form");if(V){const F=new Event("submit",{bubbles:!0,cancelable:!0});V.dispatchEvent(F)}break}}},z=()=>b?N():e.jsxs(l,{children:[e.jsxs(l,{sx:{mb:3},children:[e.jsx(c,{variant:"h5",sx:{fontWeight:600,mb:1},children:s("genericForm.title","To giao dch mi")}),e.jsx(c,{variant:"body2",color:"text.secondary",children:s("genericForm.subtitle","Chn loi giao dch bn mun thc hin")})]}),e.jsx(W,{container:!0,spacing:d?1:2,children:A[y].forms.map(E=>e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(se,{sx:{height:"100%",transition:"all 0.3s ease",cursor:"pointer","&:hover":{transform:"translateY(-4px)",boxShadow:a.shadows[8]}},children:e.jsx(Xx,{onClick:()=>L(E.id),sx:{height:"100%",p:d?1.5:2},children:e.jsxs(me,{sx:{textAlign:"center",p:0},children:[e.jsx(l,{sx:{width:60,height:60,borderRadius:"50%",backgroundColor:`${E.color}20`,color:E.color,display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:2},children:E.icon}),e.jsx(c,{variant:"h6",sx:{fontWeight:600,mb:1},children:E.title}),e.jsx(c,{variant:"body2",color:"text.secondary",children:E.description})]})})})},E.id))})]}),N=()=>{var F;if(!u||!A.flatMap(B=>B.forms).find(B=>B.id===u))return null;const R=!!n,V=n||C;return V?e.jsxs(l,{children:[g&&e.jsx(l,{sx:{mb:3,p:2,backgroundColor:"error.light",borderRadius:1},children:e.jsx(c,{variant:"body2",color:"error.main",children:g})}),!R&&e.jsx(l,{children:e.jsxs(nt,{fullWidth:!0,sx:{mb:2},children:[e.jsxs(st,{id:"portfolio-select-label",children:[s("genericForm.portfolioInfo.selectPortfolio","Chn danh mc")," *"]}),e.jsxs(Ze,{labelId:"portfolio-select-label",value:V,onChange:B=>k(B.target.value),label:`${s("genericForm.portfolioInfo.selectPortfolio","Chn danh mc")} *`,sx:{borderRadius:2},children:[e.jsx(re,{value:"",children:e.jsx("em",{children:s("genericForm.portfolioInfo.selectPortfolio","Chn danh mc")})}),o==null?void 0:o.map(B=>e.jsx(re,{value:B.portfolioId,children:B.name},B.portfolioId))]})]})}),u==="trading"&&e.jsx(l,{ref:B=>w(B),children:e.jsx(Ca,{onSubmit:O,defaultPortfolioId:V,mode:"create",isLoading:m,showSubmitButton:!1,isModal:!0,initialData:{side:nn.BUY}})}),u==="cash_flow"&&e.jsx(l,{ref:B=>w(B),children:e.jsx(rx,{onSubmit:async B=>{try{x(!0),f(null);const $={portfolioId:V,amount:parseFloat(B.amount),type:B.type||"DEPOSIT",description:B.description,reference:B.reference||void 0,flowDate:B.flowDate?B.flowDate:void 0,currency:B.currency,status:B.status,fundingSource:B.fundingSource||void 0},Y=$.type==="DEPOSIT";await q.createCashFlow(V,i,Y?"deposit":"withdrawal",$),f(null),t()}catch($){f($ instanceof Error?$.message:"Failed to create cash flow")}finally{x(!1)}},onCancel:()=>{},dialogType:"deposit",editingCashFlow:null,loading:m,error:g,portfolioFundingSource:((F=o==null?void 0:o.find(B=>B.portfolioId===V))==null?void 0:F.fundingSource)||"",hideButtons:!0,showToggle:!0,onTypeChange:()=>{}})}),u==="bank_deposit"&&e.jsx(l,{ref:B=>w(B),children:e.jsx(Qc,{open:!0,onClose:()=>{},onSubmit:M,portfolioId:V,isEdit:!1,standalone:!1,hideButtons:!0})}),u==="bank_transfer"&&e.jsx(l,{ref:B=>w(B),children:e.jsx(sx,{onSubmit:async B=>{try{x(!0),f(null);const $=n||C;if(!$)throw new Error("No portfolio selected");if(!B.fromSource||!B.toSource||!B.amount||B.amount<=0)throw new Error("Please fill in all required fields");if(B.fromSource===B.toSource)throw new Error("From source and to source cannot be the same");const Y={portfolioId:$,fromSource:B.fromSource,toSource:B.toSource,amount:B.amount,description:B.description||`Transfer from ${B.fromSource} to ${B.toSource}`,transferDate:(()=>{let _=B.transferDate;return _.includes("T")&&(_=_.split("T")[0]),new Date(_+"T12:00:00").toISOString()})()};await q.transferCashFlow($,i,Y),f(null),t()}catch($){f($ instanceof Error?$.message:"Failed to create transfer")}finally{x(!1)}},loading:m,error:g,hideSubmitButton:!0,showActions:!1,portfolioId:V})})]}):e.jsxs(l,{sx:{p:3,textAlign:"center"},children:[e.jsx(c,{variant:"h6",color:"error",sx:{mb:2},children:s("genericForm.error.noPortfolio","Khng tm thy danh mc")}),e.jsx(c,{variant:"body2",color:"text.secondary",children:s("genericForm.error.noPortfolioDescription","Vui lng to danh mc trc khi thc hin giao dch")})]})};return e.jsx(e.Fragment,{children:e.jsxs(Rt,{open:r,onClose:t,title:"",icon:e.jsx(xt,{}),maxWidth:d?!1:"lg",fullWidth:d,fullScreen:d,loading:m,showCloseButton:!u,hideHeader:!0,actions:u?e.jsxs(e.Fragment,{children:[e.jsx(he,{variant:"outlined",onClick:t,disabled:m,children:s("common.cancel","Hy")}),e.jsx(We,{variant:"contained",onClick:I,disabled:m,children:m?s("common.processing","ang x l..."):s("genericForm.create","To")})]}):e.jsx(he,{onClick:t,children:s("common.close","ng")}),children:[e.jsx(l,{sx:{borderBottom:1,borderColor:"divider",mb:d?2:3,mt:d?-2:0,position:"sticky",top:-16,backgroundColor:"background.paper",zIndex:10},children:e.jsx(Tr,{value:y,onChange:T,"aria-label":"transaction tabs",variant:d?"fullWidth":"standard",scrollButtons:!d,children:A.map(E=>e.jsx(ht,{icon:d?void 0:E.icon,label:E.label,iconPosition:d?"top":"start",sx:{textTransform:"none",fontWeight:600,fontSize:d?"0.75rem":"0.875rem",py:0,px:d?1:2,minHeight:d?48:"auto"}},E.id))})}),u?N():z()]})})},BC=({portfolioId:r})=>{var L;const{t}=Ne(),n=An(),{currentAccount:s}=Ge(),{isFullscreenOpen:a}=zc(),i=Je(),o=Nt(i.breakpoints.up("md")),[d,u]=p.useState(!1),[h,m]=p.useState(!1),[x,g]=p.useState(!1),[f,y]=p.useState(!1),j=Kc(),{portfolios:b,createPortfolio:v,isCreating:P}=Un(s==null?void 0:s.accountId);p.useEffect(()=>{y(o)},[o]);const w=async T=>{try{await j.mutateAsync(T),m(!1)}catch(M){console.error("Error creating trade:",M)}},C=async T=>{const M={...T,tradeDate:T.tradeDate};await w(M)},k=async()=>{},A=async()=>{if(!(s!=null&&s.accountId)){n("/login");return}if(!b||b.length===0)try{g(!0),await v({name:t("trading.autoCreatePortfolio.name","My Portfolio"),baseCurrency:"VND",fundingSource:"",accountId:s.accountId})}catch(T){console.error("Failed to auto-create portfolio:",T)}finally{g(!1)}u(!0)};return!(s!=null&&s.accountId)||s!=null&&s.isInvestor||a?null:e.jsxs(e.Fragment,{children:[e.jsx(Il,{in:!0,children:e.jsx(Fe,{title:x||P?t("trading.floatingButton.creatingPortfolio","ang to danh mc..."):t("trading.floatingButton.tooltip","To d liu mi"),placement:"left",arrow:!0,open:f,onOpen:()=>y(!0),onClose:()=>y(o),disableHoverListener:o,disableFocusListener:o,disableTouchListener:o,children:e.jsx(xc,{color:"secondary","aria-label":t("trading.floatingButton.ariaLabel","To d liu"),onClick:A,sx:{position:"fixed",bottom:24,right:24,zIndex:1300,boxShadow:`0 8px 32px ${U("#ff6b35",.3)}`,background:"linear-gradient(135deg, #ff6b35 0%, #f7931e 100%)","&:hover":{boxShadow:`0 12px 40px ${U("#ff6b35",.4)}`,transform:"scale(1.05)",background:"linear-gradient(135deg, #f7931e 0%, #ff6b35 100%)"},"&:active":{transform:"scale(0.95)"},transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",width:56,height:56},children:e.jsx(xt,{sx:{fontSize:28}})})})}),e.jsx(HC,{open:d,onClose:()=>u(!1),portfolioId:r||((b==null?void 0:b.length)===1?b[0].portfolioId:void 0)}),e.jsx(Ca,{open:h,onClose:()=>m(!1),onSubmit:C,defaultPortfolioId:r||((b==null?void 0:b.length)===1?b[0].portfolioId:void 0),isLoading:j.isLoading,error:(L=j.error)==null?void 0:L.message,onAssetCreated:k,mode:"create",isModal:!0,showSubmitButton:!1})]})},UC=({onClick:r,isOpen:t=!1})=>{const n=Je();return Nt(n.breakpoints.down("md"))?e.jsx(xc,{color:"primary","aria-label":"open menu",onClick:r,sx:{position:"fixed",top:"40%",left:16,zIndex:n.zIndex.speedDial,width:40,height:40,background:"transparent",boxShadow:`0 4px 20px ${n.palette.primary.light}40`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transform:t?"translate(-50%, -50%) rotate(45deg)":"translate(-50%, -50%) rotate(0deg)","&:hover":{background:`linear-gradient(135deg, ${n.palette.primary.light} 0%, ${n.palette.primary.main} 100%)`,transform:t?"translate(-50%, -50%) rotate(45deg) scale(1.1)":"translate(-50%, -50%) rotate(0deg) scale(1.1)",boxShadow:`0 6px 25px ${n.palette.primary.main}60`},"&:active":{transform:t?"translate(-50%, -50%) rotate(45deg) scale(0.95)":"translate(-50%, -50%) rotate(0deg) scale(0.95)"},animation:"fadeInUp 0.5s ease-out","@keyframes fadeInUp":{from:{opacity:0,transform:"translate(-50%, calc(-50% + 20px))"},to:{opacity:1,transform:"translate(-50%, -50%)"}},...t?{}:{animation:"pulse 2s infinite","@keyframes pulse":{"0%":{boxShadow:`0 4px 20px ${n.palette.primary.light}40`},"50%":{boxShadow:`0 4px 20px ${n.palette.primary.light}60`},"100%":{boxShadow:`0 4px 20px ${n.palette.primary.light}40`}}}},children:e.jsx(Za,{sx:{fontSize:28,color:"gray",transition:"transform 0.3s ease",transform:t?"rotate(-45deg)":"rotate(0deg)"}})}):null},_C=()=>{const{t:r}=Ne(),t=Je(),n=Nt(t.breakpoints.down("sm")),{isDemoAccount:s,switchAccount:a}=Ge(),[i,o]=p.useState(!0),[d,u]=p.useState([]);p.useEffect(()=>{if(s){h();const y=localStorage.getItem("demoAccountBannerCollapsed");y==="true"?o(!0):y==="false"&&o(!1)}},[s]);const h=async()=>{try{const j=(await q.getAccounts()).filter(b=>!b.isDemoAccount);u(j)}catch(y){console.error("Error loading accounts:",y)}},m=()=>{const y=!i;o(y),localStorage.setItem("demoAccountBannerCollapsed",y.toString())},x=async()=>{const j=d.find(b=>b.isMainAccount)||d[0];if(j)try{await a(j.accountId),window.location.href="/"}catch(b){console.error("Failed to switch account:",b)}};if(!s)return null;const g=d.some(y=>y.isMainAccount),f=d.length>0;return e.jsxs(je,{severity:"warning",icon:!n&&!i?e.jsx(Ss,{}):void 0,onClick:i?m:void 0,action:i?null:n?e.jsx(Ie,{"aria-label":"collapse",color:"inherit",size:"small",onClick:y=>{y.stopPropagation(),m()},sx:{padding:.5,"&:hover":{backgroundColor:U(t.palette.warning.main,.1)}},children:e.jsx(Dn,{sx:{fontSize:"1.25rem"}})}):e.jsxs(l,{display:"flex",alignItems:"center",gap:.5,sx:{flexShrink:0},children:[e.jsx(Ie,{"aria-label":"collapse",color:"inherit",size:"small",onClick:y=>{y.stopPropagation(),m()},sx:{"&:hover":{backgroundColor:U(t.palette.warning.main,.1)}},children:e.jsx(Dn,{fontSize:"inherit"})}),f&&e.jsx(ut,{size:"small",variant:"contained",color:"primary",startIcon:e.jsx(yr,{}),onClick:y=>{y.stopPropagation(),x()},sx:{textTransform:"none",fontWeight:600,fontSize:"0.875rem",px:2,py:.75,borderRadius:1,boxShadow:2,"&:hover":{boxShadow:4,transform:"translateY(-1px)"},transition:"all 0.2s ease-in-out",whiteSpace:"nowrap"},children:g?r("accountSwitcher.demoAccountBanner.switchToMainAccount","Chuyn sang ti khon chnh"):r("accountSwitcher.demoAccountBanner.switchToAccount","Chuyn ti khon")})]}),sx:{cursor:i?"pointer":"default",borderRadius:0,borderBottom:`2px solid ${t.palette.warning.main}`,backgroundColor:`${t.palette.warning.light}15`,py:{xs:1,sm:1.5},px:{xs:1,sm:2},position:"relative","&:hover":i?{backgroundColor:`${t.palette.warning.light}25`}:{},"& .MuiAlert-icon":{fontSize:{xs:"1.25rem",sm:"1.5rem"},display:{xs:"none",sm:"flex"}},"& .MuiAlert-message":{flex:1,width:"100%",minWidth:0},"& .MuiAlert-action":{paddingTop:{xs:0,sm:"inherit"},alignItems:{xs:"flex-start",sm:"center"}},boxShadow:`0 2px 8px ${t.palette.warning.main}20`},children:[!i&&n&&e.jsx(l,{sx:{position:"absolute",top:8,right:8,zIndex:2},children:e.jsx(Ie,{"aria-label":"collapse",color:"inherit",size:"small",onClick:y=>{y.stopPropagation(),m()},sx:{padding:.5,backgroundColor:U(t.palette.background.paper,.9),"&:hover":{backgroundColor:U(t.palette.warning.main,.1)}},children:e.jsx(Dn,{sx:{fontSize:"1.25rem"}})})}),e.jsxs(qr,{in:!i,timeout:"auto",children:[e.jsxs(ui,{sx:{fontWeight:700,fontSize:{xs:"0.875rem",sm:"1rem"},mb:{xs:.75,sm:.5},display:"flex",alignItems:"center",gap:{xs:.5,sm:1},flexWrap:{xs:"wrap",sm:"nowrap"},pr:{xs:i?4:10,sm:0}},children:[e.jsx(ce,{label:r("accountSwitcher.demoAccountBanner.demoMode","Ch  Demo"),size:"small",color:"warning",sx:{height:{xs:20,sm:24},fontWeight:700,fontSize:{xs:"0.65rem",sm:"0.75rem"},flexShrink:0}}),e.jsx(l,{component:"span",sx:{fontSize:{xs:"0.875rem",sm:"1rem"},lineHeight:1.4},children:r("accountSwitcher.demoAccountBanner.title","Bn ang s dng ti khon Demo")})]}),e.jsxs(l,{sx:{mt:{xs:.75,sm:1},pr:{xs:i?3:10,sm:0}},children:[e.jsx(l,{component:"span",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"},lineHeight:{xs:1.5,sm:1.6},display:"block"},children:r("accountSwitcher.demoAccountBanner.message","Ti khon Demo ch cho php xem d liu (read-only).  c y  quyn chnh sa v qun l, vui lng chuyn sang ti khon chnh ca bn.")}),!f&&e.jsx(l,{component:"span",sx:{display:"block",mt:{xs:.75,sm:1},fontSize:{xs:"0.75rem",sm:"0.875rem"},fontStyle:"italic",color:"text.secondary",lineHeight:1.4},children:r("accountSwitcher.demoAccountBanner.noOtherAccounts","Lu : Bn cha c ti khon chnh. Vui lng lin h qun tr vin  to ti khon.")}),n&&f&&e.jsx(l,{sx:{mt:1.5,display:"flex",gap:1,flexDirection:"column"},children:e.jsx(ut,{fullWidth:!0,size:"small",variant:"contained",color:"primary",startIcon:e.jsx(yr,{}),onClick:x,sx:{textTransform:"none",fontWeight:600,fontSize:"0.875rem",py:1,borderRadius:1,boxShadow:2,"&:hover":{boxShadow:4,transform:"translateY(-1px)"},transition:"all 0.2s ease-in-out"},children:g?r("accountSwitcher.demoAccountBanner.switchToMainAccount","Chuyn sang ti khon chnh"):r("accountSwitcher.demoAccountBanner.switchToAccount","Chuyn ti khon")})})]})]}),i&&e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",pr:{xs:4,sm:0},position:"relative"},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:{xs:.5,sm:1},flex:1},children:e.jsx(l,{component:"span",sx:{fontSize:{xs:"0.875rem",sm:"1rem"},lineHeight:1.4,fontWeight:600},children:r("accountSwitcher.demoAccountBanner.title","Bn ang s dng ti khon Demo")})}),n?e.jsx(l,{sx:{position:"absolute",top:-8,right:0},children:e.jsx(Ie,{"aria-label":"expand",color:"inherit",size:"small",onClick:y=>{y.stopPropagation(),m()},sx:{padding:.5,"&:hover":{backgroundColor:U(t.palette.warning.main,.1)}},children:e.jsx(ln,{sx:{fontSize:"1.25rem"}})})}):e.jsx(Ie,{"aria-label":"expand",color:"inherit",size:"small",onClick:y=>{y.stopPropagation(),m()},sx:{"&:hover":{backgroundColor:U(t.palette.warning.main,.1)}},children:e.jsx(ln,{fontSize:"inherit"})})]})]})},Lt=(r,t)=>t?{xs:56,sm:60,md:64,lg:64,xl:64}:{xs:200,sm:220,md:200,lg:220,xl:240},wu=()=>{const t=window.location.pathname.match(/^\/portfolios\/([^\/]+)/);return t?t[1]:void 0},Cn=({children:r})=>{const{t}=Ne(),n=Je(),s=Nt(n.breakpoints.down("md")),a=Nt(n.breakpoints.between("sm","lg")),i=An(),o=Pa(),[d,u]=p.useState(!1),[h,m]=p.useState(a),{currentAccount:x,currentUser:g,logout:f,loading:y,isDemoAccount:j}=Ge(),b=wu(),{portfolio:v}=zo(b||""),{hasAnyPermission:P,hasAnyRole:w}=Zr(),C=(x==null?void 0:x.isInvestor)===!0,k=[{text:t("navigation.dashboard"),icon:e.jsx(pc,{}),path:"/",description:t("navigation.dashboard"),badge:null},{text:t("navigation.investor.title"),icon:e.jsx(Zt,{}),path:null,description:t("navigation.investor.title"),badge:null,children:[{text:t("navigation.investor.reports"),icon:e.jsx(Zt,{}),path:"/investor",description:t("navigation.investor.reports"),badge:null},{text:t("navigation.investor.holdings"),icon:e.jsx(Jx,{}),path:"/holdings",description:t("navigation.investor.holdings"),badge:null},{text:t("navigation.investor.goals"),icon:e.jsx(Zx,{}),path:"/goals",description:t("navigation.investor.goals"),badge:null}]},...C?[]:[{text:t("navigation.fundManagement.title"),icon:e.jsx(Ue,{}),path:null,description:t("navigation.fundManagement.title"),badge:null,children:[{text:t("navigation.fundManagement.portfolios"),icon:e.jsx(Ue,{}),path:"/portfolios",description:t("navigation.fundManagement.portfolios"),badge:null},{text:t("navigation.fundManagement.reports"),icon:e.jsx(Zt,{}),path:"/reports",description:t("navigation.fundManagement.reports"),badge:null}]}],{text:t("navigation.settings"),icon:e.jsx(Gr,{}),path:"/settings",description:t("navigation.settings"),badge:null},{text:t("navigation.systemExplanation"),icon:e.jsx(ep,{}),path:"/system-guide",description:t("navigation.systemExplanation"),badge:null},...C?[]:[{text:t("navigation.dataManagement"),icon:e.jsx(fa,{}),path:"/snapshots",description:t("navigation.dataManagement"),badge:null,permissions:["financial.snapshots.manage"]},{text:t("navigation.priceManagement"),icon:e.jsx(Uu,{}),path:"/global-assets",description:t("navigation.priceManagement"),badge:null,roles:["admin","super_admin"]},{text:t("navigation.systemAdmin"),icon:e.jsx(Jt,{}),path:"/admin-management",description:t("navigation.systemAdmin"),badge:null,roles:["super_admin"]}]];rt.useEffect(()=>{(s||a)&&(m(!1),u(!1))},[s,a]);const A=()=>{u(!d)},L=()=>{s||m(!h)},T=I=>{i(I),(s||a)&&u(!1)},M=s?!1:h,O=e.jsxs(l,{sx:{height:"100vh",display:"flex",flexDirection:"column",overflow:"hidden",overflowX:"hidden",maxWidth:"100%"},children:[e.jsxs(l,{sx:{p:M?1.5:3,background:`linear-gradient(135deg, ${n.palette.primary.main} 0%, ${n.palette.primary.dark} 100%)`,color:"white",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 50%, rgba(255,255,255,0.05) 100%)",pointerEvents:"none"}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:M?1:2,position:"relative",zIndex:1},children:[e.jsx(Vt,{sx:{bgcolor:"rgba(255,255,255,0.15)",mr:M?0:2,width:M?32:48,height:M?32:48,border:"1px solid rgba(255,255,255,0.15)",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:e.jsx(Ue,{sx:{fontSize:M?20:28}})}),!M&&e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"center"},children:[e.jsx(c,{variant:"cardTitle",noWrap:!0,component:"div",sx:{mb:.25,background:"linear-gradient(135deg, #ffffff 0%, #f0f0f0 100%)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",letterSpacing:"0.5px"},children:"MMO"}),e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:.5,px:1,py:.25,backgroundColor:"rgba(255,255,255,0.1)",borderRadius:1,border:"1px solid rgba(255,255,255,0.2)",backdropFilter:"blur(10px)"},children:e.jsx(c,{variant:"formHelper",sx:{color:"white",opacity:.9,fontWeight:500,fontSize:{xs:"0.4rem",sm:"0.4rem",md:"0.45rem",lg:"0.55rem",xl:"0.65rem"},letterSpacing:"0.3px",textTransform:"uppercase"},children:"v1.0.0-beta"})})]})]}),!M&&e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,position:"relative",zIndex:1,mt:2},children:[e.jsx(l,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:"rgba(34, 197, 94, 0.8)",boxShadow:"0 0 8px rgba(34, 197, 94, 0.4)"}}),e.jsx(c,{variant:"formHelper",sx:{opacity:.9,fontWeight:300,fontSize:{xs:"0.4rem",sm:"0.45rem",md:"0.55rem",lg:"0.65rem",xl:"0.75rem"}},children:"System Online  Real-time Data"})]})]}),e.jsx(l,{sx:{flexGrow:1,overflow:"auto",overflowX:"hidden",py:.25,minHeight:0,maxWidth:"100%"},children:e.jsx(lt,{sx:{px:.25,overflow:"hidden",maxWidth:"100%","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-track":{background:"transparent"},"&::-webkit-scrollbar-thumb":{background:n.palette.divider,borderRadius:"3px","&:hover":{background:n.palette.text.secondary}}},children:k.filter(I=>{if(!I.permissions&&!I.roles)return!0;let z=!1,N=!1;return I.permissions&&(z=P(I.permissions)),I.roles&&(N=w(I.roles)),z||N}).map(I=>{if(M){const z=[];return I.path&&z.push(I),I.children&&z.push(...I.children),z.map(N=>e.jsx(Pe,{disablePadding:!0,sx:{mb:.125},children:e.jsx(Fe,{title:N.text,placement:"right",arrow:!0,children:e.jsx(ss,{selected:o.pathname===N.path,onClick:()=>T(N.path),sx:{borderRadius:1.5,mx:.25,py:.75,px:.5,transition:"all 0.2s ease-in-out",position:"relative",justifyContent:"center","&.Mui-selected":{bgcolor:U(n.palette.primary.main,.12),"&:hover":{bgcolor:U(n.palette.primary.main,.18)},"& .MuiListItemIcon-root":{color:n.palette.primary.main,transform:"scale(1.1)"}},"&:hover":{bgcolor:U(n.palette.primary.main,.08),transform:"scale(1.05)","& .MuiListItemIcon-root":{transform:"scale(1.05)"}}},children:e.jsx(tt,{sx:{minWidth:32,transition:"all 0.2s ease-in-out"},children:N.icon})})})},N.text))}return I.children?e.jsxs(l,{children:[e.jsx(Pe,{disablePadding:!0,sx:{mb:.125},children:e.jsx(Fe,{title:I.text,placement:"right",arrow:!0,children:e.jsxs(ss,{className:"parent-menu",sx:{borderRadius:1.5,mx:.25,py:.75,px:1,transition:"all 0.2s ease-in-out",position:"relative",justifyContent:"flex-start","&:hover":{bgcolor:U(n.palette.primary.main,.08),transform:"translateX(4px)","& .MuiListItemIcon-root":{transform:"scale(1.05)"}}},children:[e.jsx(tt,{sx:{minWidth:44,transition:"all 0.2s ease-in-out"},children:I.icon}),e.jsx(ve,{primary:I.text,primaryTypographyProps:{variant:"body2",fontWeight:500,fontSize:"0.875rem",color:n.palette.primary.main}})]})})}),I.children.map(z=>e.jsx(Pe,{disablePadding:!0,sx:{mb:.125,ml:2},children:e.jsx(Fe,{title:z.text,placement:"right",arrow:!0,children:e.jsxs(ss,{selected:o.pathname===z.path,onClick:()=>T(z.path),sx:{borderRadius:1.5,mx:.25,py:.75,px:1,transition:"all 0.2s ease-in-out",position:"relative",justifyContent:"flex-start","&.Mui-selected":{bgcolor:U(n.palette.primary.main,.12),"&:hover":{bgcolor:U(n.palette.primary.main,.18)},"& .MuiListItemIcon-root":{color:n.palette.primary.main,transform:"scale(1.1)"},"& .MuiListItemText-primary":{color:n.palette.primary.main,fontWeight:500},"&::before":{content:'""',position:"absolute",left:0,top:"50%",transform:"translateY(-50%)",width:4,height:24,bgcolor:n.palette.primary.main,borderRadius:"0 2px 2px 0"}},"&:hover":{bgcolor:U(n.palette.primary.main,.08),transform:"translateX(4px)","& .MuiListItemIcon-root":{transform:"scale(1.05)"}}},children:[e.jsx(tt,{sx:{minWidth:44,transition:"all 0.2s ease-in-out"},children:z.icon}),e.jsx(ve,{primary:z.text,primaryTypographyProps:{variant:"body2",fontWeight:o.pathname===z.path?500:300,fontSize:"0.875rem"}}),z.badge&&e.jsx(ce,{label:z.badge,size:"small",color:"primary",sx:{height:22,fontSize:"0.7rem",fontWeight:400,borderRadius:2,background:`linear-gradient(135deg, ${n.palette.primary.main} 0%, ${n.palette.primary.dark} 100%)`,color:"white","& .MuiChip-label":{px:1}}})]})})},z.text))]},I.text):e.jsx(Pe,{disablePadding:!0,sx:{mb:.125},children:e.jsx(Fe,{title:M?I.text:"",placement:"right",arrow:!0,children:e.jsxs(ss,{selected:o.pathname===I.path,onClick:()=>T(I.path),sx:{borderRadius:1.5,mx:.25,py:.75,px:M?.5:1,transition:"all 0.2s ease-in-out",position:"relative",justifyContent:M?"center":"flex-start","&.Mui-selected":{bgcolor:U(n.palette.primary.main,.12),"&:hover":{bgcolor:U(n.palette.primary.main,.18)},"& .MuiListItemIcon-root":{color:n.palette.primary.main,transform:"scale(1.1)"},"& .MuiListItemText-primary":{color:n.palette.primary.main,fontWeight:500},"&::before":{content:'""',position:"absolute",left:0,top:"50%",transform:"translateY(-50%)",width:4,height:24,bgcolor:n.palette.primary.main,borderRadius:"0 2px 2px 0"}},"&:hover":{bgcolor:U(n.palette.primary.main,.08),transform:M?"scale(1.05)":"translateX(4px)","& .MuiListItemIcon-root":{transform:"scale(1.05)"}}},children:[e.jsx(tt,{sx:{minWidth:M?32:44,transition:"all 0.2s ease-in-out"},children:I.icon}),!M&&e.jsxs(e.Fragment,{children:[e.jsx(ve,{primary:I.text,primaryTypographyProps:{variant:"body2",fontWeight:o.pathname===I.path?500:300,fontSize:"0.875rem"}}),I.badge&&e.jsx(ce,{label:I.badge,size:"small",color:"primary",sx:{height:22,fontSize:"0.7rem",fontWeight:400,borderRadius:2,background:`linear-gradient(135deg, ${n.palette.primary.main} 0%, ${n.palette.primary.dark} 100%)`,color:"white","& .MuiChip-label":{px:1}}})]})]})})},I.text)})})}),!s&&!a&&e.jsx(l,{sx:{p:1,display:"flex",justifyContent:"center",borderTop:1,borderColor:"divider",background:U(n.palette.background.paper,.5)},children:e.jsx(Fe,{title:t(M?"navigation.expandMenu":"navigation.collapseMenu"),placement:"right",children:e.jsx(Ie,{onClick:L,sx:{color:"text.secondary","&:hover":{color:"primary.main",backgroundColor:U(n.palette.primary.main,.1)},transition:"all 0.2s ease-in-out"},children:M?e.jsx(tp,{}):e.jsx(np,{})})})}),e.jsxs(l,{sx:{mt:"auto",p:.5,background:`linear-gradient(135deg, ${U(n.palette.background.paper,.8)} 0%, ${U(n.palette.background.paper,.6)} 100%)`,backdropFilter:"blur(12px)",borderRadius:"12px 0 0 0",overflow:"hidden",flexShrink:0},children:[e.jsx(Fe,{title:M?(g==null?void 0:g.fullName)||(g==null?void 0:g.username)||"User":"",placement:"right",arrow:!0,children:e.jsxs(l,{onClick:()=>{g&&(i("/profile"),(s||a)&&u(!1))},sx:{display:"flex",alignItems:"center",mb:.5,p:M?.5:1,borderRadius:2,background:U(n.palette.background.paper,.3),transition:"all 0.2s ease-in-out",position:"relative",cursor:g?"pointer":"default",justifyContent:M?"center":"flex-start","&:hover":{background:U(n.palette.background.paper,.5),boxShadow:`0 2px 8px ${U(n.palette.primary.main,.1)}`}},children:[g&&!g.isProfileComplete&&!g.isPasswordSet&&e.jsx(l,{sx:{position:"absolute",top:-4,right:-4,zIndex:1},children:e.jsx(Fe,{title:t("navigation.profileIncomplete"),placement:"top",children:e.jsx(ce,{icon:e.jsx(on,{sx:{fontSize:14}}),label:"!",size:"small",color:"warning",sx:{height:20,fontSize:"0.7rem",fontWeight:"bold",animation:"pulse 2s infinite","@keyframes pulse":{"0%":{transform:"scale(1)",opacity:1},"50%":{transform:"scale(1.1)",opacity:.8},"100%":{transform:"scale(1)",opacity:1}},"&:hover":{animation:"none",transform:"scale(1.1)"}}})})}),e.jsx(Vt,{sx:{width:M?32:40,height:M?32:40,mr:M?0:2,border:`2px solid ${U(n.palette.primary.main,.15)}`,background:`linear-gradient(135deg, ${U(n.palette.primary.main,.15)} 0%, ${U(n.palette.primary.main,.08)} 100%)`,boxShadow:`0 2px 8px ${U(n.palette.primary.main,.2)}`},children:g!=null&&g.avatarText?e.jsx(D,{variant:"body2",sx:{fontWeight:600,color:"primary.main"},children:g.avatarText}):e.jsx(rp,{sx:{color:"primary.main"}})}),!M&&e.jsxs(l,{sx:{flexGrow:1,minWidth:0},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(D,{variant:"body2",sx:{fontWeight:500,color:"text.primary",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(g==null?void 0:g.fullName)||(g==null?void 0:g.username)||"User"}),g!=null&&g.isProfileComplete?e.jsx(Fe,{title:t("navigation.profileComplete"),placement:"top",children:e.jsx(Xe,{sx:{fontSize:16,color:"success.main",opacity:.8}})}):g!=null&&g.isPasswordSet?e.jsx(Fe,{title:t("navigation.passwordSet"),placement:"top",children:e.jsx(Xe,{sx:{fontSize:16,color:"info.main",opacity:.8}})}):e.jsx(Fe,{title:t("navigation.profileNeedsCompletion"),placement:"top",children:e.jsx(Tt,{sx:{fontSize:16,color:"warning.main",opacity:.8}})})]}),e.jsx(D,{variant:"caption",color:"text.secondary",sx:{fontWeight:400,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},children:(g==null?void 0:g.email)||(g==null?void 0:g.username)||"No email"}),g&&!g.isProfileComplete&&e.jsx(D,{variant:"caption",color:"warning.main",sx:{fontWeight:500,display:"block",mt:.5,fontSize:"0.7rem"},children:t("navigation.completeYourProfile")})]})]})}),!M&&e.jsxs(l,{sx:{display:"flex",gap:1.5,justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Fe,{title:t("navigation.settings"),placement:"top",children:e.jsx(Ie,{size:"small",onClick:()=>{i("/profile"),(s||a)&&u(!1)},sx:{color:"text.secondary",background:U(n.palette.background.paper,.3),"&:hover":{color:"primary.main",background:U(n.palette.primary.main,.1),transform:"scale(1.05)"},transition:"all 0.2s ease-in-out",borderRadius:2,width:36,height:36},children:e.jsx(Gr,{fontSize:"small"})})}),e.jsx(Fe,{title:t("navigation.logout"),placement:"top",children:e.jsx(ut,{size:"small",onClick:f,startIcon:e.jsx(sp,{fontSize:"small"}),sx:{color:"error.main",background:U(n.palette.error.main,.1),"&:hover":{background:U(n.palette.error.main,.15),transform:"scale(1.05)",boxShadow:`0 2px 8px ${U(n.palette.error.main,.2)}`},transition:"all 0.2s ease-in-out",borderRadius:2,px:1.5,py:.5,fontSize:"0.75rem!important",fontWeight:500,textTransform:"none"},children:t("navigation.logout")})})]})]})]});return e.jsxs(l,{sx:{display:"flex",width:"100%",height:"100vh",overflow:"hidden"},children:[e.jsx(_u,{}),e.jsx(hc,{position:"fixed",elevation:0,sx:{width:{xs:"100%",sm:"100%",md:`calc(100% - ${M?Lt(n,!0).md:Lt(n,!1).md}px)`,lg:`calc(100% - ${M?Lt(n,!0).lg:Lt(n,!1).lg}px)`,xl:`calc(100% - ${M?Lt(n,!0).xl:Lt(n,!1).xl}px)`},ml:{xs:0,sm:0,md:`${M?Lt(n,!0).md:Lt(n,!1).md}px`,lg:`${M?Lt(n,!0).lg:Lt(n,!1).lg}px`,xl:`${M?Lt(n,!0).xl:Lt(n,!1).xl}px`},bgcolor:"white",color:"text.primary",borderBottom:1,borderColor:"divider",zIndex:n.zIndex.appBar,backdropFilter:"blur(10px)",background:`linear-gradient(135deg, ${U(n.palette.background.paper,.95)} 0%, ${U(n.palette.background.paper,.9)} 100%)`,transition:"all 0.3s ease-in-out"},children:e.jsxs(no,{sx:{justifyContent:"space-between"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ie,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:A,sx:{mr:2,display:{md:"none"}},children:e.jsx(Za,{})}),b&&v?e.jsxs(l,{sx:{maxWidth:{xs:"180px",sm:"300px",md:"400px"},overflow:"hidden"},children:[e.jsx(c,{variant:"h6",noWrap:!0,component:"div",sx:{fontWeight:"bold",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:v.name}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t("portfolio.title")})]}):e.jsxs(l,{sx:{display:{xs:"none",sm:"block"}},children:[e.jsx(c,{variant:"h6",noWrap:!0,component:"div",sx:{fontWeight:"bold"},children:"Portfolio Management System"}),e.jsx(c,{variant:"caption",color:"text.secondary",children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:{xs:1,sm:2},flexWrap:"nowrap"},children:[e.jsxs(l,{sx:{display:b&&s&&!a?"none":"flex",alignItems:"center",gap:{xs:.5,sm:1},mr:{xs:1,sm:2}},children:[e.jsxs(l,{sx:{position:"relative"},children:[e.jsx(Fe,{title:t("navigation.clickToGoToHome"),placement:"bottom",arrow:!0,children:e.jsx(Vt,{sx:{width:32,height:32,fontSize:"0.875rem",cursor:"pointer",transition:"all 0.2s ease-in-out","&:hover":{transform:"scale(1.05)",boxShadow:2},...(x==null?void 0:x.isMainAccount)&&{background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",border:"2px solid",borderColor:"primary.main"}},onClick:()=>i("/"),children:y?"...":((x==null?void 0:x.name)||t("common.user")).split(" ").map(I=>I.charAt(0)).join("").toUpperCase().slice(0,2)})}),(x==null?void 0:x.isMainAccount)&&e.jsx(l,{sx:{position:"absolute",top:-2,right:-2,width:12,height:12,borderRadius:"50%",backgroundColor:"primary.main",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(D,{sx:{fontSize:"0.6rem",color:"white",fontWeight:"bold"},children:""})})]}),e.jsxs(l,{sx:{display:{xs:"flex",sm:"flex"},flexDirection:"column",alignItems:"flex-start"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(D,{variant:"body2",sx:{fontWeight:500,fontSize:"0.875rem"},children:y?t("common.loading"):(x==null?void 0:x.name)||t("common.user")}),(x==null?void 0:x.isMainAccount)&&e.jsx(l,{sx:{px:.5,py:.25,backgroundColor:"primary.main",borderRadius:.5,fontSize:"0.6rem",color:"white",fontWeight:"bold"},children:"MAIN"})]}),e.jsxs(D,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem"},children:[y?"...":`${t("common.account")}`,j&&e.jsxs(l,{component:"span",sx:{ml:.5,color:"warning.main",fontWeight:600},children:[" ",t("common.readOnlyMode","Read-only")]})]})]})]}),e.jsx(a1,{}),e.jsx(l1,{size:"small"}),e.jsx(o1,{variant:"select",size:"small",showLabel:!1}),e.jsx(nv,{})]})]})}),e.jsxs(l,{component:"nav",sx:{width:{xs:0,sm:0,md:M?Lt(n,!0).md:Lt(n,!1).md,lg:M?Lt(n,!0).lg:Lt(n,!1).lg,xl:M?Lt(n,!0).xl:Lt(n,!1).xl},flexShrink:{sm:0}},"aria-label":"navigation",children:[e.jsx(Rl,{variant:"temporary",open:d,onClose:A,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",md:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:Lt(n,!1).xs,overflow:"hidden",overflowX:"hidden",maxWidth:"100%"}},children:O}),e.jsx(Rl,{variant:"permanent",sx:{display:{xs:"none",md:"block"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:{sm:M?Lt(n,!0).sm:Lt(n,!1).sm,md:M?Lt(n,!0).md:Lt(n,!1).md,lg:M?Lt(n,!0).lg:Lt(n,!1).lg,xl:M?Lt(n,!0).xl:Lt(n,!1).xl},transition:"width 0.3s ease-in-out",overflow:"hidden",overflowX:"hidden",maxWidth:"100%"}},open:!0,children:O})]}),e.jsxs(l,{component:"main",sx:{flexGrow:1,width:{xs:"100%",sm:"100%",md:`calc(100% - ${M?Lt(n,!0).md:Lt(n,!1).md}px)`,lg:`calc(100% - ${M?Lt(n,!0).lg:Lt(n,!1).lg}px)`,xl:`calc(100% - ${M?Lt(n,!0).xl:Lt(n,!1).xl}px)`},background:`linear-gradient(135deg, ${n.palette.background.default} 0%, ${U(n.palette.background.paper,.8)} 100%)`,minHeight:"100vh",maxHeight:"100vh",overflow:"hidden",position:"relative",transition:"all 0.3s ease-in-out","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,bottom:0,background:"radial-gradient(circle at 20% 80%, rgba(30, 58, 138, 0.03) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(5, 150, 105, 0.03) 0%, transparent 50%)",pointerEvents:"none"}},children:[e.jsx(no,{}),e.jsx(_C,{}),e.jsxs(l,{"data-scrollable-container":"true",sx:{p:{xs:1,sm:2,md:2.5},position:"relative",zIndex:1,height:"calc(100vh - 64px)",overflow:"auto",...j&&!localStorage.getItem("demoAccountBannerDismissed")&&{height:"calc(100vh - 64px - 100px)"}},children:[r,g&&e.jsx(i1,{userId:g.userId})]}),e.jsx(BC,{portfolioId:wu()}),e.jsx(UC,{onClick:A,isOpen:d})]})]})},YC=r=>{switch(r){case"1D":return{months:1,granularity:"DAILY"};case"1W":return{months:1,granularity:"DAILY"};case"1M":return{months:1,granularity:"DAILY"};case"3M":return{months:3,granularity:"DAILY"};case"6M":return{months:6,granularity:"DAILY"};case"1Y":return{months:12,granularity:"DAILY"};default:return{months:1,granularity:"DAILY"}}},qC=(r,t="1M")=>{const{accountId:n,loading:s}=Ge(),{months:a,granularity:i}=YC(t),{data:o,isLoading:d,error:u}=yt(["portfolio-change-all",r.map(m=>(m==null?void 0:m.portfolioId)||(m==null?void 0:m.id)||"").filter(Boolean).join(","),t,n],async()=>{if(!r||!Array.isArray(r)||r.length===0)return[];const m=r.filter(g=>g&&(g.portfolioId||g.id));if(m.length===0||!n)return[];const x=m.map(async g=>{try{const f=g.portfolioId||g.id;return f?await q.getPortfolioNAVHistory(f,n,{months:a,granularity:i}):null}catch(f){return console.warn(`Failed to fetch NAV history for portfolio ${g.portfolioId||g.id}:`,f),null}});return Promise.all(x)},{enabled:!!r&&Array.isArray(r)&&r.length>0&&r.some(m=>m&&(m.portfolioId||m.id))&&!!n&&!s,staleTime:5*60*1e3,cacheTime:10*60*1e3});return{change:(()=>{if(!o||o.length===0)return"+0.0%";let m=0,x=0;if(o.forEach(y=>{var j,b;if(y&&y.data&&Array.isArray(y.data)&&y.data.length>=2){const v=[...y.data].sort((C,k)=>new Date(C.date).getTime()-new Date(k.date).getTime()),P=parseFloat(((j=v[0].navValue)==null?void 0:j.toString())||"0"),w=parseFloat(((b=v[v.length-1].navValue)==null?void 0:b.toString())||"0");m+=P,x+=w}}),m===0)return"+0.0%";const g=(x-m)/m*100;return`${g>=0?"+":""}${g.toFixed(1)}%`})(),isLoading:d,error:u}},ax=()=>{const[r,t]=p.useState(null),[n,s]=p.useState(null),[a,i]=p.useState(!1),{data:o,isLoading:d,error:u}=yt("autoSyncStatus",async()=>{try{return await q.get("/api/v1/global-assets/auto-sync/status")}catch{return{enabled:!1,interval:15,cronExpression:"0 */15 * * * *"}}},{refetchInterval:6e5,staleTime:1e4,retry:1}),{data:h,isLoading:m,error:x}=yt("latestPriceUpdate",async()=>{try{return(await q.get("/api/v1/asset-prices?sortBy=lastPriceUpdate&sortOrder=DESC&limit=1")).data}catch{return{data:[]}}},{refetchInterval:!1,staleTime:1e4,retry:1});return p.useEffect(()=>{var y,j,b,v,P,w;if(o)if(i(o.enabled),o.enabled){if(o.lastSync?t(new Date(o.lastSync)):(v=(b=h==null?void 0:h.data)==null?void 0:b[0])!=null&&v.lastPriceUpdate&&t(new Date(h.data[0].lastPriceUpdate)),o.nextSync)s(new Date(o.nextSync));else if(o.lastSync&&o.interval){const C=new Date(o.lastSync),k=new Date(C.getTime()+o.interval*60*1e3);s(k)}}else{if((j=(y=h==null?void 0:h.data)==null?void 0:y[0])!=null&&j.lastPriceUpdate)t(new Date(h.data[0].lastPriceUpdate));else{const C=new Date,k=Math.floor(Math.random()*30)+1;t(new Date(C.getTime()-k*60*1e3))}s(null)}else if((w=(P=h==null?void 0:h.data)==null?void 0:P[0])!=null&&w.lastPriceUpdate)t(new Date(h.data[0].lastPriceUpdate));else{const C=new Date,k=Math.floor(Math.random()*30)+1;t(new Date(C.getTime()-k*60*1e3))}},[o,h]),{lastDataUpdate:r,nextUpdate:n,isAutoSyncEnabled:a,isLoading:d||m,error:u||x}},GC=()=>{const{t:r}=Ne(),{lastDataUpdate:t,isLoading:n,error:s,isAutoSyncEnabled:a}=ax();return{lastUpdateTime:t,formattedLastUpdateTime:(o=>{if(!o)return r("dashboard.dataUpdateStatus.noData");const u=new Date().getTime()-o.getTime(),h=Math.floor(u/(1e3*60)),m=Math.floor(h/60),x=Math.floor(m/24);return h<1?r("dashboard.dataUpdateStatus.justUpdated"):h<60?r("dashboard.dataUpdateStatus.minutesAgo",{minutes:h}):m<24?r("dashboard.dataUpdateStatus.hoursAgo",{hours:m}):x<7?r("dashboard.dataUpdateStatus.daysAgo",{days:x}):o.toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})(t),isLoading:n,error:s,isAutoSyncEnabled:a}},KC=({open:r,onClose:t,sourcePortfolio:n,onPortfolioCopied:s,onModalClose:a})=>{const{t:i}=Ne(),[o,d]=p.useState(""),[u,h]=p.useState(!1),[m,x]=p.useState(null),g=()=>{d(""),x(null),t()},f=async()=>{var j,b;if(!n||!o.trim()){x(i("portfolio.copy.validation.nameRequired"));return}h(!0),x(null);try{const v=await q.copyPortfolio({sourcePortfolioId:n.portfolioId,name:o.trim()});s(v),setTimeout(()=>{a&&a(),g()},500)}catch(v){x(((b=(j=v.response)==null?void 0:j.data)==null?void 0:b.message)||v.message||i("portfolio.copy.error.copyFailed"))}finally{h(!1)}},y=j=>{j.key==="Enter"&&!u&&f()};return e.jsxs(Rt,{open:r,onClose:g,title:i("portfolio.copy.title"),icon:e.jsx(Os,{color:"primary"}),loading:u,maxWidth:"sm",fullWidth:!0,actions:e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:g,disabled:u,mobileText:i("common.cancel"),desktopText:i("common.cancel"),sx:{mr:1},children:i("common.cancel")}),e.jsx(We,{onClick:f,variant:"contained",disabled:u||!o.trim(),icon:u?e.jsx(Ce,{size:16}):e.jsx(Os,{}),mobileText:i(u?"portfolio.copy.copying":"portfolio.copy.copy"),desktopText:i(u?"portfolio.copy.copying":"portfolio.copy.copyPortfolio"),forceTextOnly:!0,sx:{borderRadius:1,px:3},children:i(u?"portfolio.copy.copying":"portfolio.copy.copyPortfolio")})]}),children:[n&&e.jsxs(l,{sx:{m:2},children:[e.jsxs(D,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:[i("portfolio.copy.copyingFrom"),":"]}),e.jsx(D,{variant:"h6",color:"primary",children:n.name})]}),e.jsx(Ae,{autoFocus:!0,fullWidth:!0,label:i("portfolio.copy.newPortfolioName"),placeholder:i("portfolio.copy.newPortfolioNamePlaceholder"),value:o,onChange:j=>d(j.target.value),onKeyPress:y,disabled:u,sx:{"& .MuiOutlinedInput-root":{borderRadius:1}}}),m&&e.jsx(je,{severity:"error",sx:{mt:2},children:m}),e.jsxs(l,{sx:{mt:2,p:2,bgcolor:"grey.50",borderRadius:1},children:[e.jsx(D,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:e.jsxs("strong",{children:[i("portfolio.copy.whatWillBeCopied"),":"]})}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:[" ",i("portfolio.copy.copyItems.trades")]}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:[" ",i("portfolio.copy.copyItems.cashFlows")]}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:[" ",i("portfolio.copy.copyItems.deposits")]}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:[" ",i("portfolio.copy.copyItems.settings")]}),e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mt:1,fontStyle:"italic"},children:i("portfolio.copy.note")})]})]})},QC=({portfolio:r,onView:t,onEdit:n,onDelete:s,onPortfolioCopied:a,onManagePermissions:i,hideActions:o=!1,isReadOnly:d=!1,permissionStats:u})=>{const{t:h}=Ne(),m=Je(),x=Nt(m.breakpoints.down("sm")),[g,f]=p.useState(!1),[y,j]=p.useState(!1),[b,v]=p.useState(!1),[P,w]=p.useState(!1),[C,k]=p.useState(!1),[A,L]=p.useState(!1),T=(Number(r.unrealizedInvestPnL)||0)>=0,M=(Number(r.realizedInvestPnL)||0)>=0,O=r.isFund||!1,I=()=>{b||P||y||g||C||t(r.portfolioId)},z=$=>{$.preventDefault(),$.stopPropagation(),n&&!o&&n(r.portfolioId)},N=$=>{$.preventDefault(),$.stopPropagation(),o||f(!0)},E=()=>{f(!1),k(!0),setTimeout(()=>{k(!1)},200)},R=$=>{a&&a($)},V=$=>{$.preventDefault(),$.stopPropagation(),o||j(!0)},F=async()=>{if(!(!s||!A)){v(!0);try{await s(r.portfolioId),w(!0),j(!1),L(!1)}catch($){console.error("Failed to delete portfolio:",$)}finally{v(!1)}}},B=()=>{j(!1),L(!1),k(!0),setTimeout(()=>{k(!1)},200)};return e.jsxs("div",{className:`portfolio-card ${O?"portfolio-card--fund":"portfolio-card--individual"} ${P?"portfolio-card--deleted":""}`,onClick:I,style:{opacity:P?.5:1,pointerEvents:P?"none":"auto",transition:"opacity 0.3s ease"},children:[e.jsxs("div",{className:"portfolio-card__content",children:[e.jsx("div",{className:"portfolio-card__header",children:e.jsxs("div",{className:"portfolio-card__title-section",children:[e.jsxs("div",{className:"portfolio-card__title-wrapper",children:[O?e.jsx(ks,{className:"portfolio-card__type-icon portfolio-card__type-icon--fund"}):e.jsx(qt,{className:"portfolio-card__type-icon portfolio-card__type-icon--individual"}),e.jsx(c,{variant:"cardTitle",className:"portfolio-card__title",children:r.name}),r.visibility==="PUBLIC"&&e.jsx(Fe,{title:h("portfolio.publicTooltip")||"Public Portfolio",children:e.jsx(Uu,{className:"portfolio-card__public-icon",style:{color:"#1976d2",marginLeft:"8px",fontSize:"18px"}})})]}),e.jsx("div",{className:"portfolio-card__type-badge",style:{display:x?"none":"block"},children:h(O?"portfolio.fund":"portfolio.individual")})]})}),e.jsxs("div",{className:"portfolio-card__metrics",children:[e.jsxs("div",{className:"portfolio-card__total-value",children:[e.jsx(Ue,{className:"portfolio-card__total-value-icon"}),e.jsxs("div",{children:[e.jsx(c,{variant:"cardValue",className:"portfolio-card__total-value-amount",children:G(Number(r.totalInvestValue)||0,r.baseCurrency)}),e.jsx(c,{variant:"cardLabel",className:"portfolio-card__total-value-label",children:h("portfolio.investmentValue")})]})]}),e.jsxs("div",{className:"portfolio-card__pl-section",children:[e.jsxs("div",{className:"portfolio-card__pl-item",children:[e.jsxs("div",{className:"portfolio-card__pl-header",children:[T?e.jsx(He,{className:"portfolio-card__pl-icon portfolio-card__pl-icon--positive"}):e.jsx(Bt,{className:"portfolio-card__pl-icon portfolio-card__pl-icon--negative"}),e.jsx(c,{variant:"cardValueMedium",sx:{fontWeight:600},className:`portfolio-card__pl-amount ${T?"portfolio-card__pl-amount--positive":"portfolio-card__pl-amount--negative"}`,children:G(Number(r.unrealizedInvestPnL)||0,r.baseCurrency)})]}),e.jsx(c,{variant:"cardLabel",className:"portfolio-card__total-value-label",children:h("portfolio.unrealizedPL")})]}),e.jsxs("div",{className:"portfolio-card__pl-item",children:[e.jsxs("div",{className:"portfolio-card__pl-header",children:[M?e.jsx(He,{className:"portfolio-card__pl-icon portfolio-card__pl-icon--positive"}):e.jsx(Bt,{className:"portfolio-card__pl-icon portfolio-card__pl-icon--negative"}),e.jsx(c,{variant:"cardValueMedium",sx:{fontWeight:600},className:`portfolio-card__pl-amount ${M?"portfolio-card__pl-amount--positive":"portfolio-card__pl-amount--negative"}`,children:G(Number(r.realizedInvestPnL)||0,r.baseCurrency)})]}),e.jsx(c,{variant:"cardLabel",className:"portfolio-card__total-value-label",children:h("portfolio.realizedPL")})]})]}),e.jsxs("div",{className:"portfolio-card__cash-balance",children:[e.jsx(c,{variant:"cardLabel",className:"portfolio-card__total-value-label",children:h("portfolio.cashBalance")}),e.jsx(c,{variant:"cardValueMedium",sx:{fontWeight:600},className:"portfolio-card__cash-amount",children:G(Number(r.cashBalance)||0,r.baseCurrency)})]})]})]}),!o&&!d&&e.jsxs("div",{className:"portfolio-card__actions",children:[e.jsxs(l,{display:"flex",gap:.5,alignItems:"center",children:[n&&!d&&e.jsx(tr,{onClick:z,color:"primary",size:"small",tooltip:h("common.edit")||"Edit",sx:{"&:hover":{backgroundColor:"primary.light",color:"white"}},children:e.jsx(Tt,{})}),!d&&e.jsx(tr,{onClick:N,color:"secondary",size:"small",tooltip:h("common.copy")||"Copy",sx:{"&:hover":{backgroundColor:"secondary.light",color:"white"}},children:e.jsx(Os,{})}),i&&!d&&e.jsx(tr,{onClick:$=>{$.preventDefault(),$.stopPropagation(),i(r.portfolioId)},color:"info",size:"small",tooltip:"Manage Permissions",sx:{"&:hover":{backgroundColor:"info.light",color:"white"}},children:e.jsx(Jt,{})}),s&&!d&&e.jsx(tr,{onClick:V,color:"error",size:"small",tooltip:h("common.delete")||"Delete",sx:{"&:hover":{backgroundColor:"error.light",color:"white"}},children:e.jsx(pt,{})})]}),u&&Number(u.totalAccounts)>0&&e.jsxs(l,{display:"flex",alignItems:"center",gap:1,sx:{px:1,py:.5,borderRadius:1,backgroundColor:"action.hover",border:"1px solid",borderColor:"divider"},children:[e.jsx(Yu,{sx:{fontSize:16,color:"primary.main"}}),e.jsxs(c,{variant:"caption",sx:{fontWeight:500,color:"text.primary"},children:[u.totalAccounts," ",u.totalAccounts===1?"account":"accounts"]})]})]}),e.jsx(KC,{open:g,onClose:E,sourcePortfolio:r,onPortfolioCopied:R,onModalClose:E}),e.jsxs(Rt,{open:y,onClose:B,title:h("portfolio.delete"),icon:e.jsx(pt,{color:"error"}),loading:b,maxWidth:"sm",fullWidth:!0,titleColor:"error",actions:e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:B,disabled:b,color:"inherit",children:h("common.cancel")}),e.jsx(We,{onClick:F,disabled:b||!A,color:"error",variant:"contained",icon:b?e.jsx(Ce,{size:16}):e.jsx(pt,{}),mobileText:h("common.delete"),desktopText:h("portfolio.delete"),children:h(b?"portfolio.deleting":"portfolio.delete")})]}),children:[e.jsx(je,{severity:"warning",sx:{mb:2,mt:2},children:e.jsx(c,{variant:"body2",fontWeight:"bold",children:h("portfolio.cannotUndo")})}),e.jsx(c,{variant:"body1",paragraph:!0,children:h("portfolio.confirmDelete",{name:r.name})}),e.jsxs(c,{variant:"body2",color:"text.secondary",paragraph:!0,children:[h("portfolio.willPermanentlyDelete"),":"]}),e.jsxs(l,{component:"ul",sx:{pl:2,m:0,mb:3},children:[e.jsx(c,{component:"li",variant:"body2",color:"text.secondary",children:h("portfolio.deleteTrades")}),e.jsx(c,{component:"li",variant:"body2",color:"text.secondary",children:h("portfolio.deleteCashFlows")}),e.jsx(c,{component:"li",variant:"body2",color:"text.secondary",children:h("portfolio.deleteSnapshots")}),e.jsx(c,{component:"li",variant:"body2",color:"text.secondary",children:h("portfolio.deleteHoldings")}),e.jsx(c,{component:"li",variant:"body2",color:"text.secondary",children:h("portfolio.deleteHistorical")})]}),e.jsx(l,{sx:{border:"1px solid #e0e0e0",borderRadius:1,p:2,backgroundColor:"#fafafa",mb:2},children:e.jsx(an,{control:e.jsx(rn,{checked:A,onChange:$=>L($.target.checked),color:"error"}),label:e.jsx(c,{variant:"formHelper",sx:{color:"error.main",fontWeight:"bold"},ellipsis:!1,children:"Ti hiu rng hnh ng ny khng th hon tc v s xa vnh vin tt c d liu lin quan"})})})]})]})},ix=({portfolio:r,onView:t,onEdit:n,onDelete:s,onPortfolioCopied:a,onManagePermissions:i,hideActions:o=!1,isReadOnly:d=!1})=>{var f;const{accountId:u}=Ge(),h=r.accountId===u||((f=r.userPermission)==null?void 0:f.isOwner)===!0,{data:m}=av(r.portfolioId,h),x=!o&&h&&!d,g=h;return e.jsx(QC,{portfolio:r,onView:t,onEdit:h&&!d?n:void 0,onDelete:h&&!d?s:void 0,onPortfolioCopied:a,onManagePermissions:h&&!d?i:void 0,hideActions:!x,permissionStats:g&&m||void 0,isReadOnly:d})};var Yr;let XC=(Yr=class{constructor(){zn(this,"listeners",[])}static getInstance(){return Yr.instance||(Yr.instance=new Yr),Yr.instance}subscribe(t){return this.listeners.push(t),()=>{this.listeners=this.listeners.filter(n=>n!==t)}}show(t,n="success",s=3e3){const a={message:t,type:n,duration:s};this.listeners.forEach(i=>i(a)),setTimeout(()=>{this.listeners.forEach(i=>i(null))},s)}hide(){this.listeners.forEach(t=>t(null))}},zn(Yr,"instance"),Yr);const gr=XC.getInstance();class Yt{static success(t,n){return gr.show(t,"success",(n==null?void 0:n.duration)||3e3)}static error(t,n){return gr.show(t,"error",(n==null?void 0:n.duration)||5e3)}static warning(t,n){return gr.show(t,"warning",(n==null?void 0:n.duration)||4e3)}static info(t,n){return gr.show(t,"success",(n==null?void 0:n.duration)||3e3)}static custom(t,n){return gr.show(t,"success",(n==null?void 0:n.duration)||3e3)}static hide(){return gr.hide()}static clear(){return gr.hide()}}const Xc=({open:r,onClose:t,portfolioId:n,portfolioName:s,onPermissionUpdated:a,creatorAccountId:i})=>{const{t:o}=Ne(),{accountId:d}=Ge(),u=An(),[h,m]=p.useState([]),[x,g]=p.useState(!1),[f,y]=p.useState(null),[j,b]=p.useState(""),[v,P]=p.useState(Ht.VIEW),[w,C]=p.useState(!1),[k,A]=p.useState(!1),[L,T]=p.useState(null);p.useEffect(()=>{r&&n&&M()},[r,n]);const M=async()=>{if(d)try{g(!0),y(null);const F=await Qi.getPortfolioPermissions(n,d);m(F)}catch(F){y(o("permissions.errors.loadFailed")),console.error("Error loading permissions:",F)}finally{g(!1)}},O=async()=>{if(!(!j||!v||!d))try{C(!0);const F={portfolioId:n,accountId:j,permissionType:v},B=await Qi.createPermission(F,d);v===Ht.CREATOR?(b(""),P(Ht.VIEW),Yt.success(o("permissions.transferCreatorSuccess")),t(),u("/portfolios"),a&&a()):(m($=>[...$,B]),b(""),P(Ht.VIEW),a&&a())}catch(F){v===Ht.CREATOR?y(o("permissions.errors.transferCreatorFailed")):y(o("permissions.errors.addFailed")),console.error("Error adding permission:",F)}finally{C(!1)}},I=F=>{T(F),A(!0)},z=async()=>{if(!(!L||!d))try{await Qi.deletePermission(L,n,d),m(F=>F.filter(B=>B.permissionId!==L)),Yt.success(o("permissions.deleteSuccess")),a&&a()}catch(F){Yt.error(o("permissions.errors.deleteFailed")),y("Failed to delete permission"),console.error("Error deleting permission:",F)}finally{A(!1),T(null)}},N=()=>{A(!1),T(null)},E=F=>{switch(F){case Ht.OWNER:return e.jsx(gc,{});case Ht.UPDATE:return e.jsx(Tt,{});case Ht.VIEW:return e.jsx(Xt,{});case Ht.CREATOR:return e.jsx(ia,{});default:return e.jsx(Jt,{})}},R=F=>{switch(F){case Ht.OWNER:return"error";case Ht.UPDATE:return"warning";case Ht.VIEW:return"info";case Ht.CREATOR:return"success";default:return"default"}},V=F=>{switch(F){case Ht.OWNER:return o("permissions.permissionTypes.owner");case Ht.UPDATE:return o("permissions.permissionTypes.update");case Ht.VIEW:return o("permissions.permissionTypes.view");case Ht.CREATOR:return o("permissions.permissionTypes.creator");default:return"Unknown"}};return e.jsxs(Rt,{open:r,onClose:t,title:o("permissions.title"),icon:e.jsx(Jt,{color:"primary"}),maxWidth:"md",fullWidth:!0,actions:e.jsx(he,{onClick:t,variant:"outlined",mobileText:o("common.close"),desktopText:o("common.close"),children:o("common.close")}),children:[e.jsx(c,{variant:"cardTitle",sx:{mb:2},children:s}),f&&e.jsx(je,{severity:"error",sx:{mb:2},children:f}),e.jsxs(Te,{sx:{p:2,mb:3,backgroundColor:"grey.50"},children:[e.jsxs(c,{variant:"cardLabel",gutterBottom:!0,children:[e.jsx(ia,{sx:{mr:1,verticalAlign:"middle"}}),o("permissions.addNewPermission")]}),v===Ht.CREATOR&&e.jsxs(je,{severity:"warning",sx:{mb:2},children:[e.jsx(ui,{children:o("permissions.transferCreatorWarning")}),o("permissions.transferCreatorWarningMessage")]}),e.jsxs(l,{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap",children:[e.jsx(Ae,{label:o("permissions.accountId"),value:j,onChange:F=>b(F.target.value),size:"medium",placeholder:o("permissions.accountIdPlaceholder"),sx:{width:"100%"}}),e.jsxs(nt,{size:"small",sx:{minWidth:120},children:[e.jsx(st,{children:o("permissions.permission")}),e.jsxs(Ze,{value:v,onChange:F=>P(F.target.value),label:o("permissions.permission"),children:[e.jsx(re,{value:Ht.VIEW,children:o("permissions.permissionTypes.view")}),e.jsx(re,{value:Ht.UPDATE,children:o("permissions.permissionTypes.update")}),e.jsx(re,{value:Ht.OWNER,children:o("permissions.permissionTypes.owner")}),i&&d===i&&e.jsx(re,{value:Ht.CREATOR,children:o("permissions.permissionTypes.creator")})]})]}),e.jsx(We,{variant:"contained",onClick:O,disabled:!j||w,icon:w?e.jsx(Ce,{size:16}):e.jsx(xt,{}),mobileText:v===Ht.CREATOR?o("permissions.transferCreator"):o("permissions.addPermission"),desktopText:v===Ht.CREATOR?o("permissions.transferCreator"):o("permissions.addPermission"),forceTextOnly:!0,children:v===Ht.CREATOR?o("permissions.transferCreator"):o("permissions.addPermission")})]})]}),e.jsxs(c,{variant:"cardTitle",gutterBottom:!0,children:[o("permissions.currentPermissions")," (",h.length,")"]}),x?e.jsx(l,{display:"flex",justifyContent:"center",py:4,children:e.jsx(Ce,{})}):e.jsx(at,{component:Te,variant:"outlined",children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:o("permissions.account")}),e.jsx(S,{children:o("permissions.permission")}),e.jsx(S,{children:o("permissions.granted")}),e.jsx(S,{align:"center",children:o("permissions.actions")})]})}),e.jsx(ot,{children:h.map(F=>e.jsxs(De,{children:[e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Vt,{sx:{width:32,height:32},children:e.jsx(Sn,{})}),e.jsxs(l,{children:[e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:F.accountName||F.accountId}),e.jsx(c,{variant:"formHelper",color:"text.secondary",children:F.accountEmail||`ID: ${F.accountId.substring(0,8)}...`})]})]})}),e.jsx(S,{children:e.jsx(ce,{icon:E(F.permissionType),label:V(F.permissionType),color:R(F.permissionType),size:"small"})}),e.jsx(S,{children:e.jsx(c,{variant:"formHelper",children:new Date(F.grantedAt).toLocaleDateString()})}),e.jsx(S,{align:"center",children:e.jsx(l,{display:"flex",gap:1,justifyContent:"center",children:d!==F.accountId&&e.jsx(Fe,{title:o("permissions.removePermission"),children:e.jsx(Ie,{size:"small",color:"error",onClick:()=>I(F.permissionId),children:e.jsx(pt,{})})})})})]},F.permissionId))})]})}),h.length===0&&!x&&e.jsxs(l,{textAlign:"center",py:4,children:[e.jsx(Jt,{sx:{fontSize:48,color:"text.secondary",mb:2}}),e.jsx(c,{variant:"cardLabel",color:"text.primary",children:o("permissions.noPermissions")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:o("permissions.noPermissionsDescription")})]}),e.jsxs(kt,{open:k,onClose:N,"aria-labelledby":"delete-dialog-title","aria-describedby":"delete-dialog-description",children:[e.jsx(Et,{id:"delete-dialog-title",children:e.jsx(c,{variant:"cardTitle",children:o("permissions.confirmRemove")})}),e.jsx(Pt,{children:e.jsx(c,{variant:"body2",color:"text.secondary",ellipsis:!1,children:o("permissions.confirmRemoveDescription")})}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:N,variant:"outlined",forceTextOnly:!0,mobileText:o("common.cancel"),desktopText:o("common.cancel"),children:o("common.cancel")}),e.jsx(We,{onClick:z,color:"error",variant:"contained",forceTextOnly:!0,mobileText:o("permissions.removePermission"),desktopText:o("permissions.removePermission"),children:o("permissions.removePermission")})]})]})]})},ox=({open:r,onClose:t,onSelect:n})=>{const{t:s}=Ne(),[a,i]=p.useState([]),[o,d]=p.useState(!1),[u,h]=p.useState(null),[m,x]=p.useState("");p.useEffect(()=>{r&&g()},[r]);const g=async()=>{d(!0),h(null);try{const j=await q.getPublicPortfolios();i(j)}catch(j){h(j.message||s("publicPortfolioSelector.error.loadFailed"))}finally{d(!1)}},f=a.filter(j=>{var b,v;return j.name.toLowerCase().includes(m.toLowerCase())||((b=j.description)==null?void 0:b.toLowerCase().includes(m.toLowerCase()))||((v=j.templateName)==null?void 0:v.toLowerCase().includes(m.toLowerCase()))}),y=j=>{n(j),t()};return e.jsxs(Rt,{open:r,onClose:t,title:s("publicPortfolioSelector.title"),icon:e.jsx(Os,{}),maxWidth:"md",fullWidth:!0,actions:e.jsx(he,{onClick:t,children:s("common.cancel")}),loading:o,children:[e.jsx(Ae,{fullWidth:!0,placeholder:s("publicPortfolioSelector.searchPlaceholder"),value:m,onChange:j=>x(j.target.value),InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx($n,{})}),endAdornment:m&&e.jsx(un,{position:"end",children:e.jsx(Ie,{onClick:()=>x(""),children:e.jsx(ei,{})})})},sx:{mb:2,mt:2}}),u&&e.jsx(je,{severity:"error",sx:{mb:2},children:u}),!o&&!u&&e.jsx(lt,{children:f.map(j=>{var b,v,P;return e.jsxs(Pe,{button:!0,onClick:()=>y(j),sx:{border:1,borderColor:"divider",borderRadius:1,mb:1,"&:hover":{backgroundColor:"action.hover"}},children:[e.jsx(ve,{primary:j.templateName||j.name,secondary:e.jsxs(l,{component:"span",sx:{display:"block"},children:[e.jsx(D,{variant:"body2",color:"text.secondary",component:"span",children:j.description||s("publicPortfolioSelector.noDescription")}),j.creatorName&&e.jsx(D,{variant:"caption",color:"primary",component:"span",sx:{display:"block",mt:.5,fontWeight:500},children:s("publicPortfolioSelector.createdBy",{name:j.creatorName})})]})}),e.jsxs(l,{sx:{mt:1,display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(ce,{label:j.baseCurrency,size:"small"}),e.jsx(ce,{label:s("publicPortfolioSelector.tradesCount",{count:((b=j.trades)==null?void 0:b.length)||0}),size:"small"}),e.jsx(ce,{label:s("publicPortfolioSelector.cashFlowsCount",{count:((v=j.cashFlows)==null?void 0:v.length)||0}),size:"small"}),e.jsx(ce,{label:s("publicPortfolioSelector.depositsCount",{count:((P=j.deposits)==null?void 0:P.length)||0}),size:"small"})]}),e.jsx(bo,{children:e.jsx(Ie,{onClick:()=>y(j),children:e.jsx(Os,{})})})]},j.portfolioId)})}),!o&&!u&&f.length===0&&e.jsx(l,{sx:{textAlign:"center",py:3},children:e.jsx(D,{variant:"body1",color:"text.secondary",children:s(m?"publicPortfolioSelector.noSearchResults":"publicPortfolioSelector.noPortfolios")})})]})},JC=mi({name:sn().required("Portfolio name is required").min(2,"Name must be at least 2 characters"),baseCurrency:sn().required("Base currency is required"),fundingSource:sn().optional(),accountId:sn().required("Account ID is required")}),lx=({open:r,onClose:t,onSubmit:n,onCopyFromPublic:s,initialData:a,isEditing:i=!1,isLoading:o=!1,error:d})=>{var V;const{t:u}=Ne(),{accountId:h}=Ge(),{hasPermission:m}=Zr(),[x,g]=p.useState("create"),[f,y]=p.useState(null),[j,b]=p.useState(!1),[v,P]=p.useState("PRIVATE"),[w,C]=p.useState(""),[k,A]=p.useState(""),L=m("portfolio.visibility.manage"),{control:T,handleSubmit:M,reset:O,formState:{errors:I}}=xi({resolver:Si(JC),defaultValues:{name:(a==null?void 0:a.name)||"",baseCurrency:(a==null?void 0:a.baseCurrency)||"VND",fundingSource:(a==null?void 0:a.fundingSource)||"",accountId:(a==null?void 0:a.accountId)||h}});rt.useEffect(()=>{r&&(O({name:(a==null?void 0:a.name)||"",baseCurrency:(a==null?void 0:a.baseCurrency)||"VND",fundingSource:(a==null?void 0:a.fundingSource)||"",accountId:(a==null?void 0:a.accountId)||h}),i&&a&&(P(a.visibility||"PRIVATE"),C(a.description||""),A(a.templateName||"")))},[r,a,O,h,i]);const z=()=>{O(),g("create"),y(null),b(!1),P("PRIVATE"),C(""),A(""),t()},N=F=>{g(F),F==="create"&&(y(null),b(!1))},E=F=>{y(F),b(!1),O({name:`${F.templateName||F.name} Copy`,baseCurrency:F.baseCurrency,fundingSource:F.fundingSource||"",accountId:h||""})},R=F=>{if(x==="copy"&&f&&s)s(f.portfolioId,F.name);else{const B={...F};i&&(B.visibility=v,B.description=v==="PUBLIC"?w:void 0,B.templateName=v==="PUBLIC"?k:void 0),n(B)}};return e.jsxs(e.Fragment,{children:[e.jsx(Rt,{open:r,onClose:z,title:u(i?"portfolio.form.editTitle":"portfolio.form.createTitle"),maxWidth:"sm",fullWidth:!0,loading:o,actions:e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:z,disabled:o,mobileText:u("common.cancel"),desktopText:u("common.cancel"),children:u("common.cancel")}),e.jsx(We,{onClick:M(R),variant:"contained",disabled:o||x==="copy"&&!f,forceTextOnly:!0,startIcon:o?e.jsx(Ce,{size:16,color:"inherit"}):void 0,mobileText:u(o?"portfolio.form.saving":i?"common.update":"common.create"),desktopText:u(o?"portfolio.form.saving":i?"common.update":"common.create"),children:u(o?"portfolio.form.saving":i?"common.update":"common.create")})]}),children:e.jsxs(l,{sx:{pt:2},children:[d&&e.jsx(je,{severity:"error",sx:{mb:2,"& .MuiAlert-message":{fontSize:"0.875rem",fontWeight:500}},children:d}),!i&&e.jsxs(l,{sx:{mb:3},children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:u("portfolio.form.creationMode.title")}),e.jsxs(ro,{value:x,exclusive:!0,onChange:(F,B)=>B&&N(B),fullWidth:!0,children:[e.jsxs(xs,{value:"create",children:[e.jsx(xt,{sx:{mr:1}}),u("portfolio.form.creationMode.createNew")]}),e.jsxs(xs,{value:"copy",children:[e.jsx(Os,{sx:{mr:1}}),u("portfolio.form.creationMode.copyFromTemplate")]})]})]}),!i&&x==="copy"&&e.jsx(l,{sx:{mb:3},children:f?e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{children:[e.jsx(D,{variant:"h6",children:f.templateName||f.name}),e.jsx(D,{variant:"body2",color:"text.secondary",children:f.description||"No description available"}),e.jsxs(l,{sx:{mt:1},children:[e.jsx(ce,{label:f.baseCurrency,size:"small"}),e.jsx(ce,{label:`${((V=f.trades)==null?void 0:V.length)||0} trades`,size:"small",sx:{ml:1}})]})]}),e.jsx(Ie,{onClick:()=>b(!0),children:e.jsx($n,{})})]})})}):e.jsxs(l,{sx:{textAlign:"center",pt:0},children:[e.jsx(D,{variant:"body1",gutterBottom:!0,children:u("portfolio.form.templateSelector.selectTemplate")}),e.jsx(he,{onClick:()=>b(!0),variant:"outlined",startIcon:e.jsx($n,{}),forceTextOnly:!0,children:u("portfolio.form.templateSelector.browseTemplates")})]})}),e.jsxs(l,{display:"flex",flexDirection:"column",gap:2,children:[e.jsx(mn,{name:"name",control:T,render:({field:F})=>{var B;return e.jsx(Ae,{...F,label:u("portfolio.form.fields.name"),fullWidth:!0,error:!!I.name,helperText:(B=I.name)==null?void 0:B.message,placeholder:u("portfolio.form.fields.namePlaceholder")})}}),!(!i&&x==="copy")&&e.jsx(e.Fragment,{children:e.jsx(mn,{name:"fundingSource",control:T,render:({field:F})=>{var B;return e.jsx(Ae,{...F,label:u("portfolio.form.fields.fundingSource"),fullWidth:!0,error:!!I.fundingSource,helperText:(B=I.fundingSource)==null?void 0:B.message,placeholder:u("portfolio.form.fields.fundingSourcePlaceholder"),onChange:$=>F.onChange($.target.value.toUpperCase())})}})})]}),i&&L&&e.jsxs(l,{sx:{mt:3},children:[e.jsx(bt,{sx:{mb:2}}),e.jsx(Fe,{title:"Control who can view and copy this portfolio. Public portfolios can be copied by other users.",placement:"top",arrow:!0,children:e.jsx(an,{control:e.jsx(jn,{checked:v==="PUBLIC",onChange:F=>P(F.target.checked?"PUBLIC":"PRIVATE"),color:"primary"}),label:u(v==="PUBLIC"?"portfolio.form.visibility.public":"portfolio.form.visibility.private")})}),v==="PUBLIC"&&e.jsxs(l,{sx:{mt:2,display:"flex",flexDirection:"column",gap:2},children:[e.jsx(Ae,{label:u("portfolio.form.fields.templateName"),value:k,onChange:F=>A(F.target.value),fullWidth:!0,placeholder:u("portfolio.form.fields.templateNamePlaceholder"),helperText:u("portfolio.form.fields.templateNameHelper")}),e.jsx(Ae,{label:u("portfolio.form.fields.description"),value:w,onChange:F=>C(F.target.value),fullWidth:!0,multiline:!0,rows:3,placeholder:u("portfolio.form.fields.descriptionPlaceholder"),helperText:u("portfolio.form.fields.descriptionHelper")})]})]})]})}),e.jsx(ox,{open:j,onClose:()=>b(!1),onSelect:E})]})},Su="demoAccountSuggestionBannerDismissed",cx=()=>{const{t:r}=Ne(),t=Je(),n=Nt(t.breakpoints.down("sm")),{isDemoAccount:s,switchAccount:a}=Ge(),[i,o]=p.useState(!0),[d,u]=p.useState(null),[h,m]=p.useState(!1);p.useEffect(()=>{if(s)return;if(localStorage.getItem(Su)==="true"){o(!0);return}x();const j=setTimeout(()=>{o(!1)},1e3);return()=>clearTimeout(j)},[s]);const x=async()=>{try{const j=(await q.getAccounts()).find(b=>b.isDemoAccount);u(j||null)}catch(y){console.error("Error loading demo account:",y),u(null)}},g=()=>{o(!0),localStorage.setItem(Su,"true")},f=async()=>{if(d)try{m(!0),await a(d.accountId),window.location.href="/"}catch(y){console.error("Failed to switch to demo account:",y),m(!1)}};return s||i||!d?null:e.jsx(as,{direction:"down",in:!i,timeout:500,children:e.jsx(Xr,{in:!i,timeout:500,children:e.jsxs(je,{severity:"info",icon:e.jsx(fc,{}),action:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(ut,{size:"small",variant:"contained",color:"primary",startIcon:e.jsx(ti,{}),onClick:f,disabled:h,sx:{textTransform:"none",fontWeight:600,fontSize:{xs:"0.75rem",sm:"0.875rem"},px:{xs:1.5,sm:2},py:{xs:.5,sm:.75},borderRadius:1,whiteSpace:"nowrap",display:{xs:"none",sm:"flex"}},children:r("accountSwitcher.demoAccountSuggestion.tryDemo","Th Demo")}),e.jsx(Ie,{"aria-label":"close",color:"inherit",size:"small",onClick:g,sx:{"&:hover":{backgroundColor:U(t.palette.info.main,.1)}},children:e.jsx(sr,{fontSize:"small"})})]}),sx:{borderRadius:2,mb:3,background:`linear-gradient(135deg, ${U(t.palette.info.main,.08)} 0%, ${U(t.palette.info.main,.04)} 100%)`,border:`1px solid ${U(t.palette.info.main,.2)}`,boxShadow:`0 4px 12px ${U(t.palette.info.main,.15)}`,"& .MuiAlert-icon":{fontSize:{xs:"1.25rem",sm:"1.5rem"},color:t.palette.info.main},"& .MuiAlert-action":{alignItems:"center",paddingTop:{xs:.5,sm:"inherit"}}},children:[e.jsxs(ui,{sx:{fontWeight:700,fontSize:{xs:"0.875rem",sm:"1rem"},mb:.5,display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(ce,{label:r("accountSwitcher.demoAccountSuggestion.newFeature","Tnh nng mi"),size:"small",color:"info",sx:{height:{xs:20,sm:24},fontWeight:700,fontSize:{xs:"0.65rem",sm:"0.75rem"},flexShrink:0}}),e.jsx(l,{component:"span",children:r("accountSwitcher.demoAccountSuggestion.title","Khm ph ti khon Demo")})]}),e.jsxs(l,{sx:{mt:.5},children:[e.jsx(c,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem"},lineHeight:1.6,mb:{xs:1.5,sm:0}},ellipsis:!1,children:r("accountSwitcher.demoAccountSuggestion.message","Th nghim h thng vi ti khon Demo  xem cc tnh nng v d liu mu. Ti khon Demo cung cp d liu thc t v cho php bn khm ph h thng mt cch an ton.")}),n&&e.jsx(ut,{fullWidth:!0,size:"small",variant:"contained",color:"primary",startIcon:e.jsx(ti,{}),onClick:f,disabled:h,sx:{textTransform:"none",fontWeight:600,fontSize:"0.875rem",mt:1.5,py:1,borderRadius:1,boxShadow:2,"&:hover":{boxShadow:4,transform:"translateY(-1px)"},transition:"all 0.2s ease-in-out"},children:r("accountSwitcher.demoAccountSuggestion.tryDemo","Th Demo")})]})]})})})},ZC=({portfolio:r,displayCurrency:t,dailyReturnData:n,isLoadingDaily:s})=>{var y;if(!r||!r.portfolioId)return null;const{data:a,isLoading:i}=yt(["portfolio-performance",r.portfolioId],()=>q.getPortfolioPerformance(r.portfolioId),{enabled:!!r.portfolioId,staleTime:5*60*1e3,retry:1}),o=(n==null?void 0:n.dailyPercent)??0,d=(n==null?void 0:n.dailyValue)??0,u=o!==0?`${o>=0?"+":""}${o.toFixed(2)}%`:"+0.0%",h=o,m=(n==null?void 0:n.totalNav)??parseFloat(((y=r.totalAllValue)==null?void 0:y.toString())||"0"),x=(a==null?void 0:a.ytdReturn)!=null&&parseFloat(a.ytdReturn.toString())||0,g=x!==0?`${x>=0?"+":""}${x.toFixed(2)}%`:"+0.0%",f=x;return e.jsxs(De,{hover:!0,children:[e.jsx(S,{sx:{maxWidth:{xs:120,sm:120,md:150,lg:250},py:{xs:.5,sm:.75,md:1},px:{xs:.75,sm:1,md:1.5}},children:e.jsx(c,{variant:"tableCell",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.name})}),e.jsx(S,{align:"right",sx:{py:{xs:.5,sm:.75,md:1},px:{xs:.75,sm:1,md:1.5}},children:e.jsx(c,{variant:"tableCell",sx:{fontSize:"0.75rem",maxWidth:{xs:110,sm:"100%"}},children:G(m,t)})}),e.jsx(S,{align:"right",sx:{py:{xs:.5,sm:.75,md:1},px:{xs:.75,sm:1,md:1.5}},children:s?e.jsx(Ce,{size:14}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{label:u,size:"small",color:h>=0?"success":"error",sx:{fontSize:"0.7rem",height:22,"& .MuiChip-label":{px:1}}}),e.jsx(c,{variant:"tableCell",sx:{fontSize:"0.7rem!important",color:d>=0?"success.main":"error.main"},children:G(d,t)})]})}),e.jsx(S,{align:"right",sx:{py:{xs:.5,sm:.75,md:1},px:{xs:.75,sm:1,md:1.5}},children:i?e.jsx(Ce,{size:14}):e.jsx(ce,{label:g,size:"small",color:f>=0?"success":"error",sx:{fontSize:"0.7rem",height:22,"& .MuiChip-label":{px:1}}})})]})},ek=()=>{var Se,Ve,Re;const{t:r}=Ne(),t=An(),n=Je(),s=Kt(),{accountId:a}=Ge(),{portfolios:i,isLoading:o,error:d,refetch:u}=Un(a),{formattedLastUpdateTime:h,isLoading:m,isAutoSyncEnabled:x}=GC(),g=Nt(n.breakpoints.down("sm")),f=Array.isArray(i)?i:[],{change:y,isLoading:j}=qC(f,"1M"),b=f.filter(xe=>xe&&xe.portfolioId).map(xe=>xe.portfolioId),{data:v,isLoading:P,refetch:w}=yt(["portfolio-returns",b.join(",")],()=>q.getPortfolioReturns(b),{enabled:b.length>0,staleTime:5*60*1e3,retry:1}),C=rt.useMemo(()=>{const xe=new Map;return v!=null&&v.portfolios&&v.portfolios.forEach(te=>{xe.set(te.portfolioId,{dailyPercent:te.dailyPercent,totalNav:te.totalNav,dailyValue:te.dailyValue})}),xe},[v]),[k,A]=p.useState(!1),[L,T]=p.useState(!1),[M,O]=p.useState(null),[I,z]=p.useState(!1),[N,E]=p.useState(null),[R,V]=p.useState(!1),[F,B]=p.useState(null),{isReadOnly:$}=Ge();if(o)return e.jsxs(l,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"400px",sx:{background:`linear-gradient(135deg, ${U(n.palette.primary.main,.05)} 0%, ${U(n.palette.primary.main,.02)} 100%)`,borderRadius:3,p:4},children:[e.jsx(Ce,{size:60,thickness:4}),e.jsx(c,{variant:"pageSubtitle",sx:{mt:2},children:r("dashboard.loading")}),e.jsx(ds,{sx:{width:"200px",mt:2,borderRadius:1}})]});if(d)return e.jsxs(je,{severity:"error",sx:{mb:2,borderRadius:2,"& .MuiAlert-message":{fontSize:"1rem"}},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,children:r("dashboard.failedToLoad")}),e.jsx(c,{variant:"formHelper",children:r("dashboard.checkConnection")})]});const Y=f.length,_=f.reduce((xe,te)=>{var Ee;return xe+(parseFloat(((Ee=te==null?void 0:te.totalAllValue)==null?void 0:Ee.toString())||"0")||0)},0),K=f.reduce((xe,te)=>{var Ee;return xe+(parseFloat(((Ee=te==null?void 0:te.unrealizedAllPnL)==null?void 0:Ee.toString())||"0")||0)},0),X=f.reduce((xe,te)=>{var Ee;return xe+(parseFloat(((Ee=te==null?void 0:te.realizedAllPnL)==null?void 0:Ee.toString())||"0")||0)},0),ne=f.reduce((xe,te)=>{var Ee;return xe+(parseFloat(((Ee=te==null?void 0:te.cashBalance)==null?void 0:Ee.toString())||"0")||0)},0),oe=K+X,ee=_>0?oe/(_-oe)*100:0,H=_>0?ne/_*100:0,Q=Y>0?_/Y:0,Z=((Se=f.find(xe=>xe==null?void 0:xe.baseCurrency))==null?void 0:Se.baseCurrency)||"VND",J=xe=>{t(`/portfolios/${xe}`)},ae=xe=>{const te=f.find(Ee=>(Ee==null?void 0:Ee.portfolioId)===xe);te&&(E(te),z(!0),B(null))},ue=()=>{z(!1),E(null),B(null)},le=async xe=>{var te,Ee;if(!(!N||!a)){V(!0),B(null);try{await q.updatePortfolio(N.portfolioId,a,xe),await u(),ue()}catch(Ke){B(((Ee=(te=Ke==null?void 0:Ke.response)==null?void 0:te.data)==null?void 0:Ee.message)||(Ke==null?void 0:Ke.message)||r("portfolio.form.updateFailed"))}finally{V(!1)}}},pe=()=>{t("/portfolios/new")},Me=xe=>{t(`/portfolios/${xe.portfolioId}`)},Le=xe=>{O(xe),T(!0)},qe=()=>{T(!1),O(null)},de=async()=>{if(!k){A(!0);try{await u(),b.length>0&&await w(),s.invalidateQueries("autoSyncStatus"),s.invalidateQueries("latestPriceUpdate"),s.invalidateQueries(["portfolio-change"]),s.invalidateQueries(["portfolio-returns"]),s.invalidateQueries(["portfolio-performance"])}catch(xe){console.error("Failed to refresh data:",xe)}finally{A(!1)}}},fe=[{title:r("dashboard.totalAssets"),value:G(_,Z),subtitle:`${Y} ${r("dashboard.portfolio",{count:Y})}`,icon:e.jsx(qt,{}),color:"primary",gradient:`linear-gradient(135deg, ${U(n.palette.primary.main,.06)} 0%, ${U(n.palette.primary.main,.03)} 100%)`,trend:_>0?"positive":"neutral",change:j?"...":y||"+0.0%"},{title:r("dashboard.totalPL"),value:G(oe,Z),subtitle:oe>=0?r("dashboard.profitable"):r("dashboard.loss"),icon:oe>=0?e.jsx(He,{}):e.jsx(Bt,{}),color:oe>=0?"success":"error",gradient:oe>=0?`linear-gradient(135deg, ${U(n.palette.success.main,.06)} 0%, ${U(n.palette.success.main,.03)} 100%)`:`linear-gradient(135deg, ${U(n.palette.error.main,.06)} 0%, ${U(n.palette.error.main,.03)} 100%)`,trend:oe>=0?"positive":"negative",change:ye(ee)},{title:r("dashboard.cashPosition"),value:G(ne,Z),subtitle:`${ye(H)} ${r("dashboard.ofTotal")}`,icon:e.jsx(mr,{}),color:"info",gradient:`linear-gradient(135deg, ${U(n.palette.info.main,.06)} 0%, ${U(n.palette.info.main,.03)} 100%)`,trend:"neutral",change:r("dashboard.liquid")},{title:r("dashboard.averagePortfolioValue"),value:G(Q,Z),subtitle:r("dashboard.perPortfolio"),icon:e.jsx(Zt,{}),color:"secondary",gradient:`linear-gradient(135deg, ${U(n.palette.secondary.main,.06)} 0%, ${U(n.palette.secondary.main,.03)} 100%)`,trend:"neutral",change:r("dashboard.balanced"),display:!g}],ie=f.length>0?f.reduce((xe,te)=>{if(!xe)return te;const Ee=xe!=null&&xe.unrealizedInvestPnL&&(xe!=null&&xe.totalInvestValue)?xe.unrealizedInvestPnL/xe.totalInvestValue:0;return(te!=null&&te.unrealizedInvestPnL&&(te!=null&&te.totalInvestValue)?te.unrealizedInvestPnL/te.totalInvestValue:0)>Ee?te:xe}):null;return e.jsx(Xr,{in:!0,timeout:800,children:e.jsxs(l,{children:[e.jsx(cx,{}),e.jsxs(l,{sx:{mb:4},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"pageHeader",sx:{background:`linear-gradient(135deg, ${n.palette.primary.main} 0%, ${n.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1},children:r("dashboard.title")}),e.jsx(c,{variant:"pageSubtitle",ellipsis:!1,children:r("dashboard.subtitle")})]}),e.jsx(l,{sx:{display:"flex",gap:1},children:e.jsx(he,{variant:"outlined",icon:k?e.jsx(Ce,{size:20,color:"inherit"}):e.jsx(Mt,{}),startIcon:k?e.jsx(Ce,{size:20,color:"inherit"}):e.jsx(Mt,{}),onClick:de,disabled:k,mobileText:r(k?"common.refreshing":"common.refresh"),desktopText:r(k?"dashboard.refreshing":"dashboard.refreshData"),sx:{borderRadius:2},children:r(k?"dashboard.refreshing":"dashboard.refreshData")})})]}),e.jsxs(l,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(ce,{icon:e.jsx(Jt,{}),label:r(x?"dashboard.systemStatus":"dashboard.dataUpdateStatus.systemPaused"),color:x?"success":"warning",variant:"outlined",sx:{borderRadius:2,display:{xs:"none",sm:"block"}}}),e.jsx(ce,{icon:e.jsx(ya,{}),label:`${r("dashboard.lastUpdated")}: ${m?r("dashboard.dataUpdateStatus.loading"):h}`,color:"info",variant:"outlined",sx:{borderRadius:2}}),!g&&e.jsx(ce,{icon:e.jsx(Zt,{}),label:`${Y} ${r("dashboard.portfolio",{count:Y})} ${r("dashboard.active")}`,color:"primary",variant:"outlined",sx:{borderRadius:2}},"activePortfolios")]})]}),e.jsx(W,{container:!0,spacing:3,sx:{mb:4},children:fe.filter(xe=>xe.display!==!1).map((xe,te)=>e.jsx(W,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(as,{direction:"up",in:!0,timeout:600+te*100,children:e.jsx(se,{sx:{height:"100%",background:xe.gradient,border:`0.5px solid ${U(n.palette[xe.color].main,.15)}`,borderRadius:2,transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:`0 4px 12px ${U(n.palette[xe.color].main,.1)}`,border:`0.5px solid ${U(n.palette[xe.color].main,.2)}`}},children:e.jsxs(me,{sx:{p:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1.5},children:[e.jsx(l,{sx:{borderRadius:"50%",background:U(n.palette[xe.color].main,.08),color:`${xe.color}.main`,width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 2px 4px ${U(n.palette[xe.color].main,.15)}`},children:rt.cloneElement(xe.icon,{sx:{fontSize:20}})}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[xe.trend==="positive"&&e.jsx(ap,{sx:{color:"success.main",fontSize:20}}),xe.trend==="negative"&&e.jsx(ip,{sx:{color:"error.main",fontSize:20}}),e.jsx(ce,{label:xe.change,size:"small",color:xe.trend==="positive"?"success":xe.trend==="negative"?"error":"default",sx:{fontSize:"0.75rem",height:24,borderRadius:1.5}})]})]}),e.jsx(c,{variant:"cardValueLarge",sx:{color:"text.primary",mb:.5,fontWeight:700},children:xe.value}),e.jsx(c,{variant:"cardTitle",color:"text.secondary",sx:{mb:.5,fontWeight:500},children:xe.title}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{opacity:.8},children:xe.subtitle})]})})})},te))}),f.length>0&&e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,sm:12,md:6,lg:7,children:e.jsx(se,{sx:{borderRadius:3,background:`linear-gradient(135deg, ${U(n.palette.background.paper,.8)} 0%, ${U(n.palette.background.paper,.6)} 100%)`,border:`0.5px solid ${U(n.palette.divider,.08)}`,backdropFilter:"blur(10px)"},children:e.jsxs(me,{sx:{p:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(ar,{sx:{mr:2,color:"primary.main"}}),e.jsx(c,{variant:"chartTitle",sx:{fontWeight:"500"},children:r("dashboard.portfolioPerformance")})]}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsxs(l,{sx:{p:1.5,borderRadius:2,background:U(n.palette.success.main,.03)},children:[e.jsx(c,{variant:"formHelper",gutterBottom:!0,children:r("dashboard.bestPerforming")}),e.jsx(c,{variant:"cardTitle",sx:{color:"success.main"},children:(ie==null?void 0:ie.name)||"N/A"}),e.jsx(c,{variant:"cardValueMedium",sx:{color:"success.main"},children:G((ie==null?void 0:ie.unrealizedInvestPnL)||0,Z)})]})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsxs(l,{sx:{p:1.5,borderRadius:2,background:U(n.palette.info.main,.03)},children:[e.jsx(c,{variant:"formHelper",gutterBottom:!0,children:r("dashboard.bestPortfolioCash")}),e.jsx(c,{variant:"cardTitle",sx:{color:"info.main"},children:ie?ye(ie!=null&&ie.totalInvestValue&&(ie==null?void 0:ie.totalInvestValue)>0?_i((ie==null?void 0:ie.cashBalance)||0)/_i((ie==null?void 0:ie.totalInvestValue)||0)*100:0):"N/A"}),e.jsx(c,{variant:"cardValueMedium",sx:{color:"info.main"},children:ie?G(_i((ie==null?void 0:ie.cashBalance)||0),Z):"N/A"})]})})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:12,md:6,lg:5,children:e.jsx(se,{sx:{borderRadius:3,background:`linear-gradient(135deg, ${U(n.palette.background.paper,.8)} 0%, ${U(n.palette.background.paper,.6)} 100%)`,border:`0.5px solid ${U(n.palette.divider,.08)}`,backdropFilter:"blur(10px)",maxHeight:"400px",display:"flex",flexDirection:"column",overflow:"hidden"},children:e.jsxs(me,{sx:{p:{xs:1,sm:1.5,md:2},display:"flex",flexDirection:"column",flex:1,overflow:"hidden"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:{xs:1,sm:1.5,md:2},flexShrink:0},children:[e.jsx(Zt,{sx:{mr:{xs:1,sm:1.5,md:2},color:"secondary.main"}}),e.jsx(c,{variant:"chartTitle",sx:{fontWeight:"500"},children:r("dashboard.quickInsights.title")})]}),f.length>0?e.jsx(at,{component:Te,sx:{borderRadius:2,boxShadow:"none",bgcolor:"transparent",maxHeight:"450px",overflow:"auto",flex:1},children:e.jsxs(it,{size:"small",stickyHeader:!0,sx:{"& .MuiTableCell-root":{py:{xs:.5,sm:.75,md:1},px:{xs:.75,sm:1,md:1.5}}},children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{sx:{bgcolor:U(n.palette.background.paper,.8),maxWidth:{xs:120,sm:"100%"},px:{xs:.75,sm:1,md:1.5}},children:e.jsx(c,{variant:"tableHeader",children:r("dashboard.quickInsights.name","Danh mc")})}),e.jsx(S,{align:"right",sx:{bgcolor:U(n.palette.background.paper,.8),maxWidth:{xs:110,sm:110,md:150,lg:250},px:{xs:.75,sm:1,md:1.5}},children:e.jsx(c,{variant:"tableHeader",children:r("dashboard.quickInsights.totalValue","Gi tr")})}),e.jsx(S,{align:"right",sx:{bgcolor:U(n.palette.background.paper,.8),px:{xs:.75,sm:1,md:1.5}},children:e.jsx(c,{variant:"tableHeader",children:r("dashboard.quickInsights.dailyGrowth","Hm nay")})}),e.jsx(S,{align:"right",sx:{bgcolor:U(n.palette.background.paper,.8),px:{xs:.75,sm:1,md:1.5}},children:e.jsx(c,{variant:"tableHeader",children:r("dashboard.quickInsights.ytdGrowth","YTD")})})]})}),e.jsx(ot,{children:f.filter(xe=>xe&&xe.portfolioId).map(xe=>{const te=C.get(xe.portfolioId);return e.jsx(ZC,{portfolio:xe,displayCurrency:Z,dailyReturnData:te,isLoadingDaily:P},xe.portfolioId)})})]})}):e.jsx(c,{variant:"formHelper",color:"text.secondary",sx:{textAlign:"center",py:2},children:r("dashboard.noPortfolios")})]})})})]}),e.jsxs(l,{children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"pageTitle",component:"h2",sx:{mb:1},children:r("dashboard.investmentPortfolios")}),e.jsx(c,{variant:"pageSubtitle",children:r("dashboard.managePortfolios")})]}),e.jsx(We,{variant:"contained",icon:e.jsx(xt,{}),onClick:pe,size:"large",mobileText:r("common.create"),desktopText:r("dashboard.createNewPortfolio"),sx:{borderRadius:2,background:`linear-gradient(135deg, ${n.palette.primary.main} 0%, ${n.palette.primary.dark} 100%)`,"&:hover":{background:`linear-gradient(135deg, ${n.palette.primary.dark} 0%, ${n.palette.primary.main} 100%)`}},children:r("dashboard.createNewPortfolio")})]}),f.length===0?e.jsxs(se,{sx:{p:6,textAlign:"center",background:`linear-gradient(135deg, ${U(n.palette.background.paper,.8)} 0%, ${U(n.palette.background.paper,.6)} 100%)`,border:`1px solid ${U(n.palette.divider,.1)}`,borderRadius:3},children:[e.jsx(l,{sx:{p:3,borderRadius:"50%",background:`linear-gradient(135deg, ${U(n.palette.primary.main,.1)} 0%, ${U(n.palette.primary.main,.05)} 100%)`,display:"inline-flex",mb:3},children:e.jsx(Ue,{sx:{fontSize:80,color:"primary.main"}})}),e.jsx(c,{variant:"pageTitle",sx:{mb:2,color:"text.primary"},children:r("dashboard.noPortfoliosFound")}),e.jsx(c,{variant:"pageSubtitle",sx:{mb:3,maxWidth:500,mx:"auto"},children:r("dashboard.startInvestment")}),e.jsx(We,{variant:"contained",icon:e.jsx(xt,{}),onClick:pe,size:"large",mobileText:r("common.create"),desktopText:r("dashboard.createFirstPortfolio"),sx:{borderRadius:2,px:4,py:1.5,background:`linear-gradient(135deg, ${n.palette.primary.main} 0%, ${n.palette.primary.dark} 100%)`,"&:hover":{background:`linear-gradient(135deg, ${n.palette.primary.dark} 0%, ${n.palette.primary.main} 100%)`}},children:r("dashboard.createFirstPortfolio")})]}):e.jsx(W,{container:!0,spacing:3,children:f.filter(xe=>xe&&xe.portfolioId).map((xe,te)=>e.jsx(W,{item:!0,xs:12,sm:6,lg:4,xl:3,children:e.jsx(as,{direction:"up",in:!0,timeout:800+te*100,children:e.jsx(l,{children:e.jsx(ix,{portfolio:xe,onView:J,onEdit:ae,onPortfolioCopied:Me,onManagePermissions:Le,isReadOnly:$})})})},xe.portfolioId))})]}),M&&e.jsx(Xc,{open:L,onClose:qe,portfolioId:M,portfolioName:((Ve=f.find(xe=>(xe==null?void 0:xe.portfolioId)===M))==null?void 0:Ve.name)||"",creatorAccountId:((Re=f.find(xe=>(xe==null?void 0:xe.portfolioId)===M))==null?void 0:Re.accountId)||"",onPermissionUpdated:()=>{u()}}),e.jsx(lx,{open:I,onClose:ue,onSubmit:le,initialData:N?{name:N.name,baseCurrency:N.baseCurrency,fundingSource:N.fundingSource||"",accountId:N.accountId,visibility:N.visibility,description:N.description||"",templateName:N.templateName||""}:void 0,isEditing:!0,isLoading:R,error:F||void 0})]})})},tk=({onViewPortfolio:r,onEditPortfolio:t,onDeletePortfolio:n,onCreatePortfolio:s,onManagePermissions:a,onRefresh:i,isReadOnly:o=!1})=>{const{t:d}=Ne(),u=Je(),{accountId:h}=Ge(),{portfolios:m,isLoading:x,error:g}=Un(h),[f]=p.useState(""),[y]=p.useState(""),j=m.filter(b=>{const v=b.name.toLowerCase().includes(f.toLowerCase()),P=!y||b.baseCurrency===y;return v&&P});return x?e.jsx("div",{className:"portfolio-list",children:e.jsx("div",{className:"portfolio-list__loading",children:e.jsx(Ce,{})})}):g?e.jsx("div",{className:"portfolio-list",children:e.jsx("div",{className:"portfolio-list__error",children:d("portfolio.failedToLoad")})}):e.jsxs("div",{className:"portfolio-list",children:[e.jsxs("div",{className:"portfolio-list__header",children:[e.jsx(c,{variant:"pageHeader",sx:{background:`linear-gradient(135deg, ${u.palette.primary.main} 0%, ${u.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:0},children:d("portfolio.title")}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:1},children:[i&&e.jsx(Fe,{title:d("common.refresh"),children:e.jsx(Ie,{onClick:i,disabled:x,color:"primary",sx:{borderRadius:2,"&:hover":{backgroundColor:"primary.50"}},children:e.jsx(Mt,{})})}),s&&e.jsx(We,{className:"portfolio-list__create-btn",onClick:s,icon:e.jsx(xt,{}),mobileText:d("common.create"),desktopText:d("portfolio.create"),children:d("portfolio.create")})]})]}),j.length===0?e.jsxs("div",{className:"portfolio-list__empty",children:[e.jsx("div",{className:"portfolio-list__empty-illustration",children:e.jsx("div",{className:"portfolio-list__empty-icon",children:e.jsx(Ue,{sx:{fontSize:60,color:"#3b82f6"}})})}),e.jsxs("div",{className:"portfolio-list__empty-content",children:[e.jsx("h3",{className:"portfolio-list__empty-title",children:m.length===0?d("portfolio.startJourney"):d("portfolio.noMatch")}),m.length===0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"portfolio-list__empty-description",children:d("portfolio.createFirstDescription")}),e.jsxs("div",{className:"portfolio-list__empty-features",children:[e.jsxs("div",{className:"portfolio-list__empty-feature",children:[e.jsx("div",{className:"portfolio-list__empty-feature-icon",children:e.jsx(He,{sx:{fontSize:24,color:"#10b981"}})}),e.jsx("span",{children:d("portfolio.trackPerformance")})]}),e.jsxs("div",{className:"portfolio-list__empty-feature",children:[e.jsx("div",{className:"portfolio-list__empty-feature-icon",children:e.jsx(mr,{sx:{fontSize:24,color:"#f59e0b"}})}),e.jsx("span",{children:d("portfolio.monitorReturns")})]}),e.jsxs("div",{className:"portfolio-list__empty-feature",children:[e.jsx("div",{className:"portfolio-list__empty-feature-icon",children:e.jsx(Zt,{sx:{fontSize:24,color:"#8b5cf6"}})}),e.jsx("span",{children:d("portfolio.analyzeTrends")})]})]})]}):e.jsx("p",{className:"portfolio-list__empty-description",children:d("portfolio.adjustSearch")})]}),s&&m.length===0&&e.jsxs("div",{className:"portfolio-list__empty-actions",children:[e.jsx(We,{className:"portfolio-list__empty-btn portfolio-list__empty-btn--primary",onClick:s,icon:e.jsx(xt,{}),mobileText:d("common.create"),desktopText:d("portfolio.createFirst"),children:d("portfolio.createFirst")}),e.jsx(he,{className:"portfolio-list__empty-btn portfolio-list__empty-btn--secondary",onClick:()=>{},children:d("portfolio.learnMore")})]})]}):e.jsx("div",{className:"portfolio-list__grid",children:j.map(b=>e.jsx(ix,{portfolio:b,onView:r,onEdit:t,onDelete:n,onManagePermissions:a,isReadOnly:o},b.portfolioId))}),s&&e.jsx(Fe,{title:d(o?"common.readOnlyMode":"portfolio.create"),children:e.jsx("span",{children:e.jsx(xc,{color:"primary","aria-label":"add portfolio",onClick:o?void 0:s,disabled:o,className:"portfolio-list__fab",children:e.jsx(xt,{})})})})]})},nk=({open:r,onClose:t,asset:n,onEdit:s,onDelete:a,loading:i=!1})=>{const{t:o}=Ne(),{baseCurrency:d,accountId:u}=Ge(),[h,m]=p.useState({portfolios:[],tradingCount:0,loading:!0,isMockData:!1});p.useEffect(()=>{r&&n&&(async()=>{if(!(!n||!u))try{m(z=>({...z,loading:!0}));const T=await q.getPortfolios(u),M=Array.isArray(T)?T:[];let O=[],I=0;try{const z=await q.getAllTradesForAsset(n.id,u),N=Array.isArray(z)?z:[];if(N.length>0){const E=new Map;for(const R of N){const V=R.portfolioId;V&&(E.has(V)||E.set(V,[]),E.get(V).push(R))}for(const[R,V]of E){const F=M.find(B=>(B.id||B.portfolioId||B.uuid)===R);F&&(O.push(F),I+=V.length)}}}catch{for(const N of M.slice(0,3))try{const E=N.id||N.portfolioId||N.uuid;if(!E||typeof E!="string"||E.length<10)continue;const R=await q.getTrades(E,u,{assetId:n.id}),V=Array.isArray(R)?R:[];V.length>0&&(O.push(N),I+=V.length)}catch{}}if(O.length===0){const z=[{id:"1",name:"Main Portfolio"},{id:"2",name:"Growth Fund"},{id:"3",name:"Conservative Fund"}],N=Math.floor(Math.random()*10)+1;m({portfolios:z,tradingCount:N,loading:!1,isMockData:!0});return}m({portfolios:O.map(z=>({id:z.id,name:z.name||z.portfolioName||"Unnamed Portfolio"})),tradingCount:I,loading:!1,isMockData:!1})}catch{const M=[{id:"1",name:"Main Portfolio"},{id:"2",name:"Growth Fund"},{id:"3",name:"Conservative Fund"}],O=Math.floor(Math.random()*10)+1;m({portfolios:M,tradingCount:O,loading:!1,isMockData:!0})}})()},[n,u,r]);const x=({items:L})=>e.jsx(W,{container:!0,spacing:0,children:L.map((T,M)=>e.jsx(W,{item:!0,xs:6,md:3,sx:{borderRight:{xs:M%2===1?"none":"1px solid rgba(0, 0, 0, 0.08)",md:M%4===3?"none":"1px solid rgba(0, 0, 0, 0.08)"},borderBottom:{xs:M>=L.length-2?"none":"1px solid rgba(0, 0, 0, 0.08)",md:M>=L.length-4?"none":"1px solid rgba(0, 0, 0, 0.08)"},p:1.5,minHeight:"auto",display:"flex",alignItems:"center"},children:e.jsx(Pe,{sx:{p:0},children:e.jsx(ve,{primary:T.label,secondary:T.value,primaryTypographyProps:{variant:"subtitle2",color:"text.secondary",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},secondaryTypographyProps:{variant:"subtitle1",fontWeight:500},sx:{width:"100%"}})})},`${T.label}-${M}`))}),g=(n==null?void 0:n.currentPrice)||0,f=(n==null?void 0:n.avgCost)||0,y=(n==null?void 0:n.quantity)||(n==null?void 0:n.totalQuantity)||0,j=Number(n==null?void 0:n.totalValue)||0,b=f*y,v=j-b,P=b>0?v/b*100:0,w=(n==null?void 0:n.performance)||{daily:0,weekly:0,monthly:0,yearly:0},C=L=>({STOCK:"#1976d2",BOND:"#7b1fa2",ETF:"#2e7d32",GOLD:"#f57c00",DEPOSIT:"#2e7d32",CASH:"#1976d2",CRYPTO:"#c2185b",MUTUAL_FUND:"#f57c00",REIT:"#00695c",COMMODITY:"#558b2f"})[L]||"#616161",k=L=>L>0?"success.main":L<0?"error.main":"text.secondary",A=L=>L>0?e.jsx(He,{}):L<0?e.jsx(Bt,{}):e.jsx(Ss,{});return e.jsx(Rt,{open:r,onClose:t,title:o("asset.details.title"),icon:e.jsx(Ue,{}),maxWidth:"lg",loading:i,actions:e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",width:"100%"},children:[e.jsxs(ft,{direction:"row",spacing:1,children:[s&&n&&e.jsx(he,{onClick:()=>s(n),variant:"contained",color:"primary",size:"small",icon:e.jsx(Tt,{}),mobileText:"",desktopText:o("common.edit"),children:o("common.edit")}),a&&n&&e.jsx(he,{onClick:()=>a(n),variant:"text",color:"error",size:"small",icon:e.jsx(pt,{}),mobileText:"",desktopText:o("common.delete"),children:o("common.delete")})]}),e.jsx(he,{onClick:t,variant:"outlined",size:"small",mobileText:o("common.close"),desktopText:o("common.close"),children:o("common.close")})]}),children:e.jsxs(l,{sx:{p:1},children:[e.jsx(Te,{elevation:0,sx:{p:2,mb:2,background:`linear-gradient(135deg, ${C((n==null?void 0:n.type)||"")}15 0%, ${C((n==null?void 0:n.type)||"")}05 100%)`,border:`1px solid ${C((n==null?void 0:n.type)||"")}30`,borderRadius:2},children:e.jsxs(l,{sx:{display:"flex",alignItems:{xs:"flex-start",sm:"center"},justifyContent:{xs:"flex-start",sm:"space-between"},flexDirection:{xs:"column",sm:"row"},gap:{xs:2,sm:0},mb:2},children:[e.jsxs(l,{sx:{display:"flex",flexDirection:"column",flexWrap:"wrap"},children:[e.jsx(c,{variant:"cardTitle",children:n==null?void 0:n.symbol}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary"},children:n==null?void 0:n.name})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",width:{xs:"100%",sm:"auto"},justifyContent:{xs:"flex-start",sm:"flex-end"}},children:[e.jsx(ce,{label:n==null?void 0:n.type,size:"small",sx:{backgroundColor:C((n==null?void 0:n.type)||""),color:"white",textTransform:"uppercase",fontSize:"0.75rem"}}),e.jsx(ce,{label:(n==null?void 0:n.isActive)??!0?o("asset.details.status.active"):o("asset.details.status.inactive"),size:"small",color:(n==null?void 0:n.isActive)??!0?"success":"error",variant:"outlined"}),e.jsx(Fe,{title:h.loading?e.jsx(c,{children:o("asset.details.loading")}):h.portfolios.length>0?e.jsxs(l,{children:[e.jsxs(c,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:[o("asset.details.portfolios.title",{count:h.portfolios.length}),":"]}),e.jsx(lt,{dense:!0,sx:{p:0,maxHeight:200,overflow:"auto"},children:h.portfolios.map((L,T)=>e.jsx(Pe,{sx:{py:.5,px:0},children:e.jsx(ve,{primary:L.name,primaryTypographyProps:{fontSize:"0.75rem"}})},L.id||`portfolio-${T}`))})]}):e.jsx(c,{children:o("asset.details.noPortfolios")}),arrow:!0,placement:"top",children:e.jsx(ce,{icon:e.jsx(op,{}),label:o("asset.details.portfolios.chip",{count:h.portfolios.length}),size:"small",color:"primary",variant:"outlined",sx:{fontSize:"0.7rem"}})}),e.jsx(Fe,{title:h.loading?e.jsx(c,{children:o("asset.details.loading")}):e.jsxs(l,{children:[e.jsxs(c,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:[o("asset.details.trading.title",{count:h.tradingCount}),":",h.isMockData&&e.jsx(ce,{label:o("asset.details.demo"),size:"small",color:"warning",sx:{ml:1,fontSize:"0.6rem",height:16}},"demo-chip-trading")]}),e.jsx(c,{variant:"body2",sx:{mb:1},children:h.isMockData?o("asset.details.trading.demoDescription"):o("asset.details.trading.realDescription")}),h.portfolios.length>0&&e.jsx(c,{variant:"caption",sx:{color:"text.secondary"},children:o("asset.details.trading.foundInPortfolios",{count:h.portfolios.length})})]}),arrow:!0,placement:"top",children:e.jsx(ce,{icon:e.jsx(yr,{}),label:o("asset.details.trading.chip",{count:h.tradingCount}),size:"small",color:"secondary",variant:"outlined",sx:{fontSize:"0.7rem"}})})]})]})}),e.jsx(se,{sx:{mb:2},children:e.jsxs(me,{children:[e.jsxs(c,{variant:"cardTitle",sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Zt,{color:"primary"}),o("asset.details.sections.assetInformation")]}),e.jsx(x,{items:[{label:o("asset.details.metrics.currentValue"),value:e.jsx(c,{variant:"cardValue",sx:{color:"primary.main"},children:G(j,d)})},{label:o("asset.details.metrics.unrealizedPnL"),value:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[A(v),e.jsx(c,{variant:"cardValue",sx:{color:v>=0?"success.main":"error.main"},children:G(v,d)})]})},{label:o("asset.details.metrics.pnlPercentage"),value:e.jsx(c,{variant:"cardValue",sx:{color:P>=0?"success.main":"error.main"},children:ye(P,2)})},{label:o("asset.details.metrics.quantity"),value:e.jsx(c,{variant:"cardValue",sx:{color:"warning.main"},children:dn(y,2)})},{label:o("asset.details.price.currentPrice"),value:e.jsx(c,{variant:"cardValue",sx:{color:"primary.main"},children:G(g,d)})},{label:o("asset.details.price.averageCost"),value:e.jsx(c,{variant:"cardValue",children:G(f,d)})},{label:o("asset.details.price.priceChange"),value:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[A(g-f),e.jsx(c,{variant:"cardValue",sx:{color:k(g-f)},children:G(g-f,d)})]})},{label:o("asset.details.performance.daily"),value:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[A(w.daily),e.jsx(c,{variant:"cardValue",sx:{color:k(w.daily)},children:ye(w.daily,2)})]})},{label:o("asset.details.performance.weekly"),value:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[A(w.weekly),e.jsx(c,{variant:"cardValue",sx:{color:k(w.weekly)},children:ye(w.weekly,2)})]})},{label:o("asset.details.performance.monthly"),value:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[A(w.monthly),e.jsx(c,{variant:"cardValue",sx:{color:k(w.monthly)},children:ye(w.monthly,2)})]})},{label:o("asset.details.performance.yearly"),value:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[A(w.yearly),e.jsx(c,{variant:"cardValue",sx:{fontWeight:600,color:k(w.yearly)},children:ye(w.yearly,2)})]})},{label:o("asset.details.metadata.lastUpdated"),value:e.jsx(c,{variant:"cardValue",children:n?new Date(n.updatedAt).toLocaleDateString():""})}]})]})})]})})},rk=({open:r,assetName:t,tradeCount:n,portfolios:s=[],onConfirm:a,onCancel:i,isDeleting:o=!1})=>{const{t:d}=Ne(),[u,h]=p.useState(!1);p.useEffect(()=>{r&&h(!1)},[r]);const m=n>0?d("asset.delete.titleWithTrades"):d("asset.delete.title"),x=e.jsx(on,{color:"warning"}),g=e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:i,disabled:o,variant:"outlined",size:"medium",mobileText:d("common.cancel"),desktopText:d("common.cancel"),children:d("common.cancel")}),e.jsx(he,{onClick:a,disabled:o||!u,variant:"contained",color:"error",size:"medium",startIcon:o?e.jsx(Ce,{size:20}):e.jsx(pt,{}),mobileText:d(o?"asset.delete.deleting":"asset.delete.delete"),desktopText:o?d("asset.delete.deleting"):n>0||s.length>0?d("asset.delete.deleteWithImpact"):d("asset.delete.delete"),children:o?d("asset.delete.deleting"):n>0||s.length>0?d("asset.delete.deleteWithImpact"):d("asset.delete.delete")})]});return e.jsxs(Rt,{open:r,onClose:i,title:m,icon:x,actions:g,maxWidth:"sm",fullWidth:!0,titleColor:"warning",size:"medium",children:[s.length>0&&e.jsxs(l,{sx:{mb:3,mt:2},children:[e.jsx(c,{variant:"cardLabel",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:d("asset.delete.affectedPortfolios")}),e.jsx(l,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:s.map(f=>e.jsx(ce,{label:f.name,color:"primary",variant:"outlined",icon:e.jsx(Ue,{}),sx:{mb:1}},f.id))})]}),e.jsx(bt,{sx:{my:2}}),n>0||s.length>0?e.jsxs(l,{children:[e.jsxs(c,{variant:"cardLabel",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(on,{color:"warning"}),d("asset.delete.impactAnalysis")]}),e.jsx(c,{variant:"cardLabel",paragraph:!0,children:d("asset.delete.impactDescription",{assetName:t,portfolioCount:s.length,tradeCount:n})}),e.jsx(je,{severity:"warning",sx:{mb:2},children:e.jsx(c,{variant:"cardLabel",fontWeight:"medium",children:d("asset.delete.warningMessage")})}),e.jsx(se,{sx:{bgcolor:"grey.50",border:"1px solid",borderColor:"grey.200"},children:e.jsxs(me,{children:[e.jsxs(c,{variant:"cardTitle",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(pt,{color:"error"}),d("asset.delete.whatWillBeDeleted"),":"]}),e.jsxs(l,{sx:{mt:1,pl:2,mb:1},children:[e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary"},children:d("asset.delete.theAsset",{assetName:t})}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary"},children:d("asset.delete.tradingRecords",{count:n})}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary"},children:d("asset.delete.transactionHistory")}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary"},children:d("asset.delete.portfolioCalculations")})]})]})})]}):e.jsxs(l,{children:[e.jsxs(c,{variant:"cardLabel",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Xe,{color:"success"}),d("asset.delete.safeToDelete")]}),e.jsx(c,{variant:"cardLabel",paragraph:!0,children:d("asset.delete.safeDescription",{assetName:t})}),e.jsx(je,{severity:"success",sx:{mb:2},children:e.jsx(c,{variant:"cardLabel",children:d("asset.delete.safeMessage")})}),e.jsx(se,{sx:{bgcolor:"green.50",border:"1px solid",borderColor:"green.200"},children:e.jsxs(me,{children:[e.jsxs(c,{variant:"cardTitle",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Xe,{color:"success"}),d("asset.delete.whatWillBeDeleted"),":"]}),e.jsxs(l,{sx:{mt:1,pl:2,mb:1},children:[e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary"},children:d("asset.delete.theAsset",{assetName:t})}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary"},children:d("asset.delete.noTradeRecords")})]})]})})]}),e.jsx(l,{sx:{mt:3,p:2,bgcolor:"grey.50",borderRadius:1,border:"1px solid",borderColor:"grey.200"},children:e.jsx(an,{control:e.jsx(rn,{checked:u,onChange:f=>h(f.target.checked),color:"error",disabled:o}),label:e.jsx(c,{variant:"labelSmall",sx:{fontWeight:500,color:"error.main"},ellipsis:!1,children:d("asset.delete.confirmationText",{assetName:t,tradeCount:n,portfolioCount:s.length})}),sx:{alignItems:"flex-start"}})})]})},sk=async(r={})=>{const t=new URLSearchParams;return r.page&&t.append("page",r.page.toString()),r.limit&&t.append("limit",r.limit.toString()),r.sortBy&&t.append("sortBy",r.sortBy),r.sortOrder&&t.append("sortOrder",r.sortOrder),r.search&&t.append("search",r.search),r.type&&t.append("type",r.type),r.nation&&t.append("nation",r.nation),r.marketCode&&t.append("marketCode",r.marketCode),r.isActive!==void 0&&t.append("isActive",r.isActive.toString()),t.append("includePrice","true"),(await q.api.get(`/api/v1/global-assets?${t.toString()}`)).data},ak=async()=>{const r=new URLSearchParams;return r.append("limit","1000"),r.append("isActive","true"),r.append("includePrice","true"),(await q.api.get(`/api/v1/global-assets?${r.toString()}`)).data.data},ik=async r=>(await q.api.post("/api/v1/global-assets",r)).data,ok=async(r,t)=>(await q.api.put(`/api/v1/global-assets/${r}`,t)).data,lk=async r=>{await q.api.delete(`/api/v1/global-assets/${r}`)},dx=(r={})=>{var n,s,a,i,o;const t=yt(["globalAssets",r],async()=>await sk(r),{staleTime:3e5,cacheTime:6e5});return{...t,data:((n=t.data)==null?void 0:n.data)||[],total:((s=t.data)==null?void 0:s.total)||0,page:((a=t.data)==null?void 0:a.page)||1,limit:((i=t.data)==null?void 0:i.limit)||10,totalPages:((o=t.data)==null?void 0:o.totalPages)||1}},ck=()=>yt(["allGlobalAssets"],ak,{staleTime:5*60*1e3}),dk=()=>{const r=Kt();return jt(ik,{onSuccess:()=>{r.invalidateQueries(["globalAssets"])}})},uk=()=>{const r=Kt();return jt(({id:t,data:n})=>ok(t,n),{onSuccess:t=>{r.invalidateQueries(["globalAssets"]),r.invalidateQueries(["globalAsset",t.id])}})},hk=()=>{const r=Kt();return jt(lk,{onSuccess:()=>{r.invalidateQueries(["globalAssets"])}})},mk=()=>{const r=Kt();return jt(async({assetId:t,price:n,priceType:s,priceSource:a,changeReason:i})=>{var o;try{return await q.api.get(`/api/v1/asset-prices/asset/${t}`),(await q.api.put(`/api/v1/asset-prices/asset/${t}`,{currentPrice:n,priceType:s,priceSource:a,changeReason:i,metadata:{changeReason:i,source:"manual_update"}})).data}catch(d){if(((o=d.response)==null?void 0:o.status)===404)return(await q.api.post("/api/v1/asset-prices",{assetId:t,currentPrice:n,priceType:s,priceSource:a,changeReason:i,metadata:{changeReason:i,source:"manual_update"}})).data;throw d}},{onSuccess:()=>{r.invalidateQueries(["globalAssets"]),r.invalidateQueries(["assetPrices"]),r.invalidateQueries(["priceHistory"]),r.refetchQueries(["globalAssets"]),r.refetchQueries(["priceHistory"])}})},xk=()=>{const r=Kt();return jt(async t=>(await q.api.post(`/api/v1/market-data/update/${t}`)).data,{onSuccess:()=>{r.invalidateQueries(["globalAssets"]),r.invalidateQueries(["assetPrices"])}})},ux=()=>{const r=Kt(),t=p.useCallback(async()=>{try{return(await q.api.get("/api/v1/global-assets/auto-sync/status")).data}catch(a){throw console.error("Failed to get auto sync status:",a),a}},[]),n=p.useCallback(async a=>{try{await q.api.post("/api/v1/global-assets/auto-sync/toggle",{enabled:a}),r.invalidateQueries(["globalAssets"]),r.invalidateQueries(["assetPrices"])}catch(i){throw console.error("Failed to toggle auto sync:",i),i}},[r]),s=p.useCallback(async()=>{try{await q.api.post("/api/v1/global-assets/auto-sync/trigger"),r.invalidateQueries(["globalAssets"]),r.invalidateQueries(["assetPrices"])}catch(a){throw console.error("Failed to trigger manual sync:",a),a}},[r]);return{getAutoSyncStatus:t,toggleAutoSync:n,triggerManualSync:s}},qo={STOCK:"#045db4",BOND:"#059669",GOLD:"#ff9800",CRYPTO:"#dc3532",COMMODITY:"#ff5722",REALESTATE:"#795548",OTHER:"#9e9e9e",DEPOSITS:"#5d2fd3"},pk={...qo,CASH:"#607d8b",REALESTATE:"#795548",COMMODITIES:"#ff5722",FOREX:"#3f51b5",OTHER:"#9e9e9e",ETF:"#3f51b5",MUTUAL_FUND:"#9e9e9e"},ur=r=>{const t=r.toUpperCase();return qo[t]||pk[t]||"#9e9e9e"};Object.values(qo).map(r=>`${r}80`);const gk=Object.values(qo),fk={default:{positive:"#00c49f",negative:"#f15350",positiveLight:"#E0F2F1",negativeLight:"#FFE8E8"},blueRed:{positive:"#2196f3",negative:"#f44336",positiveLight:"#E0F2F1",negativeLight:"#FFE8E8"},tealOrange:{positive:"#00BCD4",negative:"#FF9800",positiveLight:"#E8F5E8",negativeLight:"#FFF3E0"},purplePink:{positive:"#5d2fd3",negative:"#E91E63",positiveLight:"#E0F2F1",negativeLight:"#FCE4EC"},greenRed:{positive:"#059669",negative:"#D32F2F",positiveLight:"#E0F2F1",negativeLight:"#FFEBEE"}},Jc=(r="default")=>fk[r],ns=(r,t="default")=>{const n=Jc(t);return r>=0?n.positive:n.negative},vl=(r,t="default")=>{const n=Jc(t);return r>=0?n.positiveLight:n.negativeLight},yk=({open:r,onClose:t,onBulkCreate:n,existingAssets:s=[],onRefresh:a})=>{const{t:i}=Ne(),o=Je(),d=Nt(o.breakpoints.down("md")),[u,h]=p.useState(""),[m,x]=p.useState("ALL"),[g,f]=p.useState([]),[y,j]=p.useState(!1),[b,v]=p.useState(!1),{data:P=[],isLoading:w,error:C,refetch:k}=dx({isActive:!0,limit:1e3,sortBy:"name",sortOrder:"ASC"});p.useEffect(()=>{r&&k()},[r,k]),p.useEffect(()=>{r||(h(""),x("ALL"),f([]))},[r]);const A=E=>{f(R=>R.includes(E)?R.filter(V=>V!==E):[...R,E])},L=()=>{g.length===I.length?f([]):f(I.map(E=>E.id))},T=async()=>{if(g.length!==0){j(!0);try{const E=await n(g);E.summary.failed===0?(gr.show(i("bulkAssetSelector.success.allCreated",{count:E.summary.created}),"success",3e3),setTimeout(()=>{t(),a&&setTimeout(async()=>{await a()},100)},1500)):E.summary.created>0?(gr.show(i("bulkAssetSelector.success.partialCreated",{created:E.summary.created,total:E.summary.total,failed:E.summary.failed}),"warning",4e3),setTimeout(()=>{t(),a&&setTimeout(async()=>{await a()},100)},1500)):(gr.show(i("bulkAssetSelector.error.allFailed",{count:E.summary.total}),"error",5e3),setTimeout(()=>{t()},2e3)),f([])}catch(E){console.error("Bulk create failed:",E),gr.show(i("bulkAssetSelector.error.createFailed"),"error",3e3),setTimeout(()=>{t()},1500)}finally{j(!1)}}},M=rt.useMemo(()=>{const E=new Set(s.map(R=>R.symbol.toUpperCase()));return P.filter(R=>!E.has(R.symbol.toUpperCase())&&R.priceMode!==ps.MANUAL)},[P,s]),O=rt.useMemo(()=>[...new Set(M.map(R=>R.type))].sort(),[M]),I=M.filter(E=>{const R=!u||E.symbol.toLowerCase().includes(u.toLowerCase())||E.name.toLowerCase().includes(u.toLowerCase()),V=m==="ALL"||E.type===m;return R&&V}),z=E=>({STOCK:"primary",BOND:"secondary",GOLD:"warning",COMMODITY:"info",DEPOSIT:"success",CASH:"default"})[E]||"default",N=e.jsxs(l,{sx:{display:"flex",gap:1},children:[e.jsx(he,{onClick:t,icon:e.jsx(e.Fragment,{}),mobileText:i("common.cancel"),desktopText:i("common.cancel"),children:i("common.cancel")}),e.jsx(We,{variant:"contained",onClick:T,disabled:g.length===0||y,icon:y?e.jsx(Ce,{size:20}):e.jsx(xt,{}),forceTextOnly:!0,mobileText:y?i("bulkAssetSelector.creating"):i("bulkAssetSelector.createCount",{count:g.length}),desktopText:y?i("bulkAssetSelector.creating"):i("bulkAssetSelector.createAssets",{count:g.length}),children:y?i("bulkAssetSelector.creating"):i("bulkAssetSelector.createAssets",{count:g.length})})]});return e.jsx(e.Fragment,{children:e.jsx(Rt,{open:r,onClose:t,title:i("bulkAssetSelector.title"),maxWidth:"md",size:"medium",titleColor:"primary",loading:y,actions:N,children:e.jsxs(l,{children:[!d&&e.jsxs(l,{sx:{mb:3,mt:2,backgroundColor:U(o.palette.info.main,.08),borderRadius:2,border:`1px solid ${U(o.palette.info.main,.15)}`,overflow:"hidden"},children:[e.jsx(he,{forceTextOnly:!0,onClick:()=>v(!b),sx:{justifyContent:"flex-start",p:2,textTransform:"none",color:"text.secondary",fontWeight:500,"&:hover":{backgroundColor:U(o.palette.info.main,.12)}},icon:b?e.jsx(Dn,{}):e.jsx(ln,{}),mobileText:i("bulkAssetSelector.help.title"),desktopText:i("bulkAssetSelector.help.title"),children:i("bulkAssetSelector.help.title")}),b&&e.jsx(l,{sx:{p:3,pt:0},children:e.jsx(c,{variant:"body2",ellipsis:!1,sx:{color:"text.secondary",fontWeight:500,lineHeight:1.6},children:i("bulkAssetSelector.help.description")})})]}),e.jsx(l,{mb:3,sx:{pt:3},children:e.jsxs(W,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(W,{item:!0,xs:12,md:5,children:e.jsx(Ae,{fullWidth:!0,label:i("bulkAssetSelector.search.label"),value:u,onChange:E=>h(E.target.value),InputProps:{startAdornment:e.jsx($n,{sx:{mr:1,color:"text.secondary"}})},placeholder:i("bulkAssetSelector.search.placeholder")})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:i("bulkAssetSelector.type.label")}),e.jsxs(Ze,{value:m,onChange:E=>x(E.target.value),label:i("bulkAssetSelector.type.label"),children:[e.jsx(re,{value:"ALL",children:i("bulkAssetSelector.type.all")}),O.map(E=>e.jsx(re,{value:E,children:po[E]||E},E))]})]})}),e.jsx(W,{item:!0,xs:12,md:3,children:e.jsx(he,{forceTextOnly:!0,fullWidth:!0,variant:"outlined",onClick:L,disabled:w||I.length===0,icon:e.jsx(e.Fragment,{}),mobileText:g.length===I.length?i("bulkAssetSelector.select.deselectAll"):i("bulkAssetSelector.select.selectAll"),desktopText:g.length===I.length?i("bulkAssetSelector.select.deselectAll"):i("bulkAssetSelector.select.selectAll"),children:g.length===I.length?i("bulkAssetSelector.select.deselectAll"):i("bulkAssetSelector.select.selectAll")})})]})}),w?e.jsx(l,{display:"flex",justifyContent:"center",py:4,children:e.jsx(Ce,{})}):C?e.jsxs(je,{severity:"error",children:[i("bulkAssetSelector.error.loadFailed"),": ",String(C)]}):I.length===0?e.jsx(je,{severity:"info",children:M.length===0?i("bulkAssetSelector.noAssets.allOwned"):i("bulkAssetSelector.noAssets.noSearchResults")}):e.jsxs(l,{children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,children:i("bulkAssetSelector.results.found",{count:I.length})}),e.jsx(lt,{sx:{maxHeight:400,overflow:"auto"},children:I.map(E=>e.jsxs(Pe,{dense:!0,button:!0,onClick:()=>A(E.id),sx:{borderLeft:g.includes(E.id)?"4px solid primary.main":"none",bgcolor:g.includes(E.id)?"action.selected":"inherit"},children:[e.jsx(rn,{edge:"start",checked:g.includes(E.id),tabIndex:-1,disableRipple:!0}),e.jsx(ve,{primary:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(c,{variant:"body1",fontWeight:"medium",children:E.symbol}),e.jsx(ce,{label:po[E.type],size:"small",color:z(E.type),sx:{backgroundColor:ur(E.type),color:"white","&:hover":{backgroundColor:ur(E.type),opacity:.8}}})]}),secondary:E.name})]},E.id))})]})]})})})},bk=({filters:r,onFiltersChange:t,onClearFilters:n})=>{const s=Je(),{accountId:a}=Ge(),{portfolios:i,isLoading:o}=Un(a),[d,u]=p.useState(!1),[h,m]=p.useState(r.search||""),[x,g]=p.useState(r),f=p.useRef(!1),y=p.useRef(null),j=p.useRef({searchTerm:r.search||"",localFilters:r,isTyping:!1});p.useEffect(()=>{g(r),!f.current&&r.search!==h&&(r.search===""||Math.abs((r.search||"").length-h.length)>2)&&m(r.search||"")},[r,h]),p.useEffect(()=>{const T=setTimeout(()=>{h!==x.search&&(h===""||h.length>=3)&&g(M=>({...M,search:h}))},300);return()=>clearTimeout(T)},[h,x.search]),p.useEffect(()=>{if(Object.keys(x).some(M=>x[M]!==r[M])){const M=setTimeout(()=>{t(x)},300);return()=>clearTimeout(M)}},[x,r,t]);const b=p.useCallback(T=>{f.current=!0,m(T),j.current.searchTerm=T,j.current.isTyping=!0,setTimeout(()=>{f.current=!1,j.current.isTyping=!1},1e3)},[]);p.useEffect(()=>{f.current&&y.current&&setTimeout(()=>{y.current&&y.current.focus()},0)},[h]);const v=p.useCallback(T=>{g(M=>({...M,type:T==="ALL"?void 0:T}))},[]),P=p.useCallback(T=>{g(M=>({...M,portfolioId:T==="ALL"?void 0:T}))},[]),w=p.useCallback(T=>{g(M=>({...M,sortBy:T}))},[]),C=p.useCallback(T=>{g(M=>({...M,sortOrder:T}))},[]),k=p.useCallback(()=>{m(""),g({search:"",type:void 0,portfolioId:void 0,sortBy:"name",sortOrder:"ASC",limit:100,createdBy:a}),n()},[n,a]),A=p.useCallback(()=>{u(!d)},[d]),L=p.useMemo(()=>x.search&&x.search.length>=3||x.type||x.portfolioId,[x.search,x.type,x.portfolioId]);return e.jsx(se,{variant:"outlined",sx:{borderRadius:2,boxShadow:1,border:`0.5px solid ${U(s.palette.divider,.5)}`,backgroundColor:U(s.palette.background.paper,.8)},children:e.jsxs(me,{sx:{p:3},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ir,{sx:{color:"primary.main"}}),e.jsx(D,{variant:"h6",sx:{fontWeight:600,color:"text.primary"},children:"Filters"}),L&&e.jsx(ce,{label:"Active",size:"small",color:"primary",sx:{ml:1}})]}),e.jsxs(l,{sx:{display:"flex",gap:1},children:[L&&e.jsx(he,{variant:"outlined",size:"small",icon:e.jsx(ei,{}),onClick:k,mobileText:"Clear",desktopText:"Clear All",sx:{textTransform:"none"},children:"Clear All"}),e.jsx(Ie,{onClick:A,sx:{color:"text.secondary",transform:d?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease-in-out"},children:d?e.jsx(Dn,{}):e.jsx(ln,{})})]})]}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(Ae,{ref:y,fullWidth:!0,label:"Search Assets",placeholder:"Type at least 3 characters to search...",value:h,onChange:T=>b(T.target.value),InputProps:{startAdornment:e.jsx($n,{sx:{color:"text.secondary",mr:1}}),endAdornment:h&&e.jsx(Ie,{size:"small",onClick:()=>b(""),sx:{mr:-1},children:e.jsx(ei,{})})},helperText:h.length>0&&h.length<3?`Type ${3-h.length} more character${3-h.length===1?"":"s"} to search`:void 0,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Asset Type"}),e.jsxs(Ze,{value:x.type||"ALL",onChange:T=>v(T.target.value),label:"Asset Type",sx:{borderRadius:2},children:[e.jsx(re,{value:"ALL",children:"All Types"}),e.jsx(re,{value:"STOCK",children:"Stock"}),e.jsx(re,{value:"BOND",children:"Bond"}),e.jsx(re,{value:"GOLD",children:"Gold"}),e.jsx(re,{value:"CRYPTO",children:"Cryptocurrency"}),e.jsx(re,{value:"COMMODITY",children:"Commodity"})]})]})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Portfolio"}),e.jsxs(Ze,{value:x.portfolioId||"ALL",onChange:T=>P(T.target.value),label:"Portfolio",disabled:o,sx:{borderRadius:2},children:[e.jsx(re,{value:"ALL",children:"All Portfolios"}),i==null?void 0:i.map(T=>e.jsx(re,{value:T.portfolioId,children:T.name},T.portfolioId))]})]})})]}),e.jsx(qr,{in:d,children:e.jsxs(l,{sx:{mt:3,pt:3,borderTop:`1px solid ${U(s.palette.divider,.5)}`},children:[e.jsx(D,{variant:"subtitle2",sx:{fontWeight:600,mb:2,color:"text.secondary"},children:"Advanced Options"}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Sort By"}),e.jsxs(Ze,{value:x.sortBy||"name",onChange:T=>w(T.target.value),label:"Sort By",sx:{borderRadius:2},children:[e.jsx(re,{value:"name",children:"Name"}),e.jsx(re,{value:"symbol",children:"Symbol"}),e.jsx(re,{value:"type",children:"Type"}),e.jsx(re,{value:"totalValue",children:"Total Value"}),e.jsx(re,{value:"createdAt",children:"Created Date"}),e.jsx(re,{value:"updatedAt",children:"Updated Date"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Sort Order"}),e.jsxs(Ze,{value:x.sortOrder||"ASC",onChange:T=>C(T.target.value),label:"Sort Order",sx:{borderRadius:2},children:[e.jsx(re,{value:"ASC",children:"Ascending"}),e.jsx(re,{value:"DESC",children:"Descending"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Items Per Page"}),e.jsxs(Ze,{value:x.limit||100,onChange:T=>g(M=>({...M,limit:Number(T.target.value)})),label:"Items Per Page",sx:{borderRadius:2},children:[e.jsx(re,{value:10,children:"10"}),e.jsx(re,{value:25,children:"25"}),e.jsx(re,{value:50,children:"50"}),e.jsx(re,{value:100,children:"100"}),e.jsx(re,{value:200,children:"200"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Trading Status"}),e.jsxs(Ze,{value:x.hasTrades===void 0?"ALL":x.hasTrades?"YES":"NO",onChange:T=>{const M=T.target.value;g(O=>({...O,hasTrades:M==="ALL"?void 0:M==="YES"}))},label:"Trading Status",sx:{borderRadius:2},children:[e.jsx(re,{value:"ALL",children:"All Assets"}),e.jsx(re,{value:"YES",children:"With Trades"}),e.jsx(re,{value:"NO",children:"Without Trades"})]})]})})]})]})})]})})},hx=p.memo(r=>e.jsx(bk,{...r}),()=>!0);hx.displayName="AssetsFilterPanel";const jk=lp`
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0.3; }
`,vk={assets:{title:"Hng dn s dng Assets",items:[{icon:e.jsx(fc,{fontSize:"small"}),title:"Assets l g?",description:"Assets l cc ti sn ti chnh trong portfolio ca bn nh c phiu, tri phiu, vng, crypto...",color:"info.main"},{icon:e.jsx(Ss,{fontSize:"small"}),title:"Theo di hiu sut",description:"H thng t ng tnh ton li/l, t l tng trng v phn tch ri ro",color:"warning.main"},{icon:e.jsx(xt,{fontSize:"small"}),title:"To tng asset ring l",description:"Nhn 'Add Asset'  to asset mi vi thng tin chi tit (tn, loi, gi, s lng...)",color:"primary.main"},{icon:e.jsx(cp,{fontSize:"small"}),title:"To hng lot (Bulk Create)",description:"Nhn 'Quick Create'  chn nhiu assets t danh sch mu c sn",color:"secondary.main"},{icon:e.jsx(tl,{fontSize:"small"}),title:"Quick Create nhanh hn",description:"Dnh cho ngi dng mi - chn t danh sch assets ph bin",color:"success.main"}]},trading:{title:"Hng dn s dng Trading",items:[{icon:e.jsx(xt,{fontSize:"small"}),title:"To giao dch mi",description:"Nhn 'Add Trade'  ghi li giao dch mua/bn",color:"primary.main"},{icon:e.jsx(tl,{fontSize:"small"}),title:"Theo di hiu sut",description:"Xem li/l v phn tch portfolio ca bn",color:"success.main"}]},portfolio:{title:"Hng dn s dng Portfolio",items:[{icon:e.jsx(xt,{fontSize:"small"}),title:"To portfolio mi",description:"Nhn 'Create Portfolio'  to danh mc u t",color:"primary.main"},{icon:e.jsx(tl,{fontSize:"small"}),title:"Qun l danh mc",description:"Theo di v qun l cc portfolio ca bn",color:"success.main"}]}},wk=({guideKey:r,position:t="top-right",size:n="medium",className:s})=>{const a=Je(),[i,o]=p.useState(!1),d=vk[r],h=(P=>{switch(P){case"small":return{maxWidth:300,padding:1.5};case"medium":return{maxWidth:400,padding:2};case"large":return{maxWidth:500,padding:2.5};case"xlarge":return{maxWidth:800,padding:3};case"xxlarge":return{maxWidth:1e3,padding:3};default:return{maxWidth:400,padding:2}}})(n);if(!d)return console.warn(`Guide with key "${r}" not found in registry`),null;const{title:m,items:x}=d,g=localStorage.getItem(`seen_guide_${r}`)==="true",[f,y]=p.useState(!g);p.useEffect(()=>{if(!g){const P=setTimeout(()=>{y(!1)},1e4);return()=>clearTimeout(P)}},[g]);const j=()=>{o(!i),y(!1),i||localStorage.setItem(`seen_guide_${r}`,"true")},b=()=>{switch(t){case"top-left":return{justifyContent:"flex-start"};case"top-right":return{justifyContent:"flex-end"};case"bottom-left":return{justifyContent:"flex-start",mt:"auto"};case"bottom-right":return{justifyContent:"flex-end",mt:"auto"};default:return{justifyContent:"flex-end"}}},v=e.jsxs(l,{sx:{maxWidth:h.maxWidth,p:h.padding},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(fc,{sx:{mr:1,color:"info.main",fontSize:20}}),e.jsx(l,{sx:{color:"info.main",fontWeight:600,fontSize:"14px"},children:m})]}),x.map((P,w)=>e.jsxs(l,{sx:{mb:2,display:"flex",alignItems:"flex-start"},children:[e.jsx(l,{sx:{color:P.color||"primary.main",mr:1.5,mt:.5,display:"flex",alignItems:"center"},children:P.icon}),e.jsxs(l,{children:[e.jsx(l,{sx:{fontWeight:600,color:"text.primary",fontSize:"13px",mb:.5},children:P.title}),e.jsx(l,{sx:{color:"text.secondary",fontSize:"12px",lineHeight:1.4},children:P.description})]})]},w))]});return e.jsx(l,{className:s,children:e.jsx(l,{sx:{display:"flex",...b()},children:e.jsx(Fe,{title:i?v:"",placement:"left",arrow:!0,open:i,onClose:()=>o(!1),PopperProps:{sx:{"& .MuiTooltip-tooltip":{backgroundColor:"white",color:"text.primary",fontSize:"12px",maxWidth:"none",padding:0,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",border:"1px solid rgba(0,0,0,0.1)"},"& .MuiTooltip-arrow":{color:"white"}}},children:e.jsx(Ie,{onClick:j,sx:{backgroundColor:i?U(a.palette.info.main,.2):U(a.palette.info.main,.1),color:"info.main","&:hover":{backgroundColor:U(a.palette.info.main,.2),transform:"scale(1.05)"},transition:"all 0.2s ease-in-out",animation:f?`${jk} 1.5s infinite`:"none",boxShadow:f?`0 0 20px ${U(a.palette.info.main,.5)}`:"none"},children:e.jsx(Ss,{})})})})})},Zc=p.memo(({asset:r,baseCurrency:t,theme:n,onViewDetail:s,onEdit:a,onDelete:i,isLoadingDeleteInfo:o,t:d})=>{const u=f=>{switch(ur(f)){case"#045db4":return"primary";case"#059669":return"success";case"#ff9800":return"warning";case"#dc3532":return"error";case"#ff5722":return"error";case"#795548":return"default";case"#9e9e9e":return"default";case"#5d2fd3":return"secondary";default:return"default"}},h=Number(r.currentPrice)||0,m=Number(r.avgCost)||0,x=m>0?h-m:0,g=m>0?x/m*100:0;return e.jsxs(De,{sx:{cursor:"pointer","&:hover":{backgroundColor:U(n.palette.primary.main,.02)}},onClick:()=>s(r),children:[e.jsx(S,{sx:{maxWidth:{xs:"200px",sm:"250px",md:"300px"},minWidth:"auto"},children:e.jsxs(l,{children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5,flexWrap:"wrap"},children:[r.symbol&&e.jsx(c,{variant:"formHelper",sx:{fontFamily:"monospace",backgroundColor:"grey.100",px:1,py:.25,borderRadius:.5,fontSize:"0.7rem",flexShrink:0},children:r.symbol}),e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600,color:"text.primary",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minWidth:0,flex:1,display:{xs:"none",sm:"block"}},children:r.name})]}),e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:e.jsx(ce,{label:r.type,color:u(r.type),size:"small",sx:{fontWeight:500,backgroundColor:ur(r.type),color:"white",fontSize:"0.7rem",height:20,flexShrink:0,"& .MuiChip-label":{color:"white",fontWeight:600}}})})]})}),e.jsx(S,{sx:{textAlign:"right",maxWidth:{xs:"120px",sm:"150px"},minWidth:"100px"},children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:.5},children:[e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600,color:x>=0?"success.main":"error.main",fontSize:{xs:"0.7rem",sm:"0.9rem"}},children:G(h,t)}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5,flexWrap:"wrap",justifyContent:"flex-end"},children:[e.jsx(c,{variant:"formHelper",sx:{fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:G(m,t)}),g!==0&&e.jsxs(c,{variant:"formHelper",sx:{color:x>=0?"success.main":"error.main",fontSize:{xs:"0.65rem",sm:"0.7rem"},fontWeight:600},children:[x>=0?"+":"",g.toFixed(1),"%"]})]})]})}),e.jsx(S,{sx:{textAlign:"right",maxWidth:{xs:"80px",sm:"100px"},minWidth:"60px",display:{xs:"none",sm:"table-cell"}},children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:500},children:dn(r.totalQuantity,r.type==="CRYPTO"?5:1)||0})}),e.jsxs(S,{sx:{textAlign:"right",maxWidth:{xs:"100px",sm:"120px"},minWidth:"80px"},children:[e.jsx(c,{variant:"tableCell",sx:{color:"success.main"},children:G(Number(r.totalValue)||0,t)}),e.jsx(c,{variant:"formHelper",sx:{color:"text.secondary",fontSize:{xs:"0.65rem",sm:"0.7rem"},marginTop:.5,display:{xs:"block",sm:"none"}},children:dn(r.totalQuantity,r.type==="CRYPTO"?5:1)||0})]}),e.jsx(S,{sx:{maxWidth:{xs:"100px",sm:"120px"},minWidth:"80px"},children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:400,color:"text.secondary",fontSize:{xs:"0.7rem",sm:"0.8rem"}},children:db(r.priceUpdatedAt||new Date,"HH:mm:ss dd/MM/yyyy")})}),e.jsx(S,{sx:{maxWidth:{xs:"100px",sm:"120px"},minWidth:"80px"},children:e.jsx(ce,{label:r.priceMode==="AUTOMATIC"?d("asset.form.priceMode.automatic"):d("asset.form.priceMode.manual"),color:r.priceMode==="AUTOMATIC"?"success":"warning",size:"small",sx:{fontWeight:500,fontSize:"0.7rem",height:20,"& .MuiChip-label":{fontWeight:600}}})}),e.jsx(S,{sx:{textAlign:"center",maxWidth:{xs:"120px",sm:"140px"},minWidth:"100px"},children:e.jsxs(l,{sx:{display:"flex",gap:1,justifyContent:"center"},children:[e.jsx(tr,{size:"small",onClick:f=>{f.stopPropagation(),a(r)},tooltip:d("assets.actions.editAsset"),readOnlyTooltip:d("common.readOnlyMode"),sx:{color:"info.main","&:hover":{backgroundColor:U(n.palette.info.main,.1)},"&.Mui-disabled":{opacity:.5}},children:e.jsx(Tt,{})}),e.jsx(tr,{size:"small",onClick:f=>{f.stopPropagation(),i(r)},disabled:o,tooltip:d("assets.actions.deleteAsset"),readOnlyTooltip:d("common.readOnlyMode"),sx:{color:"error.main","&:hover":{backgroundColor:U(n.palette.error.main,.1)},"&.Mui-disabled":{opacity:.5}},children:o?e.jsx(Ce,{size:16}):e.jsx(pt,{})})]})})]},r.id)});Zc.displayName="AssetTableRow";const mx=p.memo(({assets:r,baseCurrency:t,theme:n,t:s})=>{const a=p.useMemo(()=>{const o=r.length,d=r.reduce((f,y)=>f+(Number(y.totalValue)||0),0),u=o>0?d/o:0,h=r.reduce((f,y)=>(f[y.type]=(f[y.type]||0)+1,f),{}),m=r.filter(f=>{const y=Number(f.currentPrice)||0,j=Number(f.avgCost)||0;return j>0&&y>j}).length,x=r.filter(f=>{const y=Number(f.currentPrice)||0,j=Number(f.avgCost)||0;return j>0&&y<j}).length,g=r.reduce((f,y)=>{const j=Number(y.currentPrice)||0,b=Number(y.avgCost)||0,v=Number(y.totalQuantity)||0;if(b>0){const P=(j-b)*v;return f+P}return f},0);return{totalAssets:o,totalValue:d,averageValue:u,assetsByType:h,profitableAssets:m,lossAssets:x,totalProfitLoss:g}},[r]),i=p.useMemo(()=>[{title:s("assets.metrics.totalAssets"),value:e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsxs(l,{sx:{color:"success.main",fontWeight:600},children:[a.profitableAssets,""]}),e.jsxs(l,{sx:{color:"error.main",fontWeight:600},children:[a.lossAssets,""]})]})}),subtitle:`${s("assets.metrics.profitable")}: ${a.profitableAssets} | ${s("assets.metrics.loss")}: ${a.lossAssets}`,icon:e.jsx(qt,{sx:{fontSize:24,color:"primary.main"}}),color:"primary",gradient:`linear-gradient(135deg, ${U(n.palette.primary.main,.06)} 0%, ${U(n.palette.primary.main,.03)} 100%)`,mobileHidden:!0},{title:s("assets.metrics.totalValue"),value:G(a.totalValue,t),subtitle:s("assets.metrics.combinedAssetValue"),icon:e.jsx(mr,{sx:{fontSize:24,color:"success.main"}}),color:"success",gradient:`linear-gradient(135deg, ${U(n.palette.success.main,.06)} 0%, ${U(n.palette.success.main,.03)} 100%)`},{title:s("assets.metrics.currentProfitLoss"),value:e.jsxs(l,{sx:{color:a.totalProfitLoss>=0?"success.main":"error.main",fontWeight:600},children:[a.totalProfitLoss>=0?"+":"",G(a.totalProfitLoss,t)]}),subtitle:a.totalProfitLoss>=0?s("assets.metrics.totalProfit"):s("assets.metrics.totalLoss"),icon:e.jsx(Ue,{sx:{fontSize:24,color:a.totalProfitLoss>=0?"success.main":"error.main"}}),color:a.totalProfitLoss>=0?"success":"error",gradient:a.totalProfitLoss>=0?`linear-gradient(135deg, ${U(n.palette.success.main,.06)} 0%, ${U(n.palette.success.main,.03)} 100%)`:`linear-gradient(135deg, ${U(n.palette.error.main,.06)} 0%, ${U(n.palette.error.main,.03)} 100%)`,mobileHidden:!0},{title:s("assets.metrics.assetTypes"),value:Object.keys(a.assetsByType).length.toString(),subtitle:s("assets.metrics.differentCategories"),icon:e.jsx(He,{sx:{fontSize:24,color:"secondary.main"}}),color:"secondary",gradient:`linear-gradient(135deg, ${U(n.palette.secondary.main,.06)} 0%, ${U(n.palette.secondary.main,.03)} 100%)`,mobileHidden:!0}],[a,t,n.palette,s]);return e.jsx(W,{container:!0,spacing:3,sx:{mb:4},children:i.map((o,d)=>e.jsx(W,{item:!0,xs:12,sm:6,lg:3,sx:{display:o.mobileHidden?{xs:"none",sm:"block"}:"block"},children:e.jsx(se,{sx:{height:"100%",background:o.gradient,border:`0.5px solid ${U(n.palette[o.color].main,.15)}`,borderRadius:2,boxShadow:1,transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:3}},children:e.jsx(me,{sx:{p:3},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(l,{sx:{p:1.5,borderRadius:2,backgroundColor:U(n.palette[o.color].main,.1),display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:o.icon}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{component:"div",variant:"cardValue",sx:{color:`${o.color}.main`,mb:.5},children:o.value}),e.jsx(c,{variant:"cardSubtitle",sx:{color:"text.primary",mb:.5},children:o.title})]})]})})})},d))})});mx.displayName="SummaryMetrics";const xx=p.memo(({assets:r,baseCurrency:t,theme:n,onViewDetail:s,onEdit:a,onDelete:i,isLoadingDeleteInfo:o,t:d})=>e.jsxs(l,{sx:{mb:4},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsx(He,{sx:{color:"success.main",fontSize:28}}),e.jsxs(l,{children:[e.jsxs(c,{variant:"h6",sx:{fontWeight:600,color:"success.main"},children:[d("assets.withTrades.title")," (",r.length,")"]}),e.jsx(c,{variant:"body2",sx:{color:"text.secondary"},children:d("assets.withTrades.subtitle")})]})]}),r.length===0?e.jsxs(se,{sx:{p:4,textAlign:"center",background:`linear-gradient(135deg, ${U(n.palette.success.main,.05)} 0%, ${U(n.palette.success.main,.02)} 100%)`,border:`1px solid ${U(n.palette.success.main,.1)}`,borderRadius:2},children:[e.jsx(He,{sx:{fontSize:48,color:"success.main",mb:2}}),e.jsx(c,{variant:"h6",sx:{mb:1,color:"success.main"},children:d("assets.withTrades.noAssets.title")}),e.jsx(c,{variant:"body2",sx:{color:"text.secondary"},children:d("assets.withTrades.noAssets.description")})]}):e.jsx(se,{sx:{borderRadius:2,background:`linear-gradient(135deg, ${U(n.palette.background.paper,.8)} 0%, ${U(n.palette.background.paper,.6)} 100%)`,border:`1px solid ${U(n.palette.success.main,.1)}`,backdropFilter:"blur(10px)"},children:e.jsx(me,{sx:{p:0},children:e.jsx(at,{component:Te,variant:"outlined",sx:{borderRadius:0},children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:U(n.palette.success.main,.05)},children:[e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.asset")})}),e.jsx(S,{sx:{textAlign:"right"},children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.priceComparison")})}),e.jsx(S,{sx:{textAlign:"right",display:{xs:"none",sm:"table-cell"}},children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.quantity")})}),e.jsx(S,{sx:{textAlign:"right"},children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.totalValue")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.lastUpdated")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.priceMode")})}),e.jsx(S,{sx:{textAlign:"center"},children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("common.actions")})})]})}),e.jsx(ot,{children:r.map(u=>e.jsx(Zc,{asset:u,baseCurrency:t,theme:n,onViewDetail:s,onEdit:a,onDelete:i,isLoadingDeleteInfo:o,t:d},u.id))})]})})})})]})),px=p.memo(({assets:r,baseCurrency:t,theme:n,onViewDetail:s,onEdit:a,onDelete:i,isLoadingDeleteInfo:o,t:d})=>e.jsxs(l,{sx:{mb:4},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[e.jsx(qt,{sx:{color:"warning.main",fontSize:28}}),e.jsxs(l,{children:[e.jsxs(c,{variant:"h6",sx:{fontWeight:600,color:"warning.main"},children:[d("assets.withoutTrades.title")," (",r.length,")"]}),e.jsx(c,{variant:"body2",sx:{color:"text.secondary"},children:d("assets.withoutTrades.subtitle")})]})]}),r.length===0?e.jsxs(se,{sx:{p:4,textAlign:"center",background:`linear-gradient(135deg, ${U(n.palette.warning.main,.05)} 0%, ${U(n.palette.warning.main,.02)} 100%)`,border:`1px solid ${U(n.palette.warning.main,.1)}`,borderRadius:2},children:[e.jsx(qt,{sx:{fontSize:48,color:"warning.main",mb:2}}),e.jsx(c,{variant:"h6",sx:{mb:1,color:"warning.main"},children:d("assets.withoutTrades.noAssets.title")}),e.jsx(c,{variant:"body2",sx:{color:"text.secondary"},children:d("assets.withoutTrades.noAssets.description")})]}):e.jsx(se,{sx:{borderRadius:2,background:`linear-gradient(135deg, ${U(n.palette.background.paper,.8)} 0%, ${U(n.palette.background.paper,.6)} 100%)`,border:`1px solid ${U(n.palette.warning.main,.1)}`,backdropFilter:"blur(10px)"},children:e.jsx(me,{sx:{p:0},children:e.jsx(at,{component:Te,variant:"outlined",sx:{borderRadius:0},children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:U(n.palette.warning.main,.05)},children:[e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.asset")})}),e.jsx(S,{sx:{textAlign:"right"},children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.priceComparison")})}),e.jsx(S,{sx:{textAlign:"right",display:{xs:"none",sm:"table-cell"}},children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.quantity")})}),e.jsx(S,{sx:{textAlign:"right"},children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.totalValue")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.lastUpdated")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("assets.table.priceMode")})}),e.jsx(S,{sx:{textAlign:"center"},children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:600},children:d("common.actions")})})]})}),e.jsx(ot,{children:r.map(u=>e.jsx(Zc,{asset:u,baseCurrency:t,theme:n,onViewDetail:s,onEdit:a,onDelete:i,isLoadingDeleteInfo:o,t:d},u.id))})]})})})})]}));xx.displayName="AssetsWithTradesList";px.displayName="AssetsWithoutTradesList";const Sk=()=>{const{t:r}=Ne(),t=Je(),{accountId:n,baseCurrency:s}=Ge(),{portfolios:a}=Un(n),{assets:i,loading:o,error:d,filters:u,refresh:h,updateAsset:m,createAsset:x,deleteAsset:g,setFilters:f}=Yc({initialFilters:{createdBy:n,limit:50,sortBy:"name",sortOrder:"ASC"},autoFetch:!0}),[y,j]=p.useState(null),[b,v]=p.useState(null),[P,w]=p.useState(null),[C,k]=p.useState(!1),[A,L]=p.useState(!1),[T,M]=p.useState(!1),[O,I]=p.useState(null),[z,N]=p.useState(null),[E,R]=p.useState(!1),[V,F]=p.useState(0),[B,$]=p.useState([]),[Y,_]=p.useState(!1),[K,X]=p.useState(!1),[ne,oe]=p.useState(!1);p.useEffect(()=>{n&&(()=>{f({search:"",type:void 0,portfolioId:void 0,sortBy:"name",sortOrder:"ASC",limit:50,createdBy:n})})()},[n]);const ee=()=>{h()},H=p.useCallback(fe=>{console.log("handleViewAssetDetail",fe),j(fe)},[]),Q=p.useCallback(async fe=>{j(null),v(fe),w(null);try{const ie=await Km.getGlobalAssetBySymbol(fe.symbol);w(ie)}catch{}},[]),Z=p.useCallback(async fe=>{j(null),I(fe),_(!0);try{const ie=await vs.getAssetPortfolioInfo(fe.id,n);F(ie.tradingCount),$(ie.portfolios),L(!0)}catch{F(0),$([]),L(!0)}finally{_(!1)}},[n]),J=p.useCallback(()=>{k(!0)},[]),ae=p.useCallback(fe=>{oe(!0),f({...fe,createdBy:n}),setTimeout(()=>oe(!1),200)},[f,n]),ue=p.useCallback(()=>{oe(!0),f({search:"",type:void 0,portfolioId:void 0,sortBy:"name",sortOrder:"ASC",limit:100,createdBy:n}),setTimeout(()=>oe(!1),200)},[f,n]),le=p.useCallback(fe=>{X(fe)},[]),pe=p.useCallback(()=>{j(null),v(null),w(null),k(!1),L(!1),M(!1),I(null),N(null),F(0),$([]),_(!1)},[]),Me=p.useCallback(async fe=>{R(!0),N(null);try{b?(await m(b.id,fe),h()):(await x(fe),h()),pe()}catch(ie){N(ie instanceof Error?ie.message:"An error occurred")}finally{R(!1)}},[b,m,x,pe,h]),Le=p.useCallback(async()=>{if(O)try{await g(O.id),pe()}catch(fe){N(fe instanceof Error?fe.message:"An error occurred")}},[O,g,pe]),qe=p.useCallback(async fe=>{try{return await vs.bulkCreateAssets(fe,n)}catch(ie){throw ie}},[n]),de=p.useCallback(()=>{M(!0)},[]);return o?e.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:e.jsx(Ce,{})}):d?e.jsxs(l,{children:[e.jsxs(je,{severity:"error",sx:{mb:2},children:[r("assets.errors.loadingError"),": ",d]}),e.jsx(he,{onClick:ee,variant:"contained",icon:e.jsx(Mt,{}),mobileText:r("common.retry"),desktopText:r("common.retry"),children:r("common.retry")})]}):e.jsxs(l,{children:[e.jsx(l,{sx:{mb:4},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"pageHeader",sx:{background:`linear-gradient(135deg, ${t.palette.primary.main} 0%, ${t.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1},children:r("assets.pageTitle")}),e.jsx(c,{variant:"pageSubtitle",children:r("assets.pageSubtitle")})]}),e.jsxs(l,{sx:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx(We,{variant:"outlined",icon:e.jsx(xt,{}),onClick:de,readOnlyTooltip:r("assets.actions.quickCreateTooltip"),sx:{borderRadius:2,textTransform:"none",fontWeight:500},children:r("assets.actions.quickCreate")}),e.jsx(We,{variant:"contained",icon:e.jsx(xt,{}),onClick:J,readOnlyTooltip:r("assets.actions.addAssetTooltip"),mobileText:r("assets.actions.add"),desktopText:r("assets.actions.addAsset"),children:r("assets.actions.addAsset")})]})]})}),e.jsx(mx,{assets:i,baseCurrency:s,theme:t,t:r}),e.jsxs(l,{sx:{mb:3},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(wk,{guideKey:"assets",position:"top-left",size:"large"}),e.jsxs(l,{sx:{display:"flex",gap:2},children:[e.jsx(he,{variant:"outlined",icon:e.jsx(Mt,{}),onClick:ee,mobileText:r("common.refresh"),desktopText:r("assets.actions.refreshData"),sx:{borderRadius:2,textTransform:"none",fontWeight:500},children:r("assets.actions.refreshData")}),e.jsx(he,{variant:K?"contained":"outlined",icon:e.jsx(Ir,{}),onClick:()=>le(!K),sx:{borderRadius:2,textTransform:"none",fontWeight:500},children:r("assets.filters.title")})]})]}),(()=>{const fe=[];if(u.search&&fe.push({key:"search",label:r("assets.filters.search"),value:u.search}),u.type&&fe.push({key:"type",label:r("assets.filters.type"),value:u.type}),u.portfolioId){const ie=a==null?void 0:a.find(Se=>Se.portfolioId===u.portfolioId);fe.push({key:"portfolioId",label:r("assets.filters.portfolio"),value:(ie==null?void 0:ie.name)||u.portfolioId})}return fe.length>0?e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap",px:1,backgroundColor:"grey.50",borderRadius:1,border:"1px solid",borderColor:"grey.200"},children:[e.jsxs(c,{variant:"body2",sx:{fontWeight:600,color:"text.secondary",mr:1},children:[r("assets.filters.activeFilters"),":"]}),fe.map(ie=>e.jsx(ce,{label:`${ie.label}: ${ie.value}`,size:"small",color:"primary",variant:"outlined",onDelete:()=>{const Se={...u};ie.key==="search"&&(Se.search=""),ie.key==="type"&&(Se.type=void 0),ie.key==="portfolioId"&&(Se.portfolioId=void 0),ae(Se)},sx:{fontSize:"0.75rem",height:24,"& .MuiChip-label":{fontWeight:500}}},ie.key)),e.jsx(he,{size:"small",variant:"text",onClick:ue,sx:{fontSize:"0.75rem",textTransform:"none",minWidth:"auto",px:1,ml:"auto"},children:r("assets.filters.clearAll")})]}):null})()]}),K&&e.jsxs(l,{sx:{mb:3},children:[e.jsx(hx,{filters:u,onFiltersChange:ae,onClearFilters:ue}),ne&&e.jsx(l,{sx:{display:"flex",justifyContent:"center",py:2},children:e.jsx(Ce,{size:20})})]}),(()=>{const fe=i.filter(Se=>Se.hasTrades),ie=i.filter(Se=>!Se.hasTrades);return e.jsxs(l,{children:[e.jsx(xx,{assets:fe,baseCurrency:s,theme:t,onViewDetail:H,onEdit:Q,onDelete:Z,isLoadingDeleteInfo:Y,t:r}),e.jsx(px,{assets:ie,baseCurrency:s,theme:t,onViewDetail:H,onEdit:Q,onDelete:Z,isLoadingDeleteInfo:Y,t:r})]})})(),e.jsx(nk,{open:!!y,onClose:pe,asset:y,onEdit:Q,onDelete:Z,loading:!1}),e.jsx(Qm,{open:!!(C||b),onClose:pe,onSubmit:Me,onCancel:pe,loading:E,error:z,editingAsset:b,globalAsset:P,accountId:n}),e.jsx(rk,{open:A,assetName:(O==null?void 0:O.name)||"",tradeCount:V,portfolios:B,onConfirm:Le,onCancel:pe,isDeleting:E}),e.jsx(yk,{open:T,onClose:pe,onBulkCreate:qe,existingAssets:i.map(fe=>({symbol:fe.symbol,name:fe.name})),onRefresh:h})]})},gx=({deposits:r,loading:t=!1,onEdit:n,onSettle:s,onDelete:a,onViewDetails:i})=>{const{t:o}=Ne(),[d,u]=p.useState(null),[h,m]=p.useState(null),[x,g]=p.useState(!1),[f,y]=p.useState(null),j=(L,T)=>{u(L.currentTarget),m(T)},b=()=>{u(null),m(null)},v=L=>{L(),b()},P=L=>{y(L),g(!0),b()},w=()=>{f&&a&&a(f),g(!1),y(null)},C=()=>{g(!1),y(null)},k=L=>L.status==="SETTLED"?"success":L.isMatured?"warning":"primary",A=L=>L.status==="SETTLED"?e.jsx(Xe,{fontSize:"small"}):L.isMatured?e.jsx(on,{fontSize:"small"}):e.jsx(dp,{fontSize:"small"});return t?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",p:4,children:e.jsx(Ce,{})}):r.length===0?e.jsx(je,{severity:"info",sx:{mt:2},children:o("deposit.noDeposits")}):e.jsxs(at,{component:Te,sx:{mt:2},children:[e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:o("deposit.bank")}),e.jsx(S,{align:"right",children:o("deposit.principal")}),e.jsx(S,{align:"right",children:o("deposit.interestRate")}),e.jsx(S,{align:"center",children:o("deposit.term")}),e.jsx(S,{align:"center",children:o("deposit.status")}),e.jsx(S,{align:"right",children:r.some(L=>L.status==="SETTLED")?o("deposit.actualInterest"):o("deposit.accruedInterest")}),e.jsx(S,{align:"right",children:o("deposit.totalValue")}),e.jsx(S,{align:"center",children:o("deposit.actions")})]})}),e.jsx(ot,{children:r.map(L=>e.jsxs(De,{hover:!0,onClick:()=>i==null?void 0:i(L),sx:{cursor:i?"pointer":"default"},children:[e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Ue,{color:"primary",fontSize:"small"}),e.jsx(c,{variant:"body2",fontWeight:"medium",children:L.bankName||"N/A"})]})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"body2",fontWeight:"medium",children:G(L.principal||0)})}),e.jsx(S,{align:"right",children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:.5,children:[e.jsx(He,{fontSize:"small",color:"primary"}),e.jsx(c,{variant:"body2",children:L.interestRate?`${L.interestRate}%`:"N/A"})]})}),e.jsx(S,{align:"center",children:e.jsxs(l,{display:"flex",flexDirection:"column",alignItems:"center",gap:.5,children:[e.jsx(c,{variant:"body2",fontWeight:"medium",children:L.termDescription||"N/A"}),e.jsxs(c,{variant:"caption",color:"text.secondary",children:[Gt(L.startDate,"short")," - ",Gt(L.status==="SETTLED"?L.settledAt:L.endDate,"short")]})]})}),e.jsx(S,{align:"center",children:e.jsx(l,{display:"flex",flexDirection:"column",alignItems:"center",gap:.5,children:e.jsx(ce,{icon:A(L),label:L.status==="SETTLED"?o("deposit.settled"):L.isMatured?o("deposit.matured"):o("deposit.active"),color:k(L),size:"small",sx:{fontSize:"0.7rem"}})})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"body2",color:"primary",fontWeight:"medium",children:G(L.status==="SETTLED"?L.actualInterest||0:L.accruedInterest||0)})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"body2",fontWeight:"bold",color:"success.main",children:G(L.totalValue||0)})}),e.jsx(S,{align:"center",children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:1,children:[L.canBeSettled&&s&&e.jsx(We,{size:"small",variant:"contained",color:"success",icon:e.jsx(ba,{}),mobileText:o("deposit.settle"),desktopText:o("deposit.settle"),onClick:T=>{T.stopPropagation(),s(L)},sx:{minWidth:"auto",px:.5,"&.MuiButtonBase-root":{fontSize:{xs:"0.65rem !important",sm:"0.7rem !important",md:"0.75rem !important"}},"&.MuiButton-root":{fontSize:{xs:"0.65rem !important",sm:"0.7rem !important",md:"0.75rem !important"}}},children:o("deposit.settle")}),e.jsx(Ie,{size:"small",onClick:T=>{T.stopPropagation(),j(T,L)},children:e.jsx(wr,{})})]})})]},L.depositId||"unknown"))})]}),e.jsx(Gn,{anchorEl:d,open:!!d,onClose:b,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:h&&e.jsxs(e.Fragment,{children:[i&&e.jsxs(re,{onClick:()=>v(()=>i(h)),children:[e.jsx(Xt,{fontSize:"small",sx:{mr:1}}),o("deposit.viewDetails")]}),h.canBeEdited&&n&&e.jsxs(re,{onClick:()=>v(()=>n(h)),children:[e.jsx(Tt,{fontSize:"small",sx:{mr:1}}),o("deposit.edit")]}),a&&e.jsxs(re,{onClick:()=>v(()=>P(h)),sx:{color:"error.main"},children:[e.jsx(pt,{fontSize:"small",sx:{mr:1}}),o("deposit.delete")]})]})}),e.jsxs(kt,{open:x,onClose:C,maxWidth:"sm",fullWidth:!0,children:[e.jsx(Et,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Vt,{sx:{bgcolor:"error.main",width:40,height:40},children:e.jsx(pt,{})}),e.jsxs(l,{children:[e.jsx(c,{variant:"h6",fontWeight:"bold",children:o("deposit.confirmDelete")}),e.jsx(c,{variant:"body2",color:"text.secondary",children:o("deposit.cannotUndo")})]})]})}),e.jsxs(Pt,{children:[f&&e.jsx(se,{sx:{mt:2,border:"1px solid",borderColor:"error.light"},children:e.jsx(me,{children:e.jsxs(ft,{spacing:2,children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Ue,{color:"primary"}),e.jsxs(l,{children:[e.jsx(c,{variant:"h6",fontWeight:"bold",children:f.bankName||"N/A"}),e.jsx(c,{variant:"body2",color:"text.secondary",fontFamily:"monospace",children:f.accountNumber||"N/A"})]})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{variant:"body2",color:"text.secondary",children:o("deposit.principalAmount")}),e.jsx(c,{variant:"body2",fontWeight:"bold",children:G(f.principal||0)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{variant:"body2",color:"text.secondary",children:o("deposit.interestRateLabel")}),e.jsx(c,{variant:"body2",fontWeight:"bold",children:f.interestRate?`${f.interestRate}%`:"N/A"})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{variant:"body2",color:"text.secondary",children:o("deposit.termLabel")}),e.jsxs(c,{variant:"body2",fontWeight:"bold",children:[f.termDescription||"N/A"," - ",Gt(f.status==="SETTLED"?f.settledAt:f.endDate,"short")]})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{variant:"body2",color:"text.secondary",children:o("deposit.totalValueLabel")}),e.jsx(c,{variant:"body2",fontWeight:"bold",color:"success.main",children:G(f.totalValue||0)})]})]})})}),e.jsxs(je,{severity:"warning",sx:{mt:2},children:[e.jsx(c,{variant:"body2",fontWeight:"bold",children:o("deposit.deleteWarning")}),e.jsx(c,{variant:"body2",children:o("deposit.deleteWarningText")})]})]}),e.jsxs(Dt,{sx:{p:3,gap:1},children:[e.jsx(he,{onClick:C,variant:"outlined",size:"large",icon:e.jsx(Tt,{}),mobileText:o("deposit.cancel"),desktopText:o("deposit.cancel"),children:o("deposit.cancel")}),e.jsx(We,{onClick:w,variant:"contained",color:"error",size:"large",icon:e.jsx(pt,{}),mobileText:o("deposit.deletePermanently"),desktopText:o("deposit.deletePermanently"),forceTextOnly:!0,children:o("deposit.deletePermanently")})]})]})]})},fx=({open:r,onClose:t,onSubmit:n,deposit:s})=>{const{t:a}=Ne(),[i,o]=p.useState(""),d=mi({actualInterest:Ka().required(a("deposit.settlement.validation.actualInterestRequired")).min(0,a("deposit.settlement.validation.actualInterestMin")),settlementDate:sn().required(a("deposit.settlement.validation.settlementDateRequired")),notes:sn().max(500,a("deposit.settlement.validation.notesMaxLength"))}),{control:u,handleSubmit:h,reset:m,watch:x,formState:{errors:g,isSubmitting:f}}=xi({resolver:Si(d),defaultValues:{actualInterest:0,settlementDate:new Date().toISOString().split("T")[0],notes:""}}),y=x("actualInterest")||0;p.useEffect(()=>{r&&s&&(m({actualInterest:s.accruedInterest||0,settlementDate:new Date().toISOString().split("T")[0],notes:""}),o(""))},[r,s,m]);const j=async w=>{try{o(""),await n(w),t()}catch(C){o(C instanceof Error?C.message:a("common.errorOccurred"))}},b=(w,C)=>w+C;if(!s)return null;const v=`${a("deposit.settlement.title")} - ${(s==null?void 0:s.bankName)||a("common.na")}`,P=e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:t,disabled:f,variant:"outlined",size:"medium",forceTextOnly:!0,mobileText:a("common.cancel"),desktopText:a("common.cancel"),children:a("common.cancel")}),e.jsx(We,{onClick:h(j),variant:"contained",color:"success",disabled:f||(y||0)<0,size:"medium",icon:f?void 0:e.jsx(Xe,{}),forceTextOnly:!0,mobileText:a(f?"deposit.settlement.processing":"deposit.settlement.confirmSettlement"),desktopText:a(f?"deposit.settlement.processing":"deposit.settlement.confirmSettlement"),children:a(f?"deposit.settlement.processing":"deposit.settlement.confirmSettlement")})]});return e.jsx(Rt,{open:r,onClose:t,title:v,icon:e.jsx(He,{sx:{fontSize:20}}),actions:P,maxWidth:"md",fullWidth:!0,titleColor:"success",size:"medium",children:e.jsxs("form",{onSubmit:h(j),children:[i&&e.jsx(je,{severity:"error",sx:{mb:3,borderRadius:1},children:i}),e.jsx(se,{sx:{mb:1,mt:1,border:0,boxShadow:0,background:"transparent"},children:e.jsx(me,{sx:{p:1.5},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,sx:{mb:2},children:a("deposit.settlement.depositInfo")}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Ue,{fontSize:"small",color:"primary"}),e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",sx:{fontSize:"0.875rem",color:"text.secondary"},children:a("deposit.settlement.bankName")})]}),e.jsx(c,{variant:"cardValue",color:"text.primary",sx:{ml:3,mb:1,color:"text.primary"},children:s.bankName||a("common.na")}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Zn,{fontSize:"small",color:"primary"}),e.jsx(c,{variant:"cardSubtitle",color:"text.primary",sx:{color:"text.primary"},children:s.termDescription||a("common.na")})]}),e.jsxs(c,{variant:"cardSubtitle",color:"text.secondary",sx:{ml:3,color:"text.secondary"},children:[Gt(s.startDate,"short")," - ",Gt(s.endDate,"short")]})]}),e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,sx:{mb:2},children:a("deposit.settlement.financialSummary")}),e.jsxs(W,{container:!0,spacing:1,children:[e.jsx(W,{item:!0,xs:6,children:e.jsxs(l,{textAlign:"center",sx:{p:.5,border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",sx:{mb:.5,color:"text.secondary"},children:a("deposit.settlement.principal")}),e.jsx(c,{variant:"cardValue",color:"primary",fontWeight:"bold",sx:{color:"primary.main"},children:G(Number(s.principal)||0)})]})}),e.jsx(W,{item:!0,xs:6,children:e.jsxs(l,{textAlign:"center",sx:{p:.5,border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",sx:{mb:.5,color:"text.secondary"},children:a("deposit.settlement.interestRate")}),e.jsx(c,{variant:"cardValue",color:"success.main",fontWeight:"bold",sx:{color:"success.main"},children:s.interestRate?`${s.interestRate}%`:a("common.na")})]})}),e.jsx(W,{item:!0,xs:6,children:e.jsxs(l,{textAlign:"center",sx:{p:.5,border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",sx:{mb:.5,color:"text.secondary"},children:a("deposit.settlement.accruedInterest")}),e.jsx(c,{variant:"cardValue",color:"info.main",fontWeight:"bold",sx:{color:"info.main"},children:G(Number(s.accruedInterest)||0)})]})}),e.jsx(W,{item:!0,xs:6,children:e.jsxs(l,{textAlign:"center",sx:{p:.5,border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",sx:{mb:.5,color:"text.secondary"},children:a("deposit.settlement.total")}),e.jsx(c,{variant:"cardValue",color:"text.primary",fontWeight:"bold",sx:{color:"text.primary"},children:G(Number(s.totalValue)||0)})]})})]})]})]})})}),e.jsx(bt,{sx:{mb:1}}),e.jsx(se,{sx:{mb:1,border:0,boxShadow:0,background:"transparent"},children:e.jsxs(me,{sx:{p:2},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,sx:{mb:2,fontSize:"1rem"},children:a("deposit.settlement.settlementDetails")}),e.jsxs(W,{container:!0,spacing:1.5,children:[e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(mn,{name:"settlementDate",control:u,render:({field:w})=>e.jsx(hr,{dateAdapter:Ar,children:e.jsx(ls,{label:a("deposit.settlement.settlementDate"),value:w.value?new Date(w.value):null,onChange:C=>{const k=C?C.toISOString().split("T")[0]:"";w.onChange(k)},slotProps:{textField:{fullWidth:!0,size:"medium",error:!!g.settlementDate,required:!0,sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}}})})})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(mn,{name:"actualInterest",control:u,render:({field:w})=>{var C;return e.jsx(vr,{value:w.value||0,onChange:k=>w.onChange(k),label:a("deposit.settlement.actualInterest"),placeholder:a("deposit.settlement.actualInterestPlaceholder"),helperText:(C=g.actualInterest)==null?void 0:C.message,error:!!g.actualInterest,currency:"VND",showCurrency:!0,align:"right",required:!0,disabled:f,size:"medium"})}})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(mn,{name:"notes",control:u,render:({field:w})=>{var C;return e.jsx(Ae,{...w,fullWidth:!0,label:a("deposit.settlement.notes"),multiline:!0,rows:2,error:!!g.notes,helperText:(C=g.notes)==null?void 0:C.message,size:"small",sx:{"& .MuiOutlinedInput-root":{borderRadius:1,minHeight:"54px"}}})}})})]})]})}),e.jsx(bt,{sx:{mb:1}}),e.jsx(se,{sx:{border:0,boxShadow:0,background:"transparent"},children:e.jsxs(me,{sx:{p:1.5},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,sx:{mb:2},children:a("deposit.settlement.totalReceived")}),e.jsxs(W,{container:!0,spacing:1,children:[e.jsx(W,{item:!0,xs:6,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,mb:1,p:1,border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsx(Ue,{sx:{color:"primary.main",fontSize:16}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardSubtitle",sx:{color:"text.secondary",fontSize:"0.75rem"},children:a("deposit.settlement.principal")}),e.jsx(c,{variant:"cardValue",sx:{color:"text.primary",fontWeight:"bold"},children:G(Number(s.principal)||0)})]})]})}),e.jsx(W,{item:!0,xs:6,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,mb:1,p:1,border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsx(He,{sx:{color:"primary.main",fontSize:16}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardSubtitle",sx:{color:"text.secondary",fontSize:"0.75rem"},children:a("deposit.settlement.interest")}),e.jsx(c,{variant:"cardValue",sx:{color:"text.primary",fontWeight:"bold"},children:G(Number(y)||0)})]})]})}),e.jsx(W,{item:!0,xs:12,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,p:1.5,border:"1px solid",borderColor:"success.main",borderRadius:1,bgcolor:"rgba(76, 175, 80, 0.1)"},children:[e.jsx(Xe,{sx:{color:"success.main",fontSize:20}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardSubtitle",sx:{color:"success.main",fontSize:"0.875rem"},children:a("deposit.settlement.totalReceived")}),e.jsx(c,{variant:"cardValueLarge",sx:{color:"success.main",fontWeight:"bold"},children:G(b(Number(s.principal)||0,Number(y)||0))})]})]})})]})]})})]})})},yx=({open:r,onClose:t,deposit:n,onSettle:s,onEdit:a})=>{const{t:i}=Ne(),{accountId:o}=Ge(),[d,u]=p.useState(null),[h,m]=p.useState(!1),[x,g]=p.useState(null);if(p.useEffect(()=>{const v=async()=>{if(!(!(n!=null&&n.portfolioId)||!o)){m(!0),g(null);try{const P=await q.getPortfolio(n.portfolioId,o);u(P)}catch(P){console.error("Error fetching portfolio:",P),g(i("deposit.details.portfolioLoadError"))}finally{m(!1)}}};r&&(n!=null&&n.portfolioId)&&v()},[r,n==null?void 0:n.portfolioId,o,i]),!n)return null;const f=v=>{switch(v){case"ACTIVE":return"success";case"SETTLED":return"primary";case"CANCELLED":return"error";default:return"default"}},y=v=>{switch(v){case"ACTIVE":return e.jsx(Zn,{});case"SETTLED":return e.jsx(Xe,{});case"CANCELLED":return e.jsx(Zn,{});default:return e.jsx(Zn,{})}},j=`${i("deposit.details.title")} - ${n.bankName||i("common.na")}`,b=e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:t,variant:"outlined",size:"medium",children:i("common.close")}),n.canBeEdited&&a&&e.jsx(he,{onClick:()=>a(n),variant:"contained",color:"primary",size:"medium",startIcon:e.jsx(Tt,{}),children:i("common.edit")}),n.canBeSettled&&s&&e.jsx(he,{onClick:()=>s(n),variant:"contained",color:"success",size:"medium",startIcon:e.jsx(ba,{}),children:i("deposit.depositActions.settle")})]});return e.jsxs(Rt,{open:r,onClose:t,title:j,icon:e.jsx(Ue,{sx:{fontSize:20}}),actions:b,maxWidth:"md",fullWidth:!0,titleColor:"primary",size:"medium",children:[e.jsxs(l,{sx:{mb:3,mt:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsx(ce,{icon:y(n.status||"ACTIVE"),label:n.status==="ACTIVE"?i("deposit.depositStatus.active"):n.status==="SETTLED"?i("deposit.depositStatus.settled"):i("deposit.depositStatus.cancelled"),color:f(n.status||"ACTIVE"),size:"medium"}),n.daysUntilMaturity!==void 0&&n.status==="ACTIVE"&&e.jsx(ce,{icon:e.jsx(up,{}),label:i("deposit.details.daysUntilMaturity",{days:n.daysUntilMaturity}),color:n.daysUntilMaturity<=30?"warning":"info",variant:"outlined"})]}),e.jsx(c,{variant:"cardTitle",color:"text.primary",children:n.termDescription||i("common.na")})]}),e.jsx(bt,{sx:{mb:1}}),e.jsx(se,{sx:{mb:1,border:0,boxShadow:0,background:"transparent"},children:e.jsxs(me,{sx:{p:2},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,sx:{mb:2},children:i("deposit.details.portfolioInfo")}),h?e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Ce,{size:16}),e.jsx(c,{variant:"body2",color:"text.secondary",children:i("deposit.details.loadingPortfolio")})]}):x?e.jsx(je,{severity:"warning",sx:{mb:0},children:x}):d?e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(qt,{color:"primary",sx:{fontSize:20}}),e.jsxs(c,{variant:"cardSubtitle",color:"text.secondary",children:[i("deposit.details.portfolioName"),":"]}),e.jsx(c,{variant:"cardSubtitle",fontWeight:"medium",children:d.name})]}):e.jsx(c,{variant:"body2",color:"text.secondary",children:i("deposit.details.noPortfolioData")})]})}),e.jsx(bt,{sx:{mb:1}}),e.jsx(se,{sx:{mb:1,border:0,boxShadow:0,background:"transparent"},children:e.jsxs(me,{sx:{p:2},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,sx:{mb:2},children:i("deposit.details.financialInfo")}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsxs(l,{textAlign:"center",children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",gutterBottom:!0,children:i("deposit.details.principal")}),e.jsx(c,{variant:"cardTitle",color:"primary",fontWeight:"bold",children:G(n.principal||0)})]})}),e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsxs(l,{textAlign:"center",children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",gutterBottom:!0,children:i("deposit.details.interestRate")}),e.jsx(c,{variant:"cardTitle",color:"success.main",fontWeight:"bold",children:n.interestRate?`${n.interestRate}%`:i("common.na")})]})}),e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsxs(l,{textAlign:"center",children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",gutterBottom:!0,children:i("deposit.details.accruedInterest")}),e.jsx(c,{variant:"cardTitle",color:"info.main",fontWeight:"bold",children:G(n.accruedInterest||0)})]})}),e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsxs(l,{textAlign:"center",children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",gutterBottom:!0,children:i("deposit.details.totalValue")}),e.jsx(c,{variant:"cardTitle",color:"text.primary",fontWeight:"bold",children:G(n.totalValue||0)})]})})]})]})}),e.jsx(bt,{sx:{mb:1}}),e.jsx(se,{sx:{mb:0,border:0,boxShadow:0,background:"transparent"},children:e.jsxs(me,{sx:{p:2},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,sx:{mb:2},children:i("deposit.details.timelineInfo")}),e.jsxs(ft,{spacing:2,children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Rr,{color:"primary",sx:{fontSize:20}}),e.jsxs(l,{flex:1,children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",children:i("deposit.details.startDate")}),e.jsx(c,{variant:"cardSubtitle",fontWeight:"medium",children:Gt(n.startDate,"short")})]})]}),e.jsx(bt,{}),e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Xe,{color:"success",sx:{fontSize:20}}),e.jsxs(l,{flex:1,children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",children:i("deposit.details.endDate")}),e.jsx(c,{variant:"cardSubtitle",fontWeight:"medium",children:Gt(n.endDate,"short")})]})]}),n.settledAt&&e.jsxs(e.Fragment,{children:[e.jsx(bt,{}),e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Xe,{color:"success",sx:{fontSize:20}}),e.jsxs(l,{flex:1,children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",children:i("deposit.details.settlementDate")}),e.jsx(c,{variant:"cardSubtitle",fontWeight:"medium",children:Gt(n.settledAt,"short")})]})]})]})]})]})}),n.notes&&e.jsx(se,{sx:{border:"1px solid",borderColor:"divider"},children:e.jsxs(me,{sx:{p:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(hp,{color:"primary",sx:{fontSize:20}}),e.jsx(c,{variant:"cardTitle",children:i("deposit.details.notes")})]}),e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",children:n.notes})]})})]})},is=()=>{setTimeout(()=>{const r=document.querySelector('[data-scrollable-container="true"]');r?r.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},100)},Tk=()=>{const{pathname:r}=Pa();return p.useEffect(()=>{is()},[r]),null},Ck=()=>{var Q;const{t:r}=Ne(),t=Je(),[n,s]=p.useState(0),[a,i]=p.useState(!1),[o,d]=p.useState(!1),[u,h]=p.useState(!1),[m,x]=p.useState(null),[g,f]=p.useState(null),[y,j]=p.useState("ALL"),[b,v]=p.useState(""),[P,w]=p.useState("ALL"),[C,k]=p.useState(!1),A=Kt(),{accountId:L}=Ge(),{data:T=[]}=yt(["portfolios",L],()=>q.getPortfolios(L),{enabled:!!L}),{data:M,isLoading:O,error:I}=yt(["deposits",{searchTerm:b,statusFilter:P,portfolioId:y}],()=>{const Z=new URLSearchParams;return b&&Z.append("bankName",b),P!=="ALL"&&Z.append("status",P),y!=="ALL"&&Z.append("portfolioId",y),q.getDeposits(L,{portfolioId:y})},{enabled:!!L}),z=Array.isArray(M)?M:Array.isArray(M==null?void 0:M.data)?M.data:[],{data:N}=yt(["deposit-analytics",{portfolioId:y}],()=>{const Z=new URLSearchParams;return y!=="ALL"&&Z.append("portfolioId",y),q.getDepositAnalytics(L,{portfolioId:y})},{enabled:!!L}),E=jt(Z=>q.createDeposit(Z),{onSuccess:()=>{A.invalidateQueries(["deposits"]),A.invalidateQueries(["deposit-analytics-global"]),wt.success(r("deposit.createSuccess")),i(!1)},onError:Z=>{var J,ae;wt.error(((ae=(J=Z.response)==null?void 0:J.data)==null?void 0:ae.message)||r("deposit.createError"))}}),R=jt(({id:Z,data:J})=>q.updateDeposit(Z,J),{onSuccess:()=>{A.invalidateQueries(["deposits"]),A.invalidateQueries(["deposit-analytics-global"]),wt.success(r("deposit.updateSuccess")),i(!1),f(null)},onError:Z=>{var J,ae;wt.error(((ae=(J=Z.response)==null?void 0:J.data)==null?void 0:ae.message)||r("deposit.updateError"))}}),V=jt(({id:Z,data:J})=>q.settleDeposit(Z,J),{onSuccess:()=>{A.invalidateQueries(["deposits"]),A.invalidateQueries(["deposit-analytics-global"]),wt.success(r("deposit.settleSuccess")),d(!1),x(null)},onError:Z=>{var J,ae;wt.error(((ae=(J=Z.response)==null?void 0:J.data)==null?void 0:ae.message)||r("deposit.settleError"))}}),F=jt(Z=>q.deleteDeposit(Z),{onSuccess:()=>{A.invalidateQueries(["deposits"]),A.invalidateQueries(["deposit-analytics-global"]),wt.success(r("deposit.deleteSuccess"))},onError:Z=>{var J,ae;wt.error(((ae=(J=Z.response)==null?void 0:J.data)==null?void 0:ae.message)||r("deposit.deleteError"))}}),B=Z=>{E.mutate(Z)},$=Z=>{g&&R.mutate({id:g.depositId,data:Z})},Y=Z=>{m&&V.mutate({id:m.depositId,data:Z})},_=Z=>{F.mutate(Z.depositId||"")},K=Z=>{f(Z),i(!0)},X=Z=>{x(Z),d(!0)},ne=Z=>{x(Z),h(!0)},oe=z.filter(Z=>Z.status==="ACTIVE"),ee=z.filter(Z=>Z.status==="SETTLED"),H=z.filter(Z=>Z.isMatured&&Z.status==="ACTIVE");return I?e.jsx(l,{sx:{mt:2},children:e.jsx(je,{severity:"error",children:r("deposit.loadError")})}):e.jsxs(l,{sx:{mt:2},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:3,children:[e.jsx(l,{sx:{flex:1},children:e.jsx(c,{variant:"pageHeader",sx:{background:`linear-gradient(135deg, ${t.palette.primary.main} 0%, ${t.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1,filter:"none"},children:r("deposit.management")})}),e.jsxs(l,{display:"flex",gap:2,sx:{ml:2},children:[e.jsx(he,{variant:"outlined",icon:e.jsx(Ir,{}),onClick:()=>k(!C),mobileText:r("deposit.filters"),desktopText:r("deposit.filters"),color:C?"primary":"inherit",children:r("deposit.filters")}),e.jsx(he,{variant:"outlined",icon:e.jsx(Mt,{}),onClick:()=>{A.invalidateQueries(["deposits"]),A.invalidateQueries(["deposit-analytics"])},mobileText:r("deposit.refresh"),desktopText:r("deposit.refresh"),children:r("deposit.refresh")}),e.jsx(he,{variant:"contained",icon:e.jsx(xt,{}),onClick:()=>i(!0),disabled:E.isLoading||y==="ALL",mobileText:r("deposit.createNew"),desktopText:r("deposit.createNewDeposit"),children:r("deposit.createNewDeposit")})]})]}),C&&e.jsx(Te,{sx:{p:2,mb:3},children:e.jsxs(W,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Ae,{fullWidth:!0,label:r("deposit.searchByBank"),value:b,onChange:Z=>v(Z.target.value),InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx($n,{})})}})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Ae,{fullWidth:!0,select:!0,label:r("deposit.status"),value:P,onChange:Z=>w(Z.target.value),children:[e.jsx(re,{value:"ALL",children:r("deposit.all")}),e.jsx(re,{value:"ACTIVE",children:r("deposit.active")}),e.jsx(re,{value:"SETTLED",children:r("deposit.settled")})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Ae,{fullWidth:!0,select:!0,label:"Portfolio",value:y,onChange:Z=>j(Z.target.value),children:[e.jsx(re,{value:"ALL",children:r("deposit.allPortfolios")}),T.map(Z=>e.jsx(re,{value:Z.portfolioId,children:Z.name},Z.portfolioId))]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(he,{fullWidth:!0,variant:"outlined",icon:e.jsx(Ir,{}),onClick:()=>{v(""),w("ALL")},mobileText:r("deposit.clearFilters"),desktopText:r("deposit.clearFilters"),children:r("deposit.clearFilters")})})]})}),N&&e.jsxs(W,{container:!0,spacing:2,mb:3,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,sx:{display:{xs:"none",sm:"block"}},children:e.jsx(se,{sx:{height:"100%"},children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(Ue,{color:"primary"}),e.jsx(c,{variant:"cardTitle",children:r("deposit.overview")})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"formHelper",children:[r("deposit.totalDeposits"),":"]}),e.jsx(c,{variant:"tableCell",children:(N==null?void 0:N.totalDeposits)||0})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"formHelper",children:[r("deposit.activeDeposits"),":"]}),e.jsx(c,{variant:"tableCell",sx:{color:"info.main"},children:(N==null?void 0:N.activeDeposits)||0})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",children:[e.jsxs(c,{variant:"formHelper",children:[r("deposit.settledDeposits"),":"]}),e.jsx(c,{variant:"tableCell",sx:{color:"warning.main"},children:(N==null?void 0:N.settledDeposits)||0})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%"},children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(He,{color:"success"}),e.jsx(c,{variant:"cardTitle",children:r("deposit.totalValue")})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"formHelper",children:[r("deposit.totalValue"),":"]}),e.jsx(c,{variant:"cardValue",sx:{color:"success.main"},children:G(N==null?void 0:N.totalValue)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"formHelper",children:[r("deposit.totalPrincipal"),":"]}),e.jsx(c,{variant:"tableCell",children:G((N==null?void 0:N.totalPrincipal)||0)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",children:[e.jsxs(c,{variant:"formHelper",children:[r("deposit.averageInterestRate"),":"]}),e.jsx(c,{variant:"tableCell",sx:{color:"secondary.main"},children:N!=null&&N.averageInterestRate?`${ye(N.averageInterestRate)}`:"N/A"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%"},children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(Xe,{color:"success"}),e.jsx(c,{variant:"cardTitle",children:r("deposit.settledInterest")})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"formHelper",children:[r("deposit.settledInterest"),":"]}),e.jsx(c,{variant:"cardValue",sx:{color:"success.main"},children:G((N==null?void 0:N.totalSettledInterest)||0)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"formHelper",children:[r("common.quantity"),":"]}),e.jsxs(c,{variant:"tableCell",sx:{color:"warning.main"},children:[(N==null?void 0:N.settledDeposits)||0," deposits"]})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",children:[e.jsxs(c,{variant:"formHelper",children:[r("deposit.average"),":"]}),e.jsx(c,{variant:"tableCell",children:N!=null&&N.settledDeposits?G(((N==null?void 0:N.totalSettledInterest)||0)/N.settledDeposits):"N/A"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%"},children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(He,{color:"primary"}),e.jsx(c,{variant:"cardTitle",children:r("deposit.accruedInterest")})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"formHelper",children:[r("deposit.accruedInterest"),":"]}),e.jsx(c,{variant:"cardValue",sx:{color:"primary.main"},children:G((N==null?void 0:N.totalAccruedInterest)||0)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"formHelper",children:[r("common.quantity"),":"]}),e.jsxs(c,{variant:"tableCell",sx:{color:"info.main"},children:[(N==null?void 0:N.activeDeposits)||0," deposits"]})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",children:[e.jsxs(c,{variant:"formHelper",children:[r("deposit.average"),":"]}),e.jsx(c,{variant:"tableCell",children:N!=null&&N.activeDeposits?G(((N==null?void 0:N.totalAccruedInterest)||0)/N.activeDeposits):"N/A"})]})]})})})]}),e.jsx(Te,{sx:{mb:2},children:e.jsxs(Tr,{value:n,onChange:(Z,J)=>{s(J),is()},sx:{px:2},children:[e.jsx(ht,{label:`${r("deposit.all")} (${z.length})`}),e.jsx(ht,{label:`${r("deposit.active")} (${oe.length})`}),e.jsx(ht,{label:`${r("deposit.settled")} (${ee.length})`}),e.jsx(ht,{label:`${r("deposit.matured")} (${H.length})`})]})}),O?e.jsx(l,{display:"flex",justifyContent:"center",p:4,children:e.jsx(Ce,{})}):e.jsx(gx,{deposits:n===0?z:n===1?oe:n===2?ee:H,onEdit:K,onSettle:X,onDelete:_,onViewDetails:ne}),e.jsx(Qc,{open:a,onClose:()=>{i(!1),f(null)},onSubmit:g?$:B,portfolioId:y!=="ALL"?y:((Q=T[0])==null?void 0:Q.portfolioId)||"",initialData:g?{portfolioId:g.portfolioId,bankName:g.bankName,accountNumber:g.accountNumber,principal:g.principal,interestRate:g.interestRate,startDate:g.startDate,endDate:g.endDate,termMonths:g.termMonths,notes:g.notes}:void 0,isEdit:!!g}),e.jsx(fx,{open:o,onClose:()=>{d(!1),x(null)},onSubmit:Y,deposit:m}),e.jsx(yx,{open:u,onClose:()=>{h(!1),x(null)},deposit:m,onSettle:X})]})},Tu=()=>{var ae,ue;const{t:r}=Ne(),t=An(),n=Pa(),s=Je(),a=Nt(s.breakpoints.down("sm")),[i,o]=p.useState(!1),[d,u]=p.useState(null),[h,m]=p.useState(""),[x,g]=p.useState(!1),[f,y]=p.useState(!1),[j,b]=p.useState(null),[v,P]=p.useState(0),{accountId:w,isReadOnly:C}=Ge(),{userRoles:k}=Zr(),A=k.some(le=>le.roleName==="super_admin"),L=C&&!A,{portfolios:T,createPortfolio:M,updatePortfolio:O,deletePortfolio:I,refetch:z,isCreating:N,isUpdating:E,isDeleting:R,isLoading:V}=Un(w);p.useEffect(()=>{n.pathname==="/portfolios/new"&&(u(null),m(""),o(!0),t("/portfolios",{replace:!0}))},[n.pathname,t]),p.useEffect(()=>{new URLSearchParams(n.search).get("tab")==="templates"&&T.length===0&&!V&&g(!0)},[n.search,T.length,V]);const F=le=>{t(`/portfolios/${le}`)},B=le=>{u(le),o(!0)},$=()=>{u(null),m(""),o(!0)},Y=()=>{o(!1),u(null),m("")},_=async le=>{var pe,Me;try{await I(le),m("")}catch(Le){console.error("Failed to delete portfolio:",Le),m(((Me=(pe=Le.response)==null?void 0:pe.data)==null?void 0:Me.message)||r("portfolio.error.deleteFailed"))}},K=async le=>{var pe,Me;try{m(""),d?await O({id:d,data:le}):await M(le),Y()}catch(Le){if(console.error("Portfolio form error:",Le),(Me=(pe=Le.response)==null?void 0:pe.data)!=null&&Me.message){const qe=Le.response.data.message;qe.includes("already exists for this account")?m(r("portfolio.error.nameAlreadyExists",{name:le.name})):m(qe)}else m(r("portfolio.error.saveFailed"))}},X=async(le,pe)=>{var Me,Le;try{m(""),await q.copyFromPublicPortfolio({sourcePortfolioId:le,targetAccountId:w,name:pe}),await z(),Y()}catch(qe){if(console.error("Copy from public error:",qe),(Le=(Me=qe.response)==null?void 0:Me.data)!=null&&Le.message){const de=qe.response.data.message;de.includes("already exists for this account")?m(r("portfolio.error.nameAlreadyExists",{name:pe})):m(de)}else m(r("portfolio.error.copyTemplateFailed"))}},ne=async le=>{var pe,Me;try{m("");const Le=`${le.templateName||le.name} (Copy)`;await q.copyFromPublicPortfolio({sourcePortfolioId:le.portfolioId,targetAccountId:w,name:Le}),await z(),g(!1)}catch(Le){if(console.error("Select public template error:",Le),(Me=(pe=Le.response)==null?void 0:pe.data)!=null&&Me.message){const qe=Le.response.data.message;qe.includes("already exists for this account")?m(r("portfolio.error.templateNameAlreadyExists",{name:`${le.templateName||le.name} (Copy)`})):m(qe)}else m(r("portfolio.error.copyTemplateFailed"))}},oe=()=>{g(!1)},ee=le=>{b(le),y(!0)},H=()=>{y(!1),b(null)},Q=(le,pe)=>{P(pe),is()},Z=async()=>{try{await z()}catch(le){console.error("Failed to refresh portfolios:",le)}},J=()=>{if(!d)return;const le=T.find(pe=>pe.portfolioId===d);if(le)return{name:le.name,baseCurrency:le.baseCurrency,fundingSource:le.fundingSource||"",accountId:le.accountId,visibility:le.visibility,templateName:le.templateName,description:le.description}};return e.jsxs(xn,{maxWidth:"xl",children:[e.jsx(Te,{sx:{position:"sticky",top:{xs:-18,sm:-25},zIndex:1200,mb:3,boxShadow:"0 4px 12px rgba(0,0,0,0.1)",backdropFilter:"blur(10px)",backgroundColor:"rgba(255, 255, 255, 0.95)"},children:e.jsxs(Tr,{value:v,onChange:Q,variant:"fullWidth",sx:{borderBottom:1,borderColor:"divider"},children:[e.jsx(ht,{icon:a?void 0:e.jsx(Ue,{}),label:r("navigation.fundManagement.portfolios"),iconPosition:a?void 0:"start"}),e.jsx(ht,{icon:a?void 0:e.jsx(yc,{}),label:r("navigation.fundManagement.assets"),iconPosition:a?void 0:"start"}),e.jsx(ht,{icon:a?void 0:e.jsx(qt,{}),label:r("navigation.fundManagement.deposits"),iconPosition:a?void 0:"start"})]})}),v===0&&e.jsx(l,{children:e.jsx(tk,{onViewPortfolio:F,onEditPortfolio:B,onDeletePortfolio:_,onCreatePortfolio:$,onManagePermissions:ee,onRefresh:Z,isReadOnly:L})}),v===1&&e.jsx(Sk,{}),v===2&&e.jsx(Ck,{}),e.jsx(lx,{open:i,onClose:Y,onSubmit:K,onCopyFromPublic:X,initialData:J(),isEditing:!!d,isLoading:N||E,error:h}),e.jsx(ox,{open:x,onClose:oe,onSelect:ne}),e.jsx(Xc,{open:f,onClose:H,portfolioId:j||"",portfolioName:j&&((ae=T.find(le=>le.portfolioId===j))==null?void 0:ae.name)||"",creatorAccountId:j&&((ue=T.find(le=>le.portfolioId===j))==null?void 0:ue.accountId)||"",onPermissionUpdated:()=>{z()}}),(N||E||R)&&e.jsx(je,{severity:"info",sx:{mt:2},children:e.jsxs(c,{variant:"formHelper",children:[N&&r("portfolio.creating"),E&&r("portfolio.updating"),R&&r("portfolio.deleting")]})})]})};class kk{async getSnapshots(t,n){const s=new URLSearchParams;return n&&s.append("accountId",n),t&&Object.entries(t).forEach(([a,i])=>{i!=null&&s.append(a,i.toString())}),await q.getSnapshots(t,n)}async getSnapshotsPaginated(t,n){const s=new URLSearchParams;return n&&s.append("accountId",n),t&&Object.entries(t).forEach(([a,i])=>{i!=null&&s.append(a,i.toString())}),await q.getSnapshotsPaginated(t,n)}async getPortfolioSnapshotsPaginated(t,n){const s=new URLSearchParams;return s.append("portfolioId",t),n!=null&&n.page&&s.append("page",n.page.toString()),n!=null&&n.limit&&s.append("limit",n.limit.toString()),n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),n!=null&&n.granularity&&s.append("granularity",n.granularity),(n==null?void 0:n.isActive)!==void 0&&s.append("isActive",n.isActive.toString()),n!=null&&n.orderBy&&s.append("orderBy",n.orderBy),n!=null&&n.orderDirection&&s.append("orderDirection",n.orderDirection),await q.getPortfolioSnapshotsPaginated(t,n)}async getSnapshotById(t){return await q.getSnapshotById(t)}async createSnapshot(t){return await q.createSnapshot(t)}async createPortfolioSnapshots(t,n={}){return await q.createPortfolioSnapshots(t,n)}async createBulkPortfolioSnapshots(t,n={}){return await q.createBulkPortfolioSnapshots(t,n)}async updateSnapshot(t,n){return await q.updateSnapshot(t,n)}async recalculateSnapshot(t){return await q.recalculateSnapshot(t)}async bulkRecalculateSnapshots(t,n,s){return await q.bulkRecalculateSnapshots(t,n,s)}async getBulkRecalculateStatus(t,n){return await q.getBulkRecalculateStatus(t,n)}async deleteSnapshot(t){await q.deleteSnapshot(t)}async hardDeleteSnapshot(t){await q.hardDeleteSnapshot(t)}async getTimelineData(t){return await q.getSnapshotTimeline(t)}async getAggregatedTimelineData(t,n,s,a){return await q.getAggregatedTimelineData(t,n,s,a)}async getLatestSnapshot(t,n,s){return await q.getLatestSnapshot(t,n,s)}async getSnapshotStatistics(t){return await q.getSnapshotStatistics(t)}async cleanupOldSnapshots(t){return await q.cleanupOldSnapshots(t)}async deleteSnapshotsByDateRange(t,n,s,a){const i=new URLSearchParams;return i.append("startDate",n),i.append("endDate",s),a&&i.append("granularity",a),await q.deleteSnapshotsByDateRange(t,n,s,a)}async deleteSnapshotsByDate(t,n,s){const a=new URLSearchParams;return a.append("snapshotDate",n),s&&a.append("granularity",s),await q.deleteSnapshotsByDate(t,n,s)}async deleteSnapshotsByGranularity(t,n){return await q.deleteSnapshotsByGranularity(t,n)}async getPortfoliosWithSnapshots(t){return await q.getPortfoliosWithSnapshots(t)}async createPerformanceSnapshots(t){return await q.createPerformanceSnapshots(t)}async getPortfolioPerformanceSnapshots(t,n){const s=new URLSearchParams;return n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),n!=null&&n.granularity&&s.append("granularity",n.granularity),await q.getPortfolioPerformanceSnapshots(t,n)}async getPortfolioPerformanceSnapshotsPaginated(t,n){const s=new URLSearchParams;return n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),n!=null&&n.granularity&&s.append("granularity",n.granularity),n!=null&&n.page&&s.append("page",n.page.toString()),n!=null&&n.limit&&s.append("limit",n.limit.toString()),await q.getPortfolioPerformanceSnapshots(t,n)}async getAssetPerformanceSnapshots(t,n){const s=new URLSearchParams;return n!=null&&n.assetId&&s.append("assetId",n.assetId),n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),n!=null&&n.granularity&&s.append("granularity",n.granularity),await q.getAssetPerformanceSnapshots(t,n)}async getAssetPerformanceSnapshotsPaginated(t,n){const s=new URLSearchParams;return n!=null&&n.assetId&&s.append("assetId",n.assetId),n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),n!=null&&n.granularity&&s.append("granularity",n.granularity),n!=null&&n.page&&s.append("page",n.page.toString()),n!=null&&n.limit&&s.append("limit",n.limit.toString()),await q.getAssetPerformanceSnapshots(t,n)}async getAssetGroupPerformanceSnapshots(t,n){return await q.getAssetGroupPerformanceSnapshots(t,n)}async getAssetGroupPerformanceSnapshotsPaginated(t,n){return await q.getAssetGroupPerformanceSnapshots(t,n)}async getPortfolioPerformanceSummary(t,n="1Y"){return new URLSearchParams().append("period",n),await q.getPortfolioPerformanceSummary(t,n)}async getAssetPerformanceSummary(t,n){const s=new URLSearchParams;return n!=null&&n.assetId&&s.append("assetId",n.assetId),n!=null&&n.period&&s.append("period",n.period),await q.getAssetPerformanceSummary(t,n)}async getAssetGroupPerformanceSummary(t,n){return await q.getAssetGroupPerformanceSummary(t,n)}async deletePerformanceSnapshotsByDateRange(t,n,s,a){const i=new URLSearchParams;return i.append("startDate",n),i.append("endDate",s),a&&i.append("granularity",a),await q.deletePerformanceSnapshotsByDateRange(t,n,s,a)}async exportPerformanceSnapshots(t,n){const s=new URLSearchParams;return n!=null&&n.startDate&&s.append("startDate",n.startDate),n!=null&&n.endDate&&s.append("endDate",n.endDate),n!=null&&n.granularity&&s.append("granularity",n.granularity),await q.exportPerformanceSnapshots(t,n)}async getPerformanceDashboardData(t){return await q.getPerformanceDashboardData(t)}async getPerformanceComparison(t,n,s="1Y"){const a=new URLSearchParams;return a.append("benchmarkId",n),a.append("period",s),await q.getPerformanceComparison(t,n,s)}async getRiskAnalysis(t,n="1Y"){return new URLSearchParams().append("period",n),await q.getRiskAnalysis(t,n)}async getPerformanceAttribution(t,n="1Y"){return new URLSearchParams().append("period",n),await q.getPerformanceAttribution(t,n)}async getPerformanceTrends(t,n,s="1Y"){const a=new URLSearchParams;return a.append("metric",n),a.append("period",s),await q.getPerformanceTrends(t,n,s)}async getBenchmarkData(t,n,s){const a=new URLSearchParams;return n&&a.append("startDate",n),s&&a.append("endDate",s),await q.getBenchmarkData(t,n,s)}async getAvailableBenchmarks(){return await q.getAvailableBenchmarks()}async getPerformanceAlerts(t){return await q.getPerformanceAlerts(t)}async createPerformanceAlert(t,n){return await q.createPerformanceAlert(t,n)}async updatePerformanceAlert(t,n,s){return await q.updatePerformanceAlert(t,n,s)}async deletePerformanceAlert(t,n){return await q.deletePerformanceAlert(t,n)}async getAllSnapshotsForPortfolio(t,n,s,a){const[i,o,d,u]=await Promise.all([this.getSnapshots({portfolioId:t,startDate:n,endDate:s,granularity:a}),this.getPortfolioPerformanceSnapshots(t,{startDate:n,endDate:s,granularity:a}),this.getAssetPerformanceSnapshots(t,{startDate:n,endDate:s,granularity:a}),this.getAssetGroupPerformanceSnapshots(t,{startDate:n,endDate:s,granularity:a})]);return{basicSnapshots:i,performanceSnapshots:o,assetSnapshots:d,groupSnapshots:u}}async createAllSnapshotsForPortfolio(t,n,s="DAILY",a){const[i,o]=await Promise.all([this.createPortfolioSnapshots(t,{startDate:n,granularity:s,createdBy:a}),this.createPerformanceSnapshots({portfolioId:t,snapshotDate:n,granularity:s,createdBy:a})]);return{basicSnapshots:i.assetSnapshots,performanceSnapshots:o}}async deleteAllSnapshotsByDateRange(t,n,s,a){const[i,o]=await Promise.all([this.deleteSnapshotsByDateRange(t,n,s,a),this.deletePerformanceSnapshotsByDateRange(t,n,s,a)]);return{basicDeleted:i,performanceDeleted:o}}async getComprehensivePortfolioAnalysis(t,n="1Y"){const[s,a,i,o,d,u]=await Promise.all([this.getSnapshotStatistics(t),this.getPortfolioPerformanceSummary(t,n),this.getAssetPerformanceSummary(t,{period:n}),this.getAssetGroupPerformanceSummary(t,{period:n}),this.getRiskAnalysis(t,n),this.getPerformanceTrends(t,"twr",n)]);return{basicStatistics:s,performanceSummary:a,assetSummary:i,groupSummary:o,riskAnalysis:d,performanceTrends:u}}}const yn=new kk,Pk=async(r,t)=>await r.invalidateQueries({predicate:s=>s.queryKey.includes(t)}),Dk=async(r,t)=>{r.getQueryCache().findAll({predicate:s=>s.queryKey.includes(t)}).forEach(s=>{r.removeQueries(s.queryKey)}),await r.invalidateQueries()},uc={card:{border:"1px solid #edeaea",borderRadius:"32px"},section:{border:"1px solid #e3f2fd",borderRadius:"16px"},input:{border:"1px solid #bdbdbd",borderRadius:"4px"},button:{border:"1px solid #1976d2",borderRadius:"6px"},alert:{border:"1px solid #ffcdd2",borderRadius:"4px"},chart:{borderRadius:"24px"},table:{border:"1px solid #edeaea",borderRadius:"4px"},hover:{"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}}},kr=(r,t)=>({...uc[r],...t}),Pr=(r,t)=>({...uc[r],...uc.hover,...t});Pr("card"),Pr("section"),Pr("chart"),Pr("table"),Pr("alert"),Pr("button");const Ak=({navValue:r,baseCurrency:t,isFund:n=!1,totalOutstandingUnits:s=1,navPerUnit:a,isCompactMode:i=!1,getUltraSpacing:o=u=>u,portfolioId:d})=>{const{t:u}=Ne(),{accountId:h}=Ge(),[,m]=p.useState([]),[x,g]=p.useState(null),[f,y]=p.useState(null),j=a||(s>0?r/s:r),b=r>0,v=u(b?"navSummary.growth":"navSummary.decline"),P=b?"success":"error";p.useEffect(()=>{(async()=>{if(!(!d||!h))try{const $=await q.getPortfolioNAVHistory(d,h,{months:1,granularity:"DAILY"});m($.data||[]),g($.portfolio||null),y($.summary||null)}catch($){console.error("Error fetching NAV history:",$)}})()},[d,h]);const w=(x==null?void 0:x.isFund)||n,C=f==null?void 0:f.growth,k=(x==null?void 0:x.totalOutstandingUnits)||0,A=(C==null?void 0:C.dailyGrowth)||0,L=(C==null?void 0:C.dailyGrowthValue)||0,T=(C==null?void 0:C.ytdGrowth)||0,M=(C==null?void 0:C.ytdGrowthValue)||0,O=(C==null?void 0:C.isDailyGrowing)||!1,I=(C==null?void 0:C.isYtdGrowing)||!1,z=(C==null?void 0:C.navPerUnitDailyGrowth)||0,N=((C==null?void 0:C.navPerUnitDailyGrowthValue)||0)*(k||0)||0,E=(C==null?void 0:C.navPerUnitYtdGrowth)||0,R=((C==null?void 0:C.navPerUnitYtdGrowthValue)||0)*(k||0)||0,V=(C==null?void 0:C.isNavPerUnitDailyGrowing)||!1,F=(C==null?void 0:C.isNavPerUnitYtdGrowing)||!1;return e.jsx(se,{sx:{mb:o(3,1),background:"linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%)",...Pr("card",{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.08)",transition:"all 0.3s ease-in-out","&:hover":{boxShadow:"0 4px 16px rgba(0, 0, 0, 0.12)",transform:"translateY(-2px)"}})},children:e.jsxs(me,{sx:{p:{xs:.5,sm:1,md:o(1,1.5)}},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:o(3,1.5),pb:o(2,1),borderBottom:"2px solid #f1f3f4"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:i?1:1.5},children:[e.jsx(l,{sx:{p:{xs:.5,sm:i?1:1.5},backgroundColor:"primary.main",borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ue,{sx:{fontSize:i?18:20,color:"white"}})}),e.jsxs(l,{children:[e.jsx(c,{variant:"pageTitle",sx:{fontWeight:700,color:"text.primary",mb:i?.25:.5},children:u("navSummary.title")}),!i&&e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:u("navSummary.subtitle")})]})]})}),e.jsxs(W,{container:!0,spacing:o(2,1),children:[e.jsx(W,{item:!0,xs:12,sm:w?6:12,md:w?4:6,children:e.jsxs(l,{sx:{p:o(2.5,1.5),backgroundColor:"linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%)",textAlign:"center",position:"relative",overflow:"hidden",...kr("section",{"&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:i?"3px":"4px",background:"linear-gradient(90deg, #1976d2 0%, #42a5f5 100%)"}})},children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:600,textTransform:"uppercase",letterSpacing:i?.5:1,color:"#6c757d"},children:u("navSummary.navTotal")}),e.jsx(c,{variant:"cardValueLarge",sx:{fontWeight:800,color:"primary.main",mt:i?.5:1,mb:i?.25:.5},children:G(r,t)}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:500,backgroundColor:P==="success"?"rgba(76, 175, 80, 0.1)":"rgba(244, 67, 54, 0.1)",color:P==="success"?"#4caf50":"#f44336",px:i?1:1.5,py:i?.25:.5,borderRadius:1,display:"inline-block"},children:v})]})}),!w&&e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{p:o(2,1.5),backgroundColor:"linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%)",textAlign:"center",position:"relative",overflow:"hidden",...kr("section",{"&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:i?"3px":"4px",background:"linear-gradient(90deg, #1976d2 0%, #42a5f5 100%)"}})},children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:600,textTransform:"uppercase",letterSpacing:i?.5:1,color:"#6c757d",mb:i?.75:1,display:"block"},children:u("navSummary.navGrowth")}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:i?.75:2},children:[e.jsxs(l,{sx:{flex:1,textAlign:"center",p:.5,backgroundColor:O?"rgba(76, 175, 80, 0.05)":A<0?"rgba(244, 67, 54, 0.05)":"rgba(158, 158, 158, 0.05)",borderRadius:1},children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:500,mb:i?.25:.5},children:u("navSummary.recent")}),e.jsxs(c,{variant:"cardValue",sx:{fontWeight:700,color:O?"#4caf50":A<0?"#f44336":"#9e9e9e",mb:i?.25:.5},children:[A>0?"+":"",A.toFixed(2),"%"]}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:500,color:O?"#4caf50":A<0?"#f44336":"#9e9e9e"},children:G(L,t)})]}),e.jsx(l,{sx:{width:"1px",height:i?30:35,backgroundColor:"#e0e0e0"}}),e.jsxs(l,{sx:{flex:1,textAlign:"center",p:.5,backgroundColor:I?"rgba(76, 175, 80, 0.05)":T<0?"rgba(244, 67, 54, 0.05)":"rgba(158, 158, 158, 0.05)",borderRadius:1},children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:500,mb:i?.25:.5},children:u("navSummary.fromStart")}),e.jsxs(c,{variant:"cardValue",sx:{fontWeight:700,color:I?"#4caf50":T<0?"#f44336":"#9e9e9e",mb:i?.25:.5},children:[T>0?"+":"",T.toFixed(2),"%"]}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:500,color:I?"#4caf50":T<0?"#f44336":"#9e9e9e"},children:G(M,t)})]})]})]})}),w&&e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(l,{sx:{p:o(2.5,1.5),backgroundColor:"linear-gradient(135deg, #fff3e0 0%, #ffffff 100%)",textAlign:"center",position:"relative",overflow:"hidden",...kr("card",{"&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:i?"3px":"4px",background:"linear-gradient(90deg, #ff9800 0%, #ffb74d 100%)"}})},children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:600,textTransform:"uppercase",letterSpacing:i?.5:1,color:"#6c757d"},children:u("navSummary.navPerUnit")}),e.jsx(c,{variant:"cardValueLarge",sx:{fontWeight:800,color:"#ff9800",mt:i?.5:1,mb:i?.25:.5},children:G((f==null?void 0:f.navPerUnit)||j,t)}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:500,backgroundColor:"rgba(255, 152, 0, 0.1)",color:"#ff9800",px:i?1:1.5,py:i?.25:.5,borderRadius:1,display:"inline-block"},children:u("navSummary.investorBenefit")}),e.jsx(Fe,{title:u("navSummary.navPerUnitTooltip"),arrow:!0,placement:"top",children:e.jsx(Ie,{size:"small",sx:{position:"absolute",top:i?4:8,right:i?4:8,p:.5,backgroundColor:"rgba(255, 255, 255, 0.8)","&:hover":{backgroundColor:"rgba(255, 255, 255, 1)"}},children:e.jsx(qu,{sx:{fontSize:i?12:14,color:"#ff9800"}})})})]})}),w&&f&&e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(l,{sx:{p:o(2,1.5),backgroundColor:"linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%)",textAlign:"center",position:"relative",overflow:"hidden",...kr("section",{"&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:i?"3px":"4px",background:"linear-gradient(90deg, #1976d2 0%, #42a5f5 100%)"}})},children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:600,textTransform:"uppercase",letterSpacing:i?.5:1,color:"#6c757d",mb:i?.75:1,display:"block"},children:u("navSummary.navPerUnitGrowth")}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:i?.75:2},children:[e.jsxs(l,{sx:{flex:1,textAlign:"center",p:.5,backgroundColor:V?"rgba(76, 175, 80, 0.05)":z<0?"rgba(244, 67, 54, 0.05)":"rgba(158, 158, 158, 0.05)",borderRadius:1},children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:500,mb:i?.25:.5},children:u("navSummary.recent")}),e.jsxs(c,{variant:"cardValue",sx:{fontWeight:700,color:V?"#4caf50":z<0?"#f44336":"#9e9e9e",mb:i?.25:.5},children:[z>0?"+":"",z.toFixed(2),"%"]}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:500,color:V?"#4caf50":z<0?"#f44336":"#9e9e9e"},children:G(N,t)})]}),e.jsx(l,{sx:{width:"1px",height:i?30:35,backgroundColor:"#e0e0e0"}}),e.jsxs(l,{sx:{flex:1,textAlign:"center",p:.5,backgroundColor:F?"rgba(76, 175, 80, 0.05)":E<0?"rgba(244, 67, 54, 0.05)":"rgba(158, 158, 158, 0.05)",borderRadius:1},children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:500,mb:i?.25:.5},children:u("navSummary.fromStart")}),e.jsxs(c,{variant:"cardValue",sx:{fontWeight:700,color:F?"#4caf50":E<0?"#f44336":"#9e9e9e",mb:i?.25:.5},children:[E>0?"+":"",E.toFixed(2),"%"]}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontWeight:500,color:F?"#4caf50":E<0?"#f44336":"#9e9e9e"},children:G(R,t)})]})]})]})})]}),e.jsx(l,{sx:{mt:o(2,1.5),p:o(2,1.5),position:"relative",overflow:"hidden"},children:e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{display:"block",textAlign:"center",fontWeight:500,lineHeight:i?1.4:1.6},children:u("navSummary.infoNote")})})]})})},Ik=({compact:r=!1,size:t="small",children:n,sx:s={},...a})=>e.jsx(nt,{size:t,sx:{minWidth:r?60:70,...s},...a,children:n}),Rk=({compact:r=!1,size:t="small",options:n,placeholder:s,sx:a={},...i})=>e.jsxs(Ze,{size:t,displayEmpty:!0,sx:{fontSize:r?"0.6rem!important":"0.8rem!important",height:r?"28px":"32px","& .MuiSelect-select":{py:r?.3:.5,px:r?.8:1},...a},...i,children:[s&&e.jsx(Cu,{value:"",disabled:!0,compact:r,children:s}),n.map(o=>e.jsx(Cu,{value:o.value,disabled:o.disabled,compact:r,children:o.label},o.value))]}),Cu=({compact:r=!1,sx:t={},children:n,...s})=>e.jsx(re,{sx:{fontSize:r?"0.6rem!important":"0.8rem!important",...t},...s,children:n}),ka=({compact:r=!1,size:t="small",options:n,placeholder:s,value:a,onChange:i,sx:o={},formControlSx:d={},selectSx:u={}})=>e.jsx(Ik,{compact:r,size:t,sx:d,children:e.jsx(Rk,{compact:r,size:t,options:n,placeholder:s,value:a,onChange:h=>i(h.target.value),sx:{...o,...u}})}),Mk=({portfolioId:r,baseCurrency:t,compact:n=!1,getUltraSpacing:s=a=>a})=>{var oe,ee;const{t:a}=Ne(),{accountId:i}=Ge(),o=Je(),d=Nt(o.breakpoints.down("md")),[u,h]=p.useState([]),[m,x]=p.useState(!1),[g,f]=p.useState(null),[y,j]=p.useState("12"),[b]=p.useState("DAILY"),v=[{value:"3",label:"3M"},{value:"6",label:"6M"},{value:"12",label:"12M"},{value:"24",label:"24M"},{value:"36",label:"36M"}],P=async()=>{if(!(!r||!i)){x(!0),f(null);try{const H=await q.getPortfolioNAVHistory(r,i,{months:parseInt(y),granularity:b});h(H.data||[])}catch(H){console.error("Error fetching NAV history:",H),f(H instanceof Error?H.message:a("navHistory.error.loadFailed"))}finally{x(!1)}}};p.useEffect(()=>{P()},[r,i,y,b]);const w=H=>{j(H.target.value)},C=H=>{const Q=new Date(H);return b==="DAILY"?Q.toLocaleDateString("vi-VN",{month:"short",day:"numeric"}):b==="WEEKLY"?Q.toLocaleDateString("vi-VN",{month:"short",day:"numeric"}):Q.toLocaleDateString("vi-VN",{month:"short",year:"2-digit"})},k=u.length>0?(oe=u[u.length-1])==null?void 0:oe.navValue:0,A=u.length>0?(ee=u[0])==null?void 0:ee.navValue:0,L=u.map(H=>H.navValue),T=u.map(H=>H.portfolioPnL),M=u.length>0?Math.min(...L):0,O=u.length>0?Math.max(...L):0,I=O-M,z=M-I/2,N=O+I/2,E=u.length>0?Math.min(...T):0,R=u.length>0?Math.max(...T):0,V=R-E,F=E-V/2,B=R+V/2,$=u.map(H=>{const Q=A>0?(H.navValue-A)/A*100:0;return{...H,cumulativeReturn:Q}}),Y=H=>new Date(H).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"}),_=A>0?(k-A)/A*100:0,K=_>=0;let X=A,ne=0;return u.forEach(H=>{H.navValue>X&&(X=H.navValue);const Q=(H.navValue-X)/X*100;Q<ne&&(ne=Q)}),e.jsx(se,{sx:{background:"linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%)",borderRadius:3,boxShadow:"0 4px 20px rgba(0,0,0,0.08)",border:"1px solid #e3f2fd","&:hover":{boxShadow:"0 8px 30px rgba(0,0,0,0.12)",transform:"translateY(-2px)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{p:{xs:.5,sm:s(3,1.5)}},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:{xs:s(1.5,1),sm:s(2,1.5)},pb:{xs:s(.5,1),sm:s(2,1)},borderBottom:{xs:"none",sm:"2px solid #f1f3f4"}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:n?1:1.5},children:[e.jsx(l,{sx:{p:n?.75:1,borderRadius:2,background:"linear-gradient(135deg, #1976d2 0%, #42a5f5 100%)",display:{xs:"none",sm:"flex"},alignItems:"center",justifyContent:"center"},children:e.jsx(Ue,{sx:{color:"white",fontSize:n?18:20}})}),e.jsxs(l,{children:[e.jsx(c,{variant:"pageTitle",ellipsis:!1,children:a("navHistory.title")}),!n&&e.jsx(c,{variant:"pageSubtitle",sx:{display:{xs:"none",sm:"block"}},children:a("navHistory.subtitle")})]})]}),e.jsx(l,{sx:{display:"flex",gap:n?1:1.5,alignItems:"center"},children:e.jsx(ka,{compact:n,size:"small",options:v,value:y,onChange:H=>w({target:{value:String(H)}}),formControlSx:{minWidth:n?60:70},selectSx:{"& .MuiOutlinedInput-notchedOutline":{borderColor:"#e0e0e0"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#1976d2"}}})})]}),e.jsxs(W,{container:!0,spacing:s(2,1),sx:{mb:s(3,1.5),display:{xs:"none",sm:"flex"}},children:[e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsx(se,{sx:{height:n?70:90,display:"flex",alignItems:"center",background:"linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%)",border:"1px solid #e1f5fe",borderRadius:2,"&:hover":{boxShadow:"0 4px 12px rgba(25, 118, 210, 0.15)",transform:"translateY(-1px)",transition:"all 0.2s ease-in-out"}},children:e.jsxs(me,{sx:{p:{xs:.5,sm:s(2,1)},"&:last-child":{pb:{xs:.5,sm:s(2,1)}},textAlign:"center",width:"100%"},children:[e.jsx(c,{variant:"cardValueLarge",color:"primary",fontWeight:"bold",sx:{mb:n?.25:.5},children:G(k,t)}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",fontWeight:500,children:a("navHistory.currentNav")})]})})}),e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsx(se,{sx:{height:n?70:90,display:"flex",alignItems:"center",background:K?"linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%)":"linear-gradient(135deg, #ffebee 0%, #fce4ec 100%)",border:K?"1px solid #c8e6c9":"1px solid #ffcdd2",borderRadius:2,"&:hover":{boxShadow:K?"0 4px 12px rgba(76, 175, 80, 0.15)":"0 4px 12px rgba(244, 67, 54, 0.15)",transform:"translateY(-1px)",transition:"all 0.2s ease-in-out"}},children:e.jsxs(me,{sx:{p:{xs:.5,sm:s(2,1)},"&:last-child":{pb:{xs:.5,sm:s(2,1)}},textAlign:"center",width:"100%"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:.5,mb:n?.25:.5},children:[K&&e.jsx(He,{color:"success",sx:{fontSize:n?16:18}}),!K&&e.jsx(Bt,{color:"error",sx:{fontSize:n?16:18}}),e.jsx(c,{variant:"cardValueLarge",color:K?"success.main":"error.main",fontWeight:"bold",children:ye(_)})]}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",fontWeight:500,children:a("navHistory.totalReturn")})]})})}),e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsx(se,{sx:{height:n?70:90,display:"flex",alignItems:"center",background:"linear-gradient(135deg, #fff3e0 0%, #fce4ec 100%)",border:"1px solid #ffccbc",borderRadius:2,"&:hover":{boxShadow:"0 4px 12px rgba(255, 152, 0, 0.15)",transform:"translateY(-1px)",transition:"all 0.2s ease-in-out"}},children:e.jsxs(me,{sx:{p:{xs:.5,sm:s(2,1)},"&:last-child":{pb:{xs:.5,sm:s(2,1)}},textAlign:"center",width:"100%"},children:[e.jsx(c,{variant:"cardValueLarge",color:"warning.main",fontWeight:"bold",sx:{mb:n?.25:.5},children:ye(ne)}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",fontWeight:500,children:a("navHistory.maxDrawdown")})]})})}),e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsx(se,{sx:{height:n?70:90,display:"flex",alignItems:"center",background:"linear-gradient(135deg, #e0f2f1 0%, #f1f8e9 100%)",border:"1px solid #b2dfdb",borderRadius:2,"&:hover":{boxShadow:"0 4px 12px rgba(0, 150, 136, 0.15)",transform:"translateY(-1px)",transition:"all 0.2s ease-in-out"}},children:e.jsxs(me,{sx:{p:{xs:.5,sm:s(2,1)},"&:last-child":{pb:{xs:.5,sm:s(2,1)}},textAlign:"center",width:"100%"},children:[e.jsx(c,{variant:"cardValueLarge",color:"info.main",fontWeight:"bold",sx:{mb:n?.25:.5},children:u.length}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",fontWeight:500,children:a("navHistory.dataPoints")})]})})})]}),m?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",p:s(6,3),children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsx(Ce,{size:n?24:32,sx:{color:"#1976d2",mb:s(2,1)}}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:a("navHistory.loading")})]})}):g?e.jsxs(l,{sx:{textAlign:"center",p:s(4,2),background:"linear-gradient(135deg, #ffebee 0%, #fce4ec 100%)",borderRadius:2,border:"1px solid #ffcdd2"},children:[e.jsx(c,{color:"error",variant:"cardTitle",fontWeight:500,children:g}),e.jsx(c,{color:"error",variant:"cardLabel",sx:{mt:1},children:a("navHistory.error.unableToLoad")})]}):u.length===0?e.jsxs(l,{sx:{textAlign:"center",p:s(4,2),background:"linear-gradient(135deg, #f5f5f5 0%, #eeeeee 100%)",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsx(c,{color:"text.secondary",variant:"cardTitle",fontWeight:500,children:a("navHistory.noData.title")}),e.jsx(c,{color:"text.secondary",variant:"cardLabel",sx:{mt:1},children:a("navHistory.noData.message")})]}):e.jsx(l,{sx:{height:n?250:350,background:"linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%)",borderRadius:2,p:{xs:.5,sm:s(2,1)},mx:{xs:-3,sm:0}},children:e.jsx(Ln,{width:"100%",height:"100%",children:e.jsxs(nh,{data:$,margin:{top:0,right:n?0:30,left:n?0:20,bottom:n?15:20},children:[e.jsx(cr,{strokeDasharray:"3 3",stroke:"#e0e0e0",strokeOpacity:.6}),e.jsx(dr,{dataKey:"date",tickFormatter:C,stroke:"#666",fontSize:n?9:11,tickLine:!1,axisLine:!1,tick:{fill:"#666"}}),e.jsx(er,{yAxisId:"nav",tickFormatter:H=>G(H,t),stroke:"#1976d2",fontSize:n?9:11,tickLine:!1,axisLine:!1,domain:[z,N],tick:{fill:"#1976d2"},hide:d}),e.jsx(er,{yAxisId:"pnl",orientation:"right",tickFormatter:H=>G(H,t),stroke:"#ff9800",fontSize:n?9:11,tickLine:!1,axisLine:!1,domain:[F,B],tick:{fill:"#ff9800"},hide:d}),e.jsx(ca,{verticalAlign:"top",height:n?30:40,formatter:H=>H==="navValue"?a("navHistory.legend.navValue"):H==="portfolioPnL"?a("navHistory.legend.portfolioPnL"):H,wrapperStyle:{fontSize:n?"10px":"12px",fontWeight:500}}),e.jsx(En,{formatter:(H,Q)=>Q==="navValue"?[G(H,t),a("navHistory.tooltip.navValue")]:Q==="portfolioPnL"?[G(H,t),a("navHistory.tooltip.portfolioPnL")]:Q==="cumulativeReturn"?[ye(H),a("navHistory.tooltip.cumulativeReturn")]:[H,Q],labelFormatter:Y,contentStyle:{backgroundColor:"white",border:"1px solid #e0e0e0",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",fontSize:n?"10px":"12px"}}),e.jsx(or,{yAxisId:"nav",type:"monotone",dataKey:"navValue",stroke:"#1976d2",strokeWidth:n?2:3,dot:!1,activeDot:{r:n?4:5,fill:"#1976d2",stroke:"#fff",strokeWidth:2},connectNulls:!1}),e.jsx(br,{yAxisId:"pnl",dataKey:"portfolioPnL",fill:"#ff9800",fillOpacity:.7,radius:[n?2:3,n?2:3,0,0]}),A>0&&e.jsx(ri,{yAxisId:"nav",y:A,stroke:"#666",strokeDasharray:"4 4",strokeOpacity:.6,strokeWidth:1}),e.jsx(ri,{yAxisId:"pnl",y:0,stroke:"#666",strokeDasharray:"2 2",strokeOpacity:.4,strokeWidth:1})]})})})]})})},Nk=({data:r,title:t="Benchmark Comparison",benchmarkName:n="Market Index",isCompactMode:s=!1,getUltraSpacing:a=m=>m,portfolioId:i,onTimeframeChange:o,currentTimeframe:d="1Y",onTwrPeriodChange:u,currentTwrPeriod:h="YTD"})=>{const{t:m}=Ne(),[x,g]=p.useState(d),[f,y]=p.useState(h),j=Je(),b=Nt(j.breakpoints.down("md"));p.useEffect(()=>{g(d)},[d]),p.useEffect(()=>{y(h)},[h]);const v=M=>{g(M),o&&o(M)},P=M=>{y(M),u&&u(M)},w=({active:M,payload:O,label:I})=>{var z,N;return M&&O&&O.length?e.jsxs(Te,{sx:{p:2,boxShadow:3},children:[e.jsx(c,{variant:"chartTooltip",gutterBottom:!0,children:Pc(I)}),O.map((E,R)=>e.jsxs(c,{variant:"chartTooltip",sx:{wordBreak:"break-word",color:E.color},children:[E.name,": ",ye(E.value)]},R)),e.jsxs(c,{variant:"chartTooltip",color:"text.secondary",sx:{mt:1},children:[m("benchmark.difference"),": ",ye(((N=(z=O[0])==null?void 0:z.payload)==null?void 0:N.difference)||0)]})]}):null},C=M=>new Date(M).toLocaleDateString("en-US",{month:"short",day:"numeric"}),k=r.length>0?r[r.length-1].portfolio:0,A=r.length>0?r[r.length-1].benchmark:0,L=r.length>0?r[r.length-1].difference:0,T=Math.sqrt(r.reduce((M,O)=>M+Math.pow(O.difference,2),0)/r.length);return r.length===0?e.jsx(l,{sx:{p:3,textAlign:"center"},children:e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:m("benchmark.noData")})}):e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:a(2,1)},children:[e.jsxs(l,{children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(c,{variant:"chartTitle",gutterBottom:!0,sx:{mb:0},ellipsis:!1,children:t}),b?e.jsx(e.Fragment,{}):e.jsx(Fe,{title:e.jsxs(l,{sx:{p:1},children:[e.jsx(c,{variant:"chartTitle",sx:{mb:1},ellipsis:!1,children:m("benchmark.tooltip.title")}),e.jsxs(c,{variant:"formHelper",sx:{mb:1},ellipsis:!1,children:[e.jsx("strong",{children:m("benchmark.tooltip.twr")})," ",m("benchmark.tooltip.twrDescription")]}),e.jsxs(c,{variant:"formHelper",sx:{mb:1},ellipsis:!1,children:[e.jsx("strong",{children:m("benchmark.tooltip.mwr")})," ",m("benchmark.tooltip.mwrDescription")]}),e.jsx(c,{variant:"formHelper",ellipsis:!1,children:m("benchmark.tooltip.comparison")})]}),arrow:!0,placement:"top",componentsProps:{tooltip:{sx:{maxWidth:400,bgcolor:"background.paper",color:"text.primary",border:"1px solid",borderColor:"divider",boxShadow:3,"& .MuiTooltip-arrow":{color:"background.paper","&::before":{border:"1px solid",borderColor:"divider"}}}}},children:e.jsx(Ie,{size:"small",sx:{color:"primary.main"},children:e.jsx(qu,{fontSize:"small"})})})]}),e.jsx(c,{variant:"formHelper",color:"text.secondary",display:b?"none":"block",children:m("benchmark.subtitle",{benchmarkName:n})})]}),e.jsxs(l,{sx:{display:"flex",gap:2},children:[e.jsx(ka,{compact:!1,size:"small",options:[{value:"1D",label:"1 Day"},{value:"1W",label:"1 Week"},{value:"1M",label:"1 Month"},{value:"3M",label:"3 Months"},{value:"6M",label:"6 Months"},{value:"1Y",label:"1 Year"},{value:"YTD",label:"YTD"}],value:f,onChange:M=>P(String(M)),formControlSx:{minWidth:b?50:80},selectSx:{fontSize:b?"0.65rem!important":"0.75rem!important"}}),e.jsx(ka,{compact:!1,size:"small",options:[{value:"1M",label:"1 Month"},{value:"3M",label:"3 Months"},{value:"6M",label:"6 Months"},{value:"1Y",label:"1 Year"},{value:"2Y",label:"2 Years"},{value:"5Y",label:"5 Years"},{value:"ALL",label:"All Time"}],value:x,onChange:M=>v(String(M)),formControlSx:{minWidth:b?50:80},selectSx:{fontSize:b?"0.65rem!important":"0.75rem!important"}})]})]}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,lg:3,xl:2,children:e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:1,borderBottom:"1px solid",borderColor:"divider"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(He,{color:"primary",sx:{fontSize:16}}),e.jsx(c,{variant:"formHelper",color:"text.secondary",children:m("benchmark.portfolio")})]}),e.jsx(c,{variant:"cardValue",color:k>=0?"success.main":"error.main",fontWeight:"bold",children:ye(k)})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,lg:3,xl:2,children:e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:1,borderBottom:"1px solid",borderColor:"divider"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(He,{color:"info",sx:{fontSize:16}}),e.jsx(c,{variant:"formHelper",color:"text.secondary",children:n})]}),e.jsx(c,{variant:"cardValue",color:A>=0?"success.main":"error.main",fontWeight:"bold",children:ye(A)})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,lg:3,xl:2,children:e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:1,borderBottom:"1px solid",borderColor:"divider"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(mp,{color:L>=0?"success":"error",sx:{fontSize:16}}),e.jsx(c,{variant:"formHelper",color:"text.secondary",children:m("benchmark.difference")})]}),e.jsx(c,{variant:"cardValue",color:L>=0?"success.main":"error.main",fontWeight:"bold",children:ye(L)})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,lg:3,xl:2,children:e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:1,borderBottom:"1px solid",borderColor:"divider"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Bt,{color:"warning",sx:{fontSize:16}}),e.jsx(c,{variant:"formHelper",color:"text.secondary",children:m("benchmark.trackingError")})]}),e.jsx(c,{variant:"cardValue",color:"warning.main",fontWeight:"bold",children:ye(T)})]})})]}),e.jsx(l,{sx:{height:267,mb:3,px:{xs:0,sm:1},mx:{xs:-3,sm:0}},children:e.jsx(Ln,{width:"100%",height:"100%",children:e.jsxs(To,{data:r,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(cr,{strokeDasharray:"3 3"}),e.jsx(dr,{dataKey:"date",tickFormatter:C,tick:{fontSize:12}}),e.jsx(er,{tickFormatter:M=>ye(M),tick:{fontSize:12},hide:b}),e.jsx(En,{content:e.jsx(w,{})}),e.jsx(ca,{}),e.jsx(or,{type:"monotone",dataKey:"portfolio",stroke:"#1976d2",strokeWidth:3,name:m("benchmark.portfolio"),dot:!1,activeDot:{r:6}}),e.jsx(or,{type:"monotone",dataKey:"benchmark",stroke:"#dc004e",strokeWidth:2,name:n,dot:!1,activeDot:{r:4},strokeDasharray:"5 5"}),e.jsx(ri,{y:0,stroke:"#666",strokeDasharray:"2 2"})]})})})]})})},Lk=r=>!r||typeof r!="string"?!1:/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r),Ek=({analysis:r,currency:t="VND",isLoading:n=!1,error:s,selectedTimeframe:a="3M",selectedGranularity:i="weekly",onTimeframeChange:o,onGranularityChange:d,isCompactMode:u=!1})=>{var T,M;const{t:h}=Ne(),m=Je(),x=Nt(m.breakpoints.down("md")),[g,f]=p.useState("pie"),[y,j]=p.useState({total:!0,realized:!0,unrealized:!0}),b=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D","#FFC658","#FF7C7C","#8DD1E1","#D084D0","#FFB347","#87CEEB","#DDA0DD","#F0E68C","#98FB98","#F4A460","#20B2AA","#FF6347","#4682B4","#D2691E"],P=(O=>{switch(O){case"VND":return"vi-VN";case"USD":return"en-US";default:return"vi-VN"}})(t),w=p.useMemo(()=>{if(!r||!r.pnlSummary||!r.statistics||!r.riskMetrics||!Array.isArray(r.assetPerformance))return!1;if(r.pnlSummary.winRate!==void 0){const O=Number(r.pnlSummary.winRate);if(isNaN(O)||O<0||O>100)return!1}if(r.riskMetrics.volatility!==void 0){const O=Number(r.riskMetrics.volatility);if(isNaN(O)||O<0)return!1}return!0},[r]),C=p.useMemo(()=>r.monthlyPerformance.map(O=>{var I,z,N,E,R,V,F,B,$;return{month:O.period,pnl:parseFloat(((I=O.totalPl)==null?void 0:I.toString())||"0"),realizedPnl:parseFloat(((z=O.realizedPl)==null?void 0:z.toString())||"0"),unrealizedPnl:parseFloat(((N=O.unrealizedPl)==null?void 0:N.toString())||"0"),trades:O.tradesCount||0,winRate:O.winRate||0,totalVolume:parseFloat(((E=O.totalVolume)==null?void 0:E.toString())||"0"),winningTrades:O.winningTrades||0,losingTrades:O.losingTrades||0,formattedPnl:G(parseFloat(((R=O.totalPl)==null?void 0:R.toString())||"0"),t,{},P),formattedRealizedPnl:G(parseFloat(((V=O.realizedPl)==null?void 0:V.toString())||"0"),t,{},P),formattedUnrealizedPnl:G(parseFloat(((F=O.unrealizedPl)==null?void 0:F.toString())||"0"),t,{},P),formattedVolume:G(parseFloat(((B=O.totalVolume)==null?void 0:B.toString())||"0"),t,{},P),formattedWinRate:ye(O.winRate||0,1,P),color:parseFloat((($=O.totalPl)==null?void 0:$.toString())||"0")>=0?"#00C49F":"#FF8042"}}),[r.monthlyPerformance,t,P]),k=p.useMemo(()=>!r.assetPerformance||!Array.isArray(r.assetPerformance)?[]:r.assetPerformance.map((z,N)=>{var V,F,B,$,Y,_;const E=parseFloat(((V=z.totalPl)==null?void 0:V.toString())||"0"),R=Math.abs(E);return{assetId:z.assetId||`asset-${N}`,name:z.assetSymbol||h("tradeAnalysis.unknown.asset"),fullName:z.assetName||h("tradeAnalysis.unknown.assetName"),value:R,originalValue:E,trades:z.tradesCount||0,winRate:z.winRate||0,totalVolume:parseFloat(((F=z.totalVolume)==null?void 0:F.toString())||"0"),quantity:parseFloat(((B=z.quantity)==null?void 0:B.toString())||"0"),avgCost:parseFloat((($=z.avgCost)==null?void 0:$.toString())||"0"),marketValue:parseFloat(((Y=z.marketValue)==null?void 0:Y.toString())||"0"),color:b[N%b.length],formattedValue:G(E,t,{},P),formattedVolume:G(parseFloat(((_=z.totalVolume)==null?void 0:_.toString())||"0"),t,{},P),formattedWinRate:ye(z.winRate||0,1,P)}}).sort((z,N)=>N.value-z.value),[r.assetPerformance,t,P]),A=({active:O,payload:I,label:z})=>{var N;if(O&&I&&I.length){const E=(N=I[0])==null?void 0:N.payload;return e.jsxs(l,{sx:{backgroundColor:"white",border:"1px solid #e0e0e0",borderRadius:2,p:2,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",minWidth:250,maxWidth:300},children:[e.jsx(c,{variant:"subtitle1",fontWeight:"bold",color:"primary",gutterBottom:!0,children:z}),(E==null?void 0:E.month)&&e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[h("tradeAnalysis.tooltip.totalPnL"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"bold",color:E.pnl>=0?"success.main":"error.main",children:G(E.pnl||0,t,{},P)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[h("tradeAnalysis.tooltip.realizedPnL"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",color:E.realizedPnl>=0?"success.main":"error.main",children:G(E.realizedPnl||0,t,{},P)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[h("tradeAnalysis.tooltip.unrealizedPnL"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",color:E.unrealizedPnl>=0?"success.main":"error.main",children:G(E.unrealizedPnl||0,t,{},P)})]}),e.jsxs(l,{sx:{mt:1,pt:1,borderTop:"1px solid #f0f0f0"},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5,children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[h("tradeAnalysis.tooltip.trades"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",children:E.trades||0})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:.5,children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[h("tradeAnalysis.tooltip.winRate"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",color:E.winRate>=50?"success.main":"warning.main",children:ye(E.winRate||0,1,P)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[h("tradeAnalysis.tooltip.volume"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",children:G(E.totalVolume||0,t,{},P)})]})]})]}),(E==null?void 0:E.name)&&!(E!=null&&E.month)&&e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:1},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[h("tradeAnalysis.tooltip.symbol"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"bold",color:"primary",children:E.name})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[h("tradeAnalysis.tooltip.pnl"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"bold",color:E.originalValue>=0?"success.main":"error.main",children:G(E.originalValue||0,t,{},P)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[h("tradeAnalysis.tooltip.performance"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",color:E.percentage>=0?"success.main":"error.main",children:ye(E.percentage||0,2,P)})]}),(E==null?void 0:E.fullName)&&e.jsx(l,{sx:{mt:1,pt:1,borderTop:"1px solid #f0f0f0"},children:e.jsx(c,{variant:"body2",color:"text.secondary",children:E.fullName})})]})]})}return null},L=({name:O,percent:I,payload:z,x:N,y:E})=>{const R=lb(I*100,1,P),V=(z==null?void 0:z.formattedValue)||G((z==null?void 0:z.value)||0,t,{},P);return e.jsxs("g",{children:[e.jsx("text",{x:N,y:E-6,textAnchor:"middle",fill:"#333",fontSize:"10",fontWeight:"bold",children:O}),I>=.02&&e.jsx("text",{x:N,y:E+6,textAnchor:"middle",fill:"#333",fontSize:"9",fontWeight:"normal",children:R}),I>=.05&&e.jsx("text",{x:N,y:E+18,textAnchor:"middle",fill:"#333",fontSize:"9",fontWeight:"normal",children:V}),I<.02&&e.jsx("text",{x:N,y:E+6,textAnchor:"middle",fill:"#333",fontSize:"9",fontWeight:"normal",children:V})]})};return n?e.jsxs(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400,children:[e.jsx(Ce,{}),e.jsx(c,{variant:"pageSubtitle",sx:{ml:2},children:h("tradeAnalysis.loading")})]}):s?e.jsx(je,{severity:"error",children:(s==null?void 0:s.message)||h("tradeAnalysis.error.loadFailed")}):r?w?e.jsxs(l,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:u?2:4,children:[e.jsxs(l,{children:[e.jsx(c,{variant:"pageTitle",ellipsis:!1,children:h("tradeAnalysis.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",display:x?"none":"block",children:h("tradeAnalysis.subtitle")})]}),e.jsxs(l,{display:"flex",gap:2,children:[e.jsx(ka,{compact:u,size:"small",options:[{value:"ALL",label:h("tradeAnalysis.timeframe.allTime")},{value:"1M",label:h("tradeAnalysis.timeframe.oneMonth")},{value:"3M",label:h("tradeAnalysis.timeframe.threeMonths")},{value:"6M",label:h("tradeAnalysis.timeframe.sixMonths")},{value:"1Y",label:h("tradeAnalysis.timeframe.oneYear")}],value:a,onChange:O=>o==null?void 0:o(String(O)),formControlSx:{minWidth:80},selectSx:{borderRadius:2}}),e.jsx(ka,{compact:u,size:"small",options:[{value:"daily",label:h("tradeAnalysis.granularity.daily")},{value:"weekly",label:h("tradeAnalysis.granularity.weekly")},{value:"monthly",label:h("tradeAnalysis.granularity.monthly")}],value:i,onChange:O=>d==null?void 0:d(String(O)),formControlSx:{minWidth:80},selectSx:{borderRadius:2}})]})]}),e.jsxs(W,{container:!0,spacing:u?1:3,mb:u?2:4,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(se,{sx:{height:{xs:"auto",sm:u?120:180},boxShadow:2,background:"linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%)",border:"1px solid #e3f2fd",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{py:u?1.5:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,children:[e.jsxs(l,{children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",gutterBottom:!0,children:h("tradeAnalysis.totalPnL")}),e.jsx(c,{variant:"cardValue",color:r.pnlSummary.totalPnl>=0?"success.main":"error.main",fontWeight:"bold",children:G(r.pnlSummary.totalPnl,t,{},P)})]}),e.jsx(l,{sx:{color:r.pnlSummary.totalPnl>=0?"success.main":"error.main",display:"flex",alignItems:"center"},children:e.jsx(He,{sx:{fontSize:u?18:24}})})]}),!u&&e.jsxs(l,{sx:{mb:2},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsxs(c,{variant:"formHelper",color:"text.secondary",children:[h("tradeAnalysis.realizedPnL"),":"]}),e.jsx(c,{variant:"tableCell",color:r.pnlSummary.totalRealizedPnl>=0?"success.main":"error.main",fontWeight:"medium",children:G(r.pnlSummary.totalRealizedPnl,t,{},P)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{variant:"formHelper",color:"text.secondary",children:[h("tradeAnalysis.unrealizedPnL"),":"]}),e.jsx(c,{variant:"tableCell",color:r.pnlSummary.totalUnrealizedPnl>=0?"success.main":"error.main",fontWeight:"medium",children:G(r.pnlSummary.totalUnrealizedPnl,t,{},P)})]})]}),e.jsx(l,{display:"flex",alignItems:"center",gap:1,children:e.jsx(ce,{label:`${ye(r.pnlSummary.winRate,1,P)} ${h("tradeAnalysis.winRate")}`,color:r.pnlSummary.winRate>=50?"success":"warning",size:u?"small":"medium",variant:"outlined",sx:{fontSize:u?"0.65rem":"0.75rem"}})})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(se,{sx:{height:{xs:"auto",sm:u?120:180},boxShadow:2,background:"linear-gradient(135deg, #ffffff 0%, #f3e5f5 100%)",border:"1px solid #e1bee7",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{py:u?1.5:2,px:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,children:[e.jsxs(l,{children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",gutterBottom:!0,children:h("tradeAnalysis.tradingStatistics")}),e.jsxs(c,{variant:"cardValue",color:"primary",fontWeight:"bold",children:[dn(r.statistics.totalTrades,0,P)," ",h("tradeAnalysis.trades")]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{label:`${h("tradeAnalysis.average")}: ${G(r.statistics.averagePrice,t,{},P)}`,color:"info",size:u?"small":"medium",variant:"outlined",sx:{fontSize:u?"0.65rem":"0.75rem"}}),e.jsx(Zt,{sx:{display:{xs:"none",sm:"block"},color:"primary.main",fontSize:u?18:24}})]})]}),!u&&e.jsxs(l,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsxs(c,{variant:"formHelper",color:"text.secondary",children:[h("tradeAnalysis.buyTrades"),":"]}),e.jsx(c,{variant:"tableCell",color:"success.main",fontWeight:"medium",children:r.statistics.buyTrades})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsxs(c,{variant:"formHelper",color:"text.secondary",children:[h("tradeAnalysis.sellTrades"),":"]}),e.jsx(c,{variant:"tableCell",color:"error.main",fontWeight:"medium",children:r.statistics.sellTrades})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{variant:"formHelper",color:"text.secondary",children:[h("tradeAnalysis.totalVolume"),":"]}),e.jsx(c,{variant:"tableCell",color:"info.main",fontWeight:"medium",children:G(r.statistics.totalVolume,t,{},P)})]})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(se,{sx:{height:{xs:"auto",sm:u?120:180},boxShadow:2,background:"linear-gradient(135deg, #ffffff 0%, #fff3e0 100%)",border:"1px solid #ffcc02",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{py:u?1.5:2,px:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,children:[e.jsxs(l,{children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",gutterBottom:!0,children:h("tradeAnalysis.riskMetrics")}),e.jsxs(c,{variant:"cardValue",color:"warning.main",fontWeight:"bold",children:[((T=r.riskMetrics.volatility)==null?void 0:T.toFixed(2))||"N/A","%"]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{label:`${h("tradeAnalysis.riskLevel")}: ${r.riskMetrics.volatility>20?h("tradeAnalysis.riskLevels.high"):r.riskMetrics.volatility>10?h("tradeAnalysis.riskLevels.medium"):h("tradeAnalysis.riskLevels.low")}`,color:r.riskMetrics.volatility>20?"error":r.riskMetrics.volatility>10?"warning":"success",size:u?"small":"medium",variant:"outlined",sx:{fontSize:u?"0.65rem":"0.75rem"}}),e.jsx(ar,{sx:{display:{xs:"none",sm:"block"},color:"warning.main",fontSize:u?18:24}})]})]}),!u&&e.jsxs(l,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsxs(c,{variant:"formHelper",color:"text.secondary",children:[h("tradeAnalysis.maxDrawdown"),":"]}),e.jsx(c,{variant:"tableCell",color:"error.main",fontWeight:"medium",children:G(r.riskMetrics.maxDrawdown||0,t,{},P)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsxs(c,{variant:"formHelper",color:"text.secondary",children:[h("tradeAnalysis.var95"),":"]}),e.jsx(c,{variant:"tableCell",color:"warning.main",fontWeight:"medium",children:G(r.riskMetrics.var95||0,t,{},P)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(c,{variant:"formHelper",color:"text.secondary",children:[h("tradeAnalysis.sharpeRatio"),":"]}),e.jsx(c,{variant:"tableCell",color:"primary.main",fontWeight:"medium",children:((M=r.riskMetrics.sharpeRatio)==null?void 0:M.toFixed(2))||"N/A"})]})]})]})})})]}),e.jsxs(W,{container:!0,spacing:u?1:3,mb:u?2:4,children:[e.jsx(W,{item:!0,xs:12,lg:8,children:e.jsx(se,{sx:{boxShadow:2,height:u?250:400,background:"linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%)",border:"1px solid #e3f2fd",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{height:"100%",display:"flex",flexDirection:"column",p:u?1.5:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:u?1.5:3,children:[e.jsx(c,{variant:"chartTitle",children:h("tradeAnalysis.monthlyPerformance")}),e.jsxs(l,{display:"flex",gap:u?.5:1,children:[e.jsx(ce,{label:h("tradeAnalysis.totalPnL","Tng P&L"),size:u||x?"small":"medium",color:y.total?"primary":"default",onClick:()=>j(O=>({...O,total:!O.total})),sx:{cursor:"pointer"}}),e.jsx(ce,{label:x?"Thc hin":h("tradeAnalysis.realizedPnL","P&L  thc hin"),size:u||x?"small":"medium",color:y.realized?"success":"default",onClick:()=>j(O=>({...O,realized:!O.realized})),sx:{cursor:"pointer"}}),e.jsx(ce,{label:x?"Cha thc hin":h("tradeAnalysis.unrealizedPnL","P&L cha thc hin"),size:u||x?"small":"medium",color:y.unrealized?"warning":"default",onClick:()=>j(O=>({...O,unrealized:!O.unrealized})),sx:{cursor:"pointer"}})]})]}),e.jsx(l,{sx:{flex:1,minHeight:0},children:e.jsx(Ln,{width:"100%",height:"100%",children:e.jsxs(To,{data:C,children:[e.jsx(cr,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),e.jsx(dr,{dataKey:"month",tick:{fontSize:u?9:12},axisLine:{stroke:"#e0e0e0"}}),e.jsx(er,{tick:{fontSize:u?9:12},axisLine:{stroke:"#e0e0e0"},tickFormatter:O=>G(O,t,{},P),hide:x}),e.jsx(En,{content:e.jsx(A,{}),contentStyle:{backgroundColor:"transparent",border:"none",boxShadow:"none",padding:0},cursor:{stroke:"#1976d2",strokeWidth:1,strokeDasharray:"3 3"}}),y.total&&e.jsx(or,{type:"monotone",dataKey:"pnl",stroke:"#1976d2",strokeWidth:u?2:3,dot:!1,name:h("tradeAnalysis.totalPnL")}),y.realized&&e.jsx(or,{type:"monotone",dataKey:"realizedPnl",stroke:"#00C49F",strokeWidth:u?1.5:2,dot:!1,name:h("tradeAnalysis.realizedPnL")}),y.unrealized&&e.jsx(or,{type:"monotone",dataKey:"unrealizedPnl",stroke:"#FF8042",strokeWidth:u?1.5:2,dot:!1,name:h("tradeAnalysis.unrealizedPnL")})]})})})]})})}),!x&&e.jsx(W,{item:!0,xs:12,lg:4,children:e.jsx(se,{sx:{boxShadow:2,height:u?250:400,background:"white",border:"1px solid #e0e0e0",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{height:"100%",display:"flex",flexDirection:"column",p:u?1.5:2},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:u?1.5:3,children:[e.jsx(c,{variant:"chartTitle",children:h("tradeAnalysis.assetPerformance")}),e.jsxs(l,{display:"flex",gap:u?.5:1,children:[e.jsx(ce,{label:h("tradeAnalysis.pieChart"),size:u?"small":"medium",color:g==="pie"?"primary":"default",onClick:()=>f("pie"),sx:{cursor:"pointer"}}),e.jsx(ce,{label:h("tradeAnalysis.compactList"),size:u?"small":"medium",color:g==="compact"?"primary":"default",onClick:()=>f("compact"),sx:{cursor:"pointer"}})]})]}),k&&k.length>0?e.jsx(l,{sx:{height:u?200:350,display:"flex",flexDirection:"column"},children:g==="pie"?e.jsx(l,{sx:{flex:1,display:"flex",alignItems:"center",justifyContent:"center","& .recharts-pie-label-text":{fontSize:u?"8px !important":"10px !important",fontWeight:"bold !important",fill:"#333 !important",textShadow:"1px 1px 2px rgba(255,255,255,0.8) !important"}},children:e.jsx(Ln,{width:"100%",height:"100%",children:e.jsxs(Co,{children:[e.jsx(ko,{data:k,cx:"50%",cy:"50%",labelLine:!1,label:e.jsx(L,{}),outerRadius:u?60:90,innerRadius:u?25:35,fill:"#8884d8",dataKey:"value",minAngle:1,paddingAngle:1,children:k.map((O,I)=>e.jsx(Br,{fill:O.color||b[I%b.length]},`cell-${I}`))}),e.jsx(En,{content:e.jsx(A,{}),contentStyle:{backgroundColor:"transparent",border:"none",boxShadow:"none",padding:0}})]})})}):e.jsx(l,{sx:{flex:1,overflow:"auto",border:"1px solid",borderColor:"grey.200",borderRadius:1,backgroundColor:"grey.50",p:u?1:2},children:e.jsx(l,{display:"flex",flexWrap:"wrap",gap:u?.5:1,children:k.map((O,I)=>{const z=k.reduce((E,R)=>E+R.value,0),N=z>0?O.value/z*100:0;return e.jsx(ce,{size:u?"small":"medium",icon:e.jsx(l,{sx:{width:u?6:8,height:u?6:8,borderRadius:"50%",backgroundColor:O.color||b[I%b.length],border:"1px solid white",boxShadow:"0 1px 2px rgba(0,0,0,0.2)"}}),label:e.jsxs(l,{display:"flex",alignItems:"center",gap:.5,children:[e.jsx(c,{variant:"formHelper",sx:{color:"text.primary"},fontWeight:"bold",children:O.name}),e.jsx(c,{variant:"formHelper",fontWeight:"bold",sx:{color:O.originalValue>=0?"success.main":"error.main"},children:O.formattedValue}),e.jsxs(c,{variant:"formHelper",sx:{color:"primary"},fontWeight:"bold",children:["(",ye(N,1,P),")"]})]}),variant:"outlined",sx:{height:u?24:32,backgroundColor:O.originalValue>=0?"success.50":"error.50",borderColor:"grey.300",borderWidth:1,"&:hover":{backgroundColor:O.originalValue>=0?"success.100":"error.100",transform:"scale(1.02)",borderColor:O.originalValue>=0?"success.main":"error.main"},transition:"all 0.2s ease-in-out"}},I)})})})}):e.jsx(l,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:u?200:300,children:e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",gutterBottom:!0,children:h("tradeAnalysis.noAssetData")})})]})})})]}),e.jsxs(W,{container:!0,spacing:u?1:3,mb:u?2:4,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{sx:{boxShadow:2,minHeight:100,maxHeight:u?400:600,background:"white",border:"1px solid #c8e6c9",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{height:"100%",display:"flex",flexDirection:"column",p:u?1.5:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:u?1.5:3,children:[e.jsx(c,{variant:"chartTitle",children:h("tradeAnalysis.topTrades")}),e.jsx(ce,{label:h("tradeAnalysis.best"),color:"success",size:u?"small":"medium",variant:"outlined",sx:{fontSize:u?"0.65rem":"0.75rem"}})]}),e.jsx(at,{sx:{flex:1,overflow:"auto",maxHeight:u?300:450,"&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f1f1",borderRadius:"3px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#c1c1c1",borderRadius:"3px","&:hover":{backgroundColor:"#a8a8a8"}}},children:e.jsxs(it,{size:u?"small":"medium",stickyHeader:!0,children:[e.jsx(ct,{children:e.jsxs(De,{sx:{bgcolor:"grey.50"},children:[e.jsx(S,{sx:{fontWeight:600,fontSize:u?"0.7rem":"0.875rem",py:u?.5:1,maxWidth:{xs:"120px",sm:"150px",md:"200px"},minWidth:"100px"},children:h("tradeAnalysis.table.asset")}),e.jsx(S,{sx:{fontWeight:600,py:u?.5:1},children:h("tradeAnalysis.table.pnl")}),e.jsx(S,{sx:{fontWeight:600,py:u?.5:1},children:h("tradeAnalysis.table.date")})]})}),e.jsx(ot,{children:r.topTrades.slice(0,5).map(O=>e.jsxs(De,{children:[e.jsx(S,{sx:{py:u?.5:1,maxWidth:{xs:"120px",sm:"150px",md:"200px"},minWidth:"100px"},children:e.jsxs(l,{children:[e.jsx(c,{variant:"tableCell",fontWeight:"medium",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:O.assetSymbol}),e.jsx(c,{variant:"formHelper",color:"text.secondary",sx:{display:{xs:"none",sm:"block"},overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:O.assetName})]})}),e.jsx(S,{sx:{py:u?.5:1,color:O.realizedPl>=0?"success.main":"error.main"},children:G(Number(O.realizedPl)||0,t,{},P)}),e.jsx(S,{sx:{py:u?.5:1},children:new Date(O.tradeDate).toLocaleDateString()})]},O.tradeId))})]})})]})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{sx:{boxShadow:2,minHeight:100,maxHeight:u?400:600,background:"white",border:"1px solid #ffcdd2",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{height:"100%",display:"flex",flexDirection:"column",p:u?1.5:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:u?1.5:3,children:[e.jsx(c,{variant:"chartTitle",children:h("tradeAnalysis.worstTrades")}),e.jsx(ce,{label:h("tradeAnalysis.worst"),color:"error",size:u?"small":"medium",variant:"outlined",sx:{fontSize:u?"0.65rem":"0.75rem"}})]}),e.jsx(at,{sx:{flex:1,overflow:"auto",maxHeight:u?300:450,"&::-webkit-scrollbar":{width:"6px",height:"6px"},"&::-webkit-scrollbar-track":{backgroundColor:"#f1f1f1",borderRadius:"3px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"#c1c1c1",borderRadius:"3px","&:hover":{backgroundColor:"#a8a8a8"}}},children:e.jsxs(it,{size:u?"small":"medium",stickyHeader:!0,children:[e.jsx(ct,{children:e.jsxs(De,{sx:{bgcolor:"grey.50"},children:[e.jsx(S,{sx:{fontWeight:600,fontSize:u?"0.7rem":"0.875rem",py:u?.5:1,maxWidth:{xs:"120px",sm:"150px",md:"200px"},minWidth:"100px"},children:h("tradeAnalysis.table.asset")}),e.jsx(S,{sx:{fontWeight:600,py:u?.5:1},children:h("tradeAnalysis.table.pnl")}),e.jsx(S,{sx:{fontWeight:600,py:u?.5:1},children:h("tradeAnalysis.table.date")})]})}),e.jsx(ot,{children:r.worstTrades.slice(0,5).map(O=>e.jsxs(De,{children:[e.jsx(S,{sx:{py:u?.5:1,maxWidth:{xs:"120px",sm:"150px",md:"200px"},minWidth:"100px"},children:e.jsxs(l,{children:[e.jsx(c,{variant:"tableCell",fontWeight:"medium",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:O.assetSymbol}),e.jsx(c,{variant:"formHelper",color:"text.secondary",sx:{display:{xs:"none",sm:"block"},overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:O.assetName})]})}),e.jsx(S,{sx:{py:u?.5:1,fontSize:u?"0.7rem":"0.875rem",color:O.realizedPl>=0?"success.main":"error.main"},children:G(Number(O.realizedPl)||0,t,{},P)}),e.jsx(S,{sx:{py:u?.5:1,fontSize:u?"0.7rem":"0.875rem"},children:new Date(O.tradeDate).toLocaleDateString()})]},O.tradeId))})]})})]})})})]}),e.jsx(W,{container:!0,spacing:u?1:3,children:e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{sx:{boxShadow:2,background:"white",border:"1px solid #e0e0e0",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{p:u?1.5:2},children:[e.jsx(c,{variant:"chartTitle",gutterBottom:!0,sx:{mb:u?1.5:2},children:h("tradeAnalysis.assetPerformanceDetails")}),e.jsx(at,{sx:{flex:1,overflow:"auto"},children:e.jsxs(it,{size:u?"small":"medium",stickyHeader:!0,children:[e.jsx(ct,{children:e.jsxs(De,{sx:{bgcolor:"grey.50"},children:[e.jsx(S,{sx:{fontWeight:600,fontSize:u?"0.7rem":"0.875rem",py:u?.5:1,maxWidth:{xs:"120px",sm:"150px",md:"200px"},minWidth:"100px"},children:h("tradeAnalysis.table.asset")}),e.jsx(S,{sx:{fontWeight:600,py:u?.5:1},children:h("tradeAnalysis.table.quantity")}),e.jsx(S,{sx:{fontWeight:600,py:u?.5:1},children:h("tradeAnalysis.table.avgCost")}),e.jsx(S,{sx:{fontWeight:600,py:u?.5:1},children:h("tradeAnalysis.table.marketValue")}),e.jsx(S,{sx:{fontWeight:600,py:u?.5:1},children:h("tradeAnalysis.table.pnl")}),e.jsx(S,{sx:{fontWeight:600,py:u?.5:1},children:h("tradeAnalysis.table.trades")}),e.jsx(S,{sx:{fontWeight:600,py:u?.5:1},children:h("tradeAnalysis.winRate")})]})}),e.jsx(ot,{children:k&&k.length>0?k.map(O=>e.jsxs(De,{hover:!0,children:[e.jsx(S,{sx:{py:u?.5:1,maxWidth:{xs:"120px",sm:"150px",md:"200px"},minWidth:"100px"},children:e.jsxs(l,{children:[e.jsx(c,{variant:"tableCell",fontWeight:"bold",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:O.name}),e.jsx(c,{variant:"formHelper",color:"text.secondary",sx:{display:{xs:"none",sm:"block"},overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:O.fullName})]})}),e.jsx(S,{sx:{py:u?.5:1},children:e.jsx(c,{variant:"tableCell",children:dn(O.quantity,2,P)})}),e.jsx(S,{sx:{py:u?.5:1},children:e.jsx(c,{variant:"tableCell",children:G(O.avgCost,t,{},P)})}),e.jsx(S,{sx:{py:u?.5:1},children:e.jsx(c,{variant:"tableCell",children:G(O.marketValue,t,{},P)})}),e.jsx(S,{sx:{py:u?.5:1},children:e.jsx(c,{variant:"tableCell",fontWeight:"bold",color:O.value>=0?"success.main":"error.main",children:O.formattedValue})}),e.jsx(S,{sx:{py:u?.5:1},children:e.jsxs(l,{display:"flex",alignItems:"center",gap:u?.5:1,children:[e.jsx(c,{variant:"tableCell",children:O.trades}),e.jsx(ce,{label:O.winRate>=50?h("tradeAnalysis.status.win"):h("tradeAnalysis.status.loss"),size:u?"small":"medium",color:O.winRate>=50?"success":"error",variant:"outlined",sx:{fontSize:u?"0.65rem":"0.75rem"}})]})}),e.jsx(S,{sx:{py:u?.5:1},children:e.jsx(c,{variant:"tableCell",fontWeight:"bold",children:O.formattedWinRate})})]},O.assetId||O.name)):e.jsx(De,{children:e.jsx(S,{colSpan:7,align:"center",sx:{py:u?2:4},children:e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:h("tradeAnalysis.noAssetData")})})})})]})})]})})})})]}):e.jsx(je,{severity:"error",children:h("tradeAnalysis.error.invalidData")}):e.jsx(je,{severity:"info",children:h("tradeAnalysis.noData")})},bx=({portfolioId:r,isCompactMode:t=!1})=>{const{t:n}=Ne(),[s,a]=p.useState("3M"),[i,o]=p.useState("weekly");if(!Lk(r))return e.jsx(je,{severity:"error",children:"Invalid portfolio ID format"});const{portfolio:d,isLoading:u,error:h}=zo(r),m={timeframe:s,granularity:i},{data:x,isLoading:g,error:f}=$C(r,m);return u||g?e.jsxs(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400,children:[e.jsx(Ce,{}),e.jsx(c,{variant:"pageSubtitle",sx:{ml:2},children:n("tradeAnalysis.loading")})]}):h?e.jsx(je,{severity:"error",children:(h==null?void 0:h.message)||n("tradeAnalysis.error.portfolioLoadFailed")}):f?e.jsx(je,{severity:"error",children:(f==null?void 0:f.message)||n("tradeAnalysis.error.loadFailed")}):d?x?e.jsx(Ek,{analysis:x,currency:d.baseCurrency,selectedTimeframe:s,selectedGranularity:i,onTimeframeChange:a,onGranularityChange:o,isCompactMode:t}):e.jsx(je,{severity:"info",children:n("tradeAnalysis.noData")}):e.jsx(je,{severity:"error",children:n("tradeAnalysis.error.portfolioNotFound")})},Wk=({portfolioId:r,enabled:t=!0})=>yt({queryKey:["risk-metrics",r],queryFn:async()=>await q.getPortfolioRiskMetrics(r),enabled:t&&!!r,staleTime:5*60*1e3,cacheTime:10*60*1e3,retry:2,retryDelay:n=>Math.min(1e3*2**n,3e4)}),Fk=r=>{const{data:t,isLoading:n,error:s,refetch:a}=Wk(r);return{riskMetrics:t==null?void 0:t.data,totalValue:t==null?void 0:t.totalValue,calculatedAt:t==null?void 0:t.calculatedAt,period:t==null?void 0:t.period,additionalPeriods:t==null?void 0:t.additionalPeriods,isLoading:n,error:(s==null?void 0:s.message)||null,refetch:a,hasData:!!(t!=null&&t.data)}},zk=({portfolioId:r,title:t="Risk Metrics Dashboard",compact:n=!1})=>{const{t:s}=Ne(),{riskMetrics:a,isLoading:i,error:o,hasData:d}=Fk({portfolioId:r});if(i)return e.jsxs(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400,children:[e.jsx(Ce,{}),e.jsx(c,{variant:"pageSubtitle",sx:{ml:2},children:s("riskMetrics.loading")})]});if(o)return e.jsxs(je,{severity:"error",children:[s("riskMetrics.error.loadFailed"),": ",o]});if(!d||!a)return e.jsx(l,{sx:{p:n?2:3,textAlign:"center"},children:e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:s("riskMetrics.noData")})});const u=(j,b)=>{switch(b){case"var":return j>.1?"high":j>.05?"medium":"low";case"volatility":return j>.3?"high":j>.15?"medium":"low";case"drawdown":return j>.2?"high":j>.1?"medium":"low";case"ratio":return j>1.5?"excellent":j>1?"good":j>.5?"fair":"poor";default:return"medium"}},h=j=>{switch(j){case"excellent":case"low":return"success";case"good":return"info";case"fair":case"medium":return"warning";case"poor":case"high":return"error";default:return"default"}},m=j=>{switch(j){case"excellent":case"good":case"low":return e.jsx(Xe,{color:"success"});case"fair":case"medium":return e.jsx(on,{color:"warning"});case"poor":case"high":return e.jsx(Bt,{color:"error"});default:return e.jsx(Jt,{})}},x=u(a.var95||0,"var"),g=u(a.volatility||0,"volatility"),f=u(a.maxDrawdown||0,"drawdown"),y=u(a.sharpeRatio||0,"ratio");return e.jsxs(l,{children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,children:t}),!n&&e.jsx(c,{variant:"formHelper",color:"text.secondary",sx:{mb:3},children:s("riskMetrics.subtitle")}),e.jsxs(W,{container:!0,spacing:n?1:3,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%",background:"linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%)",border:"1px solid #e3f2fd",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{py:n?.5:1,px:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:n?.5:1,children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",children:s("riskMetrics.var95")}),m(x)]}),e.jsx(c,{variant:"cardValue",color:"primary",fontWeight:"bold",children:ye(a.var95,2)}),e.jsx(ce,{label:x.toUpperCase(),color:h(x),size:"small",sx:{mt:1,fontSize:n?"0.65rem":"0.75rem"}})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%",background:"linear-gradient(135deg, #ffffff 0%, #f3e5f5 100%)",border:"1px solid #e1bee7",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{py:n?.5:1,px:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:n?.5:1,children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",children:s("riskMetrics.sharpeRatio")}),m(y)]}),e.jsx(c,{variant:"cardValue",color:"primary",fontWeight:"bold",children:(a.sharpeRatio||0).toFixed(2)}),e.jsx(ce,{label:y.toUpperCase(),color:h(y),size:"small",sx:{mt:1,fontSize:n?"0.65rem":"0.75rem"}})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%",background:"linear-gradient(135deg, #ffffff 0%, #fff3e0 100%)",border:"1px solid #ffcc02",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{py:n?.5:1,px:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:n?.5:1,children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",children:s("riskMetrics.volatility")}),m(g)]}),e.jsx(c,{variant:"cardValue",color:"primary",fontWeight:"bold",children:ye(a.volatility,2)}),e.jsx(ce,{label:g.toUpperCase(),color:h(g),size:"small",sx:{mt:1,fontSize:n?"0.65rem":"0.75rem"}})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%",background:"linear-gradient(135deg, #ffffff 0%, #ffebee 100%)",border:"1px solid #ffcdd2",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{py:n?.5:1,px:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:n?.5:1,children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",children:s("riskMetrics.maxDrawdown")}),m(f)]}),e.jsx(c,{variant:"cardValue",color:"primary",fontWeight:"bold",children:ye(a.maxDrawdown,2)}),e.jsx(ce,{label:f.toUpperCase(),color:h(f),size:"small",sx:{mt:1,fontSize:n?"0.65rem":"0.75rem"}})]})})}),!n&&e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{sx:{background:"linear-gradient(135deg, #ffffff 0%, #f5f5f5 100%)",border:"1px solid #e0e0e0",borderRadius:2,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",transition:"all 0.3s ease-in-out"}},children:e.jsxs(me,{sx:{p:2},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,children:s("riskMetrics.additionalMetrics")}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:6,sm:6,md:3,children:e.jsxs(l,{children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",gutterBottom:!0,children:s("riskMetrics.var99")}),e.jsx(c,{variant:"cardValue",children:ye(a.var99,2)})]})}),e.jsx(W,{item:!0,xs:6,sm:6,md:3,children:e.jsxs(l,{children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",gutterBottom:!0,children:s("riskMetrics.beta")}),e.jsx(c,{variant:"cardValue",children:(a.beta||0).toFixed(2)})]})}),e.jsx(W,{item:!0,xs:6,sm:6,md:3,children:e.jsxs(l,{children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",gutterBottom:!0,children:s("riskMetrics.calmarRatio")}),e.jsx(c,{variant:"cardValue",children:(a.calmarRatio||0).toFixed(2)})]})}),e.jsx(W,{item:!0,xs:6,sm:6,md:3,children:e.jsxs(l,{children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",gutterBottom:!0,children:s("riskMetrics.sortinoRatio")}),e.jsx(c,{variant:"cardValue",children:(a.sortinoRatio||0).toFixed(2)})]})})]})]})})})]})]})},Ok=({portfolioId:r,portfolio:t,isCompactMode:n,getUltraSpacing:s})=>{const{t:a}=Ne(),i=Je(),o=Nt(i.breakpoints.down("md")),[d,u]=p.useState(null),[h,m]=p.useState(!1),[x,g]=p.useState(null),[f,y]=p.useState("1Y"),[j,b]=p.useState("YTD"),[,v]=p.useState(null),[P,w]=p.useState(!1),[C,k]=p.useState(null);Mc(r);const A=M=>{switch(M){case"1M":return 1;case"3M":return 3;case"6M":return 6;case"1Y":return 12;case"2Y":return 24;case"5Y":return 60;case"ALL":return 24;default:return 12}};p.useEffect(()=>{(async()=>{if(r)try{m(!0),g(null);const O=A(f),I=await q.getPortfolioBenchmarkComparison(r,O,j);u(I)}catch(O){console.error("Error fetching benchmark data:",O),g(a("portfolio.error.benchmarkLoadFailed"))}finally{m(!1)}})()},[r,f,j]),p.useEffect(()=>{(async()=>{if(r)try{w(!0),k(null);const O=await q.getPortfolioRiskMetrics(r);v(O)}catch(O){console.error("Error fetching risk metrics data:",O),k(a("portfolio.error.riskMetricsLoadFailed"))}finally{w(!1)}})()},[r]);const L=M=>{y(M)},T=M=>{b(M)};return e.jsxs(l,{sx:{backgroundColor:"background.paper",minHeight:"80vh",pt:0,px:{xs:.5,sm:s(2,1),md:s(2,1)}},children:[e.jsxs(l,{sx:{mb:{xs:s(2,1),sm:s(3,1.5),md:s(4,2)}},children:[e.jsx(Ak,{navValue:t.totalAllValue||t.totalValue||0,totalValue:t.totalAssetValue||0,baseCurrency:t.baseCurrency,isFund:t.isFund||!1,totalOutstandingUnits:t.totalOutstandingUnits||1,navPerUnit:t.navPerUnit||0,isCompactMode:n,getUltraSpacing:s,portfolioId:r}),e.jsx(l,{sx:{mb:{xs:s(2,1),sm:s(2.5,1),md:s(3,1)}},children:e.jsx(Mk,{portfolioId:r,baseCurrency:t.baseCurrency,compact:n,getUltraSpacing:s})}),e.jsx(W,{container:!0,spacing:{xs:s(1,.5),sm:s(2,1),md:s(2,1)},children:e.jsxs(W,{item:!0,xs:12,sm:12,md:12,lg:12,children:[e.jsxs(l,{sx:{display:o||n?"none":"flex",alignItems:{xs:"flex-start",sm:"center"},gap:{xs:1,sm:1.5},mb:s(1.5,1),p:{xs:.5,sm:1.5},backgroundColor:"primary.50",borderRadius:1.5,border:"1px solid",borderColor:"primary.200",flexDirection:{xs:"column",sm:"row"}},children:[e.jsx(l,{sx:{p:{xs:.4,sm:.8},backgroundColor:"primary.main",borderRadius:1,color:"white",fontSize:{xs:"0.8rem",sm:"0.9rem"},alignSelf:{xs:"flex-start",sm:"center"}},children:""}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"cardTitle",sx:{color:"primary.main",mb:.5},children:a("portfolio.fundManagerView")}),e.jsx(c,{variant:"formHelper",color:"text.secondary",sx:{display:{xs:"none",sm:"block"}},children:a("portfolio.twrDescription")}),e.jsx(c,{variant:"formHelper",color:"text.secondary",sx:{display:{xs:"block",sm:"none"}},children:a("portfolio.twrPerformance")})]})]}),h?e.jsx(l,{display:"flex",justifyContent:"center",p:2,children:e.jsx(Ce,{size:24})}):x?e.jsx(c,{color:"error",variant:"errorText",children:x}):e.jsx(Nk,{data:(d==null?void 0:d.data)||[],baseCurrency:t.baseCurrency,title:a("portfolio.portfolioPerformanceTWR"),benchmarkName:(d==null?void 0:d.benchmarkName)||"VN Index",isCompactMode:n,getUltraSpacing:s,portfolioId:r,onTimeframeChange:L,currentTimeframe:f,onTwrPeriodChange:T,currentTwrPeriod:j})]})})]}),e.jsx(l,{sx:{mb:{xs:s(2,1),sm:s(3,1.5),md:s(4,2)}},children:e.jsx(bx,{portfolioId:r,isCompactMode:n})}),e.jsx(l,{sx:{mb:{xs:s(2,1),sm:s(3,1.5),md:s(4,2)}},children:P?e.jsx(l,{display:"flex",justifyContent:"center",p:2,children:e.jsx(Ce,{size:24})}):C?e.jsx(c,{color:"error",variant:"errorText",children:C}):e.jsx(zk,{portfolioId:r,title:a("portfolio.riskMetricsDashboard"),compact:n})})]})},Vk=(r,t=12,n="DAILY")=>{const[s,a]=p.useState([]),[i,o]=p.useState(0),[d,u]=p.useState(!1),[h,m]=p.useState(null),x=p.useCallback(async()=>{if(r){u(!0),m(null);try{const g=await q.getPortfolioAllocationTimeline(r,t,n);a(g.data||[]),o(g.totalValue||0)}catch(g){m(g instanceof Error?g.message:"Failed to fetch allocation timeline data")}finally{u(!1)}}},[r,t,n]);return p.useEffect(()=>{r&&x()},[r,t,n,x]),{allocationData:s,totalValue:i,loading:d,error:h,refetch:x}},$k=({data:r,baseCurrency:t,compact:n=!1})=>{const{t:s}=Ne(),a=Object.entries(r.allocation).map(([u,h])=>({name:u.toUpperCase(),value:h.percentage,marketValue:h.value,color:ur(u)})),i=({active:u,payload:h})=>{if(u&&h&&h.length){const m=h[0].payload;return e.jsxs(l,{sx:{p:2,backgroundColor:"white",borderRadius:1,boxShadow:3,border:"1px solid #e0e0e0",minWidth:200,maxWidth:300,position:"relative"},children:[e.jsx(c,{variant:"cardTitle",color:"text.primary",sx:{fontWeight:600,mb:1},children:m.name}),e.jsxs(c,{variant:"cardLabel",color:"text.secondary",sx:{mb:.5},children:[s("portfolio.allocation"),":"]}),e.jsx(c,{variant:"cardValueMedium",sx:{fontWeight:600,mb:.5},children:ye(m.value)}),e.jsxs(c,{variant:"cardLabel",color:"text.secondary",sx:{mb:.5},children:[s("portfolio.marketValue"),":"]}),e.jsx(c,{variant:"cardValueMedium",sx:{fontWeight:600,mb:.5},children:G(m.marketValue,t)})]})}return null},o=({cx:u,cy:h,midAngle:m,outerRadius:x,percent:g,name:f})=>{if(g<.03)return null;const y=Math.PI/180,j=x+20,b=u+j*Math.cos(-m*y),v=h+j*Math.sin(-m*y);return e.jsx("text",{x:b,y:v,fill:"#333",textAnchor:b>u?"start":"end",dominantBaseline:"central",fontSize:n?10:12,fontWeight:"600",style:{pointerEvents:"none"},children:`${f} ${(g*100).toFixed(1)}%`})},d=({cx:u,cy:h,midAngle:m,outerRadius:x,percent:g})=>{if(g<.03)return e.jsx("line",{x1:u,y1:h,x2:u,y2:h,stroke:"transparent",strokeWidth:0});const f=Math.PI/180,y=u+x*Math.cos(-m*f),j=h+x*Math.sin(-m*f),b=u+(x+20)*Math.cos(-m*f),v=h+(x+20)*Math.sin(-m*f);return e.jsx("line",{x1:y,y1:j,x2:b,y2:v,stroke:"#666",strokeWidth:1,strokeDasharray:"2,2",style:{pointerEvents:"none"}})};return!r||Object.keys(r.allocation).length===0?e.jsx(l,{sx:{p:n?2:3,textAlign:"center"},children:e.jsx(c,{variant:"formHelper",color:"text.secondary",children:s("portfolio.noAllocationData")})}):e.jsx(l,{sx:{width:"100%",minHeight:n?250:300,display:"flex",alignItems:"center",justifyContent:"center",flex:1,px:{xs:0,sm:1},mx:{xs:-3,sm:0}},children:e.jsx(Ln,{width:"100%",height:n?250:300,children:e.jsxs(Co,{children:[e.jsx(ko,{data:a,cx:"50%",cy:"50%",labelLine:d,label:o,outerRadius:n?80:100,fill:"#8884d8",dataKey:"value",stroke:"#fff",strokeWidth:1,children:a.map((u,h)=>e.jsx(Br,{fill:u.color},`cell-${h}`))}),e.jsx(En,{content:e.jsx(i,{})})]})})})},Hk=({data:r,baseCurrency:t,compact:n=!1,colorScheme:s="default"})=>{const{t:a}=Ne(),i=Je(),o=Nt(i.breakpoints.down("md")),d=Array.isArray(r)?r:[],u=Jc(s),h=d.map(x=>{const g=x.value>0?x.unrealizedPl/x.value*100:0;return{name:x.assetType,unrealizedPnL:x.unrealizedPl,unrealizedPnLPercentage:g,marketValue:x.value,positionCount:x.positionCount,color:ur(x.assetType),isPositive:x.unrealizedPl>=0}}),m=({active:x,payload:g,pnlColors:f})=>{if(x&&g&&g.length){const y=g[0].payload,j=(y.unrealizedPnL||0)>=0;return e.jsxs(l,{sx:{p:2.5,backgroundColor:"white",borderRadius:2,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.12)",border:"1px solid #e0e0e0",minWidth:200,position:"relative","&::before":{content:'""',position:"absolute",top:"50%",right:-8,transform:"translateY(-50%)",width:0,height:0,borderLeft:"8px solid white",borderTop:"8px solid transparent",borderBottom:"8px solid transparent"}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:1.5,pb:1,borderBottom:"1px solid #f0f0f0"},children:[e.jsx(l,{sx:{width:12,height:12,backgroundColor:y.color,borderRadius:"50%",mr:1,flexShrink:0}}),e.jsx(c,{variant:"chartTitle",children:y.name||"Unknown"})]}),e.jsxs(l,{sx:{mb:1.5},children:[e.jsx(c,{variant:"chartTooltip",sx:{textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:500},children:a("portfolio.unrealizedPL")}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",mt:.5,gap:1},children:[j?e.jsx(He,{sx:{fontSize:20,color:f.positive}}):e.jsx(Bt,{sx:{fontSize:20,color:f.negative}}),e.jsxs(c,{variant:"cardValueMedium",sx:{color:j?f.positive:f.negative,fontWeight:"bold"},children:[j?"+":"",G(y.unrealizedPnL||0,t)]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5,backgroundColor:j?f.positiveLight:f.negativeLight,px:1,py:.25,borderRadius:1},children:[j?e.jsx(He,{sx:{fontSize:14,color:f.positive}}):e.jsx(Bt,{sx:{fontSize:14,color:f.negative}}),e.jsxs(c,{variant:"tableCell",sx:{color:j?f.positive:f.negative,fontWeight:600},children:[j?"+":"",ye(y.unrealizedPnLPercentage||0)]})]})]})]}),e.jsxs(l,{children:[e.jsx(c,{variant:"chartTooltip",sx:{textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:500},children:a("portfolio.currentValue")}),e.jsx(c,{variant:"tableCell",sx:{mt:.5,color:"text.primary"},children:G(y.marketValue||0,t)})]}),e.jsx(l,{sx:{position:"absolute",top:10,right:10,display:"flex",alignItems:"center",gap:.5},children:j?e.jsxs(c,{variant:"chartTooltip",sx:{color:"#00C49F",fontWeight:600},children:[" ",a("portfolio.profit")]}):e.jsxs(c,{variant:"chartTooltip",sx:{color:"#FF8042",fontWeight:600},children:[" ",a("portfolio.loss")]})})]})}return null};return!d||d.length===0?e.jsxs(l,{children:[e.jsx(c,{variant:"chartTitle",sx:{textAlign:"center"},children:a("portfolio.unrealizedPLByAssetType")}),e.jsx(l,{sx:{p:n?2:3,textAlign:"center"},children:e.jsx(c,{variant:"formHelper",color:"text.secondary",children:a("common.noData")})})]}):e.jsxs(l,{sx:{minHeight:n?133:200,display:"flex",flexDirection:"column",flex:1,px:{xs:0,sm:1}},children:[e.jsx(c,{variant:"chartTitle",sx:{textAlign:"center"},children:a("portfolio.unrealizedPLByAssetType")}),e.jsx(l,{sx:{flex:1,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",mx:{xs:0,sm:0}},children:e.jsx(Ln,{width:"100%",height:n?200:250,children:e.jsxs(ys,{data:h,margin:{top:n?2:10,right:n?0:10,left:n?0:10,bottom:n?2:10},children:[e.jsx(cr,{strokeDasharray:"3 3"}),e.jsx(dr,{dataKey:"name",tick:{fontSize:n?8:10},angle:n?-45:-30,textAnchor:"end",height:n?40:60}),e.jsx(er,{tickFormatter:x=>G(x,t),tick:{fontSize:n?8:10},hide:o}),e.jsx(En,{content:e.jsx(m,{pnlColors:u})}),e.jsx(br,{dataKey:"unrealizedPnL",radius:n?[2,2,0,0]:[4,4,0,0],children:h.map((x,g)=>{const f=x.isPositive?u.positive:u.negative;return e.jsx(Br,{fill:f},`cell-${g}`)})})]})})})]})},Bk=({data:r,baseCurrency:t,title:n="Risk-Return Analysis",compact:s=!1,onPeriodChange:a,selectedPeriod:i="1Y"})=>{const{t:o}=Ne(),d=Je(),u=Nt(d.breakpoints.down("md")),[h,m]=p.useState(i),x=y=>{const j=String(y);m(j),a&&a(j)},g=({active:y,payload:j})=>{if(y&&j&&j.length){const b=j[0].payload,v=b.return>=0;return e.jsxs(Te,{sx:{p:2.5,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.12)",border:"1px solid #e0e0e0",minWidth:200,position:"relative","&::before":{content:'""',position:"absolute",top:"50%",right:-8,transform:"translateY(-50%)",width:0,height:0,borderLeft:"8px solid white",borderTop:"8px solid transparent",borderBottom:"8px solid transparent"}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:1.5,pb:1,borderBottom:"1px solid #f0f0f0"},children:[e.jsx(l,{sx:{width:12,height:12,backgroundColor:b.color,borderRadius:"50%",mr:1,flexShrink:0}}),e.jsx(c,{variant:"cardTitle",sx:{fontSize:"0.9rem"},children:b.assetType.toUpperCase()})]}),e.jsxs(l,{sx:{mb:1.5},children:[e.jsx(c,{variant:"formHelper",sx:{textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:500},children:o("portfolio.returnBubbleSize")}),e.jsxs(c,{variant:"cardValue",sx:{color:v?"#00C49F":"#FF8042",fontWeight:"bold",fontSize:"1.1rem",mt:.5},children:[v?"+":"",ye(b.return)]}),e.jsx(c,{variant:"formHelper",sx:{fontStyle:"italic",mt:.5,display:"block"},children:o("portfolio.bubbleSizeDescription")})]}),e.jsxs(l,{sx:{mb:1.5},children:[e.jsx(c,{variant:"formHelper",sx:{textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:500},children:o("portfolio.riskVolatility")}),e.jsx(c,{variant:"tableCell",sx:{mt:.5,fontSize:"0.85rem",color:"text.primary"},children:ye(b.risk)})]}),e.jsxs(l,{sx:{mb:1.5},children:[e.jsx(c,{variant:"formHelper",sx:{textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:500},children:o("portfolio.portfolioValue")}),e.jsx(c,{variant:"tableCell",sx:{mt:.5,fontSize:"0.85rem",color:"text.primary"},children:G(b.value,t)})]}),e.jsxs(l,{sx:{mb:1.5},children:[e.jsx(c,{variant:"formHelper",sx:{textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:500},children:o("portfolio.performanceRating")}),e.jsx(c,{variant:"tableCell",sx:{mt:.5,fontSize:"0.85rem",color:b.return>0?"success.main":b.return<-5?"error.main":"warning.main"},children:b.return>10?o("portfolio.excellent"):b.return>5?o("portfolio.good"):b.return>0?o("portfolio.positive"):b.return>-5?o("portfolio.poor"):o("portfolio.veryPoor")})]}),e.jsx(l,{sx:{position:"absolute",top:8,right:8,display:"flex",alignItems:"center",gap:.5},children:v?e.jsxs(c,{variant:"statusText",sx:{color:"#00C49F",fontSize:"0.7rem",fontWeight:600},children:[" ",o("portfolio.highReturn")]}):e.jsxs(c,{variant:"statusText",sx:{color:"#FF8042",fontSize:"0.7rem",fontWeight:600},children:[" ",o("portfolio.lowReturn")]})})]})}return null};if(r.length===0)return e.jsx(l,{sx:{p:s?2:3,textAlign:"center"},children:e.jsx(c,{variant:s?"formHelper":"cardTitle",color:"text.secondary",children:o("portfolio.noRiskReturnData")})});const f=r.map(y=>{const v=r.map(A=>A.return),P=Math.min(...v),C=Math.max(...v)-P;let k=15;if(C>0){const A=(y.return-P)/C;k=15+Math.pow(A,.5)*25,k=Math.min(k,40)}else k=55/2;return k=Math.max(k,15),{...y,size:k}});return e.jsxs(l,{children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:s?1:2},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"chartTitle",sx:{mb:0},children:n}),e.jsx(c,{variant:"chartSubtitle",color:"text.secondary",sx:{display:{xs:"none",sm:"block"}},children:o("portfolio.riskVsReturnAnalysis")})]}),a&&e.jsx(ka,{compact:s,size:"small",options:[{value:"1M",label:"1M"},{value:"3M",label:"3M"},{value:"1Y",label:"1Y"}],value:h,onChange:x})]}),e.jsx(l,{sx:{height:s?167:267,px:{xs:0,sm:1},mx:{xs:-3,sm:0}},children:e.jsx(Ln,{width:"100%",height:"100%",children:e.jsxs(ug,{margin:{top:s?10:20,right:s?0:20,bottom:s?10:20,left:s?0:20},children:[e.jsx(cr,{strokeDasharray:"3 3"}),e.jsx(dr,{type:"number",dataKey:"risk",name:"Risk",tickFormatter:y=>ye(y),tick:{fontSize:s?10:12},label:{value:o("portfolio.riskVolatility"),position:"insideBottom",offset:s?-5:-10,style:{fontSize:s?"0.7rem":"0.8rem"}}}),e.jsx(er,{type:"number",dataKey:"return",name:"Return",tickFormatter:y=>ye(y),tick:{fontSize:s?10:12},hide:u,label:{value:o("portfolio.return"),angle:-90,position:"insideLeft",style:{fontSize:s?"0.7rem":"0.8rem"}}}),e.jsx(En,{content:e.jsx(g,{})}),f.map((y,j)=>{const b=v=>{const{cx:P,cy:w,fill:C}=v;return e.jsx("circle",{cx:P,cy:w,r:y.size||20,fill:C,fillOpacity:.7,stroke:"#fff",strokeWidth:2,strokeOpacity:.9,style:{cursor:"pointer",transition:"all 0.2s ease-in-out"},onMouseEnter:k=>{k.currentTarget.setAttribute("fillOpacity","0.9"),k.currentTarget.setAttribute("strokeWidth","3")},onMouseLeave:k=>{k.currentTarget.setAttribute("fillOpacity","0.7"),k.currentTarget.setAttribute("strokeWidth","2")}})};return e.jsx(hg,{data:[y],shape:b,children:e.jsx(Br,{fill:y.color})},`scatter-${j}`)})]})})})]})},Uk=({data:r,title:t="Diversification Heatmap",compact:n=!1})=>{const{t:s}=Ne(),a=Array.from(new Set(r.flatMap(h=>[h.asset1,h.asset2]))),o=(()=>{const h={};return a.forEach(m=>{h[m]={},a.forEach(x=>{m===x?h[m][x]=1:h[m][x]=0})}),r.forEach(m=>{h[m.asset1][m.asset2]=m.correlation,h[m.asset2][m.asset1]=m.correlation}),h})(),d=h=>{const m=Math.abs(h);return m>=.8?"#d32f2f":m>=.6?"#f57c00":m>=.4?"#fbc02d":m>=.2?"#689f38":"#388e3c"},u=h=>{const m=Math.abs(h);return Math.max(.4,.4+m*.6)};return a.length===0?e.jsx(l,{sx:{p:n?1:3,textAlign:"center"},children:e.jsx(c,{variant:n?"tableCell":"cardTitle",color:"text.secondary",children:s("portfolio.noDiversificationData")})}):e.jsxs(l,{children:[!n&&e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"chartTitle",children:t}),e.jsx(c,{variant:"chartSubtitle",color:"text.secondary",sx:{display:{xs:"none",sm:"block"}},children:s("portfolio.correlationMatrix")})]}),e.jsx(l,{sx:{overflowX:"auto",overflowY:"hidden",px:{xs:0,sm:1},mx:{xs:-3,sm:0}},children:e.jsxs(l,{sx:{minWidth:n?300:400,overflow:"hidden"},children:[e.jsxs(W,{container:!0,spacing:n?.25:.5,sx:{mb:n?.5:1},children:[e.jsx(W,{item:!0,xs:2,children:e.jsx(l,{sx:{height:n?30:40}})}),a.map(h=>e.jsx(W,{item:!0,xs:2,children:e.jsx(l,{sx:{height:n?30:40,display:"flex",alignItems:"center",justifyContent:"center",fontSize:n?"0.65rem":"0.75rem",fontWeight:"bold",color:"text.secondary"},children:h.toUpperCase()})},h))]}),a.map(h=>e.jsxs(W,{container:!0,spacing:n?.25:.5,sx:{mb:n?.25:.5},children:[e.jsx(W,{item:!0,xs:2,children:e.jsx(l,{sx:{height:n?30:40,display:"flex",alignItems:"center",justifyContent:"center",fontSize:n?"0.65rem":"0.75rem",fontWeight:"bold",color:"text.secondary"},children:h.toUpperCase()})}),a.map(m=>{const x=o[h][m],g=h===m;return e.jsx(W,{item:!0,xs:2,children:e.jsx(Fe,{title:`${h} vs ${m}: ${ye(x)}`,arrow:!0,children:e.jsx(l,{sx:{height:n?30:40,backgroundColor:g?"#e0e0e0":d(x),opacity:g?.3:u(x),display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease","&:hover":{opacity:1,transform:"scale(1.02)",zIndex:1},borderRadius:n?.5:1,border:"1px solid rgba(0,0,0,0.1)"},children:!g&&e.jsx(c,{variant:"formHelper",sx:{color:"white",fontWeight:"bold",textShadow:"1px 1px 2px rgba(0,0,0,0.5)"},children:ye(x)})})})},`${h}-${m}`)})]},h))]})}),!n&&e.jsxs(l,{sx:{mt:2,display:"flex",alignItems:"center",gap:1.5,flexWrap:"wrap"},children:[e.jsxs(c,{variant:"chartLegend",color:"text.secondary",sx:{fontWeight:600},children:[s("portfolio.correlationLevel"),":"]}),[{label:s("portfolio.correlationHigh"),color:"#d32f2f"},{label:s("portfolio.correlationMediumHigh"),color:"#f57c00"},{label:s("portfolio.correlationMedium"),color:"#fbc02d"},{label:s("portfolio.correlationLow"),color:"#689f38"},{label:s("portfolio.correlationVeryLow"),color:"#388e3c"}].map((h,m)=>e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.25},children:[e.jsx(l,{sx:{width:12,height:12,backgroundColor:h.color,borderRadius:.25,border:"1px solid rgba(0,0,0,0.1)"}}),e.jsx(c,{variant:"chartLegend",color:"text.secondary",sx:{fontSize:n?"0.6rem!important":"0.75rem!important"},children:h.label})]},m))]})]})},_k=({data:r,title:t="Timeline Chart",subtitle:n,compact:s=!1,height:a=267,colors:i=gk,showBarTypeToggle:o=!0,showChartTypeToggle:d=!0,defaultChartType:u="line",defaultBarType:h="stacked",yAxisDomain:m=[0,100],yAxisFormatter:x=A=>In(A,1),xAxisFormatter:g=A=>new Date(A).toLocaleDateString("en-US",{month:"short",day:"numeric"}),tooltipFormatter:f=A=>In(A,1),className:y,sx:j,showLegend:b=!0,showGrid:v=!0,showTooltip:P=!0,lineStrokeWidth:w=2,barRadius:C=[2,2,0,0],barOpacity:k=1})=>{const[A,L]=p.useState(u),[T,M]=p.useState(h),O=Je(),I=Nt(O.breakpoints.down("md")),z=r.length>0?Array.from(new Set(r.flatMap(B=>Object.keys(B).filter($=>$!=="date")))):[],N=(B,$)=>{$!==null&&L($)},E=(B,$)=>{$!==null&&M($)},R=({active:B,payload:$,label:Y})=>{if(B&&$&&$.length){const _=A==="combo"?$.filter((K,X,ne)=>ne.findIndex(oe=>oe.dataKey===K.dataKey)===X):$;return e.jsxs(Te,{sx:{p:2,boxShadow:3},children:[e.jsx(c,{variant:"chartSubtitle",gutterBottom:!0,children:Pc(Y)}),_.map((K,X)=>e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(l,{sx:{width:12,height:12,backgroundColor:K.color,borderRadius:"50%",mr:1,flexShrink:0}}),e.jsxs(c,{variant:"chartTooltip",sx:{flex:1},children:[K.dataKey,": ",f(K.value)]})]},X))]})}return null},V=({payload:B})=>!B||B.length===0?null:e.jsx(l,{sx:{display:"flex",flexWrap:"wrap",gap:s?1:1.5,justifyContent:"center",mt:s?1:2,px:s?1:2},children:B.map(($,Y)=>e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:s?.5:.75,px:s?.75:1,py:s?.25:.5,borderRadius:1,backgroundColor:"rgba(0, 0, 0, 0.02)",border:"1px solid rgba(0, 0, 0, 0.1)"},children:[e.jsx(l,{sx:{width:s?8:10,height:s?8:10,backgroundColor:$.color,borderRadius:"50%",flexShrink:0}}),e.jsx(c,{variant:"chartLegend",sx:{lineHeight:I?1.2:void 0,"&.MuiTypography-root":{fontSize:I?"0.65rem !important":"0.75rem !important"},"&.MuiTypography-chartLegend":{fontSize:I?"0.65rem !important":"0.75rem !important"}},children:$.value})]},Y))}),F=()=>{const B={data:r,margin:{top:20,right:30,left:20,bottom:5}},$={xAxis:e.jsx(dr,{dataKey:"date",tickFormatter:g,tick:{fontSize:s?10:12}}),yAxis:e.jsx(er,{tickFormatter:x,tick:{fontSize:s?10:12},domain:m,hide:I}),grid:v?e.jsx(cr,{strokeDasharray:"3 3"}):null,tooltip:P?e.jsx(En,{content:e.jsx(R,{})}):null,legend:b?e.jsx(ca,{content:e.jsx(V,{})}):null};return A==="line"?e.jsxs(To,{...B,children:[$.grid,$.xAxis,$.yAxis,$.tooltip,$.legend,z.map((Y,_)=>e.jsx(or,{type:"monotone",dataKey:Y,stroke:ur(Y),strokeWidth:w,dot:!1,activeDot:{r:4}},Y))]}):A==="bar"?e.jsxs(ys,{...B,children:[$.grid,$.xAxis,$.yAxis,$.tooltip,$.legend,z.map((Y,_)=>e.jsx(br,{dataKey:Y,fill:ur(Y),fillOpacity:k,radius:C,stackId:T==="stacked"?"stack":void 0},Y))]}):e.jsxs(nh,{...B,children:[$.grid,$.xAxis,$.yAxis,$.tooltip,$.legend,z.map((Y,_)=>e.jsx(br,{dataKey:Y,fill:ur(Y),fillOpacity:k*.6,radius:C,stackId:T==="stacked"?"stack":void 0,name:`${Y} (Bar)`,legendType:"none"},`bar-${Y}`)),z.map((Y,_)=>e.jsx(or,{type:"monotone",dataKey:Y,stroke:ur(Y),strokeWidth:w+1,dot:!1,activeDot:{r:4},name:`${Y} (Line)`},`line-${Y}`))]})};return e.jsxs(l,{className:y,sx:j,children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"chartTitle",gutterBottom:!0,children:t}),n&&e.jsx(c,{variant:"chartSubtitle",color:"text.secondary",children:n})]}),(d||o)&&e.jsxs(l,{sx:{display:"flex",gap:1,alignItems:"center"},children:[o&&(A==="bar"||A==="combo")&&e.jsxs(ro,{value:T,exclusive:!0,onChange:E,size:"small",sx:{"& .MuiToggleButton-root":{fontSize:"0.5rem",px:s?.375:.5,py:s?.125:.25,minWidth:s?"35px":"40px",height:s?"20px":"24px"}},children:[e.jsx(xs,{value:"stacked",children:"Stacked"}),e.jsx(xs,{value:"side-by-side",children:"Side-by-Side"})]}),d&&e.jsxs(ro,{value:A,exclusive:!0,onChange:N,size:"small",sx:{"& .MuiToggleButton-root":{fontSize:"0.5rem",px:s?.5:.75,py:s?.25:.375,minWidth:s?"30px":"35px",height:s?"20px":"24px"}},children:[e.jsx(xs,{value:"line",children:"Line"}),e.jsx(xs,{value:"bar",children:"Bar"}),e.jsx(xs,{value:"combo",children:"Combo"})]})]})]}),e.jsx(l,{sx:{height:s?a*.75:a},children:e.jsx(Ln,{width:"100%",height:"100%",children:F()})})]})},Yk=({value:r,onChange:t,compact:n=!1,disabled:s=!1})=>{const a=(o,d)=>{d!==null&&t(d)},i=[{value:"DAILY",label:"Ngy",icon:e.jsx(Rr,{fontSize:"small"}),tooltip:"Xem theo ngy - chi tit nht"},{value:"WEEKLY",label:"Tun",icon:e.jsx(xp,{fontSize:"small"}),tooltip:"Xem theo tun - cn bng"},{value:"MONTHLY",label:"Thng",icon:e.jsx(pp,{fontSize:"small"}),tooltip:"Xem theo thng - tng quan"}];return e.jsx(ro,{value:r,exclusive:!0,onChange:a,size:"small",disabled:s,sx:{"& .MuiToggleButton-root":{fontSize:n?"0.45rem":"0.55rem",px:n?.6:.8,py:n?.3:.4,minWidth:n?"auto":"40px",display:"flex",alignItems:"center",gap:.3,height:n?"24px":"28px"}},children:i.map(o=>e.jsx(Fe,{title:o.tooltip,arrow:!0,children:e.jsxs(xs,{value:o.value,children:[o.icon,!n&&e.jsx("span",{children:o.label})]})},o.value))})},qk=({data:r,title:t="",compact:n=!1,granularity:s="DAILY",onGranularityChange:a,showGranularitySelector:i=!0})=>{const o=()=>({DAILY:"Thay i phn b theo ngy",WEEKLY:"Thay i phn b theo tun",MONTHLY:"Thay i phn b theo thng"})[s]||"Historical allocation changes over time";return e.jsxs(l,{sx:{px:{xs:0,sm:1},mx:{xs:-3,sm:0}},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:0,px:{xs:1,sm:0}},children:[e.jsxs(l,{sx:{display:{xs:"none",sm:"block"}},children:[e.jsx(c,{variant:"chartTitle",gutterBottom:!0,children:t}),e.jsx(c,{variant:"chartSubtitle",color:"text.secondary",children:o()})]}),i&&a&&e.jsx(l,{sx:{display:"flex",justifyContent:"flex-end",width:"100%"},children:e.jsx(Yk,{value:s,onChange:a,compact:n})})]}),e.jsx(_k,{data:r,title:"",subtitle:"",compact:n,height:267,defaultChartType:"bar",defaultBarType:"stacked",showChartTypeToggle:!1,showBarTypeToggle:!1,yAxisDomain:[0,100],yAxisFormatter:d=>In(d,1),tooltipFormatter:d=>In(d,1)})]})},Gk=({open:r,onClose:t,symbol:n,baseCurrency:s,portfolioId:a,accountId:i,assetId:o})=>{const{t:d}=Ne(),[u,h]=rt.useState([]),[m,x]=rt.useState(!1),[g,f]=rt.useState(null),y=rt.useCallback(async()=>{var j,b;if(!(!r||!o||!a||!i)){x(!0),f(null),h([]);try{const v=await q.getTrades(a,i,{assetId:o});v.sort((P,w)=>new Date(w.tradeDate).getTime()-new Date(P.tradeDate).getTime()),h(v)}catch(v){f(((b=(j=v==null?void 0:v.response)==null?void 0:j.data)==null?void 0:b.message)||(v==null?void 0:v.message)||"Failed to load trade history")}finally{x(!1)}}},[r,o,a,i]);return rt.useEffect(()=>{y()},[y]),e.jsxs(Rt,{open:r,onClose:t,title:e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsxs(c,{variant:"cardTitle",sx:{fontWeight:700},children:[d("portfolio.tradeHistory")," ",n?`- ${n}`:""]})}),loading:m,maxWidth:"lg",actions:e.jsx(l,{sx:{width:"100%",display:"flex",justifyContent:"flex-end"},children:e.jsx(ut,{onClick:t,variant:"outlined",color:"primary",children:d("common.close")})}),children:[g&&e.jsx(je,{severity:"error",sx:{mb:2},children:e.jsx(c,{variant:"tableCell",children:g})}),!m&&!g&&e.jsx(l,{children:u.length===0?e.jsx(c,{variant:"tableCell",color:"text.secondary",children:d("common.noData")}):e.jsx(at,{component:Te,children:e.jsxs(it,{size:"small",stickyHeader:!0,children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{align:"left",children:d("trading.date")}),e.jsx(S,{align:"left",sx:{display:{xs:"none",sm:"table-cell"}},children:d("trading.side")}),e.jsx(S,{align:"right",children:d("common.quantity")}),e.jsx(S,{align:"right",children:d("common.price")}),e.jsx(S,{align:"right",children:d("common.total")}),e.jsx(S,{align:"right",children:"P/L"})]})}),e.jsx(ot,{children:u.map((j,b)=>{const v=Number(j.quantity??0),P=Number(j.price??0),w=v*P,C=(j.side||"").toString().toUpperCase(),k=C==="BUY"?"success":C==="SELL"?"error":"default",A=j.avgCost!==void 0?Number(j.avgCost):void 0,L=C==="SELL"?j.realizedPl!==void 0?Number(j.realizedPl):A!==void 0?(P-A)*v:void 0:void 0;return e.jsxs(De,{hover:!0,children:[e.jsx(S,{sx:{color:"text.secondary"},children:j.tradeDate?Gt(j.tradeDate,"dd/MM/yyyy"):"-"}),e.jsx(S,{sx:{display:{xs:"none",sm:"table-cell"}},children:e.jsx(ce,{size:"small",label:C||"-",color:k,variant:k==="default"?"outlined":"filled"})}),e.jsx(S,{align:"right",children:v.toLocaleString()}),e.jsx(S,{align:"right",children:G(P,s)}),e.jsx(S,{align:"right",sx:{color:C==="BUY"?"success.main":C==="SELL"?"error.main":"text.primary"},children:G(w,s)}),e.jsx(S,{align:"right",sx:{color:L!==void 0?L>=0?"success.main":"error.main":"text.secondary"},children:L!==void 0?G(L,s):"-"})]},b)})})]})})})]})},ku=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D","#FFC658","#FF7C7C","#8DD1E1","#D084D0","#FFB347","#87CEEB","#DDA0DD","#F0E68C","#98FB98"],Kk=({data:r,baseCurrency:t,title:n="Asset Detail Summary",compact:s=!1,accountId:a,portfolioId:i})=>{const{t:o}=Ne(),d=Je(),u=Nt(d.breakpoints.down("md")),[h,m]=rt.useState(!1),[x,g]=rt.useState(null),[f,y]=rt.useState(null),j=(T,M)=>{M&&(g(T),y(M),m(!0))},b=()=>m(!1);if(!r||r.length===0)return e.jsx(l,{sx:{p:s?1:3,textAlign:"center"},children:e.jsx(c,{variant:s?"tableCell":"cardTitle",color:"text.secondary",children:o("portfolio.noAllocationData")})});const v=r.map((T,M)=>({assetId:T.assetId,symbol:T.symbol,name:T.name,assetType:T.assetType,quantity:T.quantity,currentPrice:T.currentPrice,totalValue:T.totalValue,percentage:T.percentage,unrealizedPl:T.unrealizedPl,unrealizedPlPercentage:T.unrealizedPlPercentage,color:ku[M%ku.length]})),P=({active:T,payload:M})=>{var O;if(T&&M&&M.length){const I=M[0].payload;return e.jsxs(l,{sx:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e0e0e0",borderRadius:2,p:2,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",minWidth:200,maxWidth:300},children:[e.jsxs(c,{variant:"cardTitle",sx:{mb:1,color:"#1a1a1a"},children:[I.symbol," - ",I.name]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.allocation"),":"]}),e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:ye(I.percentage||0)})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.value"),":"]}),e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:G(I.totalValue,t)})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.quantity"),":"]}),e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:((O=I.quantity)==null?void 0:O.toLocaleString())||"0"})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("assets.currentPrice"),":"]}),e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:G(I.currentPrice,t)})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,backgroundColor:(I.unrealizedPl||0)>=0?"rgba(76, 175, 80, 0.1)":"rgba(244, 67, 54, 0.1)",borderRadius:1,border:`1px solid ${(I.unrealizedPl||0)>=0?"rgba(76, 175, 80, 0.3)":"rgba(244, 67, 54, 0.3)"}`},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.unrealizedPL"),":"]}),e.jsxs(l,{sx:{textAlign:"right"},children:[e.jsx(c,{variant:"tableCell",sx:{fontWeight:600,color:(I.unrealizedPl||0)>=0?"#4caf50":"#f44336"},children:G(I.unrealizedPl||0,t)}),e.jsx(c,{variant:"labelSmall",sx:{color:(I.unrealizedPl||0)>=0?"#4caf50":"#f44336"},children:ye(I.unrealizedPlPercentage||0)})]})]})]})}return null},w=()=>{const M=s?20:30;return Math.max(s?100:150,Math.min(s?400:600,50+v.length*M))},C=()=>e.jsx(l,{sx:{height:{xs:w(),sm:s?200:300}},children:e.jsx(Ln,{width:"100%",height:"100%",children:e.jsxs(ys,{data:v,margin:{top:20,right:30,left:20,bottom:5},layout:"vertical",children:[e.jsx(cr,{strokeDasharray:"3 3"}),e.jsx(dr,{type:"number",tickFormatter:T=>ye(T),tick:{fontSize:s?10:12}}),e.jsx(er,{type:"category",dataKey:"symbol",tick:{fontSize:s?10:12},width:s?60:80}),e.jsx(En,{content:e.jsx(P,{})}),e.jsx(br,{dataKey:"percentage",radius:[0,4,4,0],children:v.map((T,M)=>e.jsx(Br,{fill:T.color},`cell-${M}`))})]})})}),k=()=>e.jsx(l,{sx:{height:{xs:w(),sm:s?200:300}},children:e.jsx(Ln,{width:"100%",height:"100%",children:e.jsxs(ys,{data:v,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(cr,{strokeDasharray:"3 3"}),e.jsx(dr,{dataKey:"symbol",tick:{fontSize:s?10:12},angle:-70,textAnchor:"end",height:s?60:80}),e.jsx(er,{tickFormatter:T=>ye(T),tick:{fontSize:s?10:12},hide:u}),e.jsx(En,{content:e.jsx(P,{})}),e.jsx(br,{dataKey:"percentage",radius:[4,4,0,0],children:v.map((T,M)=>e.jsx(Br,{fill:T.color},`cell-${M}`))})]})})}),A=()=>e.jsx(l,{sx:{height:{xs:w(),sm:s?200:300}},children:e.jsx(Ln,{width:"100%",height:"100%",children:e.jsxs(ys,{data:v,margin:{top:20,right:30,left:20,bottom:5},layout:"vertical",children:[e.jsx(cr,{strokeDasharray:"3 3"}),e.jsx(dr,{type:"number",tickFormatter:T=>G(T,t),tick:{fontSize:s?10:12}}),e.jsx(er,{type:"category",dataKey:"symbol",tick:{fontSize:s?10:12},width:s?60:80}),e.jsx(En,{content:({active:T,payload:M})=>{var O;if(T&&M&&M.length){const I=M[0].payload;return e.jsxs(l,{sx:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e0e0e0",borderRadius:2,p:2,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",minWidth:200,maxWidth:300},children:[e.jsxs(c,{variant:"cardTitle",sx:{mb:1,color:"#1a1a1a"},children:[I.symbol," - ",I.name]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.currentValue"),":"]}),e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:G(I.totalValue,t)})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.quantity"),":"]}),e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:((O=I.quantity)==null?void 0:O.toLocaleString())||"0"})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.marketPrice"),":"]}),e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:G(I.currentPrice,t)})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,backgroundColor:vl(I.unrealizedPl),borderRadius:1,border:`1px solid ${ns(I.unrealizedPl)}40`},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.unrealizedPL"),":"]}),e.jsxs(l,{sx:{textAlign:"right"},children:[e.jsx(c,{variant:"tableCell",sx:{fontWeight:600,color:ns(I.unrealizedPl)},children:G(I.unrealizedPl,t)}),e.jsx(c,{variant:"labelSmall",sx:{color:ns(I.unrealizedPl)},children:ye(I.unrealizedPlPercentage)})]})]})]})}return null}}),e.jsx(br,{dataKey:"unrealizedPl",radius:[0,4,4,0],children:v.map((T,M)=>e.jsx(Br,{fill:ns(T.unrealizedPl)},`cell-${M}`))})]})})}),L=()=>e.jsx(l,{sx:{height:{xs:w(),sm:s?200:300}},children:e.jsx(Ln,{width:"100%",height:"100%",children:e.jsxs(ys,{data:v,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(cr,{strokeDasharray:"3 3"}),e.jsx(dr,{dataKey:"symbol",tick:{fontSize:s?10:12},angle:-70,textAnchor:"end",height:s?60:80}),e.jsx(er,{tickFormatter:T=>G(T,t),tick:{fontSize:s?10:12},hide:u}),e.jsx(En,{content:({active:T,payload:M})=>{var O;if(T&&M&&M.length){const I=M[0].payload;return e.jsxs(l,{sx:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e0e0e0",borderRadius:2,p:2,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",minWidth:200,maxWidth:300},children:[e.jsxs(c,{variant:"cardTitle",sx:{mb:1,color:"#1a1a1a"},children:[I.symbol," - ",I.name]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.currentValue"),":"]}),e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:G(I.totalValue,t)})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.quantity"),":"]}),e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:((O=I.quantity)==null?void 0:O.toLocaleString())||"0"})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.marketPrice"),":"]}),e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:G(I.currentPrice,t)})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:1,backgroundColor:vl(I.unrealizedPl),borderRadius:1,border:`1px solid ${ns(I.unrealizedPl)}40`},children:[e.jsxs(c,{variant:"tableCell",color:"text.secondary",children:[o("portfolio.unrealizedPL"),":"]}),e.jsxs(l,{sx:{textAlign:"right"},children:[e.jsx(c,{variant:"tableCell",sx:{fontWeight:600,color:ns(I.unrealizedPl)},children:G(I.unrealizedPl,t)}),e.jsx(c,{variant:"labelSmall",sx:{color:ns(I.unrealizedPl)},children:ye(I.unrealizedPlPercentage)})]})]})]})}return null}}),e.jsx(br,{dataKey:"unrealizedPl",radius:[4,4,0,0],children:v.map((T,M)=>e.jsx(Br,{fill:ns(T.unrealizedPl)},`cell-${M}`))})]})})});return!r||r.length===0?e.jsx(l,{sx:{p:3,textAlign:"center"},children:e.jsx(c,{variant:"cardTitle",color:"text.secondary",children:o("portfolio.noAllocationData")})}):e.jsxs(l,{children:[e.jsx(Gk,{open:h,onClose:b,symbol:x,baseCurrency:t,accountId:a,portfolioId:i,assetId:f||""}),!s&&e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"pageTitle",children:n}),e.jsx(c,{variant:"labelSmall",color:"text.secondary",sx:{mb:3},children:o("portfolio.individualAssetHoldingsDescription")})]}),e.jsxs(W,{container:!0,spacing:s?1.5:3,sx:{mb:s?1.5:3},children:[e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsxs(c,{variant:"chartTitle",children:[o("portfolio.assetAllocation")," (%)"]}),u?e.jsx(C,{}):e.jsx(k,{})]}),e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(c,{variant:"chartTitle",children:o("portfolio.unrealizedPL")}),u?e.jsx(A,{}):e.jsx(L,{})]})]}),e.jsxs(l,{sx:{mb:s?1.5:3,p:s?1.5:2,backgroundColor:"rgba(25, 118, 210, 0.04)",borderRadius:2,border:"1px solid rgba(25, 118, 210, 0.12)"},children:[e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,mb:s?1:2},children:o("portfolio.portfolioPerformanceSummary")}),e.jsxs(W,{container:!0,spacing:s?1:2,children:[e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:o("portfolio.totalUnrealizedPL")}),e.jsx(c,{variant:"cardValue",color:v.reduce((T,M)=>T+M.unrealizedPl,0)>=0?"success.main":"error.main",sx:{fontWeight:"bold",display:"block"},children:G(v.reduce((T,M)=>T+M.unrealizedPl,0),t)})]})}),e.jsx(W,{item:!0,xs:6,sm:4,children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:o("portfolio.profitableAssets")}),e.jsxs(c,{variant:"cardValue",color:"success.main",sx:{fontWeight:"bold",display:"block"},children:[v.filter(T=>T.unrealizedPl>0).length," / ",v.length]})]})}),e.jsx(W,{item:!0,xs:6,sm:4,children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:o("portfolio.bestPerformer")}),e.jsx(c,{variant:"tableCell",color:"primary",sx:{fontWeight:"bold",display:"block"},children:v.length>0?v.reduce((T,M)=>M.unrealizedPlPercentage>T.unrealizedPlPercentage?M:T).symbol:o("common.noData")})]})})]})]}),e.jsx(W,{container:!0,spacing:s?1:1.5,children:v.map((T,M)=>{var O;return e.jsx(W,{item:!0,xs:12,sm:6,md:4,lg:3,xl:2,children:e.jsx(se,{sx:{height:"100%",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:3}},children:e.jsxs(me,{sx:{p:s?1:1.5,"&:last-child":{pb:s?1:1.5}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(l,{sx:{width:10,height:10,backgroundColor:T.color,borderRadius:"50%",mr:.75}}),e.jsx(c,{variant:"cardValueMedium",sx:{cursor:T.assetId?"pointer":"default",textDecoration:T.assetId?"underline":"none",textUnderlineOffset:"2px"},onClick:()=>T.assetId&&j(T.symbol,T.assetId),children:T.symbol})]}),e.jsx(ce,{label:T.assetType,size:"small",color:"primary",variant:"outlined",sx:{height:18,fontSize:"0.65rem","& .MuiChip-label":{px:.75}}})]}),e.jsx(c,{variant:"labelSmall",color:"text.secondary",sx:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",mb:1,fontSize:"0.7rem!important"},children:T.name}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,p:.75,backgroundColor:"rgba(25, 118, 210, 0.04)",borderRadius:1,border:"1px solid rgba(25, 118, 210, 0.12)"},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"labelXSmall",sx:{color:"text.secondary"},children:o("portfolio.allocation")}),e.jsx(c,{variant:"cardValueSmall",color:"primary",sx:{fontWeight:"bold",display:"block"},children:ye(T.percentage)})]}),e.jsxs(l,{sx:{textAlign:"right"},children:[e.jsx(c,{variant:"labelXSmall",sx:{color:"text.secondary"},children:o("portfolio.value")}),e.jsx(c,{variant:"cardValueSmall",color:"text.primary",sx:{fontWeight:"bold",display:"block"},children:G(T.totalValue,t)})]})]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:.5},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"labelXSmall",color:"text.secondary",children:o("portfolio.qty")}),e.jsx(c,{variant:"labelSmall",sx:{fontWeight:"bold",display:"block"},children:((O=T.quantity)==null?void 0:O.toLocaleString())||"0"})]}),e.jsxs(l,{children:[e.jsx(c,{variant:"labelXSmall",color:"text.secondary",children:o("portfolio.marketPrice")}),e.jsx(c,{variant:"labelSmall",sx:{fontWeight:"bold",display:"block"},children:G(T.currentPrice,t)})]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mt:1,p:.75,backgroundColor:vl(T.unrealizedPl),borderRadius:1,border:`1px solid ${ns(T.unrealizedPl)}30`},children:[e.jsxs(l,{sx:{flex:"1 1 auto",minWidth:0},children:[e.jsx(c,{variant:"labelXSmall",sx:{color:"text.secondary",display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},children:o("portfolio.unrealizedPL")}),e.jsx(c,{variant:"cardValueSmall",sx:{fontWeight:"bold",color:T.unrealizedPl>=0?"success.main":"error.main",display:"block"},children:G(T.unrealizedPl,t)})]}),e.jsxs(l,{sx:{textAlign:"right"},children:[e.jsx(c,{variant:"cardValueSmall",sx:{fontWeight:"bold",color:T.unrealizedPl>=0?"success.main":"error.main",display:"block"},children:ye(T.unrealizedPlPercentage)}),e.jsx(c,{variant:"labelXSmall",sx:{color:"text.secondary"},children:T.unrealizedPl>=0?o("portfolio.profit"):o("portfolio.loss")})]})]})]})})},M)})}),e.jsx(l,{sx:{mt:3,p:3,backgroundColor:"#f5f5f5",borderRadius:2},children:e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:6,sm:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",gutterBottom:!0,children:o("portfolio.totalAssets")}),e.jsx(c,{variant:"cardValue",color:"primary",sx:{fontWeight:"bold"},children:r.length})]})}),e.jsx(W,{item:!0,xs:6,sm:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",gutterBottom:!0,children:o("portfolio.totalAssetValue")}),e.jsx(c,{variant:"cardValue",color:"primary",sx:{fontWeight:"bold"},children:G(r.reduce((T,M)=>T+M.totalValue,0),t)})]})}),e.jsx(W,{item:!0,xs:6,sm:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",gutterBottom:!0,children:o("portfolio.totalPL")}),e.jsx(c,{variant:"cardValue",sx:{fontWeight:"bold",color:r.reduce((T,M)=>T+M.unrealizedPl,0)>=0?"success.main":"error.main"},children:G(r.reduce((T,M)=>T+M.unrealizedPl,0),t)})]})}),e.jsx(W,{item:!0,xs:6,sm:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",gutterBottom:!0,children:o("portfolio.assetTypes")}),e.jsx(c,{variant:"cardValue",color:"primary",sx:{fontWeight:"bold"},children:new Set(r.map(T=>T.assetType)).size})]})})]})})]})},Qk=({portfolioId:r,portfolio:t,isCompactMode:n,getUltraSpacing:s})=>{const{t:a}=Ne(),[i,o]=p.useState(null),[d,u]=p.useState(!1),[h,m]=p.useState(null),[x,g]=p.useState("1M"),[f,y]=p.useState(null),[j,b]=p.useState(!1),[v,P]=p.useState(null),[w,C]=p.useState(null),[k,A]=p.useState(!1),[L,T]=p.useState(null),[M,O]=p.useState("DAILY"),{allocationData:I,loading:z,error:N}=Vk(r,12,M),{allocationData:E,isLoading:R,error:V}=Mc(r),{performanceData:F,isLoading:B,error:$}=iv(r);return p.useEffect(()=>{(async()=>{if(r)try{u(!0),m(null);const _=await q.getPortfolioRiskReturn(r,x);o(_)}catch(_){console.error("Error fetching risk-return data:",_),m("Failed to load risk-return data")}finally{u(!1)}})()},[r,x]),p.useEffect(()=>{(async()=>{if(r)try{b(!0),P(null);const _=await q.getPortfolioDiversificationHeatmap(r);y(_)}catch(_){console.error("Error fetching diversification data:",_),P("Failed to load diversification data")}finally{b(!1)}})()},[r]),p.useEffect(()=>{(async()=>{if(r)try{A(!0),T(null);const _=await q.getPortfolioAssetDetailSummary(r);C(_)}catch(_){console.error("Error fetching asset detail data:",_),T("Failed to load asset detail data")}finally{A(!1)}})()},[r]),e.jsxs(l,{sx:{backgroundColor:"background.paper",minHeight:"80vh",pt:0,px:{xs:.5,sm:s(2,1)}},children:[e.jsx(l,{sx:{display:{xs:"none",md:"block"}},children:e.jsxs(W,{container:!0,spacing:s(3,1),sx:{mb:s(4,2)},children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{sx:{background:"linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%)",color:"#212529",position:"relative",overflow:"hidden",...Pr((t.totalInvestValue||0)>=0?"card":"alert",{boxShadow:"0 4px 20px rgba(0,0,0,0.08)","&:hover":{transform:"translateY(-3px)",boxShadow:"0 8px 30px rgba(0,0,0,0.12)",transition:"all 0.3s ease-in-out"}})},children:[e.jsx(l,{sx:{position:"absolute",top:-15,right:-15,width:80,height:80,borderRadius:"50%",background:"linear-gradient(135deg, #1976d2 0%, #42a5f5 100%)",display:"flex",alignItems:"center",justifyContent:"center",opacity:.05},children:e.jsx(Ue,{sx:{fontSize:35,color:"#1976d2"}})}),e.jsxs(me,{sx:{p:s(3,1.5),position:"relative",zIndex:1},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:s(2,1)},children:e.jsx(c,{variant:"cardTitle",sx:{textAlign:"center"},children:a("portfolio.totalInvestment")})}),e.jsx(c,{variant:"cardValue",sx:{mb:s(1,.5)},children:G(t.totalInvestValue||0,t.baseCurrency)}),e.jsx(c,{variant:"cardLabel",children:a("portfolio.assetsDepositsValue")})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{sx:{background:(t.unrealizedInvestPnL||0)>=0?"linear-gradient(135deg, #ffffff 0%, #f1f8e9 100%)":"linear-gradient(135deg, #ffffff 0%, #ffebee 100%)",color:"#212529",position:"relative",overflow:"hidden",...Pr("card",{boxShadow:"0 4px 20px rgba(0,0,0,0.08)","&:hover":{transform:"translateY(-3px)",boxShadow:"0 8px 30px rgba(0,0,0,0.12)",transition:"all 0.3s ease-in-out"}})},children:[e.jsx(l,{sx:{position:"absolute",top:-15,right:-15,width:80,height:80,borderRadius:"50%",background:(t.unrealizedInvestPnL||0)>=0?"linear-gradient(135deg, #4caf50 0%, #8bc34a 100%)":"linear-gradient(135deg, #f44336 0%, #ff9800 100%)",display:"flex",alignItems:"center",justifyContent:"center",opacity:.05},children:(t.unrealizedInvestPnL||0)>=0?e.jsx(He,{sx:{fontSize:35,color:"#4caf50"}}):e.jsx(Bt,{sx:{fontSize:35,color:"#f44336"}})}),e.jsxs(me,{sx:{p:s(3,1.5),position:"relative",zIndex:1},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:s(2,1)},children:e.jsx(c,{variant:"cardTitle",sx:{textAlign:"center"},children:a("portfolio.unrealizedPL")})}),e.jsx(c,{variant:"cardValue",sx:{mb:s(1,.5),color:(t.unrealizedInvestPnL||0)>=0?"#28a745":"#dc3545"},children:G(t.unrealizedInvestPnL||0,t.baseCurrency)}),e.jsx(c,{variant:"cardLabel",children:a("portfolio.currentUnrealizedPL")})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{sx:{background:"linear-gradient(135deg, #ffffff 0%, #f3e5f5 100%)",color:"#212529",position:"relative",overflow:"hidden",...Pr("card",{boxShadow:"0 4px 20px rgba(0,0,0,0.08)","&:hover":{transform:"translateY(-3px)",boxShadow:"0 8px 30px rgba(0,0,0,0.12)",transition:"all 0.3s ease-in-out"}})},children:[e.jsx(l,{sx:{position:"absolute",top:-15,right:-15,width:80,height:80,borderRadius:"50%",background:"linear-gradient(135deg, #9c27b0 0%, #e91e63 100%)",display:"flex",alignItems:"center",justifyContent:"center",opacity:.05},children:e.jsx(Ue,{sx:{fontSize:35,color:"#9c27b0"}})}),e.jsxs(me,{sx:{p:s(3,1.5),position:"relative",zIndex:1},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:s(2,1)},children:e.jsx(c,{variant:"cardTitle",sx:{textAlign:"center"},children:a("portfolio.cashBalance")})}),e.jsx(c,{variant:"cardValue",sx:{mb:s(1,.5)},children:G(t.cashBalance,t.baseCurrency)}),e.jsx(c,{variant:"cardLabel",children:a("portfolio.availableCash")})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{sx:{background:"linear-gradient(135deg, #ffffff 0%, #e8f5e8 100%)",color:"#212529",position:"relative",overflow:"hidden",display:{xs:"none",sm:"flex"},...Pr("card",{boxShadow:"0 4px 20px rgba(0,0,0,0.08)","&:hover":{transform:"translateY(-3px)",boxShadow:"0 8px 30px rgba(0,0,0,0.12)",transition:"all 0.3s ease-in-out"}})},children:[e.jsx(l,{sx:{position:"absolute",top:-15,right:-15,width:80,height:80,borderRadius:"50%",background:"linear-gradient(135deg, #4caf50 0%, #8bc34a 100%)",display:"flex",alignItems:"center",justifyContent:"center",opacity:.05},children:e.jsx(He,{sx:{fontSize:35,color:"#4caf50"}})}),e.jsxs(me,{sx:{p:s(3,1.5),position:"relative",zIndex:1},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:s(2,1)},children:e.jsx(c,{variant:"cardTitle",sx:{textAlign:"center"},children:a("portfolio.assetClasses")})}),e.jsx(c,{variant:"cardValue",sx:{mb:s(1,.5)},children:Vn(Object.keys((E==null?void 0:E.allocation)||{}).length,0)}),e.jsx(c,{variant:"cardLabel",children:a("portfolio.differentAssetTypes")})]})]})})]})}),e.jsxs(l,{sx:{display:{xs:"block",md:"none"},mb:s(4,2)},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,mb:s(2,1)},children:[e.jsx(Ue,{sx:{fontSize:20,color:"primary.main"}}),e.jsx(c,{variant:"pageTitle",children:a("portfolio.portfolioOverview")})]}),e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:s(1,.5),"& .portfolio-item":{display:"flex",alignItems:"center",justifyContent:"space-between",p:s(1,.5),borderRadius:.5,backgroundColor:"transparent",border:"none",minHeight:"auto"}},children:[e.jsxs(l,{className:"portfolio-item",children:[e.jsx(l,{sx:{display:"flex",alignItems:"center"},children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:500,fontSize:"0.85rem"},children:a("portfolio.totalInvestment")})}),e.jsx(c,{variant:"cardValue",sx:{color:"primary.main"},children:G(t.totalInvestValue||0,t.baseCurrency)})]}),e.jsx(bt,{}),e.jsxs(l,{className:"portfolio-item",children:[e.jsx(l,{sx:{display:"flex",alignItems:"center"},children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:500,fontSize:"0.85rem"},children:a("portfolio.unrealizedPL")})}),e.jsx(c,{variant:"cardValue",sx:{color:(t.unrealizedInvestPnL||0)>=0?"#4caf50":"#f44336"},children:G(t.unrealizedInvestPnL||0,t.baseCurrency)})]}),e.jsx(bt,{}),e.jsxs(l,{className:"portfolio-item",children:[e.jsx(l,{sx:{display:"flex",alignItems:"center"},children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:500,fontSize:"0.85rem"},children:a("portfolio.cashBalance")})}),e.jsx(c,{variant:"cardValue",sx:{color:(t.cashBalance||0)>=0?"#4caf50":"#f44336"},children:G(t.cashBalance,t.baseCurrency)})]})]})]}),e.jsxs(c,{variant:"pageTitle",sx:{mb:s(3,1),display:"flex",alignItems:"center",gap:1},children:[e.jsx($s,{sx:{fontSize:20,color:"primary.main"}}),a("portfolio.assetTypeAllocation")]}),e.jsxs(W,{container:!0,spacing:s(2,1),sx:{mb:s(4,2),"& .MuiGrid-item":{display:"flex",flexDirection:"column"}},children:[e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(l,{sx:{p:{xs:.5,sm:s(1.5,.5)},backgroundColor:"white",boxShadow:0,height:"100%",display:"flex",flexDirection:"column",alignItems:"center",...kr("chart")},children:[e.jsx(c,{variant:"chartTitle",sx:{mb:s(1,.5),textAlign:"center"},children:a("portfolio.assetAllocationPie")}),R?e.jsx(l,{display:"flex",justifyContent:"center",p:1,children:e.jsx(Ce,{size:20})}):V?e.jsx(c,{variant:"errorText",children:a("portfolio.failedToLoadAllocation")}):e.jsx($k,{data:E||{allocation:{},totalValue:0,totalAssetsValue:0,totalDepositsValue:0,assetCount:0},baseCurrency:t.baseCurrency,compact:n})]})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(l,{sx:{p:{xs:0,sm:s(1.5,.5)},backgroundColor:"white",boxShadow:0,height:"100%",display:"flex",flexDirection:"column",...kr("chart")},children:B?e.jsx(l,{display:"flex",justifyContent:"center",p:1,children:e.jsx(Ce,{size:20})}):$?e.jsx(c,{variant:"errorText",children:a("portfolio.failedToLoadPL")}):e.jsx(Hk,{data:F!=null&&F.data?F.data.map(Y=>({assetType:Y.assetType,value:Y.value,performance:Y.performance,unrealizedPl:Y.unrealizedPl,positionCount:Y.positionCount,color:Y.color})):[],baseCurrency:t.baseCurrency,compact:n,colorScheme:"default"})})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(l,{sx:{p:{xs:.5,sm:s(1.5,.5)},backgroundColor:"white",boxShadow:0,height:"100%",minHeight:250,display:"flex",flexDirection:"column",...kr("chart")},children:[e.jsx(c,{variant:"chartTitle",sx:{mb:s(1,.5),textAlign:"center"},children:a("portfolio.allocationSummary")}),E&&Object.keys(E.allocation).length>0?e.jsxs(l,{children:[Object.entries(E.allocation).map(([Y,_])=>e.jsxs(l,{sx:{mb:s(1,.5)},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:.3},children:[e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:Y.toUpperCase()}),e.jsxs(c,{variant:"tableCell",sx:{fontWeight:700,color:"primary.main"},children:[dn(_.percentage,1),"%"]})]}),e.jsx(l,{sx:{width:"100%",height:"4px",backgroundColor:"#e0e0e0",borderRadius:"2px",overflow:"hidden"},children:e.jsx(l,{sx:{width:`${_.percentage}%`,height:"100%",backgroundColor:ur(Y),transition:"width 0.3s ease"}})}),e.jsx(c,{variant:"formHelper",sx:{mt:.2,display:"block"},children:G(_.value,t.baseCurrency)})]},Y)),e.jsx(l,{sx:{mt:s(1,.5),pt:s(1,.5),borderTop:"1px solid #e0e0e0",textAlign:"center"},children:e.jsxs(l,{sx:{display:"flex",gap:2,justifyContent:"space-between"},children:[e.jsxs(l,{sx:{flex:1,textAlign:"center"},children:[e.jsx(c,{variant:"formHelper",sx:{display:"block",mb:.5},children:a("portfolio.totalAssetsValue")}),e.jsx(c,{variant:"cardValue",sx:{color:"primary.main",fontWeight:700},children:G((E==null?void 0:E.totalAssetsValue)||0,t.baseCurrency)})]}),e.jsxs(l,{sx:{flex:1,textAlign:"center"},children:[e.jsx(c,{variant:"formHelper",sx:{display:"block",mb:.5},children:a("portfolio.totalDepositsValue")}),e.jsx(c,{variant:"cardValue",sx:{color:"primary.main",fontWeight:700},children:G((E==null?void 0:E.totalDepositsValue)||0,t.baseCurrency)})]})]})})]}):e.jsx(c,{variant:"formHelper",sx:{textAlign:"center",mt:2},children:a("portfolio.noAllocationData")})]})})]}),e.jsxs(c,{variant:"pageTitle",sx:{mb:s(3,1),display:"flex",alignItems:"center",gap:1},children:[e.jsx(Gu,{sx:{fontSize:20,color:"primary.main"}}),a("portfolio.assetDetailSummary")]}),e.jsx(l,{sx:{p:{xs:.5,sm:s(2,1)},backgroundColor:"white",mb:s(4,2),...kr("section")},children:k?e.jsx(l,{display:"flex",justifyContent:"center",p:2,children:e.jsx(Ce,{size:24})}):L?e.jsx(c,{variant:"errorText",children:L}):e.jsx(Kk,{data:(w==null?void 0:w.data)||[],baseCurrency:t.baseCurrency,title:a("portfolio.individualAssetHoldings"),compact:n,accountId:(t==null?void 0:t.accountId)||(t==null?void 0:t.ownerAccountId)||(()=>{try{const Y=localStorage.getItem("current_account");if(!Y)return"";const _=JSON.parse(Y);return(_==null?void 0:_.accountId)||(_==null?void 0:_.id)||""}catch{return""}})(),portfolioId:r})}),e.jsxs(c,{variant:"pageTitle",sx:{mb:s(3,1),display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ku,{sx:{fontSize:20,color:"primary.main"}}),a("portfolio.riskPerformanceAnalysis")]}),e.jsxs(W,{container:!0,spacing:s(2,1),sx:{mb:s(4,2)},children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(l,{sx:{p:{xs:.5,sm:s(2,1)},backgroundColor:"white",boxShadow:0,height:"100%",...kr("chart")},children:d?e.jsx(l,{display:"flex",justifyContent:"center",p:2,children:e.jsx(Ce,{size:24})}):h?e.jsx(c,{variant:"errorText",children:h}):e.jsx(Bk,{data:((i==null?void 0:i.data)||[]).map(Y=>({...Y,color:ur(Y.assetType)})),baseCurrency:t.baseCurrency,title:a("portfolio.riskReturnAnalysis"),compact:n,onPeriodChange:g,selectedPeriod:x})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(l,{sx:{p:{xs:.5,sm:s(2,1)},backgroundColor:"white",boxShadow:0,height:"100%",overflow:"hidden",...kr("chart")},children:j?e.jsx(l,{display:"flex",justifyContent:"center",p:2,children:e.jsx(Ce,{size:24})}):v?e.jsx(c,{variant:"errorText",children:v}):e.jsx(Uk,{data:(f==null?void 0:f.data)||[],title:a("portfolio.diversificationHeatmap"),compact:n})})})]}),e.jsxs(c,{variant:"pageTitle",sx:{mb:1,display:"flex",alignItems:"center",gap:1,mt:1},children:[e.jsx(ya,{sx:{fontSize:20,color:"primary.main"}}),a("portfolio.allocationTimeline")]}),e.jsx(l,{sx:{p:{xs:.5,sm:s(2,1)},backgroundColor:"white",boxShadow:0,mb:s(4,2),...kr("chart")},children:z?e.jsx(l,{display:"flex",justifyContent:"center",p:2,children:e.jsx(Ce,{size:24})}):N?e.jsx(c,{variant:"errorText",children:N}):e.jsx(qk,{data:I||[],baseCurrency:t.baseCurrency,title:a("portfolio.allocationTimeline"),compact:n,granularity:M,onGranularityChange:O,showGranularitySelector:!0})})]})},Xk=({open:r,onClose:t,onSubmit:n,initialData:s,isLoading:a=!1,error:i})=>{const{t:o}=Ne(),d=async u=>{try{await n(u),t()}catch(h){console.error("Error updating trade:",h)}};return e.jsx(Ca,{onSubmit:d,initialData:s,isLoading:a,error:i,mode:"edit",showSubmitButton:!1,isModal:!0,open:r,onClose:t,title:o("trading.modal.editTrade"),icon:e.jsx(Tt,{}),maxWidth:"md",size:"medium"})},Jk=({trade:r,tradeDetails:t=[],isLoading:n=!1})=>{const{t:s}=Ne(),a=g=>g===nn.BUY?"success":"error",i=g=>g===nn.BUY?e.jsx(He,{}):e.jsx(Bt,{}),o=g=>s(`trading.${g.toLowerCase()}`),d=t.reduce((g,f)=>g+f.matchedQty,0),u=t.reduce((g,f)=>g+f.pnl,0),h=r.quantity*r.price,m=(Number(r.fee)||0)+(Number(r.tax)||0),x=h+m;return e.jsxs(l,{children:[e.jsxs(l,{sx:{bgcolor:"grey.50",p:1.5,borderRadius:1,mb:2,border:1,borderColor:"grey.200"},children:[e.jsx(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:e.jsx(l,{display:"flex",alignItems:"center",gap:1.5,children:e.jsxs(l,{display:"flex",gap:.5,children:[e.jsx(ce,{label:r.assetSymbol,color:"primary",variant:"outlined",size:"small",sx:{fontWeight:600}}),e.jsx(ce,{label:o(r.side),color:a(r.side),icon:i(r.side),size:"small",sx:{fontWeight:600}})]})})}),e.jsxs(c,{variant:"labelSmall",color:"text.secondary",children:[r.assetName,"  ",Gt(r.tradeDate,"HH:mm dd/MM/yyyy")]})]}),e.jsxs(l,{sx:{mb:2},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,color:"primary",fontWeight:"bold",sx:{mb:1.5},children:s("trading.tradeDetails.tradeInformation")}),e.jsx(W,{container:!0,spacing:2,children:e.jsx(W,{item:!0,xs:12,md:12,children:e.jsx(l,{sx:g=>({border:`1px solid ${g.palette.divider}`,borderRadius:1,overflow:"hidden"}),children:e.jsxs(W,{container:!0,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:g=>({borderRight:{xs:"none",md:`1px solid ${g.palette.divider}`}}),children:[e.jsxs(l,{sx:g=>({display:"flex",justifyContent:"space-between",alignItems:"center",p:2,borderBottom:`1px solid ${g.palette.divider}`}),children:[e.jsx(c,{variant:"cardLabel",children:s("trading.tradeDetails.quantity")}),e.jsx(c,{variant:"cardValue",children:dn(r.quantity,2)})]}),e.jsxs(l,{sx:g=>({display:"flex",justifyContent:"space-between",alignItems:"center",p:2,borderBottom:`1px solid ${g.palette.divider}`}),children:[e.jsx(c,{variant:"cardLabel",children:s("trading.tradeDetails.pricePerUnit")}),e.jsx(c,{variant:"cardValue",children:G(r.price)})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2},children:[e.jsx(c,{variant:"cardLabel",children:s("trading.tradeDetails.totalValue")}),e.jsx(c,{variant:"cardValue",children:G(h)})]})]})}),e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsxs(l,{sx:g=>({display:"flex",justifyContent:"space-between",alignItems:"center",p:2,borderBottom:`1px solid ${g.palette.divider}`}),children:[e.jsx(c,{variant:"cardLabel",children:s("trading.tradeDetails.feesTaxes")}),e.jsx(c,{variant:"cardValue",children:G(m)})]}),e.jsxs(l,{sx:g=>({display:"flex",justifyContent:"space-between",alignItems:"center",p:2,borderBottom:`1px solid ${g.palette.divider}`}),children:[e.jsx(c,{variant:"cardLabel",children:s("trading.tradeDetails.totalCost")}),e.jsx(c,{variant:"cardValue",children:G(x)})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2},children:[e.jsx(c,{variant:"cardLabel",children:s("trading.tradeDetails.realizedPL")}),e.jsx(c,{variant:"cardValue",fontWeight:"bold",color:r.realizedPl&&r.realizedPl>=0?"success.main":"error.main",children:r.realizedPl?G(Number(r.realizedPl)||0):s("common.na")})]})]})]})})})})]}),r.notes&&e.jsxs(l,{mb:2,children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,color:"primary",fontWeight:"bold",sx:{mb:1},children:s("trading.tradeDetails.notes")}),e.jsx(l,{sx:{p:1.5,bgcolor:"info.50",borderRadius:1,border:1,borderColor:"info.200"},children:e.jsx(c,{variant:"labelSmall",children:r.notes})})]}),r.side===nn.SELL&&t.length>0&&e.jsxs(l,{mb:2,children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,color:"primary",fontWeight:"bold",sx:{mb:1.5},children:s("trading.tradeDetails.tradeMatchingDetails")}),e.jsxs(W,{container:!0,spacing:1.5,mb:2,children:[e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsxs(l,{textAlign:"center",p:1.5,sx:{bgcolor:"success.50",borderRadius:1,border:1,borderColor:"success.200"},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",gutterBottom:!0,children:s("trading.tradeDetails.totalMatched")}),e.jsx(c,{variant:"cardValue",fontWeight:"bold",color:"success.main",children:dn(d,2)})]})}),e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsxs(l,{textAlign:"center",p:1.5,sx:{bgcolor:"warning.50",borderRadius:1,border:1,borderColor:"warning.200"},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",gutterBottom:!0,children:s("trading.tradeDetails.remaining")}),e.jsx(c,{variant:"cardValue",fontWeight:"bold",color:"warning.main",children:dn(r.remainingQuantity||0,2)})]})}),e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsxs(l,{textAlign:"center",p:1.5,sx:{bgcolor:u>=0?"success.50":"error.50",borderRadius:1,border:1,borderColor:u>=0?"success.200":"error.200"},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",gutterBottom:!0,children:s("trading.tradeDetails.totalRealizedPL")}),e.jsx(c,{variant:"cardValue",fontWeight:"bold",color:u>=0?"success.main":"error.main",children:G(u)})]})})]}),e.jsx(at,{component:Te,variant:"outlined",sx:{borderRadius:1,boxShadow:1},children:e.jsxs(it,{size:"small",children:[e.jsx(ct,{children:e.jsxs(De,{sx:{bgcolor:"grey.50"},children:[e.jsx(S,{sx:{fontWeight:600},children:s("trading.tradeDetails.buyTradeId")}),e.jsx(S,{align:"right",sx:{fontWeight:600},children:s("trading.tradeDetails.matchedQty")}),e.jsx(S,{align:"right",sx:{fontWeight:600},children:s("trading.tradeDetails.buyPrice")}),e.jsx(S,{align:"right",sx:{fontWeight:600},children:s("trading.tradeDetails.sellPrice")}),e.jsx(S,{align:"right",sx:{fontWeight:600},children:s("trading.tradeDetails.pl")}),e.jsx(S,{sx:{fontWeight:600},children:s("trading.tradeDetails.matchedDate")})]})}),e.jsx(ot,{children:t.map(g=>e.jsxs(De,{sx:{"&:nth-of-type(odd)":{bgcolor:"grey.25"},"&:hover":{bgcolor:"action.hover"}},children:[e.jsx(S,{children:e.jsxs(c,{variant:"labelSmall",fontFamily:"monospace",fontWeight:"medium",children:[g.buyTradeId.slice(0,8),"..."]})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"labelSmall",fontWeight:"medium",children:dn(g.matchedQty,2)})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"labelSmall",fontWeight:"medium",children:G(g.buyPrice)})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"labelSmall",fontWeight:"medium",children:G(g.sellPrice)})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"labelSmall",color:g.pnl>=0?"success.main":"error.main",fontWeight:"bold",children:G(g.pnl)})}),e.jsx(S,{children:e.jsx(c,{variant:"labelSmall",fontWeight:"medium",children:fn(_r(g.createdAt.toString()),"MMM dd, yyyy")})})]},g.detailId))})]})})]}),r.side===nn.SELL&&(r.remainingQuantity||0)>0&&e.jsx(l,{mb:2,children:e.jsx(je,{severity:"warning",variant:"outlined",sx:{borderRadius:1,"& .MuiAlert-message":{width:"100%"}},children:e.jsx(c,{variant:"labelSmall",fontWeight:"medium",children:e.jsx(sf,{i18nKey:"trading.tradeDetails.unmatchedTradeWarning",values:{quantity:dn(r.remainingQuantity||0,2)},components:{strong:e.jsx("strong",{})}})})})}),n&&e.jsx(l,{display:"flex",justifyContent:"center",py:4,children:e.jsx(c,{variant:"labelSmall",children:s("trading.tradeDetails.loadingTradeDetails")})})]})},Zk=({open:r,onClose:t,onEdit:n,trade:s,tradeDetails:a=[],isLoading:i=!1,error:o})=>{const{t:d}=Ne();if(!s)return null;const u=e.jsx(l,{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",children:e.jsx(c,{variant:"cardTitle",fontWeight:"bold",children:d("trading.tradeDetails.modal.title")})}),h=e.jsxs(l,{display:"flex",justifyContent:"flex-end",gap:1,width:"100%",children:[e.jsx(he,{onClick:t,variant:"text",mobileText:d("common.close"),desktopText:d("common.close"),sx:{textTransform:"none",px:3},children:d("common.close")}),n&&e.jsx(he,{onClick:()=>n(s),variant:"contained",icon:e.jsx(Tt,{}),mobileText:d("common.edit"),desktopText:d("trading.tradeDetails.modal.editTrade"),sx:{textTransform:"none",px:3},forceTextOnly:!0,children:d("trading.tradeDetails.modal.editTrade")})]});return e.jsx(Rt,{open:r,onClose:t,title:u,maxWidth:"lg",loading:i,actions:h,children:e.jsxs(l,{children:[o&&e.jsx(je,{severity:"error",sx:{m:2,mb:2},children:o}),e.jsx(l,{sx:{overflow:"auto"},children:!i&&e.jsx(Jk,{trade:s,tradeDetails:a,isLoading:i})})]})})},e2=({open:r,onClose:t,onConfirm:n,title:s,message:a,confirmText:i="Confirm",cancelText:o="Cancel",type:d="warning",isLoading:u=!1,confirmColor:h="error"})=>{const m=()=>{switch(d){case"delete":return e.jsx(pt,{color:"error",sx:{fontSize:40}});case"warning":return e.jsx(on,{color:"warning",sx:{fontSize:40}});default:return e.jsx(on,{color:"info",sx:{fontSize:40}})}},x=()=>{switch(d){case"delete":return"error.main";case"warning":return"warning.main";default:return"info.main"}};return e.jsxs(kt,{open:r,onClose:t,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3,boxShadow:4}},children:[e.jsx(Et,{sx:{pb:1},children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(l,{sx:{p:1.5,borderRadius:"50%",bgcolor:`${x()}15`,display:"flex",alignItems:"center",justifyContent:"center"},children:m()}),e.jsx(D,{variant:"h6",component:"div",fontWeight:600,children:s})]}),e.jsx(Ie,{onClick:t,size:"small",sx:{color:"text.secondary","&:hover":{bgcolor:"action.hover"}},children:e.jsx(sr,{})})]})}),e.jsx(bt,{}),e.jsx(Pt,{sx:{pt:3,pb:2},children:e.jsx(D,{variant:"body1",color:"text.primary",sx:{lineHeight:1.6},children:a})}),e.jsx(bt,{}),e.jsxs(Dt,{sx:{p:3,gap:2},children:[e.jsx(he,{onClick:t,variant:"outlined",disabled:u,icon:e.jsx(sr,{}),mobileText:o,desktopText:o,sx:{textTransform:"none",px:3,py:1,borderRadius:2,minWidth:100},children:o}),e.jsx(he,{onClick:n,variant:"contained",color:h,disabled:u,icon:d==="delete"?e.jsx(pt,{}):e.jsx(on,{}),mobileText:u?"Processing...":i,desktopText:u?"Processing...":i,sx:{textTransform:"none",px:3,py:1,borderRadius:2,minWidth:100,fontWeight:600},children:u?"Processing...":i})]})]})},t2=({trades:r,isLoading:t=!1,onEdit:n,onDelete:s,onView:a,onCreate:i,onPageChange:o,currentPage:d=1,totalPages:u=1,isCompactMode:h=!1,isReadOnly:m=!1})=>{const{t:x}=Ne(),g=Je(),f=Nt(g.breakpoints.down("md")),[y,j]=p.useState(""),[b,v]=p.useState("ALL"),[P,w]=p.useState(null),[C,k]=p.useState(null),[A,L]=p.useState("list"),[T,M]=p.useState(new Set),[O,I]=p.useState(!0),[z,N]=p.useState(!1),E=p.useMemo(()=>r.filter(ne=>{var H,Q,Z;const oe=((H=ne.assetSymbol)==null?void 0:H.toLowerCase().includes(y.toLowerCase()))||((Q=ne.assetName)==null?void 0:Q.toLowerCase().includes(y.toLowerCase()))||((Z=ne.notes)==null?void 0:Z.toLowerCase().includes(y.toLowerCase())),ee=b==="ALL"||ne.side===b;return oe&&ee}),[r,y,b]),R=p.useMemo(()=>{if(!O)return{"All Trades":E};const ne={};E.forEach(ee=>{const H=fn(_r(ee.tradeDate.toString()),"yyyy-MM-dd");ne[H]||(ne[H]=[]),ne[H].push(ee)});const oe={};return Object.keys(ne).sort((ee,H)=>new Date(H).getTime()-new Date(ee).getTime()).forEach(ee=>{const H=fn(_r(ee),"MMM dd, yyyy");oe[H]=ne[ee]}),oe},[E,O]),V=ne=>{const oe=new Set(T);oe.has(ne)?oe.delete(ne):oe.add(ne),M(oe)},F=()=>{T.size===Object.keys(R).length?M(new Set):M(new Set(Object.keys(R)))},B=(ne,oe)=>{ne.stopPropagation(),w(ne.currentTarget),k(oe)},$=()=>{w(null),k(null)},Y=ne=>{if(C){switch(ne){case"view":a==null||a(C);break;case"edit":n==null||n(C);break;case"delete":s==null||s(C);break}$()}},_=ne=>ne===nn.BUY?"success":"error",K=ne=>ne===nn.BUY?e.jsx(He,{sx:{fontSize:14,color:"success.main"}}):e.jsx(Bt,{sx:{fontSize:14,color:"error.main"}}),X={date:{minWidth:120},asset:{minWidth:120,flex:1,maxWidth:200},side:{minWidth:80},exchange:{minWidth:100},fundingSource:{minWidth:120},quantity:{minWidth:100},price:{minWidth:100},totalValue:{minWidth:120},fees:{minWidth:100},totalCost:{minWidth:120},pl:{minWidth:100},actions:{minWidth:80}};return e.jsxs(l,{sx:{width:"100%",maxWidth:"100%",overflow:"hidden","& *":{boxSizing:"border-box"},"& .MuiTableContainer-root":{overflowX:"auto !important",maxWidth:"100% !important"},"& .MuiTable-root":{width:"100% !important",tableLayout:"auto !important"},"& .MuiTableCell-root":{whiteSpace:"normal",wordWrap:"break-word"}},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:h?1:3,children:[e.jsxs(l,{children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5,mb:0},children:[e.jsx(c,{variant:h?"cardTitle":"pageTitle",fontWeight:"bold",component:"h2",children:x("trading.tradeSummary")}),e.jsx(hb,{placement:"top",size:"small",color:"primary"})]}),!h&&!f&&e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:x("trading.manageAndTrack")})]}),e.jsxs(l,{display:"flex",gap:.5,children:[e.jsx(he,{variant:A==="grid"?"contained":"outlined",size:"small",icon:e.jsx(vo,{}),onClick:()=>L("grid"),mobileText:"G",desktopText:x("common.grid"),sx:{textTransform:"none",minWidth:h?60:80,px:h?1:2},children:h?"G":x("common.grid")}),e.jsx(he,{variant:A==="list"?"contained":"outlined",size:"small",icon:e.jsx(wo,{}),onClick:()=>L("list"),mobileText:"L",desktopText:x("common.list"),sx:{textTransform:"none",minWidth:h?60:80,px:h?1:2},children:h?"L":x("common.list")})]})]}),e.jsx(l,{sx:{mb:h?1:4,overflowX:"auto !important",maxWidth:"100%",width:"100%","&::-webkit-scrollbar":{height:8},"&::-webkit-scrollbar-track":{backgroundColor:"rgba(0,0,0,0.1)",borderRadius:4},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.3)",borderRadius:4,"&:hover":{backgroundColor:"rgba(0,0,0,0.5)"}}},children:(()=>{const ne=E.reduce((ee,H)=>{const Q=H.exchange||"Unknown";ee[Q]||(ee[Q]={exchange:Q,totalTrades:0,totalVolume:0,totalFees:0,totalRealizedPL:0,buyVolume:0,sellVolume:0,buyTrades:0,sellTrades:0});const Z=Number(H.totalValue)||0,J=(Number(H.fee)||0)+(Number(H.tax)||0),ae=Number(H.realizedPl)||0;return ee[Q].totalTrades+=1,ee[Q].totalVolume+=Z,ee[Q].totalFees+=J,ee[Q].totalRealizedPL+=ae,H.side===nn.BUY?(ee[Q].buyVolume+=Z,ee[Q].buyTrades+=1):(ee[Q].sellVolume+=Z,ee[Q].sellTrades+=1),ee},{}),oe=Object.values(ne).sort((ee,H)=>H.totalVolume-ee.totalVolume);return A==="grid"?e.jsxs(W,{container:!0,spacing:h?1:3,sx:{minWidth:800},children:[oe.map(ee=>e.jsx(W,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(se,{variant:"outlined",sx:{height:"100%",background:"rgba(255, 255, 255, 0.6)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"text.primary",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)","&:hover":{transform:"translateY(-2px)",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)",background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(15px)",border:"1px solid rgba(59, 130, 246, 0.3)"},transition:"all 0.3s ease-in-out"},children:e.jsxs(me,{sx:{p:h?1:2},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:h?.5:1},children:e.jsx(c,{variant:h?"cardLabel":"cardTitle",fontWeight:"600",sx:{color:"primary.main",textShadow:"0 1px 2px rgba(0, 0, 0, 0.1)",letterSpacing:"0.025em"},children:ee.exchange})}),e.jsxs(l,{sx:{mb:h?1:2,textAlign:"center"},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:h?.5:1},children:e.jsx(c,{variant:h?"cardValueSmall":"cardValue",fontWeight:"700",sx:{color:"#1e293b",textShadow:"0 1px 2px rgba(0, 0, 0, 0.1)",letterSpacing:"-0.025em"},children:G(ee.totalVolume)})}),e.jsx(c,{variant:"labelSmall",sx:{color:"#64748b",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.05em"},children:x("trading.totalVolume")})]}),e.jsxs(l,{sx:{mt:h?1:2,display:"flex",flexDirection:"column",gap:h?1:1.5},children:[e.jsxs(l,{sx:{display:"flex",gap:h?1:1.5},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:h?.5:1,p:h?1:1.5,background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(5px)",borderRadius:2,flex:1,border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[e.jsx(Zt,{sx:{color:"#3b82f6",fontSize:16,filter:"drop-shadow(0 1px 1px rgba(0, 0, 0, 0.1))"}}),e.jsxs(l,{children:[e.jsx(c,{variant:"labelXSmall",sx:{color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em",lineHeight:1.2},children:x("trading.trades")}),e.jsx(c,{variant:"labelXSmall",sx:{color:"#1e293b",fontWeight:700,lineHeight:1.2,textShadow:"0 1px 1px rgba(0, 0, 0, 0.1)"},children:ee.totalTrades})]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:h?.5:1,p:h?1:1.5,background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(5px)",borderRadius:2,flex:1,border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[e.jsx(qt,{sx:{color:"#f59e0b",fontSize:16,filter:"drop-shadow(0 1px 1px rgba(0, 0, 0, 0.1))"}}),e.jsxs(l,{children:[e.jsx(c,{variant:"labelXSmall",sx:{color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em",lineHeight:1.2},children:x("trading.fees")}),e.jsx(c,{variant:"labelXSmall",sx:{color:"#1e293b",fontWeight:700,lineHeight:1.2,textShadow:"0 1px 1px rgba(0, 0, 0, 0.1)"},children:G(ee.totalFees)})]})]})]}),e.jsxs(l,{sx:{display:"flex",gap:h?1:1.5},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:h?.5:1,p:h?1:1.5,background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(5px)",borderRadius:2,flex:1,border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[ee.totalRealizedPL>=0?e.jsx(He,{sx:{color:"#16a34a",fontSize:16,filter:"drop-shadow(0 1px 1px rgba(0, 0, 0, 0.1))"}}):e.jsx(Bt,{sx:{color:"#dc2626",fontSize:16,filter:"drop-shadow(0 1px 1px rgba(0, 0, 0, 0.1))"}}),e.jsxs(l,{children:[e.jsx(c,{variant:"labelXSmall",sx:{color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em",lineHeight:1.2},children:x("trading.pl")}),e.jsx(c,{variant:"labelXSmall",sx:{color:ee.totalRealizedPL>=0?"#16a34a":"#dc2626",fontWeight:700,lineHeight:1.2,textShadow:"0 1px 1px rgba(0, 0, 0, 0.1)"},children:G(ee.totalRealizedPL)})]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:h?.5:1,p:h?1:1.5,background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(5px)",borderRadius:2,flex:1,border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[e.jsx(ar,{sx:{color:"#8b5cf6",fontSize:16,filter:"drop-shadow(0 1px 1px rgba(0, 0, 0, 0.1))"}}),e.jsxs(l,{children:[e.jsx(c,{variant:"labelXSmall",sx:{color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em",lineHeight:1.2},children:x("trading.return")}),e.jsxs(c,{variant:"labelXSmall",sx:{color:"#1e293b",fontWeight:700,lineHeight:1.2,textShadow:"0 1px 1px rgba(0, 0, 0, 0.1)"},children:[ee.totalVolume>0?(ee.totalRealizedPL/ee.totalVolume*100).toFixed(1):0,"%"]})]})]})]})]}),e.jsxs(l,{sx:{mt:h?1:2,display:"flex",justifyContent:"space-between",alignItems:"center",gap:h?1:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,p:1.5,background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(5px)",borderRadius:2,flex:1,border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[e.jsx(He,{sx:{color:"#16a34a",fontSize:16,filter:"drop-shadow(0 1px 1px rgba(0, 0, 0, 0.1))"}}),e.jsxs(l,{children:[e.jsxs(c,{variant:"labelXSmall",sx:{color:"#16a34a",textTransform:"uppercase",lineHeight:1.2,textShadow:"0 1px 1px rgba(0, 0, 0, 0.1)"},children:[ee.buyTrades," ",x("trading.buy")]}),e.jsx(c,{variant:"labelXSmall",sx:{color:"#64748b",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.05em"},children:G(ee.buyVolume)})]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,p:1.5,background:"rgba(255, 255, 255, 0.8)",backdropFilter:"blur(5px)",borderRadius:2,flex:1,border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)"},children:[e.jsx(Bt,{sx:{color:"#dc2626",fontSize:16,filter:"drop-shadow(0 1px 1px rgba(0, 0, 0, 0.1))"}}),e.jsxs(l,{children:[e.jsxs(c,{variant:"labelXSmall",sx:{color:"#dc2626",textTransform:"uppercase",lineHeight:1.2,textShadow:"0 1px 1px rgba(0, 0, 0, 0.1)"},children:[ee.sellTrades," ",x("trading.sell")]}),e.jsx(c,{variant:"labelXSmall",sx:{color:"#64748b",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.05em"},children:G(ee.sellVolume)})]})]})]})]})})},ee.exchange)),oe.length===0&&e.jsx(W,{item:!0,xs:12,children:e.jsxs(se,{variant:"outlined",sx:{textAlign:"center",py:4},children:[e.jsx(c,{variant:"cardTitle",color:"text.secondary",children:x("trading.noExchangeData")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:x("trading.exchangeInfoDescription")})]})})]}):e.jsx(l,{children:oe.length===0?e.jsxs(se,{variant:"outlined",sx:{textAlign:"center",py:h?2:4},children:[e.jsx(c,{variant:h?"cardLabel":"cardTitle",color:"text.secondary",children:x("trading.noExchangeData")}),e.jsx(c,{variant:h?"labelSmall":"cardLabel",color:"text.secondary",children:x("trading.exchangeInfoDescription")})]}):e.jsx(at,{component:Te,variant:"outlined",sx:{borderRadius:2,width:"auto"},children:e.jsxs(it,{size:h?"small":"medium",sx:{width:"auto",maxWidth:"100%"},children:[e.jsx(ct,{children:e.jsxs(De,{sx:{bgcolor:"grey.50"},children:[e.jsx(S,{sx:{fontWeight:600,color:"text.primary",py:h?.5:1},children:x("trading.exchange")}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary",py:h?.5:1},children:x("trading.totalVolume")}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary",py:h?.5:1},children:x("trading.trades")}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary",py:h?.5:1},children:x("trading.fees")}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary",py:h?.5:1},children:x("trading.pl")}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary",py:h?.5:1},children:x("trading.returnPercent")}),e.jsx(S,{align:"center",sx:{fontWeight:600,color:"text.primary",py:h?.5:1},children:x("trading.buy")}),e.jsx(S,{align:"center",sx:{fontWeight:600,color:"text.primary",py:h?.5:1},children:x("trading.sell")})]})}),e.jsx(ot,{children:oe.map(ee=>e.jsxs(De,{hover:!0,sx:{"&:hover":{bgcolor:"action.hover"},"&:last-child td":{borderBottom:0}},children:[e.jsx(S,{sx:{py:h?.5:1},children:e.jsx(l,{children:e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:ee.exchange})})}),e.jsx(S,{align:"right",sx:{py:h?.5:1},children:e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:G(ee.totalVolume)})}),e.jsx(S,{align:"right",sx:{py:h?.5:1},children:e.jsx(c,{variant:"tableCell",children:ee.totalTrades})}),e.jsx(S,{align:"right",sx:{py:h?.5:1},children:e.jsx(c,{variant:"tableCell",children:G(ee.totalFees)})}),e.jsx(S,{align:"right",sx:{py:h?.5:1},children:e.jsx(c,{variant:"tableCell",fontWeight:"medium",color:ee.totalRealizedPL>=0?"success.main":"error.main",children:G(ee.totalRealizedPL)})}),e.jsx(S,{align:"right",sx:{py:h?.5:1},children:e.jsxs(c,{variant:"tableCell",fontWeight:"medium",children:[ee.totalVolume>0?(ee.totalRealizedPL/ee.totalVolume*100).toFixed(1):0,"%"]})}),e.jsx(S,{align:"center",sx:{py:h?.5:1},children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:ee.buyTrades}),e.jsx(c,{variant:"labelXSmall",color:"text.secondary",children:G(ee.buyVolume)})]})}),e.jsx(S,{align:"center",sx:{py:h?.5:1},children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:ee.sellTrades}),e.jsx(c,{variant:"labelXSmall",color:"text.secondary",children:G(ee.sellVolume)})]})})]},ee.exchange))})]})})})})()}),e.jsxs(l,{sx:{mb:h?1.5:3,overflowX:"auto !important",maxWidth:"100%",width:"100%","&::-webkit-scrollbar":{height:8},"&::-webkit-scrollbar-track":{backgroundColor:"rgba(0,0,0,0.1)",borderRadius:4},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.3)",borderRadius:4,"&:hover":{backgroundColor:"rgba(0,0,0,0.5)"}}},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:h?.5:2,children:[e.jsx(c,{variant:"pageTitle",sx:{fontSize:h?"0.9rem":void 0},children:x("trading.tradeHistory")}),e.jsx(l,{display:"flex",gap:1,alignItems:"center",children:e.jsx(he,{size:"small",variant:"outlined",icon:e.jsx(Ir,{}),mobileText:x("common.filter"),desktopText:x("common.filter"),onClick:()=>N(!z),color:z?"primary":"inherit",children:x("common.filter")})})]}),z&&e.jsx(l,{sx:{mb:2,p:2,border:"1px solid",borderColor:"divider",borderRadius:2,backgroundColor:"background.paper"},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(l,{children:e.jsx(Ae,{fullWidth:!0,size:"small",placeholder:x("trading.searchPlaceholder"),value:y,onChange:ne=>j(ne.target.value),InputProps:{startAdornment:e.jsx($n,{sx:{mr:1,color:"text.secondary"}})},sx:{minWidth:300,maxWidth:400,"& .MuiOutlinedInput-root":{borderRadius:2}}})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(l,{children:e.jsxs(nt,{size:"small",sx:{minWidth:200,maxWidth:300},children:[e.jsx(st,{children:x("trading.side")}),e.jsxs(Ze,{value:b,label:x("trading.side"),onChange:ne=>v(ne.target.value),sx:{borderRadius:2},children:[e.jsx(re,{value:"ALL",children:x("trading.allSides")}),e.jsx(re,{value:nn.BUY,children:x("trading.buy")}),e.jsx(re,{value:nn.SELL,children:x("trading.sell")})]})]})})})]})}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,flexWrap:"wrap",children:[e.jsxs(l,{display:"flex",gap:1,alignItems:"center",flexWrap:"wrap",children:[e.jsx(he,{variant:"text",icon:e.jsx(Rr,{}),mobileText:x("common.group"),desktopText:x("common.groupByDate"),onClick:()=>I(!O),size:"small",sx:{textTransform:"none",fontSize:"0.75rem",minWidth:"auto",px:1,py:.5,color:O?"primary.main":"text.secondary","&:hover":{backgroundColor:"action.hover",color:O?"primary.dark":"text.primary"}},children:x("trading.groupByDate")}),O&&Object.keys(R).length>1&&e.jsx(he,{size:"small",variant:"text",icon:T.size===Object.keys(R).length?e.jsx(ln,{}):e.jsx(Dn,{}),mobileText:T.size===Object.keys(R).length?x("trading.expand"):x("trading.collapse"),desktopText:T.size===Object.keys(R).length?x("trading.expandAll"):x("trading.collapseAll"),onClick:F,sx:{textTransform:"none",fontSize:"0.75rem",minWidth:"auto",px:1,py:.5,color:"text.secondary","&:hover":{backgroundColor:"action.hover",color:"text.primary"}},children:T.size===Object.keys(R).length?x("trading.expandAll"):x("trading.collapseAll")})]}),e.jsxs(c,{variant:"formHelper",children:[x("trading.total"),": ",e.jsx("strong",{children:E.length})," ",x("trading.trades")]})]})]}),e.jsx(at,{component:Te,variant:"outlined",sx:{borderRadius:2,mb:h?2:3,boxShadow:1,overflowX:"auto !important",maxWidth:"100%",width:"100%","&::-webkit-scrollbar":{height:8},"&::-webkit-scrollbar-track":{backgroundColor:"rgba(0,0,0,0.1)",borderRadius:4},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.3)",borderRadius:4,"&:hover":{backgroundColor:"rgba(0,0,0,0.5)"}}},children:e.jsxs(it,{sx:{width:"100%",tableLayout:"auto"},children:[e.jsx(ct,{children:e.jsxs(De,{sx:{bgcolor:"grey.50"},children:[e.jsx(S,{sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.date},children:x("tables.date")}),e.jsx(S,{sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.asset},children:x("trading.asset")}),e.jsx(S,{sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.side},children:x("trading.side")}),e.jsx(S,{sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.exchange,display:{xs:"none",sm:"table-cell"}},children:x("trading.exchange")}),e.jsx(S,{sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.fundingSource,display:{xs:"none",sm:"table-cell"}},children:x("trading.fundingSource")}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.quantity},children:x("common.quantity")}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.price},children:x("common.price")}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.totalValue},children:x("trading.totalValue")}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.fees},children:x("trading.fees")}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.totalCost},children:x("trading.totalCost")}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.pl},children:x("trading.pl")}),e.jsx(S,{align:"center",sx:{fontWeight:600,color:"text.primary",py:h?1:2,...X.actions},children:x("tables.actions")})]})}),e.jsx(ot,{children:t?e.jsx(De,{children:e.jsx(S,{colSpan:12,align:"center",sx:{py:6},children:e.jsxs(l,{display:"flex",flexDirection:"column",alignItems:"center",gap:2,children:[e.jsx(Ce,{size:40}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:x("trading.loadingTrades")})]})})}):E.length===0?e.jsx(De,{children:e.jsx(S,{colSpan:12,align:"center",sx:{py:6},children:e.jsxs(l,{display:"flex",flexDirection:"column",alignItems:"center",gap:2,children:[e.jsx(c,{variant:"cardTitle",color:"text.secondary",children:x("trading.noTradesFound")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:x("trading.noTradesMatchFilter")}),e.jsx(We,{variant:"outlined",icon:e.jsx(xt,{}),onClick:i,mobileText:x("common.add"),desktopText:x("common.createFirstTrade"),sx:{mt:1},children:x("trading.createFirstTrade")})]})})}):Object.entries(R).map(([ne,oe])=>e.jsxs(rt.Fragment,{children:[O&&e.jsx(De,{sx:{bgcolor:"grey.100","&:hover":{bgcolor:"grey.200"},cursor:"pointer"},onClick:()=>V(ne),children:e.jsx(S,{colSpan:12,sx:{py:h?1:1.5,borderBottom:"2px solid",borderBottomColor:"primary.main"},children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Rr,{sx:{fontSize:16,color:"primary.main"}}),e.jsx(c,{variant:"cardTitle",fontWeight:"600",color:"primary.main",children:ne}),e.jsxs(c,{variant:"labelSmall",color:"text.secondary",children:["(",oe.length," ",oe.length===1?x("trading.trade"):x("trading.trades"),")"]})]}),e.jsx(l,{display:"flex",alignItems:"center",gap:1,children:T.has(ne)?e.jsx(ln,{sx:{fontSize:20,color:"text.secondary"}}):e.jsx(Dn,{sx:{fontSize:20,color:"text.secondary"}})})]})})}),!T.has(ne)&&oe.map(ee=>{var H,Q;return e.jsxs(De,{hover:!0,onClick:()=>a==null?void 0:a(ee),sx:{"&:hover":{bgcolor:"action.hover",cursor:"pointer"},"&:last-child td":{borderBottom:0}},children:[e.jsxs(S,{sx:{py:h?1:2,...X.date},children:[e.jsx(c,{variant:"tableCell",children:fn(_r(ee.tradeDate.toString()),"MMM dd, yyyy")}),e.jsx(c,{variant:"labelXSmall",color:"text.secondary",children:fn(_r(ee.tradeDate.toString()),"HH:mm")})]}),e.jsx(S,{sx:{py:h?1:2,...X.asset},children:e.jsxs(l,{children:[e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:ee.assetSymbol||((H=ee.asset)==null?void 0:H.symbol)||"N/A"}),e.jsx(c,{variant:"labelXSmall",color:"text.secondary",sx:{display:{xs:"none",sm:"block"}},children:ee.assetName||((Q=ee.asset)==null?void 0:Q.name)||"N/A"})]})}),e.jsx(S,{sx:{py:h?1:2,...X.side},children:e.jsx(ce,{label:ee.side,color:_(ee.side),size:"small",icon:K(ee.side),sx:{fontWeight:600,"& .MuiChip-icon":{marginLeft:.5}}})}),e.jsx(S,{sx:{py:h?1:2,...X.exchange,display:{xs:"none",sm:"table-cell"}},children:e.jsx(c,{variant:"tableCell",color:"text.secondary",children:ee.exchange||"-"})}),e.jsx(S,{sx:{py:h?1:2,...X.fundingSource,display:{xs:"none",sm:"table-cell"}},children:e.jsx(c,{variant:"tableCell",color:"text.secondary",children:ee.fundingSource||"-"})}),e.jsx(S,{align:"right",sx:{py:h?1:2,...X.quantity},children:e.jsx(c,{variant:"tableCell",children:dn(ee.quantity,2)})}),e.jsx(S,{align:"right",sx:{py:h?1:2,...X.price},children:e.jsx(c,{variant:"tableCell",children:G(ee.price)})}),e.jsx(S,{align:"right",sx:{py:h?1:2,...X.totalValue},children:e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:G(Number(ee.totalValue)||ee.quantity*ee.price)})}),e.jsx(S,{align:"right",sx:{py:h?1:2,...X.fees},children:e.jsx(c,{variant:"tableCell",children:G((Number(ee.fee)||0)+(Number(ee.tax)||0))})}),e.jsx(S,{align:"right",sx:{py:h?1:2,...X.totalCost},children:e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:G(Number(ee.totalCost)||ee.quantity*ee.price+(Number(ee.fee)||0)+(Number(ee.tax)||0))})}),e.jsx(S,{align:"right",sx:{py:h?1:2,...X.pl},children:ee.realizedPl!==void 0&&e.jsx(c,{variant:"tableCell",color:ee.realizedPl>=0?"success.main":"error.main",fontWeight:"medium",children:G(Number(ee.realizedPl)||0)})}),e.jsx(S,{align:"center",sx:{py:h?1:2,...X.actions},children:e.jsx(Fe,{title:x("tables.actions"),children:e.jsx(Ie,{size:h?"small":"medium",onClick:Z=>B(Z,ee),sx:{"&:hover":{bgcolor:"primary.main",color:"white"}},children:e.jsx(wr,{})})})})]},ee.tradeId)})]},ne))})]})}),u>1&&e.jsx(l,{display:"flex",justifyContent:"center",mt:h?2:3,children:e.jsx(la,{count:u,page:d,onChange:(ne,oe)=>o==null?void 0:o(oe),color:"primary",shape:"rounded",size:h?"medium":"large"})}),e.jsxs(Gn,{anchorEl:P,open:!!P,onClose:$,PaperProps:{sx:{borderRadius:2,boxShadow:3,minWidth:160}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[e.jsxs(re,{onClick:()=>Y("view"),sx:{py:1.5},children:[e.jsx(tt,{children:e.jsx(Xt,{fontSize:"small",color:"primary"})}),e.jsx(ve,{children:x("trading.viewDetails")})]}),e.jsxs(re,{onClick:()=>Y("edit"),disabled:m,sx:{py:1.5},children:[e.jsx(tt,{children:e.jsx(Tt,{fontSize:"small",color:"primary"})}),e.jsx(ve,{children:x("trading.editTrade")})]}),e.jsxs(re,{onClick:()=>Y("delete"),disabled:m,sx:{py:1.5,color:"error.main"},children:[e.jsx(tt,{children:e.jsx(pt,{fontSize:"small",color:"error"})}),e.jsx(ve,{children:x("trading.deleteTrade")})]})]})]})},jx=({portfolioId:r,onCreate:t,isCompactMode:n=!1,isReadOnly:s=!1})=>{var E,R;const{t:a}=Ne(),[i,o]=p.useState({assetId:"",side:"",startDate:"",endDate:""}),[d,u]=p.useState(!1),[h,m]=p.useState(!1),[x,g]=p.useState(!1),[f,y]=p.useState(null),{data:j,isLoading:b,error:v}=Gc(r,i),P=OC(),w=zC(),{data:C,isLoading:k,error:A}=VC((f==null?void 0:f.tradeId)||""),L=V=>{o(V)},T=V=>{y(V),u(!0)},M=V=>{y(V),m(!0)},O=V=>{y(V),g(!0)},I=async()=>{if(f)try{await P.mutateAsync(f.tradeId),g(!1),y(null)}catch(V){console.error("Error deleting trade:",V)}},z=()=>{u(!1),m(!1),g(!1),y(null)},N=()=>{t&&t()};return b?e.jsxs(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400,children:[e.jsx(Ce,{}),e.jsx(c,{variant:"cardLabel",sx:{ml:2},children:a("trading.loadingTrades")})]}):v?e.jsx(je,{severity:"error",children:(v==null?void 0:v.message)||a("trading.failedToLoadTrades")}):e.jsxs(l,{children:[e.jsx(t2,{trades:j||[],isLoading:b,error:v==null?void 0:v.message,onEdit:T,onView:M,onDelete:O,onCreate:N,onFiltersChange:L,filters:i,isCompactMode:n,isReadOnly:s}),e.jsx(Xk,{open:d,onClose:z,onSubmit:async V=>{if(f)try{await w.mutateAsync({id:f.tradeId,data:{...V,tradeDate:V.tradeDate}}),z()}catch(F){console.error("Error updating trade:",F)}},initialData:f?{...f,tradeDate:typeof f.tradeDate=="string"?f.tradeDate:f.tradeDate.toISOString()}:void 0,isLoading:w.isLoading,error:(E=w.error)==null?void 0:E.message}),e.jsx(Zk,{open:h,onClose:z,onEdit:T,trade:f,tradeDetails:(C==null?void 0:C.tradeDetails)||[],isLoading:k,error:typeof A=="object"&&A!==null&&"message"in A?A.message:void 0}),e.jsx(e2,{open:x,onClose:z,onConfirm:I,title:a("trading.deleteTrade"),message:a("trading.deleteTradeConfirm",{asset:(f==null?void 0:f.assetSymbol)||((R=f==null?void 0:f.asset)==null?void 0:R.symbol)||a("common.thisAsset")}),confirmText:a("common.delete"),cancelText:a("common.cancel"),type:"delete",isLoading:P.isLoading,confirmColor:"error"})]})},n2=({portfolioId:r,isCompactMode:t,onCreateTrade:n})=>e.jsx(l,{sx:{backgroundColor:"background.paper",minHeight:"80vh",pt:0,px:t?1:2},children:e.jsx(l,{sx:{mb:t?2:4},children:e.jsx(jx,{portfolioId:r,onCreate:n,isCompactMode:t})})}),r2=({portfolioId:r,compact:t=!1})=>{const{t:n}=Ne(),[s,a]=p.useState(0),[i,o]=p.useState(!1),[d,u]=p.useState(!1),[h,m]=p.useState(!1),[x,g]=p.useState(null),[f,y]=p.useState(null),j=Kt(),{data:b,isLoading:v,error:P}=yt(["deposits",r],()=>q.getPortfolioDeposits(r),{enabled:!!r}),w=Array.isArray(b)?b:[],{data:C}=yt(["deposit-analytics",r],()=>q.getPortfolioDepositAnalytics(r),{enabled:!!r}),k=jt($=>q.createDeposit($),{onSuccess:()=>{j.invalidateQueries(["deposits",r]),j.invalidateQueries(["deposit-analytics",r]),wt.success(n("deposit.createSuccess")),o(!1)},onError:$=>{var Y,_;wt.error(((_=(Y=$.response)==null?void 0:Y.data)==null?void 0:_.message)||n("deposit.createError"))}}),A=jt(({id:$,data:Y})=>q.updateDeposit($,Y),{onSuccess:()=>{j.invalidateQueries(["deposits",r]),j.invalidateQueries(["deposit-analytics",r]),wt.success(n("deposit.updateSuccess")),o(!1),y(null)},onError:$=>{var Y,_;wt.error(((_=(Y=$.response)==null?void 0:Y.data)==null?void 0:_.message)||n("deposit.updateError"))}}),L=jt(({id:$,data:Y})=>q.settleDeposit($,Y),{onSuccess:()=>{j.invalidateQueries(["deposits",r]),j.invalidateQueries(["deposit-analytics",r]),wt.success(n("deposit.settleSuccess")),u(!1),g(null)},onError:$=>{var Y,_;wt.error(((_=(Y=$.response)==null?void 0:Y.data)==null?void 0:_.message)||n("deposit.settleError"))}}),T=jt($=>q.deleteDeposit($),{onSuccess:()=>{j.invalidateQueries(["deposits",r]),j.invalidateQueries(["deposit-analytics",r]),wt.success(n("deposit.deleteSuccess"))},onError:$=>{var Y,_;wt.error(((_=(Y=$.response)==null?void 0:Y.data)==null?void 0:_.message)||n("deposit.deleteError"))}}),M=$=>{k.mutate($)},O=$=>{f&&A.mutate({id:f.depositId,data:$})},I=$=>{x&&L.mutate({id:x.depositId,data:$})},z=$=>{T.mutate($.depositId||"")},N=$=>{y($),o(!0)},E=$=>{g($),u(!0)},R=$=>{g($),m(!0)},V=w.filter($=>$.status==="ACTIVE"),F=w.filter($=>$.status==="SETTLED"),B=w.filter($=>$.isMatured&&$.status==="ACTIVE");return P?e.jsx(je,{severity:"error",sx:{mt:2},children:n("deposit.loadError")}):e.jsxs(l,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:t?2:3,children:[e.jsx(c,{variant:t?"h5":"h4",fontWeight:"bold",sx:{fontSize:t?"1.1rem":void 0},children:n("deposit.management")}),e.jsx(he,{variant:"contained",icon:e.jsx(xt,{}),mobileText:n("deposit.createNew"),desktopText:n("deposit.createNewDeposit"),onClick:()=>o(!0),disabled:k.isLoading,size:t?"small":"medium",sx:{px:t?1.5:2,py:t?.5:1,fontSize:t?"0.8rem":void 0},children:n(t?"deposit.createNew":"deposit.createNewDeposit")})]}),C&&e.jsxs(W,{container:!0,spacing:t?1.5:2,mb:t?2:3,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%"},children:e.jsxs(me,{sx:{px:t?1.5:2,py:t?1:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:t?.5:1,mb:t?1:2,children:[e.jsx(Ue,{color:"primary",sx:{fontSize:t?18:24}}),e.jsx(c,{variant:t?"subtitle1":"h6",fontWeight:"bold",sx:{fontSize:t?"0.9rem":void 0},children:n("deposit.overview")})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("deposit.totalDeposits"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",children:(C==null?void 0:C.totalDeposits)||0})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("deposit.activeDeposits"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",color:"info.main",children:(C==null?void 0:C.activeDeposits)||0})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("deposit.settledDeposits"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",color:"warning.main",children:(C==null?void 0:C.settledDeposits)||0})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%"},children:e.jsxs(me,{sx:{px:t?1.5:2,py:t?1:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:t?.5:1,mb:t?1:2,children:[e.jsx(He,{color:"success",sx:{fontSize:t?18:24}}),e.jsx(c,{variant:t?"subtitle1":"h6",fontWeight:"bold",sx:{fontSize:t?"0.9rem":void 0},children:n("deposit.totalValue")})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("deposit.totalValue"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"bold",color:"success.main",children:G(C==null?void 0:C.totalValue)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("deposit.totalPrincipal"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",children:G((C==null?void 0:C.totalPrincipal)||0)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("deposit.averageInterestRate"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",color:"secondary.main",children:C!=null&&C.averageInterestRate?`${ye(C.averageInterestRate)}`:"N/A"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%"},children:e.jsxs(me,{sx:{px:t?1.5:2,py:t?1:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:t?.5:1,mb:t?1:2,children:[e.jsx(Xe,{color:"success",sx:{fontSize:t?18:24}}),e.jsx(c,{variant:t?"subtitle1":"h6",fontWeight:"bold",sx:{fontSize:t?"0.9rem":void 0},children:n("deposit.settledInterest")})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("deposit.settledInterest"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"bold",color:"success.main",children:G((C==null?void 0:C.totalSettledInterest)||0)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("common.quantity"),":"]}),e.jsxs(c,{variant:"body2",fontWeight:"medium",color:"warning.main",children:[(C==null?void 0:C.settledDeposits)||0," deposits"]})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("deposit.average"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",children:C!=null&&C.settledDeposits?G(((C==null?void 0:C.totalSettledInterest)||0)/C.settledDeposits):"N/A"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%"},children:e.jsxs(me,{sx:{px:t?1.5:2,py:t?1:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:t?.5:1,mb:t?1:2,children:[e.jsx(He,{color:"primary",sx:{fontSize:t?18:24}}),e.jsx(c,{variant:t?"subtitle1":"h6",fontWeight:"bold",sx:{fontSize:t?"0.9rem":void 0},children:n("deposit.accruedInterest")})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("deposit.accruedInterest"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"bold",color:"primary.main",children:G((C==null?void 0:C.totalAccruedInterest)||0)})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("common.quantity"),":"]}),e.jsxs(c,{variant:"body2",fontWeight:"medium",color:"info.main",children:[(C==null?void 0:C.activeDeposits)||0," deposits"]})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[n("deposit.average"),":"]}),e.jsx(c,{variant:"body2",fontWeight:"medium",children:C!=null&&C.activeDeposits?G(((C==null?void 0:C.totalAccruedInterest)||0)/C.activeDeposits):"N/A"})]})]})})})]}),e.jsx(Te,{sx:{mb:t?1.5:2},children:e.jsxs(Tr,{value:s,onChange:($,Y)=>a(Y),sx:{px:t?1.5:2,"& .MuiTab-root":{fontSize:t?"0.8rem":void 0,py:t?1:1.5,px:t?1:2}},children:[e.jsx(ht,{label:`${n("deposit.all")} (${w.length})`}),e.jsx(ht,{label:`${n("deposit.active")} (${V.length})`}),e.jsx(ht,{label:`${n("deposit.settled")} (${F.length})`}),e.jsx(ht,{label:`${n("deposit.matured")} (${B.length})`})]})}),v?e.jsx(l,{display:"flex",justifyContent:"center",p:4,children:e.jsx(Ce,{})}):e.jsx(gx,{deposits:s===0?w:s===1?V:s===2?F:B,onEdit:N,onSettle:E,onDelete:z,onViewDetails:R}),e.jsx(Qc,{open:i,onClose:()=>{o(!1),y(null)},onSubmit:f?O:M,portfolioId:r,initialData:f?{portfolioId:f.portfolioId,bankName:f.bankName,accountNumber:f.accountNumber,principal:f.principal,interestRate:f.interestRate,startDate:f.startDate,endDate:f.endDate,termMonths:f.termMonths,notes:f.notes}:void 0,isEdit:!!f}),e.jsx(fx,{open:d,onClose:()=>{u(!1),g(null)},onSubmit:I,deposit:x}),e.jsx(yx,{open:h,onClose:()=>{m(!1),g(null)},deposit:x,onSettle:E,onEdit:N})]})},s2=({portfolioId:r,isCompactMode:t,getUltraSpacing:n})=>e.jsxs(l,{sx:{backgroundColor:"background.paper",minHeight:"80vh",pt:0,px:n(2,1)},children:[e.jsx(D,{variant:t?"h6":"h5",gutterBottom:!0,sx:{fontWeight:600,color:"#4a5568",mb:n(3,1.5),fontSize:t?"0.9rem":void 0,display:"flex",alignItems:"center",gap:1}}),e.jsx(l,{sx:{mb:n(4,2)},children:e.jsx(r2,{portfolioId:r,compact:t})})]}),Pu=({open:r,onClose:t,onSubmit:n,dialogType:s,editingCashFlow:a,loading:i,error:o,portfolioFundingSource:d=""})=>{const{t:u}=Ne(),h=g=>{switch(g){case"DEPOSIT":return"";case"WITHDRAWAL":return"";case"DIVIDEND":return"";case"INTEREST":return"";case"FEE":return"";case"TAX":return"";case"ADJUSTMENT":return"";case"BUY_TRADE":return"";case"SELL_TRADE":return"";case"DEPOSIT_SETTLEMENT":return"";case"DEPOSIT_CREATION":return"";default:return}},m=g=>["DEPOSIT","DIVIDEND","INTEREST","SELL_TRADE","DEPOSIT_SETTLEMENT"].includes(g),x=g=>m(g)?"success":"error";return e.jsx(Rt,{open:r,onClose:t,title:a?u("cashflow.modal.editTitle"):u("cashflow.modal.createTitle",{type:s.charAt(0).toUpperCase()+s.slice(1)}),icon:a?e.jsx(Tt,{color:"primary"}):h(s),maxWidth:"md",fullWidth:!0,loading:i,titleColor:a?"primary":x(s.toUpperCase())==="success"?"success":"error",children:e.jsx(rx,{onSubmit:n,onCancel:t,dialogType:s,editingCashFlow:a,loading:i,error:o,portfolioFundingSource:d,hideButtons:!1})})},a2=({open:r,onClose:t,onConfirm:n,cashFlowToDelete:s,loading:a,error:i})=>{const{t:o}=Ne();return e.jsx(Rt,{open:r,onClose:()=>{t()},title:o("cashflow.delete.title"),icon:e.jsx(pt,{color:"error"}),maxWidth:"sm",fullWidth:!0,loading:a,titleColor:"error",actions:e.jsxs(l,{sx:{display:"flex",gap:1},children:[e.jsx(he,{onClick:()=>{t()},mobileText:o("common.cancel"),desktopText:o("common.cancel"),children:o("common.cancel")}),e.jsx(he,{onClick:n,color:"error",variant:"contained",icon:a?null:e.jsx(pt,{}),mobileText:o(a?"cashflow.delete.deleting":"cashflow.delete.delete"),desktopText:o(a?"cashflow.delete.deleting":"cashflow.delete.delete"),disabled:a,children:o(a?"cashflow.delete.deleting":"cashflow.delete.delete")})]}),children:e.jsxs(l,{sx:{pt:1},children:[e.jsx(c,{variant:"tableCell",children:o("cashflow.delete.message")}),(s==null?void 0:s.status)==="CANCELLED"&&e.jsxs(je,{severity:"warning",sx:{mt:2,mb:2},children:[e.jsxs(c,{variant:"tableCell",children:[e.jsxs("strong",{children:[o("cashflow.delete.warning"),":"]})," ",o("cashflow.delete.cancelledWarning")]}),e.jsx(c,{variant:"formHelper",sx:{mt:1,display:"block"},children:o("cashflow.delete.cancelledHelper")})]}),i&&e.jsxs(je,{severity:"error",sx:{mt:2,mb:2},children:[e.jsxs(c,{variant:"tableCell",children:[e.jsxs("strong",{children:[o("cashflow.delete.error"),":"]})," ",i]}),e.jsx(c,{variant:"formHelper",sx:{mt:1,display:"block"},children:o("cashflow.delete.errorHelper")})]}),s&&e.jsxs(l,{sx:{mt:2,p:2,bgcolor:"grey.50",borderRadius:1},children:[e.jsxs(c,{variant:"tableCell",children:[e.jsxs("strong",{children:[o("cashflow.delete.type"),":"]})," ",s.type]}),e.jsxs(c,{variant:"tableCell",children:[e.jsxs("strong",{children:[o("cashflow.delete.amount"),":"]})," ",G(s.amount,s.currency)]}),e.jsxs(c,{variant:"tableCell",children:[e.jsxs("strong",{children:[o("cashflow.delete.description"),":"]})," ",s.description]}),e.jsxs(c,{variant:"tableCell",children:[e.jsxs("strong",{children:[o("cashflow.delete.status"),":"]})," ",s.status]})]})]})})},i2=({open:r,onClose:t,onSubmit:n,loading:s,error:a,portfolioId:i})=>{const{t:o}=Ne(),d=p.useRef(null),[u,h]=p.useState({fromSource:"",toSource:"",amount:0,description:"",transferDate:""}),m=async()=>{d.current&&d.current.requestSubmit()},x=()=>u.fromSource&&u.toSource&&u.amount>0&&u.fromSource!==u.toSource;return e.jsx(Rt,{open:r,onClose:()=>{t()},title:o("cashflow.transfer.title"),icon:e.jsx(yr,{color:"secondary"}),maxWidth:"md",fullWidth:!0,loading:s,titleColor:"secondary",actions:e.jsxs(l,{sx:{display:"flex",gap:1},children:[e.jsx(he,{onClick:()=>{t()},mobileText:o("common.cancel"),desktopText:o("common.cancel"),children:o("common.cancel")}),e.jsx(We,{onClick:m,variant:"contained",color:"secondary",icon:s?void 0:e.jsx(yr,{}),mobileText:o(s?"cashflow.transfer.transferring":"cashflow.transfer.transfer"),desktopText:o(s?"cashflow.transfer.transferring":"cashflow.transfer.transferCash"),disabled:s||!x(),forceTextOnly:!0,children:o(s?"cashflow.transfer.transferring":"cashflow.transfer.transferCash")})]}),children:e.jsx(l,{ref:d,children:e.jsx(sx,{onSubmit:n,loading:s,error:a,onDataChange:h,hideSubmitButton:!0,showActions:!1,portfolioId:i})})})},o2=`
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
`;if(typeof document<"u"){const r=document.createElement("style");r.textContent=o2,document.head.appendChild(r)}const l2=({portfolioId:r})=>{const{t}=Ne(),{accountId:n}=Ge(),s=Je(),a=Nt(s.breakpoints.down("md")),[i,o]=p.useState("bar"),[d,u]=p.useState("1y"),[h,m]=p.useState([]),[x,g]=p.useState([]),[f,y]=p.useState([]),[j,b]=p.useState(!1),v={deposits:"#4caf50",withdrawals:"#f44336",dividends:"#2196f3",interest:"#ff9800",netFlow:"#9c27b0",cumulative:"#ff5722",grid:"#e0e0e0",text:"#424242"};p.useEffect(()=>{P()},[r,d]);const P=async()=>{try{b(!0);const T=(await q.getPortfolioCashFlowHistory(r,n,{limit:1e3})).data||[];w(T),C(T),k(T)}catch(L){console.error("Error loading cash flow data:",L)}finally{b(!1)}},w=L=>{const T=d==="7d"?7:d==="30d"?30:d==="90d"?90:365,M=new Date;M.setDate(M.getDate()-T);const I=L.filter(E=>new Date(E.flowDate)>=M&&(E.status==="COMPLETED"||!E.status)).reduce((E,R)=>{const V=R.flowDate.split("T")[0];E[V]||(E[V]={date:V,deposits:0,withdrawals:0,dividends:0,netFlow:0});const F=parseFloat(R.amount);return R.type==="DEPOSIT"||R.type==="SELL_TRADE"||R.type==="DEPOSIT_SETTLEMENT"?E[V].deposits+=Math.abs(F):R.type==="WITHDRAWAL"||R.type==="BUY_TRADE"||R.type==="DEPOSIT_CREATION"?E[V].withdrawals+=Math.abs(F):R.type==="DIVIDEND"&&(E[V].dividends+=F),E[V].netFlow=E[V].deposits+E[V].dividends-E[V].withdrawals,E},{});let z=0;const N=Object.values(I).sort((E,R)=>new Date(E.date).getTime()-new Date(R.date).getTime()).map(E=>(z+=E.netFlow,{...E,cumulative:z}));m(N)},C=L=>{const T=d==="7d"?1:d==="30d"?3:d==="90d"?6:12,M=new Date;M.setMonth(M.getMonth()-T);const I=L.filter(N=>new Date(N.flowDate)>=M&&(N.status==="COMPLETED"||!N.status)).reduce((N,E)=>{const R=new Date(E.flowDate),V=`${R.getFullYear()}-${String(R.getMonth()+1).padStart(2,"0")}`;N[V]||(N[V]={month:V,deposits:0,withdrawals:0,dividends:0,netFlow:0});const F=parseFloat(E.amount);return E.type==="DEPOSIT"||E.type==="SELL_TRADE"||E.type==="DEPOSIT_SETTLEMENT"?N[V].deposits+=Math.abs(F):E.type==="WITHDRAWAL"||E.type==="BUY_TRADE"||E.type==="DEPOSIT_CREATION"?N[V].withdrawals+=Math.abs(F):E.type==="DIVIDEND"&&(N[V].dividends+=F),N[V].netFlow=N[V].deposits+N[V].dividends-N[V].withdrawals,N},{}),z=Object.values(I).sort((N,E)=>N.month.localeCompare(E.month));g(z)},k=L=>{const T=d==="7d"?7:d==="30d"?30:d==="90d"?90:365,M=new Date;M.setDate(M.getDate()-T);const I=L.filter(N=>new Date(N.flowDate)>=M&&(N.status==="COMPLETED"||!N.status)).reduce((N,E)=>{const R=parseFloat(E.amount);return E.type==="DEPOSIT"||E.type==="SELL_TRADE"||E.type==="DEPOSIT_SETTLEMENT"?N.deposits+=Math.abs(R):E.type==="WITHDRAWAL"||E.type==="BUY_TRADE"||E.type==="DEPOSIT_CREATION"?N.withdrawals+=Math.abs(R):E.type==="DIVIDEND"?N.dividends+=R:E.type==="INTEREST"&&(N.interest+=R),N},{deposits:0,withdrawals:0,dividends:0,interest:0}),z=[{name:t("cashflow.chart.deposits"),value:I.deposits,color:v.deposits},{name:t("cashflow.chart.withdrawals"),value:I.withdrawals,color:v.withdrawals},{name:t("cashflow.chart.dividends"),value:I.dividends,color:v.dividends},{name:t("cashflow.chart.interest"),value:I.interest,color:v.interest}].filter(N=>N.value>0);y(z)},A=()=>{if(j)return e.jsxs(l,{sx:{p:3},children:[e.jsxs(l,{display:"flex",alignItems:"center",mb:2,children:[e.jsx(Mt,{sx:{mr:1,animation:"spin 1s linear infinite"}}),e.jsx(D,{variant:"h6",children:t("cashflow.chart.loading")})]}),e.jsx($i,{variant:"rectangular",height:400,sx:{borderRadius:2}}),e.jsx(l,{mt:2,children:e.jsx(D,{variant:"body2",color:"text.secondary",children:t("cashflow.chart.fetchingData",{portfolioId:r})})})]});if(h.length===0&&x.length===0&&f.length===0)return e.jsx(l,{sx:{p:4,textAlign:"center"},children:e.jsxs(je,{severity:"info",icon:e.jsx(ya,{}),sx:{mb:2,"& .MuiAlert-message":{width:"100%"}},children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:t("cashflow.chart.noData.title")}),e.jsx(D,{variant:"body2",color:"text.secondary",children:t("cashflow.chart.noData.message")})]})});switch(i){case"line":return e.jsx(l,{children:e.jsx(Ln,{width:"100%",height:400,children:e.jsxs(To,{data:h,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"depositsGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:v.deposits,stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:v.deposits,stopOpacity:.1})]}),e.jsxs("linearGradient",{id:"withdrawalsGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:v.withdrawals,stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:v.withdrawals,stopOpacity:.1})]})]}),e.jsx(cr,{strokeDasharray:"3 3",stroke:v.grid,opacity:.3}),e.jsx(dr,{dataKey:"date",tick:{fontSize:12,fill:v.text},axisLine:{stroke:v.grid},tickLine:{stroke:v.grid}}),e.jsx(er,{tickFormatter:L=>G(L),tick:{fontSize:12,fill:v.text},axisLine:{stroke:v.grid},tickLine:{stroke:v.grid},hide:a}),e.jsx(En,{formatter:(L,T)=>[G(Number(L)),T],labelStyle:{color:v.text},contentStyle:{backgroundColor:"white",border:`1px solid ${v.grid}`,borderRadius:8,boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}}),e.jsx(ca,{wrapperStyle:{paddingTop:20}}),e.jsx(ri,{y:0,stroke:v.grid,strokeDasharray:"2 2"}),e.jsx(or,{type:"monotone",dataKey:"deposits",stroke:v.deposits,strokeWidth:3,dot:{fill:v.deposits,strokeWidth:2,r:4},activeDot:{r:6,stroke:v.deposits,strokeWidth:2}}),e.jsx(or,{type:"monotone",dataKey:"withdrawals",stroke:v.withdrawals,strokeWidth:3,dot:{fill:v.withdrawals,strokeWidth:2,r:4},activeDot:{r:6,stroke:v.withdrawals,strokeWidth:2}}),e.jsx(or,{type:"monotone",dataKey:"dividends",stroke:v.dividends,strokeWidth:3,dot:{fill:v.dividends,strokeWidth:2,r:4},activeDot:{r:6,stroke:v.dividends,strokeWidth:2}}),e.jsx(or,{type:"monotone",dataKey:"netFlow",stroke:v.netFlow,strokeWidth:4,dot:{fill:v.netFlow,strokeWidth:2,r:5},activeDot:{r:7,stroke:v.netFlow,strokeWidth:2}}),e.jsx(or,{type:"monotone",dataKey:"cumulative",stroke:v.cumulative,strokeWidth:3,strokeDasharray:"8 4",dot:{fill:v.cumulative,strokeWidth:2,r:4},activeDot:{r:6,stroke:v.cumulative,strokeWidth:2}})]})})});case"bar":return e.jsx(l,{children:e.jsx(Ln,{width:"100%",height:400,children:e.jsxs(ys,{data:x,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"depositsBar",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:v.deposits,stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:v.deposits,stopOpacity:.4})]}),e.jsxs("linearGradient",{id:"withdrawalsBar",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:v.withdrawals,stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:v.withdrawals,stopOpacity:.4})]}),e.jsxs("linearGradient",{id:"dividendsBar",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:v.dividends,stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:v.dividends,stopOpacity:.4})]})]}),e.jsx(cr,{strokeDasharray:"3 3",stroke:v.grid,opacity:.3}),e.jsx(dr,{dataKey:"month",tick:{fontSize:12,fill:v.text},axisLine:{stroke:v.grid},tickLine:{stroke:v.grid}}),e.jsx(er,{tickFormatter:L=>G(L),tick:{fontSize:12,fill:v.text},axisLine:{stroke:v.grid},tickLine:{stroke:v.grid},hide:a}),e.jsx(En,{formatter:(L,T)=>[G(Number(L)),T],labelStyle:{color:v.text},contentStyle:{backgroundColor:"white",border:`1px solid ${v.grid}`,borderRadius:8,boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}}),e.jsx(ca,{wrapperStyle:{paddingTop:20}}),e.jsx(ri,{y:0,stroke:v.grid,strokeDasharray:"2 2"}),e.jsx(br,{dataKey:"deposits",fill:"url(#depositsBar)",radius:[4,4,0,0],stroke:v.deposits,strokeWidth:1}),e.jsx(br,{dataKey:"withdrawals",fill:"url(#withdrawalsBar)",radius:[4,4,0,0],stroke:v.withdrawals,strokeWidth:1}),e.jsx(br,{dataKey:"dividends",fill:"url(#dividendsBar)",radius:[4,4,0,0],stroke:v.dividends,strokeWidth:1})]})})});case"pie":return e.jsx(l,{children:e.jsx(Ln,{width:"100%",height:400,children:e.jsxs(Co,{children:[e.jsx(ko,{data:f,cx:"50%",cy:"50%",labelLine:!1,label:({name:L,percent:T})=>`${L}: ${(T*100).toFixed(1)}%`,outerRadius:100,innerRadius:40,paddingAngle:2,dataKey:"value",children:f.map((L,T)=>e.jsx(Br,{fill:L.color,stroke:L.color,strokeWidth:2},`cell-${T}`))}),e.jsx(En,{formatter:(L,T)=>[G(Number(L)),T],contentStyle:{backgroundColor:"white",border:`1px solid ${v.grid}`,borderRadius:8,boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}}),e.jsx(ca,{verticalAlign:"bottom",height:36,wrapperStyle:{paddingTop:20}})]})})});default:return null}};return e.jsx(se,{sx:{borderRadius:3,boxShadow:"0 4px 20px rgba(0,0,0,0.08)",border:"1px solid rgba(0,0,0,0.05)"},children:e.jsxs(me,{sx:{p:3},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsxs(l,{children:[e.jsx(D,{variant:"h5",fontWeight:"600",color:"text.primary",gutterBottom:!0,children:t("cashflow.chart.title")}),e.jsx(D,{variant:"body2",color:"text.secondary",display:{xs:"none",sm:"block"},children:t("cashflow.chart.subtitle")})]}),e.jsxs(l,{display:"flex",gap:2,alignItems:"center",children:[e.jsx(Fe,{title:t("cashflow.chart.refresh"),children:e.jsx(Ie,{onClick:P,disabled:j,sx:{bgcolor:"primary.50","&:hover":{bgcolor:"primary.100"}},children:e.jsx(Mt,{})})}),e.jsxs(nt,{size:"small",sx:{display:{xs:"none",sm:"block"}},children:[e.jsx(st,{children:t("cashflow.chart.chartType")}),e.jsxs(Ze,{value:i,label:t("cashflow.chart.chartType"),onChange:L=>o(L.target.value),children:[e.jsx(re,{value:"line",children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(ya,{sx:{mr:1,fontSize:20}}),t("cashflow.chart.lineChart")]})}),e.jsx(re,{value:"bar",children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Qu,{sx:{mr:1,fontSize:20}}),t("cashflow.chart.barChart")]})}),e.jsx(re,{value:"pie",children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx($s,{sx:{mr:1,fontSize:20}}),t("cashflow.chart.pieChart")]})})]})]}),e.jsxs(nt,{size:"small",sx:{display:{xs:"none",sm:"block"}},children:[e.jsx(st,{children:t("cashflow.chart.timeRange")}),e.jsxs(Ze,{value:d,label:t("cashflow.chart.timeRange"),onChange:L=>u(L.target.value),children:[e.jsx(re,{value:"7d",children:t("cashflow.chart.last7Days")}),e.jsx(re,{value:"30d",children:t("cashflow.chart.last30Days")}),e.jsx(re,{value:"90d",children:t("cashflow.chart.last90Days")}),e.jsx(re,{value:"1y",children:t("cashflow.chart.lastYear")})]})]})]})]}),e.jsx(bt,{sx:{mb:3}}),A(),h.length>0&&e.jsx(l,{mt:2,children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsx(ce,{icon:e.jsx(He,{}),label:t("cashflow.chart.dataPoints",{count:h.length}),color:"primary",variant:"outlined",size:"small"})}),e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsx(ce,{icon:e.jsx(Ue,{}),label:t("cashflow.chart.view",{range:d.toUpperCase()}),color:"secondary",variant:"outlined",size:"small"})})]})})]})})},c2=({cashFlows:r,loading:t=!1,isCompactMode:n=!1,getUltraSpacing:s=a=>a})=>{const{t:a}=Ne(),[i,o]=rt.useState("list"),u=(()=>{const x=new Map;return r.filter(f=>f.status==="COMPLETED").forEach(f=>{const y=f.fundingSource||"UNKNOWN",j=["DEPOSIT","DIVIDEND","INTEREST","SELL_TRADE","DEPOSIT_SETTLEMENT"].includes(f.type);x.has(y)||x.set(y,{totalInflow:0,totalOutflow:0,transactionCount:0,lastTransactionDate:f.flowDate});const b=x.get(y);b.transactionCount+=1,j?b.totalInflow+=Math.abs(f.amount):b.totalOutflow+=Math.abs(f.amount),new Date(f.flowDate)>new Date(b.lastTransactionDate)&&(b.lastTransactionDate=f.flowDate)}),Array.from(x.entries()).map(([f,y])=>({source:f,totalInflow:y.totalInflow,totalOutflow:y.totalOutflow,netAmount:y.totalInflow-y.totalOutflow,transactionCount:y.transactionCount,lastTransactionDate:y.lastTransactionDate})).sort((f,y)=>Math.abs(y.netAmount)-Math.abs(f.netAmount))})(),h=x=>{const g=x.toLowerCase();return g.includes("bank")||g.includes("vietcombank")||g.includes("vcb")?e.jsx(Ue,{}):g.includes("wallet")||g.includes("cash")?e.jsx(qt,{}):g.includes("business")||g.includes("company")?e.jsx(ks,{}):g.includes("card")||g.includes("credit")?e.jsx(fp,{}):g.includes("savings")||g.includes("deposit")?e.jsx(Xu,{}):e.jsx(qt,{})},m=x=>new Date(x).toLocaleDateString("vi-VN",{year:"numeric",month:"short",day:"numeric"});return t?e.jsxs(l,{sx:{mb:s(3,1.5)},children:[e.jsx(c,{variant:n?"h6":"h5",gutterBottom:!0,sx:{fontWeight:600,color:"#4a5568",mb:s(2,1),fontSize:n?"0.9rem":void 0},children:a("cashflow.fundingSource.title")}),e.jsx(W,{container:!0,spacing:s(2,1),children:[1,2,3].map(x=>e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsx($i,{variant:"rectangular",height:60}),e.jsx($i,{variant:"text",width:"60%"}),e.jsx($i,{variant:"text",width:"40%"})]})})},x))})]}):u.length===0?e.jsxs(l,{sx:{mb:s(3,1.5)},children:[e.jsx(c,{variant:n?"h6":"h5",gutterBottom:!0,sx:{fontWeight:600,color:"#4a5568",mb:s(2,1),fontSize:n?"0.9rem":void 0},children:a("cashflow.fundingSource.title")}),e.jsx(je,{severity:"info",sx:{borderRadius:2},children:e.jsx(c,{variant:"body2",children:"No funding source data available. Add funding sources to your cash flows to see the summary."})})]}):e.jsx(l,{sx:{mb:s(4,2)},children:e.jsx(se,{sx:{background:"linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%)",border:"0.5px solid rgba(160, 174, 192, 0.1)",boxShadow:"0 2px 12px rgba(0, 0, 0, 0.03)",borderRadius:2,overflow:"hidden"},children:e.jsxs(me,{sx:{px:n?2:3,py:n?1.5:3},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:s(3,1.5),pb:n?1:2,borderBottom:"1px solid rgba(160, 174, 192, 0.08)"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:n?1:2},children:[e.jsx(l,{sx:{p:n?1:1.5,borderRadius:"50%",background:"linear-gradient(135deg, #4a5568 0%, #718096 100%)",boxShadow:"0 4px 12px rgba(74, 85, 104, 0.2)",width:n?36:48,height:n?36:48,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(qt,{sx:{color:"white",fontSize:n?18:24}})}),e.jsxs(l,{children:[e.jsx(c,{variant:n?"subtitle1":"h5",sx:{fontWeight:500,color:"#4a5568",fontSize:n?"0.9rem":"1.4rem",letterSpacing:"-0.01em"},children:a("cashflow.fundingSource.title")}),e.jsx(c,{variant:"body2",color:"text.secondary",sx:{fontSize:n?"0.7rem":void 0},children:a("cashflow.fundingSource.subtitle")})]})]}),e.jsxs(gp,{size:"small",variant:"outlined",sx:{"& .MuiButton-root":{borderRadius:2,textTransform:"none",fontWeight:400,px:n?1:2,py:n?.5:1,fontSize:n?"0.65rem":"0.75rem",borderColor:"rgba(160, 174, 192, 0.25)","&:hover":{borderColor:"#4a5568",backgroundColor:"rgba(74, 85, 104, 0.05)"}}},children:[e.jsx(he,{icon:e.jsx(vo,{}),onClick:()=>o("grid"),variant:i==="grid"?"contained":"outlined",mobileText:a("cashflow.fundingSource.grid"),desktopText:a("cashflow.fundingSource.grid"),sx:{backgroundColor:i==="grid"?"#4a5568":"transparent",color:i==="grid"?"white":"#718096","&:hover":{backgroundColor:i==="grid"?"#4a5568 !important":"transparent !important",color:i==="grid"?"white !important":"#718096 !important",transform:"none !important",boxShadow:"none !important"}},children:a(n?"cashflow.fundingSource.grid":"cashflow.fundingSource.gridView")}),e.jsx(he,{icon:e.jsx(wo,{}),onClick:()=>o("list"),variant:i==="list"?"contained":"outlined",mobileText:a("cashflow.fundingSource.list"),desktopText:a("cashflow.fundingSource.list"),sx:{backgroundColor:i==="list"?"#4a5568":"transparent",color:i==="list"?"white":"#718096","&:hover":{backgroundColor:i==="list"?"#4a5568 !important":"transparent !important",color:i==="list"?"white !important":"#718096 !important",transform:"none !important",boxShadow:"none !important"}},children:a(n?"cashflow.fundingSource.list":"cashflow.fundingSource.listView")})]})]}),i==="grid"?e.jsx(W,{container:!0,spacing:s(2,1),children:u.map(x=>e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(se,{sx:{height:"100%",background:x.netAmount>=0?"linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%)":"linear-gradient(135deg, #ffebee 0%, #fce4ec 100%)",border:`1px solid ${x.netAmount>=0?"#c8e6c9":"#ffcdd2"}`,transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:3}},children:e.jsxs(me,{sx:{p:s(2,1.5)},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:s(1.5,1)},children:[e.jsx(Vt,{sx:{bgcolor:x.netAmount>=0?"success.main":"error.main",mr:1,width:n?32:40,height:n?32:40},children:h(x.source)}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:n?"body2":"body1",fontWeight:"bold",noWrap:!0,sx:{color:"#4a5568",fontSize:n?"0.8rem":void 0},children:x.source}),e.jsxs(c,{variant:"caption",color:"text.secondary",sx:{fontSize:n?"0.7rem":void 0},children:[x.transactionCount," transactions"]})]})]}),e.jsx(bt,{sx:{mb:s(1.5,1)}}),e.jsxs(l,{sx:{mb:s(1,.5)},children:[e.jsx(c,{variant:"caption",color:"text.secondary",sx:{fontSize:n?"0.7rem":void 0},children:"Net Amount"}),e.jsx(c,{variant:n?"h6":"h5",fontWeight:"bold",sx:{color:x.netAmount>=0?"success.main":"error.main",fontSize:n?"1rem":void 0},children:G(x.netAmount)})]}),e.jsxs(W,{container:!0,spacing:1,children:[e.jsx(W,{item:!0,xs:6,children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:.5},children:[e.jsx(He,{sx:{color:"success.main",fontSize:n?16:20,mr:.5}}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{fontSize:n?"0.7rem":void 0},children:"Inflow"})]}),e.jsx(c,{variant:n?"body2":"body1",fontWeight:"bold",color:"success.main",sx:{fontSize:n?"0.8rem":void 0},children:G(x.totalInflow)})]})}),e.jsx(W,{item:!0,xs:6,children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:.5},children:[e.jsx(Bt,{sx:{color:"error.main",fontSize:n?16:20,mr:.5}}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{fontSize:n?"0.7rem":void 0},children:"Outflow"})]}),e.jsx(c,{variant:n?"body2":"body1",fontWeight:"bold",color:"error.main",sx:{fontSize:n?"0.8rem":void 0},children:G(x.totalOutflow)})]})})]}),e.jsx(l,{sx:{mt:s(1,.5),pt:s(1,.5),borderTop:"1px solid",borderColor:"divider"},children:e.jsxs(c,{variant:"caption",color:"text.secondary",sx:{fontSize:n?"0.7rem":void 0},children:[a("cashflow.fundingSource.lastTransaction"),": ",m(x.lastTransactionDate)]})})]})})},x.source))}):e.jsx(at,{component:Te,sx:{borderRadius:2},children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:"grey.50"},children:[e.jsx(S,{children:e.jsx("strong",{children:a("cashflow.fundingSource.fundingSource")})}),e.jsx(S,{align:"right",children:e.jsx("strong",{children:a("cashflow.fundingSource.netAmount")})}),e.jsx(S,{align:"right",children:e.jsx("strong",{children:a("cashflow.fundingSource.inflow")})}),e.jsx(S,{align:"right",children:e.jsx("strong",{children:a("cashflow.fundingSource.outflow")})}),e.jsx(S,{align:"center",children:e.jsx("strong",{children:a("cashflow.fundingSource.transactions")})}),e.jsx(S,{children:e.jsx("strong",{children:a("cashflow.fundingSource.lastTransaction")})})]})}),e.jsx(ot,{children:u.map(x=>e.jsxs(De,{hover:!0,children:[e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Vt,{sx:{bgcolor:x.netAmount>=0?"success.main":"error.main",mr:2,width:32,height:32},children:h(x.source)}),e.jsx(c,{variant:"body2",fontWeight:"bold",children:x.source})]})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"body2",fontWeight:"bold",color:x.netAmount>=0?"success.main":"error.main",children:G(x.netAmount)})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"body2",color:"success.main",fontWeight:"bold",children:G(x.totalInflow)})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"body2",color:"error.main",fontWeight:"bold",children:G(x.totalOutflow)})}),e.jsx(S,{align:"center",children:e.jsx(ce,{label:x.transactionCount,size:"small",color:"primary",variant:"outlined"})}),e.jsx(S,{children:e.jsx(c,{variant:"body2",color:"text.secondary",children:m(x.lastTransactionDate)})})]},x.source))})]})})]})})})},d2=({portfolioId:r,onCashFlowUpdate:t,compact:n=!1})=>{const s=Je(),a=Nt(s.breakpoints.down("md")),{t:i}=Ne(),{accountId:o}=Ge(),{portfolio:d}=zo(r),[u,h]=p.useState([]),[m,x]=p.useState([]),[g,f]=p.useState(!1),[y,j]=p.useState(null),[b,v]=p.useState(!1),[P,w]=p.useState("deposit"),[C,k]=p.useState(null),[A,L]=p.useState(!1),[T,M]=p.useState(null),[O,I]=p.useState(null),[z,N]=p.useState(!1),[E,R]=p.useState(1),[V,F]=p.useState(["ALL"]),[B,$]=p.useState(!1),[Y,_]=p.useState(null),[K,X]=p.useState({startDate:null,endDate:null}),[ne,oe]=p.useState(new Set),[ee,H]=p.useState(!0),[Q,Z]=p.useState(!1),J=ke=>{const $e=V.filter(Qe=>Qe!==ke);$e.length===0?F(["ALL"]):F($e)},ae=()=>{const ke=K.startDate&&!isNaN(K.startDate.getTime()),$e=K.endDate&&!isNaN(K.endDate.getTime());if(K.startDate&&!ke||K.endDate&&!$e){j(i("cashflow.validation.invalidDates"));return}Me(),pe()},[ue,le]=p.useState({page:1,limit:50,total:0,totalPages:0}),pe=async()=>{try{const ke=await q.getPortfolioCashFlowHistory(r,o,{limit:1e5});x(ke.data||[])}catch(ke){console.error("Failed to load all cash flows:",ke)}},Me=async(ke=(ue==null?void 0:ue.page)||1,$e=(ue==null?void 0:ue.limit)||50)=>{try{f(!0);const Qe={page:ke,limit:$e,startDate:K.startDate?K.startDate.toISOString():void 0,endDate:K.endDate?K.endDate.toISOString():void 0,types:V.includes("ALL")?void 0:V},Fn=await q.getPortfolioCashFlowHistory(r,o,Qe);h(Fn.data),le(Fn.pagination)}catch(Qe){j(Qe instanceof Error?Qe.message:i("cashflow.error.loadFailed"))}finally{f(!1)}},Le=(ke,$e)=>{Me($e,(ue==null?void 0:ue.limit)||50)},qe=ke=>{const $e=ke.target.value;Me(1,$e)};p.useEffect(()=>{Me(),pe()},[r]);const de=ke=>{switch(ke){case"DEPOSIT":return"success";case"WITHDRAWAL":return"error";case"DIVIDEND":return"info";case"INTEREST":return"warning";case"FEE":return"error";case"TAX":return"error";case"TRADE_SETTLEMENT":return"default";case"BUY_TRADE":return"error";case"SELL_TRADE":return"success";case"DEPOSIT_SETTLEMENT":return"success";case"DEPOSIT_CREATION":return"error";default:return"default"}},fe=ke=>{switch(ke){case"DEPOSIT":return e.jsx(Ue,{});case"WITHDRAWAL":return e.jsx(qt,{});case"DIVIDEND":return e.jsx(He,{});case"INTEREST":return e.jsx(He,{});case"FEE":return e.jsx(zs,{});case"TAX":return e.jsx(zs,{});case"ADJUSTMENT":return e.jsx(Ue,{});case"BUY_TRADE":return e.jsx(qt,{});case"SELL_TRADE":return e.jsx(Ue,{});case"DEPOSIT_SETTLEMENT":return e.jsx(Ue,{});case"DEPOSIT_CREATION":return e.jsx(qt,{});default:return}},ie=ke=>ke.replace(/_/g," ");let Se=(m||[]).filter(ke=>(ke.type==="DEPOSIT"||ke.type==="SELL_TRADE"||ke.type==="DEPOSIT_SETTLEMENT"||ke.type==="DIVIDEND")&&ke.status==="COMPLETED").reduce((ke,$e)=>ke+Math.abs($e.amount),0);const Ve=(m||[]).filter(ke=>(ke.type==="WITHDRAWAL"||ke.type==="BUY_TRADE"||ke.type==="DEPOSIT_CREATION")&&ke.status==="COMPLETED").reduce((ke,$e)=>ke+Math.abs($e.amount),0),Re=Se-Ve,xe=u||[],te=p.useMemo(()=>{if(!ee)return{"All Transactions":xe};const ke={};xe.forEach(Qe=>{const Nr=new Date(Qe.flowDate).toISOString().split("T")[0];ke[Nr]||(ke[Nr]=[]),ke[Nr].push(Qe)});const $e={};return Object.keys(ke).sort((Qe,Fn)=>new Date(Fn).getTime()-new Date(Qe).getTime()).forEach(Qe=>{const Nr=new Date(Qe).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"2-digit"});$e[Nr]=ke[Qe]}),$e},[xe,ee]),Ee=ke=>{const $e=new Set(ne);$e.has(ke)?$e.delete(ke):$e.add(ke),oe($e)},Ke=()=>{ne.size===Object.keys(te).length?oe(new Set):oe(new Set(Object.keys(te)))},Qt=xe.filter(ke=>ke.status==="COMPLETED").reduce((ke,$e)=>{const Qe=["DEPOSIT","DIVIDEND","INTEREST","SELL_TRADE","DEPOSIT_SETTLEMENT"].includes($e.type);return ke+(Qe?Math.abs($e.amount):-Math.abs($e.amount))},0),cn=(ke,$e)=>{R($e),is()},Ut=ke=>{w(ke),k(null),v(!0)},xr=ke=>{if(ke.status==="CANCELLED"){j("Cannot edit cancelled cash flow");return}k(ke),w(ke.type.toLowerCase()),v(!0)},mt=ke=>{M(ke),I(null),L(!0)},_t=ke=>{ke.status!=="CANCELLED"&&(_(ke),$(!0))},us=()=>{$(!1),_(null)};return e.jsx(hr,{dateAdapter:Ar,children:e.jsxs(l,{children:[e.jsxs(l,{sx:{mb:n?1:3,display:{xs:"none",sm:"block"}},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:n?.5:2,sx:{position:"sticky",top:0,zIndex:1e3,backgroundColor:"background.paper",borderBottom:1,borderColor:"divider",px:n?1.5:3,py:n?.5:2,boxShadow:2,transition:"all 0.3s ease-in-out"},children:[e.jsx(c,{variant:"pageTitle",sx:{display:{xs:"none",md:"block"}},children:i("cashflow.title")}),e.jsxs(l,{display:"flex",gap:1,children:[e.jsx(Fe,{title:i("cashflow.refresh"),children:e.jsx(Ie,{onClick:()=>{Me(),pe()},disabled:g,color:"primary",children:e.jsx(Mt,{})})}),e.jsx(he,{variant:"contained",color:"success",icon:a?void 0:e.jsx(Ue,{}),onClick:()=>Ut("deposit"),size:n||a?"small":"medium",mobileText:i("cashflow.deposit"),desktopText:i("cashflow.deposit"),sx:{borderRadius:2,mr:n||a?.5:1,px:n||a?1:2,py:n||a?.5:1,...n||a?{fontSize:"0.7rem!important"}:{fontSize:{xs:"0.65rem!important",sm:"0.65rem!important",md:"0.7rem!important",lg:"0.75rem!important",xl:"0.8rem!important"}}},children:i(n||a?"cashflow.deposit":"cashflow.createDeposit")}),e.jsx(he,{variant:"contained",color:"error",icon:a?void 0:e.jsx(qt,{}),onClick:()=>Ut("withdrawal"),size:n||a?"small":"medium",mobileText:i("cashflow.withdraw"),desktopText:i("cashflow.withdrawal"),sx:{borderRadius:2,mr:n||a?.5:1,px:n||a?1:2,py:n||a?.5:1,...n||a?{fontSize:"0.7rem!important"}:{fontSize:{xs:"0.65rem!important",sm:"0.65rem!important",md:"0.7rem!important",lg:"0.75rem!important",xl:"0.8rem!important"}}},children:i(n||a?"cashflow.withdraw":"cashflow.createWithdrawal")}),e.jsx(he,{variant:"contained",color:"info",icon:a?void 0:e.jsx(He,{}),onClick:()=>Ut("dividend"),size:n||a?"small":"medium",mobileText:i("cashflow.dividend"),desktopText:i("cashflow.dividend"),sx:{borderRadius:2,mr:n||a?.5:1,px:n||a?1:2,py:n||a?.5:1,...n||a?{fontSize:"0.7rem!important"}:{fontSize:{xs:"0.65rem!important",sm:"0.65rem!important",md:"0.7rem!important",lg:"0.75rem!important",xl:"0.8rem!important"}}},children:i(n||a?"cashflow.dividend":"cashflow.createDividend")}),e.jsx(he,{variant:"contained",color:"secondary",icon:a?void 0:e.jsx(yr,{}),mobileText:i("cashflow.transfer.transfer"),desktopText:i("cashflow.transfer.transferCash"),onClick:()=>{N(!0)},size:n||a?"small":"medium",sx:{borderRadius:2,px:n||a?1:2,py:n||a?.5:1,...n||a?{fontSize:"0.7rem!important"}:{fontSize:{xs:"0.65rem!important",sm:"0.65rem!important",md:"0.7rem!important",lg:"0.75rem!important",xl:"0.8rem!important"}}},children:i(n||a?"cashflow.transfer.transfer":"cashflow.transfer.transferCash")})]})]}),y&&e.jsx(je,{severity:"error",sx:{mb:2},onClose:()=>j(null),children:e.jsx(c,{variant:"tableCell",children:y})})]}),e.jsx(l,{sx:{display:{xs:"block",md:"none"},mb:2},children:e.jsx(at,{component:Te,sx:{boxShadow:2,borderRadius:2},children:e.jsx(it,{size:"small",children:e.jsxs(ot,{children:[e.jsxs(De,{children:[e.jsxs(S,{align:"center",sx:{borderRight:"1px solid",borderColor:"divider",width:"50%",py:1.5,px:2},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:.5},children:i("cashflow.summary.totalInflows")}),e.jsx(c,{variant:"cardValueLarge",sx:{color:"#1e40af",fontSize:"0.9rem",fontWeight:600},children:G(Se)})]}),e.jsxs(S,{align:"center",sx:{width:"50%",py:1.5,px:2},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:.5},children:i("cashflow.summary.totalOutflows")}),e.jsx(c,{variant:"cardValueLarge",sx:{color:"#dc2626",fontSize:"0.9rem",fontWeight:600},children:G(Ve)})]})]}),e.jsxs(De,{children:[e.jsxs(S,{align:"center",sx:{borderRight:"1px solid",borderColor:"divider",width:"50%",py:1.5,px:2},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:.5},children:i("cashflow.summary.netCashFlow")}),e.jsx(c,{variant:"cardValueLarge",sx:{color:Re>=0?"#15803d":"#dc2626",fontSize:"0.9rem",fontWeight:600},children:G(Re)})]}),e.jsxs(S,{align:"center",sx:{width:"50%",py:1.5,px:2},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:.5},children:i("cashflow.summary.transactions")}),e.jsx(c,{variant:"cardValueLarge",sx:{color:"#7c3aed",fontSize:"0.9rem",fontWeight:600},children:(m==null?void 0:m.length)||0})]})]})]})})})}),e.jsxs(W,{container:!0,spacing:n?1.5:3,sx:{mb:n?1.5:4,display:{xs:"none",md:"flex"}},children:[e.jsx(W,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(se,{sx:{height:"100%",background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #bae6fd 100%)",boxShadow:"0 2px 12px rgba(59, 130, 246, 0.08)",border:"1px solid rgba(59, 130, 246, 0.1)",borderRadius:3,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(59, 130, 246, 0.12)"}},children:e.jsx(me,{sx:{px:n?1.5:3,py:n?1:3},children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsx(l,{sx:{p:n?.5:1.5,borderRadius:"50%",background:"linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%)",boxShadow:"0 2px 8px rgba(59, 130, 246, 0.2)",maxWidth:{xs:n?28:40,sm:n?32:42,md:n?36:44,lg:n?40:45,xl:n?44:50},height:{xs:n?28:40,sm:n?32:42,md:n?36:44,lg:n?40:45,xl:n?44:50},display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ue,{sx:{color:"white",fontSize:{xs:n?14:18,sm:n?16:20,md:n?18:22,lg:n?20:24,xl:n?22:26}}})}),e.jsxs(l,{sx:{textAlign:"right"},children:[e.jsx(c,{variant:"cardLabel",sx:{color:"#1e40af",textTransform:"uppercase",letterSpacing:"0.5px"},children:i("cashflow.summary.totalInflows")}),e.jsx(c,{variant:"cardValueLarge",sx:{color:"#1e40af",fontSize:n?"1rem":"1.5rem",mt:.5},children:G(Se)})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(se,{sx:{height:"100%",background:"linear-gradient(135deg, #fef2f2 0%, #fee2e2 50%, #fecaca 100%)",boxShadow:"0 2px 12px rgba(239, 68, 68, 0.08)",border:"1px solid rgba(239, 68, 68, 0.1)",borderRadius:3,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(239, 68, 68, 0.12)"}},children:e.jsx(me,{sx:{px:n?1.5:3,py:n?1:3},children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsx(l,{sx:{p:n?.5:1.5,borderRadius:"50%",background:"linear-gradient(135deg, #ef4444 0%, #f87171 100%)",boxShadow:"0 2px 8px rgba(239, 68, 68, 0.2)",width:{xs:n?28:40,sm:n?32:42,md:n?36:44,lg:n?40:45,xl:n?44:50},height:{xs:n?28:40,sm:n?32:42,md:n?36:44,lg:n?40:45,xl:n?44:50},display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(qt,{sx:{color:"white",fontSize:{xs:n?14:18,sm:n?16:20,md:n?18:22,lg:n?20:24,xl:n?22:26}}})}),e.jsxs(l,{sx:{textAlign:"right"},children:[e.jsx(c,{variant:"cardLabel",sx:{color:"#dc2626",textTransform:"uppercase",letterSpacing:"0.5px"},children:i("cashflow.summary.totalOutflows")}),e.jsx(c,{variant:"cardValueLarge",sx:{color:"#dc2626",fontSize:n?"1rem":"1.5rem",mt:.5},children:G(Ve)})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(se,{sx:{height:"100%",background:Re>=0?"linear-gradient(135deg, #f0fdf4 0%, #dcfce7 50%, #bbf7d0 100%)":"linear-gradient(135deg, #fef2f2 0%, #fee2e2 50%, #fecaca 100%)",boxShadow:Re>=0?"0 2px 12px rgba(34, 197, 94, 0.08)":"0 2px 12px rgba(239, 68, 68, 0.08)",border:Re>=0?"1px solid rgba(34, 197, 94, 0.1)":"1px solid rgba(239, 68, 68, 0.1)",borderRadius:3,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateY(-2px)",boxShadow:Re>=0?"0 4px 20px rgba(34, 197, 94, 0.12)":"0 4px 20px rgba(239, 68, 68, 0.12)"}},children:e.jsx(me,{sx:{px:n?1.5:3,py:n?1:3},children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsx(l,{sx:{p:n?.5:1.5,borderRadius:"50%",background:Re>=0?"linear-gradient(135deg, #22c55e 0%, #4ade80 100%)":"linear-gradient(135deg, #ef4444 0%, #f87171 100%)",boxShadow:Re>=0?"0 2px 8px rgba(34, 197, 94, 0.2)":"0 2px 8px rgba(239, 68, 68, 0.2)",width:{xs:n?28:40,sm:n?32:42,md:n?36:44,lg:n?40:45,xl:n?44:50},height:{xs:n?28:40,sm:n?32:42,md:n?36:44,lg:n?40:45,xl:n?44:50},display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ue,{sx:{color:"white",fontSize:{xs:n?14:18,sm:n?16:20,md:n?18:22,lg:n?20:24,xl:n?22:26}}})}),e.jsxs(l,{sx:{textAlign:"right"},children:[e.jsx(c,{variant:"cardLabel",sx:{color:Re>=0?"#15803d":"#dc2626",textTransform:"uppercase",letterSpacing:"0.5px"},children:i("cashflow.summary.netCashFlow")}),e.jsx(c,{variant:"cardValueLarge",sx:{color:Re>=0?"#15803d":"#dc2626",fontSize:n?"1rem":"1.5rem",mt:.5},children:G(Re)})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(se,{sx:{height:"100%",background:"linear-gradient(135deg, #faf5ff 0%, #f3e8ff 50%, #e9d5ff 100%)",boxShadow:"0 2px 12px rgba(168, 85, 247, 0.08)",border:"1px solid rgba(168, 85, 247, 0.1)",borderRadius:3,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(168, 85, 247, 0.12)"}},children:e.jsx(me,{sx:{px:n?1.5:3,py:n?1:3},children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsx(l,{sx:{p:n?.5:1.5,borderRadius:"50%",background:"linear-gradient(135deg, #a855f7 0%, #c084fc 100%)",boxShadow:"0 2px 8px rgba(168, 85, 247, 0.2)",width:{xs:n?28:40,sm:n?32:42,md:n?36:44,lg:n?40:45,xl:n?44:50},height:{xs:n?28:40,sm:n?32:42,md:n?36:44,lg:n?40:45,xl:n?44:50},display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ya,{sx:{color:"white",fontSize:{xs:n?14:18,sm:n?16:20,md:n?18:22,lg:n?20:24,xl:n?22:26}}})}),e.jsxs(l,{sx:{textAlign:"right"},children:[e.jsx(c,{variant:"cardLabel",sx:{color:"#7c3aed",textTransform:"uppercase",letterSpacing:"0.5px"},children:i("cashflow.summary.transactions")}),e.jsx(c,{variant:"cardValueLarge",sx:{color:"#7c3aed",fontSize:n?"1rem":"1.5rem",mt:.5},children:(m==null?void 0:m.length)||0})]})]})})})})]}),e.jsx(c2,{cashFlows:m,loading:g}),e.jsxs(se,{children:[e.jsx(l,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Tr,{value:E,onChange:cn,"aria-label":"cash flow tabs",children:[e.jsx(ht,{icon:e.jsx(ya,{}),label:i("cashflow.tabs.analytics"),iconPosition:"start",sx:{textTransform:"none",fontWeight:600,...n?{fontSize:"0.75rem"}:{fontSize:"0.875rem"},py:n?.5:1.5,px:n?1:2}}),e.jsx(ht,{icon:e.jsx(Ju,{}),label:i("cashflow.tabs.history"),iconPosition:"start",sx:{textTransform:"none",fontWeight:600,...n?{fontSize:"0.75rem"}:{fontSize:"0.875rem"},py:n?.5:1.5,px:n?1:2}})]})}),e.jsxs(me,{children:[E===0&&e.jsx(l,{children:e.jsx(l2,{portfolioId:r})}),E===1&&e.jsxs(l,{children:[e.jsxs(l,{sx:{mb:n?1.5:3},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:n?.5:2,children:[e.jsx(c,{variant:"pageTitle",sx:{fontSize:n?"0.9rem":void 0},children:i("cashflow.history.title")}),e.jsxs(l,{display:"flex",gap:1,alignItems:"center",children:[e.jsx(c,{variant:"formHelper",children:i("cashflow.history.transactionCount",{count:xe.length})}),e.jsx(he,{size:"small",variant:"outlined",icon:e.jsx(Ir,{}),mobileText:i("cashflow.filter"),desktopText:i("cashflow.filter"),onClick:()=>Z(!Q),color:Q?"primary":"inherit",children:i("cashflow.filter")}),e.jsx(he,{size:"small",variant:"outlined",icon:e.jsx(Mt,{}),mobileText:i("cashflow.refresh"),desktopText:i("cashflow.refresh"),onClick:()=>{Me(),pe()},disabled:g,children:i("cashflow.refresh")})]})]}),Q&&e.jsxs(l,{sx:{mb:2,p:2,border:"1px solid",borderColor:"divider",borderRadius:2,backgroundColor:"background.paper"},children:[e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(l,{children:[e.jsx(c,{variant:"formLabel",sx:{mb:1,display:"block"},children:i("cashflow.filters.dateRange")}),e.jsxs(l,{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap",children:[e.jsx(ls,{label:i("cashflow.filters.from"),value:K.startDate,onChange:ke=>X($e=>({...$e,startDate:ke})),slotProps:{textField:{size:"small",sx:{minWidth:160},error:!1,helperText:""}},format:"dd/MM/yyyy"}),e.jsx(ls,{label:i("cashflow.filters.to"),value:K.endDate,onChange:ke=>X($e=>({...$e,endDate:ke})),slotProps:{textField:{size:"small",sx:{minWidth:160},error:!1,helperText:""}},format:"dd/MM/yyyy"})]})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(l,{children:[e.jsx(c,{variant:"formLabel",sx:{mb:1,display:"block"},children:i("cashflow.filters.transactionTypes")}),e.jsxs(nt,{fullWidth:!0,size:"small",children:[e.jsx(st,{children:i("cashflow.filters.type")}),e.jsxs(Ze,{multiple:!0,value:V,label:i("cashflow.filters.type"),onChange:ke=>{const $e=ke.target.value;$e.includes("ALL")&&$e.length===1?F(["ALL"]):$e.length===0?F(["ALL"]):F($e)},input:e.jsx(yp,{label:i("cashflow.filters.type")}),renderValue:ke=>e.jsx(l,{sx:{display:"flex",flexWrap:"wrap",gap:.5,maxHeight:60,overflow:"auto"},children:ke.map($e=>e.jsx(ce,{label:$e,size:"small",onDelete:$e==="ALL"?void 0:()=>J($e),onClick:Qe=>{$e!=="ALL"&&Qe.stopPropagation()}},$e))}),MenuProps:{PaperProps:{style:{maxHeight:300,width:250}}},children:[e.jsxs(re,{value:"ALL",children:[e.jsx(rn,{checked:V.includes("ALL")}),e.jsx(ve,{primary:i("cashflow.filters.allTypes")})]}),e.jsxs(re,{value:"DEPOSIT",children:[e.jsx(rn,{checked:V.includes("DEPOSIT")}),e.jsx(ve,{primary:i("cashflow.filters.deposits")})]}),e.jsxs(re,{value:"WITHDRAWAL",children:[e.jsx(rn,{checked:V.includes("WITHDRAWAL")}),e.jsx(ve,{primary:i("cashflow.filters.withdrawals")})]}),e.jsxs(re,{value:"DIVIDEND",children:[e.jsx(rn,{checked:V.includes("DIVIDEND")}),e.jsx(ve,{primary:i("cashflow.filters.dividends")})]}),e.jsxs(re,{value:"INTEREST",children:[e.jsx(rn,{checked:V.includes("INTEREST")}),e.jsx(ve,{primary:i("cashflow.filters.interest")})]}),e.jsxs(re,{value:"FEE",children:[e.jsx(rn,{checked:V.includes("FEE")}),e.jsx(ve,{primary:i("cashflow.filters.fees")})]}),e.jsxs(re,{value:"TAX",children:[e.jsx(rn,{checked:V.includes("TAX")}),e.jsx(ve,{primary:i("cashflow.filters.taxes")})]}),e.jsxs(re,{value:"ADJUSTMENT",children:[e.jsx(rn,{checked:V.includes("ADJUSTMENT")}),e.jsx(ve,{primary:i("cashflow.filters.adjustments")})]}),e.jsxs(re,{value:"BUY_TRADE",children:[e.jsx(rn,{checked:V.includes("BUY_TRADE")}),e.jsx(ve,{primary:i("cashflow.filters.buyTrades")})]}),e.jsxs(re,{value:"SELL_TRADE",children:[e.jsx(rn,{checked:V.includes("SELL_TRADE")}),e.jsx(ve,{primary:i("cashflow.filters.sellTrades")})]}),e.jsxs(re,{value:"DEPOSIT_SETTLEMENT",children:[e.jsx(rn,{checked:V.includes("DEPOSIT_SETTLEMENT")}),e.jsx(ve,{primary:i("cashflow.filters.depositSettlements")})]}),e.jsxs(re,{value:"DEPOSIT_CREATION",children:[e.jsx(rn,{checked:V.includes("DEPOSIT_CREATION")}),e.jsx(ve,{primary:i("cashflow.filters.depositCreations")})]})]})]})]})})]}),e.jsx(l,{display:"flex",gap:1,mt:2,justifyContent:"flex-end",alignItems:"center",children:e.jsx(he,{size:"small",variant:"contained",icon:e.jsx($n,{}),mobileText:i("cashflow.filters.apply"),desktopText:i("cashflow.filters.applyFilters"),onClick:ae,disabled:g,children:i("cashflow.filters.applyFilters")})})]}),(K.startDate&&!isNaN(K.startDate.getTime())||K.endDate&&!isNaN(K.endDate.getTime())||V.length>0&&!V.includes("ALL"))&&e.jsxs(l,{sx:{mb:2,p:1,backgroundColor:"grey.100",borderRadius:1},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsxs(c,{variant:"formHelper",children:[i("cashflow.filters.activeFilters"),":"]}),e.jsx(he,{size:"small",variant:"text",icon:e.jsx(ei,{}),mobileText:i("cashflow.filters.reset"),desktopText:i("cashflow.filters.resetAll"),onClick:()=>{F(["ALL"]),X({startDate:null,endDate:null})},sx:{fontSize:"0.75rem",minWidth:"auto",px:1,py:.5,color:"text.secondary","&:hover":{backgroundColor:"action.hover",color:"text.primary"}},children:i("cashflow.filters.resetAll")})]}),e.jsxs(l,{display:"flex",gap:1,flexWrap:"wrap",children:[K.startDate&&!isNaN(K.startDate.getTime())&&e.jsx(ce,{label:`${i("cashflow.filters.from")}: ${Gt(K.startDate.toISOString())}`,size:"small",onDelete:()=>X(ke=>({...ke,startDate:null}))}),K.endDate&&!isNaN(K.endDate.getTime())&&e.jsx(ce,{label:`${i("cashflow.filters.to")}: ${Gt(K.endDate.toISOString())}`,size:"small",onDelete:()=>X(ke=>({...ke,endDate:null}))}),V.length>0&&!V.includes("ALL")&&e.jsx(ce,{label:`${i("cashflow.filters.types")}: ${V.join(", ")}`,size:"small",onDelete:()=>F(["ALL"])})]})]})]}),e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,flexWrap:"wrap",children:[e.jsxs(l,{display:"flex",gap:1,alignItems:"center",flexWrap:"wrap",children:[e.jsx(he,{variant:"text",icon:e.jsx(Rr,{}),mobileText:i("cashflow.table.group"),desktopText:i("cashflow.table.groupByDate"),onClick:()=>H(!ee),size:"small",sx:{textTransform:"none",fontSize:"0.75rem",minWidth:"auto",px:1,py:.5,color:ee?"primary.main":"text.secondary","&:hover":{backgroundColor:"action.hover",color:ee?"primary.dark":"text.primary"}},children:i("cashflow.table.groupByDate")}),ee&&Object.keys(te).length>1&&e.jsx(he,{size:"small",variant:"text",icon:ne.size===Object.keys(te).length?e.jsx(ln,{}):e.jsx(Dn,{}),mobileText:ne.size===Object.keys(te).length?i("cashflow.table.expand"):i("cashflow.table.collapse"),desktopText:ne.size===Object.keys(te).length?i("cashflow.table.expandAll"):i("cashflow.table.collapseAll"),onClick:Ke,sx:{textTransform:"none",fontSize:"0.75rem",minWidth:"auto",px:1,py:.5,color:"text.secondary","&:hover":{backgroundColor:"action.hover",color:"text.primary"}},children:ne.size===Object.keys(te).length?i("cashflow.table.expandAll"):i("cashflow.table.collapseAll")})]}),e.jsxs(c,{variant:"formHelper",children:[i("cashflow.table.total"),": ",e.jsx("strong",{children:G(Qt,"VND")})," (",i("cashflow.table.items",{count:xe.length}),")"]})]}),g?e.jsx(l,{sx:{width:"100%",mb:2},children:e.jsx(ds,{})}):e.jsxs(e.Fragment,{children:[e.jsx(at,{component:Te,sx:{borderRadius:2},children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:"grey.50"},children:[e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",sx:{fontWeight:600},children:i("cashflow.table.type")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",sx:{fontWeight:600},children:i("cashflow.table.amount")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",sx:{fontWeight:600},children:i("cashflow.table.description")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",sx:{fontWeight:600},children:i("cashflow.table.reference")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",sx:{fontWeight:600},children:i("cashflow.table.fundingSource")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",sx:{fontWeight:600},children:i("cashflow.table.date")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",sx:{fontWeight:600},children:i("cashflow.table.status")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",sx:{fontWeight:600},children:i("cashflow.table.actions")})})]})}),e.jsx(ot,{children:Object.entries(te).map(([ke,$e])=>e.jsxs(rt.Fragment,{children:[ee&&e.jsx(De,{sx:{bgcolor:"grey.100","&:hover":{bgcolor:"grey.200"},cursor:"pointer"},onClick:()=>Ee(ke),children:e.jsx(S,{colSpan:8,sx:{py:n?1:1.5,borderBottom:"2px solid",borderBottomColor:"primary.main"},children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Rr,{sx:{fontSize:16,color:"primary.main"}}),e.jsx(c,{variant:"cardTitle",fontWeight:"600",color:"primary.main",children:ke}),e.jsxs(c,{variant:"labelSmall",color:"text.secondary",children:["(",i("cashflow.table.transactionCount",{count:$e.length}),")"]})]}),e.jsx(l,{display:"flex",alignItems:"center",gap:1,children:ne.has(ke)?e.jsx(ln,{sx:{fontSize:20,color:"text.secondary"}}):e.jsx(Dn,{sx:{fontSize:20,color:"text.secondary"}})})]})})}),!ne.has(ke)&&$e.map(Qe=>e.jsxs(De,{hover:!0,onClick:()=>_t(Qe),sx:{cursor:Qe.status==="CANCELLED"?"default":"pointer","&:hover":{backgroundColor:Qe.status==="CANCELLED"?"inherit":"action.hover"}},children:[e.jsx(S,{children:e.jsx(ce,{...fe(Qe.type)&&{icon:fe(Qe.type)},label:ie(Qe.type),color:de(Qe.type),size:"small",variant:"outlined"})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{color:Qe.type==="DEPOSIT"||Qe.type==="DIVIDEND"||Qe.type==="SELL_TRADE"||Qe.type==="DEPOSIT_SETTLEMENT"?"success.main":"error.main"},children:G(Qe.type==="DEPOSIT"||Qe.type==="DIVIDEND"||Qe.type==="SELL_TRADE"||Qe.type==="DEPOSIT_SETTLEMENT"?Qe.amount:-Qe.amount)})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",noWrap:!0,sx:{maxWidth:220},children:Qe.description})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{color:"text.secondary"},children:Qe.reference||"-"})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{color:"text.secondary"},children:Qe.fundingSource||"-"})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",children:Gt(Qe.flowDate)})}),e.jsx(S,{children:e.jsx(ce,{label:Qe.status,color:Qe.status==="COMPLETED"?"success":Qe.status==="PENDING"?"warning":Qe.status==="CANCELLED"?"error":"default",size:"small",variant:"filled"})}),e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",gap:1},children:[e.jsx(tr,{size:"small",onClick:Fn=>{Fn.stopPropagation(),xr(Qe)},color:"primary",disabled:Qe.status==="CANCELLED",tooltip:Qe.status==="CANCELLED"?i("cashflow.tooltips.cannotEditCancelled"):i("cashflow.tooltips.edit"),children:e.jsx(Tt,{fontSize:"small"})}),e.jsx(tr,{size:"small",onClick:Fn=>{Fn.stopPropagation(),mt(Qe)},color:"error",tooltip:i("cashflow.tooltips.delete"),children:e.jsx(pt,{fontSize:"small"})})]})})]},Qe.cashflowId))]},ke))})]})}),(ue==null?void 0:ue.totalPages)&&ue.totalPages>1&&e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:3,px:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(c,{variant:"formHelper",children:i("cashflow.pagination.showing",{start:(ue.page-1)*ue.limit+1,end:Math.min(ue.page*ue.limit,ue.total),total:ue.total})}),e.jsxs(nt,{size:"small",sx:{minWidth:80},children:[e.jsx(st,{children:i("cashflow.pagination.perPage")}),e.jsxs(Ze,{value:ue.limit,onChange:qe,label:i("cashflow.pagination.perPage"),children:[e.jsx(re,{value:5,children:"5"}),e.jsx(re,{value:10,children:"10"}),e.jsx(re,{value:25,children:"25"}),e.jsx(re,{value:50,children:"50"})]})]})]}),e.jsx(la,{count:ue.totalPages,page:ue.page,onChange:Le,color:"primary",showFirstButton:!0,showLastButton:!0})]})]})]})]})]}),e.jsx(Pu,{open:b,onClose:()=>{v(!1),j(null)},onSubmit:async ke=>{try{f(!0),j(null);const $e={portfolioId:r,amount:parseFloat(ke.amount),type:P.toUpperCase(),description:ke.description,reference:ke.reference||void 0,flowDate:ke.flowDate?ke.flowDate:void 0,currency:ke.currency,status:ke.status,fundingSource:ke.fundingSource||void 0};C!==null?await q.updateCashFlow(r,o,C.cashflowId,$e):await q.createCashFlow(r,o,P,$e),v(!1),k(null),j(null),await Me(),await pe(),t==null||t()}catch($e){j($e instanceof Error?$e.message:i("cashflow.error.createFailed",{action:C?"update":"create"}))}finally{f(!1)}},dialogType:P,editingCashFlow:C,loading:g,error:y,portfolioFundingSource:(d==null?void 0:d.fundingSource)||""}),e.jsx(a2,{open:A,onClose:()=>{L(!1),I(null)},onConfirm:async()=>{if(T)try{f(!0),I(null),await q.deleteCashFlow(r,o,T.cashflowId),await Me(),await pe(),L(!1),M(null),I(null),t==null||t()}catch(ke){const $e=ke instanceof Error?ke.message:"Failed to delete cash flow";I($e),console.error("Delete cash flow error:",ke)}finally{f(!1)}},cashFlowToDelete:T,loading:g,error:O}),e.jsx(i2,{open:z,onClose:()=>{N(!1),j(null)},onSubmit:async ke=>{try{if(f(!0),j(null),!ke.fromSource||!ke.toSource)throw new Error("Please select both source and destination funding sources");if(ke.fromSource===ke.toSource)throw new Error("Source and destination cannot be the same");if(ke.amount<=0)throw new Error("Transfer amount must be greater than 0");const $e={portfolioId:r,fromSource:ke.fromSource,toSource:ke.toSource,amount:ke.amount,description:ke.description||`Transfer from ${ke.fromSource} to ${ke.toSource}`,transferDate:(()=>{let Qe=ke.transferDate;return Qe.includes("T")&&(Qe=Qe.split("T")[0]),new Date(Qe+"T12:00:00").toISOString()})()};await q.transferCashFlow(r,o,$e),N(!1),j(null),await Me(),await pe(),t==null||t()}catch($e){j($e instanceof Error?$e.message:"Failed to transfer cash")}finally{f(!1)}},loading:g,error:y,portfolioId:r}),e.jsx(Pu,{open:B,onClose:us,onSubmit:async ke=>{try{f(!0),j(null);const $e={portfolioId:r,amount:parseFloat(ke.amount),type:(Y==null?void 0:Y.type)||"DEPOSIT",description:ke.description,reference:ke.reference||void 0,flowDate:ke.flowDate?ke.flowDate:void 0,currency:ke.currency,status:ke.status,fundingSource:ke.fundingSource||void 0};Y&&await q.updateCashFlow(r,o,Y.cashflowId,$e),us(),j(null),await Me(),await pe(),t==null||t()}catch($e){j($e instanceof Error?$e.message:i("cashflow.error.updateFailed"))}finally{f(!1)}},dialogType:(Y==null?void 0:Y.type.toLowerCase())||"deposit",editingCashFlow:Y,loading:g,error:y,portfolioFundingSource:(d==null?void 0:d.fundingSource)||""})]})})},u2=({portfolioId:r,isCompactMode:t,getUltraSpacing:n,onCashFlowUpdate:s})=>e.jsxs(l,{sx:{backgroundColor:"background.paper",minHeight:"80vh",pt:0,px:n(2,1)},children:[e.jsx(D,{variant:t?"h6":"h5",gutterBottom:!0,sx:{fontWeight:600,color:"#4a5568",mb:n(3,1.5),fontSize:t?"0.9rem":void 0,display:"flex",alignItems:"center",gap:1}}),e.jsx(l,{sx:{mb:n(4,2)},children:e.jsx(d2,{portfolioId:r,onCashFlowUpdate:s,compact:t})})]}),h2=(r,t=!1)=>{const[n,s]=p.useState([]),[a,i]=p.useState(!1),[o,d]=p.useState(null),u=async()=>{if(!r||!t){s([]);return}i(!0),d(null);try{const g=await q.getFundInvestors(r);s(g)}catch(g){d("Failed to load investor holdings"),console.error("Error loading holdings:",g)}finally{i(!1)}},h=async g=>{i(!0),d(null);try{const f=await q.subscribeToFund(g);return await u(),f}catch(f){throw d("Failed to process subscription"),console.error("Error processing subscription:",f),f}finally{i(!1)}},m=async g=>{i(!0),d(null);try{const f=await q.redeemFromFund(g);return await u(),f}catch(f){throw d("Failed to process redemption"),console.error("Error processing redemption:",f),f}finally{i(!1)}},x=async(g,f)=>{i(!0),d(null);try{await q.convertPortfolioToFund(g,f)}catch(y){throw d("Failed to convert portfolio to fund"),console.error("Error converting to fund:",y),y}finally{i(!1)}};return p.useEffect(()=>{u()},[r,t]),{holdings:n,loading:a,error:o,refetch:u,subscribeToFund:h,redeemFromFund:m,convertToFund:x}},m2=({open:r,onClose:t,portfolio:n,onConvert:s,loading:a=!1})=>{const{t:i,i18n:o}=Ne(),[d,u]=p.useState(!1),[h,m]=p.useState(""),[x,g]=p.useState(null),f=()=>{u(!1),m(""),g(null),t()},y=async()=>{var P,w;g(null);try{if(d&&h){const C=new Date(h);if(isNaN(C.getTime())){g(i("nav.holdings.convertToFundModal.validation.invalidDateFormat"));return}if(C>new Date){g(i("nav.holdings.convertToFundModal.validation.dateInFuture"));return}await s(h)}else await s();f()}catch(C){g(((w=(P=C.response)==null?void 0:P.data)==null?void 0:w.message)||C.message||i("nav.holdings.convertToFundModal.error.convertFailed"))}},j=P=>P.toISOString().split("T")[0],b=()=>(o.language||"vi")==="en"?"en-US":"vi-VN",v=e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:f,disabled:a,size:"medium",children:i("common.cancel")}),e.jsx(We,{onClick:y,variant:"contained",disabled:a||d&&!h,size:"medium",icon:a?e.jsx(Ce,{size:20}):e.jsx(Ue,{}),mobileText:i("nav.holdings.convertToFundModal.convert"),desktopText:i("nav.holdings.convertToFundModal.convertToFund"),forceTextOnly:!0,children:i(a?"nav.holdings.convertToFundModal.converting":"nav.holdings.convertToFundModal.convertToFund")})]});return e.jsx(Rt,{open:r,onClose:f,title:i("nav.holdings.convertToFundModal.title"),icon:e.jsx(Ue,{color:"primary"}),actions:v,loading:a,maxWidth:"md",titleColor:"primary",size:"medium",children:e.jsxs(l,{sx:{pt:1},children:[e.jsx(se,{variant:"outlined",sx:{mb:3,p:2,backgroundColor:"grey.50"},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:6,children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:i("nav.holdings.convertToFundModal.portfolioName")}),e.jsx(c,{variant:"cardTitle",children:n.name})]}),e.jsxs(W,{item:!0,xs:6,children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:i("nav.holdings.convertToFundModal.baseCurrency")}),e.jsx(c,{variant:"cardTitle",children:n.baseCurrency})]})]})}),e.jsxs(l,{sx:{mb:3},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,children:i("nav.holdings.convertToFundModal.conversionOptions")}),e.jsx(an,{control:e.jsx(rn,{checked:d,onChange:P=>u(P.target.checked),disabled:a}),label:e.jsx(c,{variant:"body2",children:i("nav.holdings.convertToFundModal.useSnapshotDate")})}),d&&e.jsx(l,{sx:{mt:2,ml:4},children:e.jsx(Ae,{fullWidth:!0,label:i("nav.holdings.convertToFundModal.snapshotDate"),type:"date",value:h,onChange:P=>m(P.target.value),helperText:i("nav.holdings.convertToFundModal.snapshotDateHelper"),disabled:a,InputLabelProps:{shrink:!0},inputProps:{max:j(new Date)}})})]}),e.jsxs(se,{variant:"outlined",sx:{p:2,backgroundColor:"info.50",borderColor:"info.200"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5,mb:1},children:[e.jsx(Rr,{sx:{fontSize:16,color:"info.main"}}),e.jsx(c,{variant:"subtitle2",color:"info.main",children:i("nav.holdings.convertToFundModal.conversionInformation")})]}),e.jsx(c,{variant:"body2",color:"text.secondary",sx:{mb:1},ellipsis:!1,children:d&&h?e.jsx(e.Fragment,{children:i("nav.holdings.convertToFundModal.conversionInfoWithDate",{date:new Date(h).toLocaleDateString(b())})}):e.jsx(e.Fragment,{children:i("nav.holdings.convertToFundModal.conversionInfoCurrent")})}),e.jsx(c,{variant:"body2",color:"text.secondary",ellipsis:!1,children:i("nav.holdings.convertToFundModal.conversionInfoAfter")})]}),x&&e.jsx(je,{severity:"error",sx:{mt:2},children:x})]})})},x2=({open:r,onClose:t,portfolio:n,onConvert:s})=>{const{t:a}=Ne(),[i,o]=p.useState(!1),[d,u]=p.useState(!1),h=async()=>{if(d){o(!0);try{await s()}catch(g){console.error("Failed to convert fund to portfolio:",g)}finally{o(!1)}}},m=()=>{u(!1),t()},x=e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:m,disabled:i,color:"inherit",size:"medium",children:a("common.cancel")}),e.jsx(We,{onClick:h,disabled:i||!d,color:"warning",variant:"contained",icon:i?e.jsx(Ce,{size:20}):e.jsx(Ml,{}),mobileText:a("nav.holdings.convertToPortfolioModal.convert"),desktopText:a("nav.holdings.convertToPortfolioModal.convertToPortfolio"),forceTextOnly:!0,size:"medium",children:a(i?"nav.holdings.convertToPortfolioModal.converting":"nav.holdings.convertToPortfolioModal.convertToPortfolio")})]});return e.jsx(Rt,{open:r,onClose:m,title:a("nav.holdings.convertToPortfolioModal.title"),icon:e.jsx(Ml,{color:"warning"}),actions:x,loading:i,maxWidth:"md",titleColor:"warning",size:"medium",children:e.jsxs(l,{sx:{pt:1},children:[e.jsx(je,{severity:"warning",sx:{mb:2},children:e.jsx(c,{variant:"body2",fontWeight:"bold",ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.warningTitle")})}),e.jsx(c,{variant:"labelMedium",paragraph:!0,ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.confirmationQuestion",{name:n.name})}),e.jsx(c,{variant:"cardTitle",paragraph:!0,children:a("nav.holdings.convertToPortfolioModal.willDelete")}),e.jsxs(l,{component:"ul",sx:{pl:2,m:0,mb:3},children:[e.jsx(l,{component:"li",children:e.jsx(c,{variant:"body2",color:"text.secondary",ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.deleteItem1")})}),e.jsx(l,{component:"li",children:e.jsx(c,{variant:"body2",color:"text.secondary",ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.deleteItem2")})}),e.jsx(l,{component:"li",children:e.jsx(c,{variant:"body2",color:"text.secondary",ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.deleteItem3")})}),e.jsx(l,{component:"li",children:e.jsx(c,{variant:"body2",color:"text.secondary",ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.deleteItem4")})}),e.jsx(l,{component:"li",children:e.jsx(c,{variant:"body2",color:"text.secondary",ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.deleteItem5")})})]}),e.jsx(c,{variant:"cardTitle",paragraph:!0,children:a("nav.holdings.convertToPortfolioModal.willRetain")}),e.jsxs(l,{component:"ul",sx:{pl:2,m:0,mb:3},children:[e.jsx(l,{component:"li",children:e.jsx(c,{variant:"body2",color:"text.secondary",ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.retainItem1")})}),e.jsx(l,{component:"li",children:e.jsx(c,{variant:"body2",color:"text.secondary",ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.retainItem2")})}),e.jsx(l,{component:"li",children:e.jsx(c,{variant:"body2",color:"text.secondary",ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.retainItem3")})}),e.jsx(l,{component:"li",children:e.jsx(c,{variant:"body2",color:"text.secondary",ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.retainItem4")})})]}),e.jsx(l,{sx:{border:"1px solid #e0e0e0",borderRadius:1,p:2,backgroundColor:"#fafafa",mb:2},children:e.jsx(an,{control:e.jsx(rn,{checked:d,onChange:g=>u(g.target.checked),color:"warning",disabled:i}),label:e.jsx(c,{variant:"body2",color:"warning.main",fontWeight:"bold",ellipsis:!1,children:a("nav.holdings.convertToPortfolioModal.confirmationLabel")})})})]})})};let wl=null,Du=0;const p2=5*60*1e3,g2=()=>{const[r,t]=p.useState([]),[n,s]=p.useState(!1),[a,i]=p.useState(null),o=async()=>{try{const u=Date.now();if(wl&&u-Du<p2){t(wl);return}s(!0),i(null);const m=(await q.getAccounts()).sort((x,g)=>x.isMainAccount&&!g.isMainAccount?-1:!x.isMainAccount&&g.isMainAccount?1:new Date(g.createdAt).getTime()-new Date(x.createdAt).getTime());wl=m,Du=u,t(m)}catch(u){console.error("Error loading accounts:",u),i("Failed to load accounts"),t([])}finally{s(!1)}};return p.useEffect(()=>{o()},[]),{accounts:r,loading:n,error:a,refetch:()=>{o()}}},vx=({value:r,onChange:t,label:n="Account",placeholder:s="Search for an account...",helperText:a,error:i=!1,required:o=!1,disabled:d=!1,fullWidth:u=!0,margin:h="normal",variant:m="outlined",onBlur:x,onFocus:g,filterInvestorOnly:f=!1,accounts:y,portfolioId:j,allowCustomAccountId:b=!1,showPortfolioInvestors:v=!1})=>{const{accounts:P,loading:w,error:C}=g2(),[k,A]=p.useState(""),[L,T]=p.useState(null),[M,O]=p.useState([]),[I,z]=p.useState(!1),[N,E]=p.useState(""),[R,V]=p.useState(!1),F=y||P;p.useEffect(()=>{j&&v&&M.length===0&&$()},[j,v]);const B=()=>{j&&v&&M.length===0&&$(),g==null||g()},$=async()=>{if(j)try{z(!0);const J=await q.getFundInvestors(j);O(J||[])}catch(J){console.error("Error loading portfolio investors:",J),O([])}finally{z(!1)}},Y=()=>{j&&v&&M.length===0&&$()},_=f?F.filter(J=>J.isInvestor):F;p.useEffect(()=>{if(r&&F.length>0){const J=F.find(ae=>ae.accountId===r);T(J||null)}else T(null)},[r,F]),p.useEffect(()=>{if(!(k===void 0||k==="undefined")&&!(L&&k===`${L.name} (ID: ${L.accountId})`))if(k&&!L){const J=F.find(ae=>ae.accountId===k);J?(T(J),V(!1),E(""),t(J.accountId.trim())):b&&X(k)?(V(!0),E(k),t(k.trim())):(T(null),V(!1),E(""),t(""))}else(L||!k&&!N)&&(V(!1),E(""))},[k,F,b,L,N,t]),p.useEffect(()=>{L&&R&&(V(!1),E(""))},[L,R]);const K=(J,ae)=>{typeof ae=="string"?(T(null),V(!0),E(ae),t(ae.trim())):ae&&typeof ae=="object"?(T(ae),V(!1),E(""),t(ae.accountId)):(T(null),V(!1),E(""),t(""))},X=J=>/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(J),ne=(J,ae)=>{if(A(ae),!(L&&ae===`${L.name} (ID: ${L.accountId})`))if(ae){const ue=F.find(le=>le.accountId===ae);ue?(T(ue),V(!1),E(""),t(ue.accountId.trim())):b&&X(ae)?(V(!0),E(ae),t(ae.trim())):(T(null),V(!1),E(""),t(""))}else T(null),V(!1),E(""),t("")},oe=()=>{b&&R&&N&&t(N),x==null||x()};p.useEffect(()=>{b&&R&&N&&!L&&t(N)},[b,R,N,L,t]);const ee=J=>typeof J=="string"?J:`${J.name} (ID: ${J.accountId})`,H=(J,ae)=>typeof J=="string"&&typeof ae=="string"?J===ae:typeof J=="object"&&typeof ae=="object"?J.accountId===ae.accountId:!1,Q=()=>v&&M.length>0?M.map(J=>{const ae=J.account||{};return{id:J.holdingId||J.id,accountId:J.accountId,name:ae.name||ae.accountId||`Investor ${J.accountId}`,email:ae.email||"N/A",baseCurrency:ae.baseCurrency||"VND",isInvestor:ae.isInvestor||!1,isMainAccount:ae.isMainAccount||!1,createdAt:ae.createdAt||J.createdAt,updatedAt:ae.updatedAt||J.updatedAt}}):_,Z=(J,ae)=>{const{key:ue,...le}=J;if(typeof ae=="string")return e.jsx(l,{component:"li",...le,children:e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsxs(D,{variant:"body1",sx:{fontWeight:600},children:[ae," (New Account)"]})})},ue);const pe=v&&M.some(Me=>Me.accountId===ae.accountId);return e.jsx(l,{component:"li",...le,children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",width:"100%"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[pe?e.jsx(He,{sx:{fontSize:16,color:"success.main"}}):e.jsx(Ue,{sx:{fontSize:16,color:"text.secondary"}}),e.jsx(D,{variant:"body1",sx:{fontWeight:600},children:ae.name||ae.accountId||`Account ${ae.accountId}`})]}),e.jsxs(l,{sx:{display:"flex",gap:.5},children:[ae.isMainAccount&&e.jsx(ce,{label:"Main",size:"small",color:"primary"}),ae.isInvestor&&e.jsx(ce,{label:"Investor",size:"small",color:"success"}),pe&&e.jsx(ce,{label:"Portfolio Investor",size:"small",color:"info"})]})]}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:["ID: ",ae.accountId]}),e.jsxs(D,{variant:"caption",color:"text.secondary",children:["Email: ",ae.email||"N/A"]})]})},ue)};return e.jsxs(l,{children:[e.jsx(jo,{value:R?N:L,onChange:K,inputValue:k,onInputChange:ne,options:Q(),getOptionLabel:ee,isOptionEqualToValue:H,renderOption:Z,loading:w||I,disabled:d,fullWidth:u,onBlur:oe,onFocus:B,freeSolo:b,selectOnFocus:!1,clearOnBlur:!1,handleHomeEndKeys:!0,onOpen:()=>{j&&v&&M.length===0&&$()},renderInput:J=>e.jsx(Ae,{...J,label:n,placeholder:s,helperText:a||C,error:i||!!C,required:o,margin:h,variant:m,InputProps:{...J.InputProps,onClick:Y,endAdornment:e.jsxs(e.Fragment,{children:[w||I?e.jsx(Ce,{color:"inherit",size:20}):null,J.InputProps.endAdornment]})}}),noOptionsText:w||I?"Loading accounts...":f?"No investor accounts found":"No accounts found",loadingText:"Loading accounts...",openOnFocus:!0}),v&&e.jsx(l,{sx:{mt:1},children:I?e.jsxs(D,{variant:"caption",color:"text.secondary",children:[e.jsx(Ce,{size:12,sx:{mr:.5,verticalAlign:"middle"}}),"Loading portfolio investors..."]}):M.length>0?e.jsxs(D,{variant:"caption",color:"text.secondary",children:[e.jsx(He,{sx:{fontSize:14,mr:.5,verticalAlign:"middle"}}),M.length," existing investor(s) in this portfolio"]}):e.jsxs(D,{variant:"caption",color:"text.secondary",children:[e.jsx(He,{sx:{fontSize:14,mr:.5,verticalAlign:"middle"}}),"No existing investors found in this portfolio"]})})]})},wx=({open:r,onClose:t,portfolio:n,onSubscriptionSuccess:s,preselectedAccountId:a})=>{const{t:i}=Ne(),[o,d]=p.useState({accountId:"",amount:0,units:0,description:"",transactionDate:new Date().toISOString().split("T")[0]}),[u,h]=p.useState(!1),[m,x]=p.useState(null),[g,f]=p.useState({}),y=()=>{d({accountId:"",amount:0,units:0,description:"",transactionDate:new Date().toISOString().split("T")[0]}),x(null),f({})};p.useEffect(()=>{n&&y()},[n]),p.useEffect(()=>{r&&n&&(d({accountId:a||"",amount:0,units:0,description:"",transactionDate:new Date().toISOString().split("T")[0]}),x(null),f({}))},[r,n,a]);const j=()=>{const A={};return(!o.accountId||o.accountId.trim()==="")&&(A.accountId=i("holdings.subscriptionModal.validation.accountRequired")),(!o.amount||o.amount<=0)&&(A.amount=i("holdings.subscriptionModal.validation.amountRequired")),w<=0&&(A.units=i("holdings.subscriptionModal.validation.unitsRequired")),o.transactionDate||(A.transactionDate=i("holdings.subscriptionModal.validation.dateRequired")),f(A),Object.keys(A).length===0},b=async()=>{var A,L,T,M,O,I,z;if(!(!n||!j())){h(!0),x(null);try{const N={accountId:o.accountId,portfolioId:n.portfolioId,amount:o.amount,description:o.description,subscriptionDate:o.transactionDate};await q.subscribeToFund(N),y(),s(),t()}catch(N){console.error("Error creating subscription:",N),console.error("Error response:",(A=N.response)==null?void 0:A.data),console.error("Error status:",(L=N.response)==null?void 0:L.status);let E=i("holdings.subscriptionModal.error.createFailed");(M=(T=N.response)==null?void 0:T.data)!=null&&M.message?E=N.response.data.message:((O=N.response)==null?void 0:O.status)===403?E=i("holdings.subscriptionModal.error.unauthorized"):((I=N.response)==null?void 0:I.status)===400?E=i("holdings.subscriptionModal.error.invalidData"):((z=N.response)==null?void 0:z.status)===404&&(E=i("holdings.subscriptionModal.error.notFound")),x(E)}finally{h(!1)}}},v=()=>{u||(y(),t())};if(!n)return null;const P=n.navPerUnit||0,w=o.amount>0&&P>0?Math.round(o.amount/P*1e3)/1e3:0,C=o.accountId&&o.accountId.trim()!==""&&o.amount>0&&!u,k=e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:v,disabled:u,size:"medium",children:i("common.cancel")}),e.jsx(We,{onClick:b,variant:"contained",disabled:!C,size:"medium",icon:u?e.jsx(Ce,{size:20}):e.jsx(xt,{}),mobileText:i("holdings.subscriptionModal.createSubscription"),desktopText:i("holdings.subscriptionModal.createSubscription"),forceTextOnly:!0,children:i(u?"holdings.subscriptionModal.creating":"holdings.subscriptionModal.createSubscription")})]});return e.jsx(Rt,{open:r,onClose:v,title:i("holdings.subscriptionModal.title"),icon:e.jsx(xt,{color:"primary"}),actions:k,loading:u,maxWidth:"md",fullWidth:!0,titleColor:"primary",size:"medium",children:e.jsxs(l,{sx:{pt:1},children:[e.jsxs(se,{variant:"outlined",sx:{mb:3,p:2,backgroundColor:"grey.50"},children:[e.jsx(c,{variant:"cardTitle",sx:{color:"text.secondary"},gutterBottom:!0,children:i("holdings.subscriptionModal.fundInformation")}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:6,children:[e.jsx(c,{variant:"labelSmall",sx:{color:"text.secondary"},children:i("holdings.subscriptionModal.fundName")}),e.jsx(c,{variant:"cardTitle",sx:{color:"primary"},children:n.name})]}),e.jsxs(W,{item:!0,xs:6,children:[e.jsx(c,{variant:"labelSmall",sx:{color:"text.secondary"},children:i("holdings.subscriptionModal.navPerUnit")}),e.jsx(c,{variant:"cardTitle",sx:{color:"primary"},children:G(P,"VND")})]})]})]}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,children:e.jsx(vx,{value:o.accountId,onChange:A=>{const L=typeof A=="string"?A:String(A||"");d(T=>({...T,accountId:L})),g.accountId&&f(T=>({...T,accountId:void 0}))},label:i("holdings.subscriptionModal.account"),placeholder:i("holdings.subscriptionModal.accountPlaceholder"),helperText:g.accountId,error:!!g.accountId,disabled:u,filterInvestorOnly:!1,portfolioId:n.portfolioId,allowCustomAccountId:!0,showPortfolioInvestors:!0,required:!0})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(vr,{value:o.amount,onChange:A=>{d(L=>({...L,amount:A})),g.amount&&f(L=>({...L,amount:void 0}))},label:i("holdings.subscriptionModal.investmentAmount"),placeholder:i("holdings.subscriptionModal.investmentAmountPlaceholder"),helperText:g.amount,error:!!g.amount,disabled:u,currency:"VND",showCurrency:!0,align:"right",required:!0})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(gi,{value:w,onChange:()=>{},label:i("holdings.subscriptionModal.unitsAutoCalculated"),placeholder:i("holdings.subscriptionModal.unitsPlaceholder"),error:!!g.units,disabled:!0,decimalPlaces:3,min:.001,step:.001,showThousandsSeparator:!0,align:"right",required:!0})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(hr,{dateAdapter:Ar,children:e.jsx(ls,{label:i("holdings.subscriptionModal.transactionDate"),value:o.transactionDate?new Date(o.transactionDate):null,onChange:A=>{const L=A?A.toISOString().split("T")[0]:"";d(T=>({...T,transactionDate:L})),g.transactionDate&&f(T=>({...T,transactionDate:void 0}))},disabled:u,slotProps:{textField:{fullWidth:!0,error:!!g.transactionDate,required:!0}}})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(Ae,{fullWidth:!0,label:i("holdings.subscriptionModal.description"),value:o.description,onChange:A=>d(L=>({...L,description:A.target.value})),disabled:u})})]}),e.jsxs(se,{variant:"outlined",sx:{mt:3,p:2,backgroundColor:"info.50",border:"1px solid",borderColor:"info.200"},children:[e.jsx(c,{variant:"pageTitle",sx:{color:"info.main"},gutterBottom:!0,children:i("holdings.subscriptionModal.calculationSummary")}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:6,md:4,children:[e.jsx(c,{variant:"labelSmall",sx:{color:"text.secondary"},children:i("holdings.subscriptionModal.navPerUnit")}),e.jsx(c,{variant:"cardValue",sx:{color:"primary"},children:G(P,"VND")})]}),e.jsxs(W,{item:!0,xs:6,md:4,children:[e.jsx(c,{variant:"labelSmall",sx:{color:"text.secondary"},children:i("holdings.subscriptionModal.calculatedUnits")}),e.jsx(c,{variant:"cardValue",sx:{color:"primary"},children:Vn(w,3)})]}),e.jsxs(W,{item:!0,xs:12,md:4,children:[e.jsx(c,{variant:"labelSmall",sx:{color:"text.secondary"},children:i("holdings.subscriptionModal.investmentAmountLabel")}),e.jsx(c,{variant:"cardValue",sx:{color:"primary"},children:G(o.amount,"VND")})]})]})]}),m&&e.jsx(je,{severity:"error",sx:{mt:2},children:m}),e.jsxs(je,{sx:{mt:2},children:[e.jsx(c,{variant:"labelSmall",sx:{mt:1},ellipsis:!1,children:i("holdings.subscriptionModal.dataImpactMessage")}),e.jsxs(l,{component:"ul",sx:{mt:1,pl:2,mb:0},children:[e.jsx(c,{component:"li",variant:"labelSmall",ellipsis:!1,children:i("holdings.subscriptionModal.dataImpactItem1")}),e.jsx(c,{component:"li",variant:"labelSmall",ellipsis:!1,children:i("holdings.subscriptionModal.dataImpactItem2")}),e.jsx(c,{component:"li",variant:"labelSmall",ellipsis:!1,children:i("holdings.subscriptionModal.dataImpactItem3")})]}),e.jsx(c,{variant:"labelSmall",sx:{mt:1,fontStyle:"italic"},ellipsis:!1,children:i("holdings.subscriptionModal.dataImpactNote")})]})]})})},f2=r=>{const[t,n]=p.useState([]),[s,a]=p.useState(!1),[i,o]=p.useState(null);return p.useEffect(()=>{if(!r){n([]),a(!1),o(null);return}(async()=>{var u,h;try{a(!0),o(null);const x=(await q.getFundInvestors(r)).reduce((g,f)=>(!g.find(j=>j.accountId===f.accountId)&&f.account&&g.push(f.account),g),[]);n(x)}catch(m){console.error("Error fetching accounts with holdings:",m),o(((h=(u=m.response)==null?void 0:u.data)==null?void 0:h.message)||"Failed to fetch accounts with holdings"),n([])}finally{a(!1)}})()},[r]),{accounts:t,loading:s,error:i}},Sx=({open:r,onClose:t,portfolio:n,onRedemptionSuccess:s,preselectedAccountId:a})=>{const{t:i}=Ne(),[o,d]=p.useState({accountId:"",amount:0,units:0,description:"",transactionDate:new Date().toISOString().split("T")[0]}),[u,h]=p.useState(!1),[m,x]=p.useState(null),[g,f]=p.useState({}),{accounts:y,loading:j,error:b}=f2((n==null?void 0:n.portfolioId)||null);p.useEffect(()=>{n&&(d({accountId:a||"",amount:0,units:0,description:"",transactionDate:new Date().toISOString().split("T")[0]}),x(null),f({}))},[n,a]);const v=()=>{const T={};return o.accountId||(T.accountId=i("holdings.redemptionModal.validation.accountRequired")),(!o.units||o.units<=0)&&(T.units=i("holdings.redemptionModal.validation.unitsRequired")),o.transactionDate||(T.transactionDate=i("holdings.redemptionModal.validation.dateRequired")),f(T),Object.keys(T).length===0},P=async()=>{var T,M;if(!(!n||!v())){h(!0),x(null);try{const O={accountId:o.accountId,portfolioId:n.portfolioId,units:o.units,description:o.description,redemptionDate:o.transactionDate};await q.redeemFromFund(O),s(),t()}catch(O){console.error("Error creating redemption:",O),x(((M=(T=O.response)==null?void 0:T.data)==null?void 0:M.message)||i("holdings.redemptionModal.error.createFailed"))}finally{h(!1)}}},w=()=>{u||(x(null),f({}),t())};if(!n)return null;const C=n.navPerUnit||0,k=o.units>0&&C>0?Math.round(o.units*C*1e3)/1e3:0,A=o.accountId&&o.units>0&&k>0&&!u,L=e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:w,disabled:u,size:"medium",children:i("common.cancel")}),e.jsx(We,{onClick:P,variant:"contained",color:"error",disabled:!A,size:"medium",icon:u?e.jsx(Ce,{size:20}):e.jsx(ja,{}),mobileText:i("holdings.redemptionModal.processRedemption"),desktopText:i("holdings.redemptionModal.processRedemption"),forceTextOnly:!0,children:i(u?"holdings.redemptionModal.processing":"holdings.redemptionModal.processRedemption")})]});return e.jsx(Rt,{open:r,onClose:w,title:i("holdings.redemptionModal.title"),icon:e.jsx(ja,{color:"error"}),actions:L,loading:u,maxWidth:"md",fullWidth:!0,titleColor:"error",size:"medium",children:e.jsxs(l,{sx:{pt:1},children:[e.jsxs(se,{variant:"outlined",sx:{mb:3,p:2,backgroundColor:"grey.50"},children:[e.jsx(c,{variant:"cardTitle",sx:{color:"text.secondary"},gutterBottom:!0,children:i("holdings.redemptionModal.fundInformation")}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:6,children:[e.jsx(c,{variant:"labelSmall",sx:{color:"text.secondary"},children:i("holdings.redemptionModal.fundName")}),e.jsx(c,{variant:"cardTitle",sx:{color:"primary"},children:n.name})]}),e.jsxs(W,{item:!0,xs:6,children:[e.jsx(c,{variant:"labelSmall",sx:{color:"text.secondary"},children:i("holdings.redemptionModal.navPerUnit")}),e.jsx(c,{variant:"cardTitle",sx:{color:"primary"},children:G(C,"VND")})]})]})]}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,children:e.jsx(vx,{value:o.accountId,onChange:T=>{const M=typeof T=="string"?T:String(T||"");d(O=>({...O,accountId:M})),g.accountId&&f(O=>({...O,accountId:void 0}))},label:i("holdings.redemptionModal.investorAccount"),placeholder:i("holdings.redemptionModal.investorAccountPlaceholder"),helperText:b?`Error: ${b}`:i("holdings.redemptionModal.investorAccountHelper"),error:!!g.accountId||!!b,disabled:u||j,accounts:y,required:!0})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(vr,{value:k,onChange:()=>{},label:i("holdings.redemptionModal.redemptionAmount"),placeholder:i("holdings.redemptionModal.redemptionAmountPlaceholder"),error:!!g.amount,disabled:!0,currency:"VND",showCurrency:!0,align:"right",required:!0})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(gi,{value:o.units,onChange:T=>{d(M=>({...M,units:T})),g.units&&f(M=>({...M,units:void 0}))},label:i("holdings.redemptionModal.unitsToRedeem"),placeholder:i("holdings.redemptionModal.unitsPlaceholder"),helperText:g.units,error:!!g.units,disabled:u,decimalPlaces:3,min:.001,step:.001,showThousandsSeparator:!0,align:"right",required:!0})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(hr,{dateAdapter:Ar,children:e.jsx(ls,{label:i("holdings.redemptionModal.transactionDate"),value:o.transactionDate?new Date(o.transactionDate):null,onChange:T=>{const M=T?T.toISOString().split("T")[0]:"";d(O=>({...O,transactionDate:M})),g.transactionDate&&f(O=>({...O,transactionDate:void 0}))},disabled:u,slotProps:{textField:{fullWidth:!0,error:!!g.transactionDate,required:!0}}})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(Ae,{fullWidth:!0,label:i("holdings.redemptionModal.description"),value:o.description,onChange:T=>d(M=>({...M,description:T.target.value})),disabled:u,placeholder:i("holdings.redemptionModal.descriptionPlaceholder")})})]}),e.jsxs(se,{variant:"outlined",sx:{mt:3,p:2,backgroundColor:"warning.50",border:"1px solid",borderColor:"warning.200"},children:[e.jsx(c,{variant:"pageTitle",sx:{color:"warning.main"},gutterBottom:!0,children:i("holdings.redemptionModal.redemptionSummary")}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:6,md:4,children:[e.jsx(c,{variant:"labelSmall",sx:{color:"text.secondary"},children:i("holdings.redemptionModal.navPerUnit")}),e.jsx(c,{variant:"cardValue",sx:{color:"primary"},children:G(C,"VND")})]}),e.jsxs(W,{item:!0,xs:6,md:4,children:[e.jsx(c,{variant:"labelSmall",sx:{color:"text.secondary"},children:i("holdings.redemptionModal.unitsToRedeemLabel")}),e.jsx(c,{variant:"cardValue",sx:{color:"primary"},children:Vn(o.units,3)})]}),e.jsxs(W,{item:!0,xs:12,md:4,children:[e.jsx(c,{variant:"labelSmall",sx:{color:"text.secondary"},children:i("holdings.redemptionModal.calculatedAmount")}),e.jsx(c,{variant:"cardValue",sx:{color:"primary"},children:G(k,"VND")})]})]})]}),m&&e.jsx(je,{severity:"error",sx:{mt:2},children:m}),e.jsxs(je,{sx:{mt:2},children:[e.jsx(c,{variant:"labelSmall",sx:{mt:1},ellipsis:!1,children:i("holdings.redemptionModal.dataImpactMessage")}),e.jsxs(l,{component:"ul",sx:{mt:1,pl:2,mb:0},children:[e.jsx(c,{component:"li",variant:"labelSmall",ellipsis:!1,children:i("holdings.redemptionModal.dataImpactItem1")}),e.jsx(c,{component:"li",variant:"labelSmall",ellipsis:!1,children:i("holdings.redemptionModal.dataImpactItem2")}),e.jsx(c,{component:"li",variant:"labelSmall",ellipsis:!1,children:i("holdings.redemptionModal.dataImpactItem3")})]}),e.jsx(c,{variant:"labelSmall",sx:{mt:1,fontStyle:"italic"},ellipsis:!1,children:i("holdings.redemptionModal.dataImpactNote")})]})]})})},y2=({portfolio:r,getUltraSpacing:t=s=>s,onPortfolioUpdate:n})=>{const{t:s}=Ne(),a=An(),{accountId:i}=Ge(),{holdings:o,loading:d,error:u,refetch:h,convertToFund:m}=h2(r.portfolioId,r.isFund||!1),[x,g]=p.useState(!1),[f,y]=p.useState(!1),[j,b]=p.useState(!1),[v,P]=p.useState(!1),[w,C]=p.useState(!1),k=async()=>{try{C(!0),await q.refreshNavPerUnit(r.portfolioId),await q.recalculateAllHoldings(r.portfolioId),n&&n(),await h()}catch(I){console.error("Error recalculating NAV and holdings:",I)}finally{C(!1)}},A=async I=>{try{await m(r.portfolioId,I),n&&n()}catch(z){throw z}},L=async()=>{try{await q.convertFundToPortfolio(r.portfolioId,i),n&&n(),P(!1)}catch(I){throw console.error("Error converting fund to portfolio:",I),I}},T=o.reduce((I,z)=>I+Number(z.totalInvestment),0),M=o.reduce((I,z)=>I+Number(z.currentValue),0),O=Number(M)-Number(T);return r.isFund?e.jsxs(l,{children:[e.jsx(se,{sx:{mb:t(3,1)},children:e.jsxs(me,{sx:{p:t(2,1.5)},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(c,{variant:"pageTitle",sx:{fontWeight:600},children:s("nav.holdings.fundSummary")}),e.jsxs(l,{sx:{display:"flex",gap:1},children:[e.jsx(Fe,{title:s("nav.holdings.recalculateNav"),children:e.jsx(Ie,{onClick:k,disabled:w||d,color:"primary",sx:{"&:hover":{backgroundColor:"primary.light",color:"white"}},children:w?e.jsx(Ce,{size:20}):e.jsx(bp,{})})}),e.jsx(Fe,{title:s("nav.holdings.refreshHoldings"),children:e.jsx(Ie,{onClick:async()=>{await h(),n&&n()},disabled:d,children:e.jsx(Mt,{})})})]})]}),e.jsxs(W,{container:!0,spacing:t(2,1),children:[e.jsx(W,{item:!0,xs:6,sm:6,md:2.4,children:e.jsxs(l,{sx:{textAlign:"center",p:1},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:s("nav.holdings.navPerUnit")}),e.jsx(c,{variant:"cardValue",sx:{fontWeight:600,color:"primary.main"},children:G(r.navPerUnit||0,r.baseCurrency)})]})}),e.jsx(W,{item:!0,xs:6,sm:6,md:2.4,children:e.jsxs(l,{sx:{textAlign:"center",p:1},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:s("nav.holdings.totalOutstandingUnits")}),e.jsx(c,{variant:"cardValue",sx:{fontWeight:600},children:Vn(r.totalOutstandingUnits||0,3)})]})}),e.jsx(W,{item:!0,xs:6,sm:6,md:2.4,sx:{display:{xs:"none",sm:"block"}},children:e.jsxs(l,{sx:{textAlign:"center",p:1},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:s("nav.holdings.numberOfInvestors")}),e.jsx(c,{variant:"cardValue",sx:{fontWeight:600},children:Vn(o.length,0)})]})}),e.jsx(W,{item:!0,xs:6,sm:6,md:2.4,children:e.jsxs(l,{sx:{textAlign:"center",p:1},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:s("nav.holdings.totalPnL")}),e.jsx(c,{variant:"cardValue",sx:{fontWeight:600,color:O>=0?"success.main":"error.main"},children:G(O,r.baseCurrency)})]})}),e.jsx(W,{item:!0,xs:6,sm:6,md:2.4,children:e.jsxs(l,{sx:{textAlign:"center",p:1},children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:s("nav.holdings.lastNavUpdate")}),e.jsx(c,{variant:"cardValue",sx:{fontWeight:600,fontSize:"0.9rem"},children:r.lastNavDate?new Date(r.lastNavDate).toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"N/A"})]})})]})]})}),e.jsx(se,{sx:{mb:t(3,1)},children:e.jsx(me,{sx:{p:t(2,1.5)},children:e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2},children:[e.jsxs(l,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(We,{variant:"contained",icon:e.jsx(xt,{}),mobileText:s("nav.holdings.new"),desktopText:s("nav.holdings.newSubscription"),onClick:()=>g(!0),sx:{minWidth:150},children:s("nav.holdings.newSubscription")}),e.jsx(We,{variant:"outlined",icon:e.jsx(ja,{}),mobileText:s("nav.holdings.process"),desktopText:s("nav.holdings.processRedemption"),onClick:()=>y(!0),sx:{minWidth:150},children:s("nav.holdings.processRedemption")})]}),e.jsx(We,{variant:"outlined",color:"warning",icon:e.jsx(Ml,{}),mobileText:s("nav.holdings.convert"),desktopText:s("nav.holdings.convertToPortfolio"),onClick:()=>P(!0),sx:{minWidth:150},children:s("nav.holdings.convertToPortfolio")})]})})}),u&&e.jsx(je,{severity:"error",sx:{mb:t(2,1)},children:e.jsx(c,{variant:"tableCell",children:u})}),e.jsx(se,{children:e.jsxs(me,{sx:{p:t(2,1.5)},children:[e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,mb:2},children:s("nav.holdings.investorHoldings")}),d?e.jsx(l,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(Ce,{})}):o.length===0?e.jsxs(l,{sx:{textAlign:"center",py:4},children:[e.jsx(c,{variant:"tableCell",color:"text.secondary",children:s("nav.holdings.noHoldings")}),e.jsx(c,{variant:"labelSmall",color:"text.secondary",sx:{mt:1},children:s("nav.holdings.noHoldingsMessage")})]}):e.jsx(at,{component:Te,variant:"outlined",children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",children:s("nav.holdings.investor")})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:s("nav.holdings.units")})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:s("nav.holdings.avgCost")})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:s("nav.holdings.totalInvestment")})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:s("nav.holdings.currentValue")})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:s("nav.holdings.unrealizedPnL")})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:s("nav.holdings.returnPercent")})}),e.jsx(S,{align:"center",children:e.jsx(c,{variant:"tableHeaderSmall",children:s("common.actions")})})]})}),e.jsx(ot,{children:o.map(I=>{var N,E;const z=I.totalInvestment>0?(I.currentValue-I.totalInvestment)/I.totalInvestment*100:0;return e.jsxs(De,{onClick:()=>a(`/holdings/${I.holdingId}?from=nav`),sx:{cursor:"pointer","&:hover":{backgroundColor:"action.hover"},"&:active":{backgroundColor:"action.selected"}},children:[e.jsx(S,{children:e.jsxs(l,{children:[e.jsx(c,{variant:"tableCell",sx:{fontWeight:600},children:((N=I.account)==null?void 0:N.name)||"Unknown"}),e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:((E=I.account)==null?void 0:E.email)||"No email"})]})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableCell",children:Vn(I.totalUnits,3)})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableCell",children:G(I.avgCostPerUnit,r.baseCurrency)})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableCell",children:G(I.totalInvestment,r.baseCurrency)})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableCell",children:G(I.currentValue,r.baseCurrency)})}),e.jsx(S,{align:"right",children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:.5},children:[I.unrealizedPnL>=0?e.jsx(He,{sx:{fontSize:16,color:"success.main"}}):e.jsx(Bt,{sx:{fontSize:16,color:"error.main"}}),e.jsx(c,{variant:"tableCell",sx:{color:I.unrealizedPnL>=0?"success.main":"error.main",fontWeight:600},children:G(I.unrealizedPnL,r.baseCurrency)})]})}),e.jsx(S,{align:"right",children:e.jsx(ce,{label:ye(z,2),color:z>=0?"success":"error",size:"small"})}),e.jsx(S,{align:"center",children:e.jsx(Fe,{title:s("nav.holdings.viewDetails"),children:e.jsx(Ie,{size:"small",onClick:R=>{R.stopPropagation(),a(`/holdings/${I.holdingId}?from=nav`)},children:e.jsx(Xt,{})})})})]},I.holdingId)})})]})})]})}),e.jsx(wx,{open:x,onClose:()=>g(!1),portfolio:r,onSubscriptionSuccess:()=>{g(!1),h(),n==null||n()}}),e.jsx(Sx,{open:f,onClose:()=>y(!1),portfolio:r,onRedemptionSuccess:()=>{y(!1),h(),n==null||n()}}),e.jsx(x2,{open:v,onClose:()=>P(!1),portfolio:r,onConvert:L})]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{sx:{mb:t(3,1)},children:e.jsxs(me,{sx:{p:t(2,1.5),textAlign:"center"},children:[e.jsx(Ue,{sx:{fontSize:48,color:"text.secondary",mb:2}}),e.jsx(c,{variant:"cardTitle",gutterBottom:!0,children:s("nav.holdings.notFund")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{mb:3},children:s("nav.holdings.notFundMessage")}),e.jsx(We,{variant:"contained",icon:e.jsx(Ue,{}),mobileText:s("nav.holdings.convert"),desktopText:s("nav.holdings.convertToFund"),onClick:()=>b(!0),disabled:d,children:d?e.jsx(Ce,{size:20}):s("nav.holdings.convertToFund")})]})}),e.jsx(m2,{open:j,onClose:()=>b(!1),portfolio:r,onConvert:A,loading:d})]})},b2=({portfolio:r,isCompactMode:t,getUltraSpacing:n,onPortfolioUpdate:s})=>e.jsxs(l,{sx:{backgroundColor:"background.paper",minHeight:"80vh",pt:0,px:n(2,1)},children:[e.jsx(D,{variant:t?"h6":"h5",gutterBottom:!0,sx:{fontWeight:600,color:"#4a5568",mb:n(3,1.5),fontSize:t?"0.9rem":void 0,display:"flex",alignItems:"center",gap:1}}),e.jsx(l,{sx:{mb:n(4,2)},children:e.jsx(y2,{portfolio:r,isCompactMode:t,getUltraSpacing:n,onPortfolioUpdate:s})})]}),j2=({data:r,loading:t=!1,error:n=null})=>{const{t:s}=Ne(),a=Je();if(t)return e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400,children:e.jsx(Ce,{})});if(n||!r)return e.jsx(je,{severity:"error",children:n||s("investorReport.error.loadFailed","Khng th ti bo co u t. Vui lng th li sau.")});const i=d=>({STOCK:"C phiu",BOND:"Tri phiu",GOLD:"Vng",CASH:"Tin mt",DEPOSITS:"Tin gi",CRYPTO:"Crypto",REALESTATE:"Bt ng sn",COMMODITY:"Hng ha",OTHER:"Khc",ETF:"ETF"})[d.toUpperCase()]||d,o=d=>{const u=i(d);return{"C phiu":a.palette.primary.main,"Tri phiu":a.palette.secondary.main,Vng:a.palette.warning.main,"Tin gi":a.palette.info.main,"Tin mt":a.palette.success.main,Crypto:a.palette.error.main,"Bt ng sn":a.palette.secondary.main,"Hng ha":a.palette.warning.main,Khc:a.palette.grey[500]}[u]||a.palette.grey[500]};return e.jsxs(l,{sx:{backgroundColor:"background.paper",px:{xs:0,md:2}},children:[e.jsxs(l,{mb:2,px:{xs:1,md:0},pt:{xs:1,sm:0},children:[e.jsx(l,{display:"flex",flexDirection:"column",gap:1,children:r.performance&&e.jsx(l,{justifyContent:"flex-end",sx:{display:{xs:"none",sm:"flex"}},children:e.jsxs(l,{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap",children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:.5,children:[e.jsxs(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.65rem"},children:[r.lastUpdated&&Gt(r.lastUpdated)!==Gt(new Date)?s("investorView.lastestDaily","Gn nht"):s("investorView.daily","Hm nay"),":"]}),e.jsx(c,{variant:"caption",color:(r.performance.dailyGrowth||0)>=0?"success.main":"error.main",fontWeight:"bold",sx:{fontSize:"0.7rem"},children:In(r.performance.dailyGrowth||0,2)})]}),e.jsxs(l,{display:"flex",alignItems:"center",gap:.5,children:[e.jsxs(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.65rem"},children:[s("investorReport.monthlyGrowth","Thng ny"),":"]}),e.jsx(c,{variant:"caption",color:(r.performance.monthlyGrowth||0)>=0?"success.main":"error.main",fontWeight:"bold",sx:{fontSize:"0.7rem"},children:In(r.performance.monthlyGrowth||0,2)})]}),e.jsxs(l,{display:"flex",alignItems:"center",gap:.5,children:[e.jsxs(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.65rem"},children:[s("investorReport.ytdGrowth","T u nm"),":"]}),e.jsx(c,{variant:"caption",color:(r.performance.ytdGrowth||0)>=0?"success.main":"error.main",fontWeight:"bold",sx:{fontSize:"0.7rem"},children:In(r.performance.ytdGrowth||0,2)})]})]})})}),e.jsx(l,{display:"flex",justifyContent:"flex-end",children:e.jsxs(c,{variant:"caption",color:"text.secondary",children:[s("investorReport.lastUpdated","Cp nht ln cui"),": ",Gt(r.lastUpdated,"dd/MM/yyyy")]})})]}),e.jsxs(l,{sx:{mb:3},children:[e.jsx(l,{sx:{display:{xs:"none",md:"block"}},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{mb:1},children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(l,{sx:{mr:2,display:"flex",alignItems:"center"},children:e.jsx(Ue,{color:"primary",sx:{fontSize:32}})}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",sx:{mb:.5},children:s("investorReport.totalValue","Tng gi tr danh mc")}),e.jsx(c,{variant:"cardValue",color:"primary",sx:{mb:.5},children:G(r.totalValue)}),e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",children:s("investorReport.totalValueDesc","Tng ti sn qu")})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{mb:1},children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(l,{sx:{mr:2,display:"flex",alignItems:"center"},children:e.jsx($s,{color:"info",sx:{fontSize:32}})}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",sx:{mb:.5},children:s("investorReport.investmentAssets","Tin u t")}),e.jsx(c,{variant:"cardValue",color:"warning.main",sx:{mb:.5},children:G(r.assetValue)}),e.jsxs(c,{variant:"cardSubtitle",color:"text.secondary",children:[ye(r.summary.assetPercentage)," ",s("investorReport.ofTotal","tng ti sn")]})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{mb:1},children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(l,{sx:{mr:2,display:"flex",alignItems:"center"},children:e.jsx(ba,{color:"success",sx:{fontSize:32}})}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",sx:{mb:.5},children:s("investorReport.cashBalance","Tin mt")}),e.jsx(c,{variant:"cardValue",color:"success.main",sx:{mb:.5},children:G(r.cashBalance)}),e.jsxs(c,{variant:"cardSubtitle",color:"text.secondary",children:[ye(r.summary.cashPercentage)," ",s("investorReport.ofTotal","tng ti sn")]})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{mb:1},children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(l,{sx:{mr:2,display:"flex",alignItems:"center"},children:e.jsx(ar,{color:"warning",sx:{fontSize:32}})}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",sx:{mb:.5},children:s("investorReport.deposits","Tin gi")}),e.jsx(c,{variant:"cardValue",color:"info.main",sx:{mb:.5},children:G(r.summary.depositsValue||0)}),e.jsxs(c,{variant:"cardSubtitle",color:"text.secondary",children:[ye(r.summary.depositsPercentage||0)," ",s("investorReport.ofTotal","tng ti sn")]})]})]})})})})]})}),e.jsx(l,{sx:{display:{xs:"block",md:"none"},p:{xs:1,md:2}},children:e.jsx(se,{children:e.jsxs(me,{sx:{p:2},children:[e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:6,children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2,pb:2,borderBottom:`1px solid ${a.palette.divider}`},children:[e.jsx(Ue,{color:"primary",sx:{fontSize:20,mr:1}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",color:"text.secondary",sx:{fontSize:"0.75rem"},children:s("investorReport.totalValue","Tng gi tr")}),e.jsx(c,{variant:"cardValue",color:"primary",fontWeight:"600",sx:{fontSize:"0.9rem"},children:G(r.totalValue)})]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(ba,{color:"success",sx:{fontSize:20,mr:1}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",color:"text.secondary",sx:{fontSize:"0.75rem"},children:s("investorReport.cashBalance","Tin mt")}),e.jsx(c,{variant:"cardValue",color:"success.main",fontWeight:"600",sx:{fontSize:"0.9rem"},children:G(r.cashBalance)})]})]})]}),e.jsxs(W,{item:!0,xs:6,children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2,pb:2,borderBottom:`1px solid ${a.palette.divider}`},children:[e.jsx($s,{color:"info",sx:{fontSize:20,mr:1}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",color:"text.secondary",sx:{fontSize:"0.75rem"},children:s("investorReport.investmentAssets","Tin u t")}),e.jsx(c,{variant:"cardValue",color:"warning.main",fontWeight:"600",sx:{fontSize:"0.9rem"},children:G(r.assetValue)}),e.jsxs(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.65rem"},desktopOnly:!0,children:[ye(r.summary.assetPercentage)," ",s("investorReport.ofTotal","tng")]})]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(ar,{color:"warning",sx:{fontSize:20,mr:1}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",color:"text.secondary",sx:{fontSize:"0.75rem"},children:s("investorReport.deposits","Tin gi")}),e.jsx(c,{variant:"cardValue",color:"info.main",fontWeight:"600",sx:{fontSize:"0.9rem"},children:G(r.summary.depositsValue||0)}),e.jsxs(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.65rem"},desktopOnly:!0,children:[ye(r.summary.depositsPercentage||0)," ",s("investorReport.ofTotal","tng")]})]})]})]})]}),r.performance&&e.jsxs(l,{sx:{mt:2,pt:2,borderTop:`1px solid ${a.palette.divider}`},children:[e.jsx(c,{variant:"body2",color:"text.secondary",sx:{mb:1.5,fontSize:"0.8rem",fontWeight:600},children:s("investorReport.performance","Hiu sut")}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(l,{sx:{textAlign:"center",flex:1},children:[e.jsx(c,{variant:"body1",color:(r.performance.dailyGrowth||0)>=0?"success.main":"error.main",fontWeight:"600",sx:{fontSize:"0.9rem"},children:In(r.performance.dailyGrowth||0,2)}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:r.lastUpdated&&Gt(r.lastUpdated)!==Gt(new Date)?s("investorView.lastestDaily","Gn nht"):s("investorView.daily","Hm nay")})]}),e.jsxs(l,{sx:{textAlign:"center",flex:1},children:[e.jsx(c,{variant:"body1",color:(r.performance.monthlyGrowth||0)>=0?"success.main":"error.main",fontWeight:"600",sx:{fontSize:"0.9rem"},children:In(r.performance.monthlyGrowth||0,2)}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:s("investorReport.monthlyGrowth","Thng ny")})]}),e.jsxs(l,{sx:{textAlign:"center",flex:1},children:[e.jsx(c,{variant:"body1",color:(r.performance.ytdGrowth||0)>=0?"success.main":"error.main",fontWeight:"600",sx:{fontSize:"0.9rem"},children:In(r.performance.ytdGrowth||0,2)}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},ellipsis:!1,children:s("investorReport.ytdGrowth","T u nm")})]})]})]})]})})})]}),e.jsx(Ki,{variant:"transparent",size:"medium",spacing:"medium",hoverable:!1,title:s("investorReport.assetAllocation","Phn b ti sn theo loi"),sx:{padding:"0 !important","& .MuiCardContent-root":{padding:"0 !important"},"& .MuiCard-root":{padding:"0 !important"},"& .MuiPaper-root":{padding:"0 !important"}},children:e.jsx(gs,{hoverable:!1,columns:[{key:"assetType",header:s("investorReport.assetType","Loi ti sn"),render:d=>e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(l,{sx:{width:12,height:12,borderRadius:"50%",backgroundColor:o(d.assetType),mr:1}}),i(d.assetType)]})},{key:"value",header:s("investorReport.value","Gi tr"),align:"right",render:d=>e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:G(d.value)})},{key:"percentage",header:s("investorReport.percentage","T l"),align:"right",render:d=>e.jsx(ce,{label:ye(d.percentage),size:"small",sx:{backgroundColor:U(o(d.assetType),.1),color:o(d.assetType)}})},{key:"count",header:s("investorReport.count","S lng"),align:"right",cellSx:{display:{xs:"none",sm:"table-cell"}},render:d=>e.jsxs(c,{variant:"tableCell",children:[d.count," ",s("investorReport.positions","v th")]})}],data:r.assetAllocation,size:"small"})}),e.jsx(Ki,{variant:"transparent",size:"medium",spacing:"medium",hoverable:!1,title:s("investorReport.assetDetails","Chi tit ti sn"),sx:{padding:"0 !important","& .MuiCardContent-root":{padding:"0 !important"},"& .MuiCard-root":{padding:"0 !important"},"& .MuiPaper-root":{padding:"0 !important"}},children:e.jsx(gs,{hoverable:!1,columns:[{key:"symbol",header:s("investorReport.symbol","M"),render:d=>e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:d.symbol})},{key:"type",header:s("investorReport.type","Loi"),render:d=>e.jsx(ce,{label:i(d.assetType),size:"small",sx:{fontSize:{xs:"0.6rem",sm:"0.9rem"},height:24,padding:"0 4px",backgroundColor:U(o(d.assetType),.1),color:o(d.assetType)}})},{key:"quantity",header:s("investorReport.quantity","S lng"),align:"right",render:d=>e.jsx(c,{variant:"tableCell",children:dn(d.quantity,d.assetType==="CRYPTO"?5:1)})},{key:"price",header:s("investorReport.price","Gi hin ti"),align:"right",cellSx:{display:{xs:"none",sm:"table-cell"}},render:d=>e.jsx(c,{variant:"tableCell",children:G(d.currentPrice)})},{key:"value",header:s("investorReport.value","Gi tr"),align:"right",render:d=>e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:G(d.currentValue)})},{key:"percentage",header:s("investorReport.percentage","T l"),align:"right",cellSx:{display:{xs:"none",sm:"table-cell"}},render:d=>e.jsx(c,{variant:"tableCell",children:ye(d.percentage)})},{key:"unrealizedPl",header:s("investorReport.unrealizedPl","Li/L cha thc hin"),align:"right",cellSx:{display:{xs:"none",sm:"table-cell"}},render:d=>e.jsxs(c,{variant:"tableCell",sx:{color:d.unrealizedPl>=0?"success.main":"error.main"},children:[d.unrealizedPl>=0?"+":"",G(d.unrealizedPl)]})}],data:r.assetDetails,size:"small"})}),r.deposits&&r.deposits.length>0&&e.jsx(Ki,{variant:"transparent",size:"medium",spacing:"medium",hoverable:!1,title:s("investorReport.depositsDetails","Chi tit tin gi"),sx:{padding:"0 !important","& .MuiCardContent-root":{padding:"0 !important"},"& .MuiCard-root":{padding:"0 !important"},"& .MuiPaper-root":{padding:"0 !important"}},children:e.jsx(gs,{hoverable:!1,columns:[{key:"bankName",header:s("investorReport.bankName","Ngn hng"),render:d=>e.jsx(c,{variant:"tableCell",children:d.bankName})},{key:"principal",header:s("investorReport.principal","S tin gc"),align:"right",cellSx:{display:{xs:"none",sm:"table-cell"}},render:d=>e.jsx(c,{variant:"tableCell",fontWeight:"medium",children:G(d.principal)})},{key:"interestRate",header:s("investorReport.interestRate","Li sut (%)"),align:"right",render:d=>e.jsxs(c,{variant:"tableCell",color:"success.main",children:[typeof d.interestRate=="number"?d.interestRate.toFixed(2):(parseFloat(d.interestRate)||0).toFixed(2),"%"]})},{key:"totalValue",header:s("investorReport.totalValueWithInterest","Tng vn v li"),align:"right",render:d=>e.jsx(c,{variant:"tableCell",fontWeight:"medium",color:"primary.main",children:G(d.totalValue)})},{key:"status",header:s("investorReport.status","Trng thi"),cellSx:{display:{xs:"none",sm:"table-cell"}},render:d=>e.jsx(ce,{label:d.status,size:"small",color:d.status==="ACTIVE"?"success":"default",variant:d.status==="ACTIVE"?"filled":"outlined"})},{key:"startDate",header:s("investorReport.startDate","Ngy bt u"),cellSx:{display:{xs:"none",sm:"table-cell"}},render:d=>e.jsx(c,{variant:"tableCell",children:new Date(d.startDate).toLocaleDateString("vi-VN")})},{key:"endDate",header:s("investorReport.endDate","Ngy kt thc"),render:d=>e.jsx(c,{variant:"tableCell",children:d.endDate?new Date(d.endDate).toLocaleDateString("vi-VN"):"Khng xc nh"})}],data:r.deposits,size:"small"})})]})},Tx=({portfolioId:r,accountId:t})=>{const{t:n}=Ne(),[s,a]=p.useState(null),[i,o]=p.useState(!0),[d,u]=p.useState(null);return p.useEffect(()=>{(async()=>{if(!(!r||!t)){o(!0),u(null);try{const m=await q.getInvestorReport(r,t),x={portfolioId:m.portfolio.id,portfolioName:m.portfolio.name,totalValue:m.portfolio.totalValue,cashBalance:m.portfolio.cashBalance,assetValue:m.portfolio.assetValue,assetAllocation:m.assetAllocation,assetDetails:m.assetDetails,summary:{totalAssets:m.summary.totalAssets,totalCash:m.summary.totalCash,totalValue:m.summary.totalValue,cashPercentage:m.summary.cashPercentage,assetPercentage:m.summary.assetPercentage,depositsValue:m.portfolio.depositsValue,depositsPercentage:m.summary.depositsPercentage},deposits:m.deposits,performance:m.performance,lastUpdated:m.portfolio.lastUpdated};a(x)}catch(m){console.error("Error fetching investor report:",m),u(n("investorReport.error.loadFailed","Khng th ti bo co u t. Vui lng th li sau."))}finally{o(!1)}}})()},[r,t,n]),e.jsx(j2,{data:s,loading:i,error:d})},Cx=({open:r,onClose:t,onConfirm:n,isRecalculating:s})=>{const{t:a}=Ne(),i=e.jsx(l,{sx:{p:1.5,borderRadius:"50%",bgcolor:"warning.light",color:"warning.contrastText",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(on,{fontSize:"medium"})}),o=e.jsxs(e.Fragment,{children:[e.jsx(ut,{onClick:t,variant:"outlined",disabled:s,sx:{textTransform:"none",minWidth:100},children:a("common.cancel")}),e.jsx(ut,{onClick:n,variant:"contained",color:"warning",disabled:s,startIcon:s?e.jsx(Ce,{size:20}):e.jsx(Mt,{}),sx:{textTransform:"none",minWidth:140},children:a(s?"snapshots.recalculating":"snapshots.recalculateAll")})]});return e.jsxs(Rt,{open:r,onClose:t,title:a("snapshots.recalculateConfirmTitle"),icon:i,actions:o,loading:s,maxWidth:"sm",titleColor:"warning",size:"medium",children:[e.jsx(c,{variant:"labelMedium",ellipsis:!1,sx:{mb:3,mt:3},children:a("snapshots.recalculateConfirm")}),e.jsx(je,{severity:"warning",sx:{"& .MuiAlert-message":{color:"text.primary",width:"100%"}},children:a("snapshots.recalculateWarning")})]})};function Gs(r){const{children:t,value:n,index:s,...a}=r;return e.jsx("div",{role:"tabpanel",hidden:n!==s,id:`portfolio-tabpanel-${s}`,"aria-labelledby":`portfolio-tab-${s}`,...a,children:n===s&&e.jsx(l,{sx:{p:{xs:2,sm:2.5,md:3}},children:t})})}const v2=()=>{var Se,Ve;const{t:r}=Ne(),{portfolioId:t}=So(),[n]=vc(),s=An(),a=Pa(),[i,o]=p.useState(0),[d,u]=p.useState(!1),[h,m]=p.useState(!1),[x,g]=p.useState(!1),[f,y]=p.useState("fund-manager"),[j,b]=p.useState(!1),[v,P]=p.useState(null),[w,C]=p.useState(!1),[k,A]=p.useState(!1),L=p.useRef(null),[T,M]=p.useState({open:!1,message:"",severity:"info"}),{accountId:O}=Ge(),I=Kt(),z=Je(),N=Nt(z.breakpoints.down("sm"));p.useEffect(()=>{f==="fund-manager"&&o(0)},[f]),p.useEffect(()=>{is()},[t]),p.useEffect(()=>{if(f==="fund-manager"){const Re=n.get("tab");if(Re){let xe;isNaN(Number(Re))?xe={performance:0,allocation:1,trading:2,deposit:3,"cash-flow":4,holdings:5}[Re]??0:xe=parseInt(Re,10),xe>=0&&xe<=5&&(o(xe),is())}}},[n,f]),p.useEffect(()=>{if(f==="fund-manager"&&L.current){const Re=()=>{var te,Ee,Ke;const xe=(te=L.current)==null?void 0:te.querySelector(".MuiTabs-flexContainer");if(xe){const cn=xe.querySelectorAll(".MuiTab-root")[i];if(cn){const Ut=(Ee=L.current)==null?void 0:Ee.querySelector(".MuiTabs-scroller");if(Ut&&((Ke=L.current)==null?void 0:Ke.querySelector(".MuiTabs-flexContainer"))){const mt=Ut.clientWidth,_t=cn.offsetLeft,us=cn.offsetWidth,ke=_t+us/2,$e=mt/2,Qe=ke-$e,Fn=Ut.scrollWidth-mt,Nr=Math.max(0,Math.min(Qe,Fn));Ut.scrollTo({left:Nr,behavior:"smooth"})}}}};requestAnimationFrame(()=>{requestAnimationFrame(()=>{setTimeout(Re,200)})})}},[i,f]);const E=(Re,xe)=>h?xe:Re,{portfolio:R,isLoading:V,error:F,refetch:B}=zo(t),{performanceData:$}=Mc(t),Y=R&&O?R.accountId===O||((Se=R.userPermission)==null?void 0:Se.isOwner)===!0:!1,_=Kc(),X=Gc(t).data||[],ne=(Re,xe)=>{if(f==="fund-manager"){const te=Math.min(Math.max(xe,0),5);o(te),is()}},oe=async Re=>{try{await _.mutateAsync(Re),u(!1)}catch(xe){console.error("Error creating trade:",xe)}};p.useEffect(()=>{if(T.open){const Re=setTimeout(()=>{ie()},4e3);return()=>clearTimeout(Re)}},[T.open]);const ee=async()=>{if(t){g(!0);try{const Re=new Date().toISOString().split("T")[0];try{const xe=await yn.bulkRecalculateSnapshots(t,O,Re);if(xe.status==="PROCESSING"){const te=async()=>{try{const Ee=await yn.getBulkRecalculateStatus(t,xe.trackingId);Ee.status==="completed"?await H():Ee.status==="failed"?(fe("Failed to calculate performance.","warning"),await H()):Ee.status==="in_progress"||Ee.status==="started"?setTimeout(te,1e3):fe("Performance status unknown.","warning")}catch(Ee){console.error("Failed to get snapshot status:",Ee),fe("Failed to get performance status. Refreshing data anyway.","warning"),await H()}};setTimeout(te,500)}else fe("Performance calculated successfully","success"),await H()}catch(xe){console.error("Failed to calculate performance:",xe),fe("Failed to calculate performance. Refreshing data anyway.","warning"),await H()}}catch(Re){console.error(" Error refreshing data:",Re),fe("Failed to refresh data","error")}finally{}}},H=async()=>{try{await Pk(I,t),await Dk(I,t),await Promise.all([I.invalidateQueries(["portfolio",t]),I.invalidateQueries(["portfolio-performance",t]),I.invalidateQueries(["portfolio-allocation",t]),I.invalidateQueries(["portfolio-positions",t]),I.invalidateQueries(["trades",t]),I.invalidateQueries(["portfolio-permission-stats",t]),I.invalidateQueries(["investor-report",t]),I.invalidateQueries(["cash-flow",t])]),fe("Data refreshed successfully","success")}catch(Re){console.error(" Error refreshing portfolio data:",Re),fe("Failed to refresh data","error")}finally{g(!1)}},Q=X.length,Z=X.reduce((Re,xe)=>Re+(Number(xe.quantity)*Number(xe.price)||0),0),J=X.reduce((Re,xe)=>Re+(Number(xe.fee)||0)+(Number(xe.tax)||0),0),ae=X.reduce((Re,xe)=>Re+(Number(xe.realizedPl)||0),0),ue=()=>{const Re=a.state,xe=(Re==null?void 0:Re.from)==="investor"||(Re==null?void 0:Re.fromInvestor)===!0,Ee=n.get("from")==="investor",Ke=document.referrer,Qt=Ke&&(Ke.includes("/investor")||Ke.endsWith("/investor"));s(xe||Ee||Qt?"/investor":"/portfolios")},le=Re=>{P(Re.currentTarget)},pe=()=>{P(null)},Me=()=>{b(!0),pe()},Le=()=>{A(!0),pe()},qe=async()=>{A(!1),C(!0);try{const Re=await yn.bulkRecalculateSnapshots(t,O);if(Re.status==="PROCESSING"){fe(`Processing ${Re.dateRange?`${Re.dateRange.startDate} to ${Re.dateRange.endDate}`:"snapshots"} in background. Estimated duration: ${Re.estimatedDuration}`,"info");const xe=async()=>{try{const te=await yn.getBulkRecalculateStatus(t,Re.trackingId);te.status==="completed"?(fe(`Completed: ${te.summary.totalSnapshots} snapshots across ${te.summary.successfulDates} dates`,"success"),setTimeout(()=>{B().catch(Ee=>{console.warn("Failed to refresh portfolio data:",Ee)})},100),await H(),C(!1)):te.status==="failed"?(fe("Recalculate failed. Please try again.","error"),C(!1)):te.status==="in_progress"||te.status==="started"?setTimeout(xe,1e3):(fe("Recalculate status unknown. Please check manually.","warning"),C(!1))}catch(te){console.error("Failed to get bulk recalculate status:",te),fe("Failed to get recalculate status. Please check manually.","error"),C(!1)}};setTimeout(xe,500)}}catch(Re){console.error("Failed to bulk recalculate snapshots:",Re),fe(r("snapshots.recalculateFailed"),"error"),C(!1)}},de=()=>{A(!1)},fe=(Re,xe)=>{M({open:!0,message:Re,severity:xe})},ie=()=>{M(Re=>({...Re,open:!1}))};return V?e.jsxs(l,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"50vh",gap:2,children:[e.jsx(Ce,{size:60,thickness:4}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:r("portfolio.loading","ang ti d liu...")})]}):F||!R?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400,children:e.jsx(c,{variant:"errorText",children:r("portfolio.failedToLoad")})}):e.jsxs(l,{className:"portfolio-detail",sx:{scrollBehavior:"smooth",position:"relative",minHeight:"100vh",overflow:"visible",WebkitOverflowScrolling:"touch"},children:[e.jsx(l,{sx:{backgroundColor:"rgba(255, 255, 255, 0.95)",borderBottom:"1px solid",borderColor:"divider",py:{xs:1,sm:1.5,md:2},px:{xs:1,sm:1.5,md:2},mb:{xs:1.5,sm:2,md:3},boxShadow:{xs:"0 2px 8px rgba(0,0,0,0.08)",sm:"0 4px 12px rgba(0,0,0,0.1)"},backdropFilter:"blur(10px)"},children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{flexDirection:{xs:"column",sm:"row"},gap:{xs:1.5,sm:2,md:0},width:"100%"},children:[e.jsxs(l,{sx:{textAlign:"left",width:{xs:"100%",sm:"auto"},flex:{sm:1},display:"flex",alignItems:"left",justifyContent:"space-between",flexDirection:{xs:"row",sm:"column"},gap:{xs:1,sm:0}},children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",sx:{minWidth:0,flex:1},children:[e.jsx(c,{variant:"pageTitle",gutterBottom:!1,sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:{xs:"180px",sm:"300px",md:"400px",lg:"500px"}},children:R.name}),R.userPermission&&e.jsx(Jl,{permission:R.userPermission,size:"small",showIcon:!0})]}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",sx:{display:{xs:"none",sm:"block"}},children:r("portfolio.managementTrading")}),e.jsxs(l,{display:{xs:"flex",sm:"none"},gap:1,sx:{flexDirection:"row",flexShrink:0,flexWrap:"nowrap",overflow:"hidden"},children:[e.jsx(Fe,{title:r("portfolio.backToPortfolios"),children:e.jsx(Ie,{onClick:ue,color:"primary",size:"medium",sx:{borderRadius:2,width:40,height:40,flexShrink:0,border:"1px solid",borderColor:"primary.main",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(0,0,0,0.15)",backgroundColor:"primary.light",color:"primary.contrastText"}},children:e.jsx(Kr,{})})}),e.jsx(tr,{onClick:ee,disabled:x,color:"primary",size:"medium",tooltip:r(x?"portfolio.calculatingPerformance":"portfolio.refreshAllData"),sx:{borderRadius:2,width:40,height:40,flexShrink:0,border:"1px solid",borderColor:"primary.main",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(0,0,0,0.15)",backgroundColor:"primary.light",color:"primary.contrastText"},"&:disabled":{opacity:.7,cursor:"not-allowed"}},children:x?e.jsx(Ce,{size:20,color:"inherit"}):e.jsx(Mt,{})}),e.jsx(tr,{onClick:le,color:"primary",size:"medium",tooltip:r("common.moreActions"),sx:{borderRadius:2,width:40,height:40,flexShrink:0,border:"1px solid",borderColor:"primary.main",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(0,0,0,0.15)",backgroundColor:"primary.light",color:"primary.contrastText"}},children:w?e.jsx(Ce,{size:20}):e.jsx(wr,{})})]})]}),e.jsxs(l,{display:{xs:"none",sm:"flex"},gap:2,sx:{flexDirection:"row",width:"auto",flexShrink:0,flexWrap:"nowrap",overflow:"hidden",pt:.5},children:[e.jsx(Fe,{title:r("portfolio.backToPortfolios"),children:e.jsx(Ie,{onClick:ue,color:"primary",size:"medium",sx:{borderRadius:2,width:40,height:40,flexShrink:0,border:"1px solid",borderColor:"primary.main",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(0,0,0,0.15)",backgroundColor:"primary.light",color:"primary.contrastText"}},children:e.jsx(Kr,{})})}),e.jsx(tr,{onClick:ee,disabled:x,color:"primary",size:"medium",tooltip:r(x?"portfolio.calculatingPerformance":"portfolio.refreshAllData"),sx:{borderRadius:2,width:40,height:40,flexShrink:0,border:"1px solid",borderColor:"primary.main",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(0,0,0,0.15)",backgroundColor:"primary.light",color:"primary.contrastText"},"&:disabled":{opacity:.7,cursor:"not-allowed"}},children:x?e.jsx(Ce,{size:20,color:"inherit"}):e.jsx(Mt,{})}),e.jsx(tr,{onClick:le,color:"primary",size:"medium",tooltip:r("common.moreActions"),sx:{borderRadius:2,width:40,height:40,flexShrink:0,border:"1px solid",borderColor:"primary.main",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(0,0,0,0.15)",backgroundColor:"primary.light",color:"primary.contrastText"}},children:w?e.jsx(Ce,{size:20}):e.jsx(wr,{})})]})]})}),e.jsxs(W,{container:!0,spacing:{xs:2,sm:3},sx:{mb:{xs:2,sm:4},maxWidth:"100%",margin:0,"& .MuiGrid-item":{paddingLeft:{xs:"8px",sm:"12px",md:"16px"},paddingTop:{xs:"8px",sm:"12px",md:"16px"}}},children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{sx:{background:"linear-gradient(135deg, #f8f9ff 0%, #e8f0ff 100%)",color:"#1a1a1a",position:"relative",overflow:"hidden",border:"1px solid #e0e7ff","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(102, 126, 234, 0.15)",transition:"all 0.3s ease-in-out"}},children:[e.jsx(l,{sx:{position:"absolute",top:-20,right:-20,width:80,height:80,borderRadius:"50%",background:"rgba(102, 126, 234, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ue,{sx:{fontSize:32,opacity:.6,color:"#667eea"}})}),e.jsxs(me,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",p:{xs:1.5,sm:2.5,md:3}},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"cardTitle",sx:{mb:{xs:.3,sm:.5}},children:r("portfolio.portfolioValue")}),e.jsx(c,{variant:"cardSubtitle",children:r("portfolio.assetValueNav")})]}),e.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"row",sm:"row"},gap:{xs:1,sm:2},mt:2},children:[e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:{xs:.5,sm:.8}},ellipsis:!0,children:r("portfolio.capitalValue")}),e.jsx(c,{variant:"cardValue",ellipsis:!0,children:G(R.totalCapitalValue||0,R.baseCurrency)})]}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:{xs:.5,sm:.8}},ellipsis:!0,children:r("portfolio.currentNav")}),e.jsx(c,{variant:"cardValue",ellipsis:!0,children:G(R.totalAllValue,R.baseCurrency)})]})]})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{sx:{background:(($==null?void 0:$.totalReturn)||0)>=0?"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)":"linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%)",color:"#1a1a1a",position:"relative",overflow:"hidden",border:(($==null?void 0:$.totalReturn)||0)>=0?"1px solid #bae6fd":"1px solid #fecaca","&:hover":{transform:"translateY(-2px)",boxShadow:(($==null?void 0:$.totalReturn)||0)>=0?"0 4px 20px rgba(79, 172, 254, 0.15)":"0 4px 20px rgba(250, 112, 154, 0.15)",transition:"all 0.3s ease-in-out"}},children:[e.jsx(l,{sx:{position:"absolute",top:-20,right:-20,width:80,height:80,borderRadius:"50%",background:(($==null?void 0:$.totalReturn)||0)>=0?"rgba(79, 172, 254, 0.1)":"rgba(250, 112, 154, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:(($==null?void 0:$.totalReturn)||0)>=0?e.jsx(He,{sx:{fontSize:32,opacity:.6,color:"#0ea5e9"}}):e.jsx(Bt,{sx:{fontSize:32,opacity:.6,color:"#f43f5e"}})}),e.jsxs(me,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",p:{xs:1.5,sm:2.5,md:3}},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"cardTitle",sx:{mb:{xs:.3,sm:.5}},children:r("portfolio.performance")}),e.jsx(c,{variant:"cardSubtitle",children:r("portfolio.totalAnnualReturns")})]}),e.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"row",sm:"row"},gap:{xs:1,sm:2},mt:2},children:[e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:{xs:.5,sm:.8}},children:r("portfolio.ytdReturn")}),e.jsx(c,{variant:"cardValue",sx:{color:(($==null?void 0:$.ytdReturn)||0)>=0?"#059669":"#dc2626"},children:$?ye($.ytdReturn):r("common.noData")})]}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:{xs:.5,sm:.8}},children:r("portfolio.totalReturn")}),e.jsx(c,{variant:"cardValue",sx:{color:(($==null?void 0:$.totalReturn)||0)>=0?"#059669":"#dc2626"},children:$?ye($.totalReturn):r("common.noData")})]})]})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{sx:{background:"linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)",color:"#1a1a1a",position:"relative",overflow:"hidden",border:"1px solid #bbf7d0","&:hover":{transform:"translateY(-2px)",boxShadow:"0 4px 20px rgba(34, 197, 94, 0.15)",transition:"all 0.3s ease-in-out"},display:{xs:"none",sm:"block"}},children:[e.jsx(l,{sx:{position:"absolute",top:-20,right:-20,width:80,height:80,borderRadius:"50%",background:"rgba(34, 197, 94, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(He,{sx:{fontSize:32,opacity:.6,color:"#22c55e"}})}),e.jsxs(me,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",p:{xs:1.5,sm:2.5,md:3}},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"cardTitle",sx:{mb:{xs:.3,sm:.5}},children:r("portfolio.tradingActivity")}),e.jsx(c,{variant:"cardSubtitle",children:r("portfolio.tradingVolume")})]}),e.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"row",sm:"row"},gap:{xs:1,sm:2},mt:2},children:[e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:{xs:.5,sm:.8}},children:r("portfolio.totalTrades")}),e.jsx(c,{variant:"cardValue",children:Vn(Q,0)})]}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:{xs:.5,sm:.8}},children:r("portfolio.totalTradedValue")}),e.jsx(c,{variant:"cardValue",children:G(Z,(R==null?void 0:R.baseCurrency)||"VND")})]})]})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{sx:{background:ae>=0?"linear-gradient(135deg, #fdf4ff 0%, #fae8ff 100%)":"linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%)",color:"#1a1a1a",position:"relative",overflow:"hidden",border:ae>=0?"1px solid #f3e8ff":"1px solid #fecaca","&:hover":{transform:"translateY(-2px)",boxShadow:ae>=0?"0 4px 20px rgba(240, 147, 251, 0.15)":"0 4px 20px rgba(255, 154, 158, 0.15)",transition:"all 0.3s ease-in-out"},display:{xs:"none",sm:"block"}},children:[e.jsx(l,{sx:{position:"absolute",top:-20,right:-20,width:80,height:80,borderRadius:"50%",background:ae>=0?"rgba(240, 147, 251, 0.1)":"rgba(255, 154, 158, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:ae>=0?e.jsx(He,{sx:{fontSize:32,opacity:.6,color:"#a855f7"}}):e.jsx(Bt,{sx:{fontSize:32,opacity:.6,color:"#f43f5e"}})}),e.jsxs(me,{sx:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",p:{xs:1.5,sm:2.5,md:3}},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"cardTitle",sx:{mb:{xs:.3,sm:.5}},children:r("portfolio.plCosts")}),e.jsx(c,{variant:"cardSubtitle",children:r("portfolio.profitCosts")})]}),e.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"row",sm:"row"},gap:{xs:1,sm:2},mt:2},children:[e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:{xs:.5,sm:.8}},children:r("portfolio.realizedPL")}),e.jsx(c,{variant:"cardValue",sx:{color:R.realizedInvestPnL>=0?"#059669":"#dc2626"},children:G(R.realizedInvestPnL||0,(R==null?void 0:R.baseCurrency)||"VND")})]}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"cardLabel",sx:{mb:{xs:.5,sm:.8}},children:r("portfolio.feesTaxes")}),e.jsx(c,{variant:"cardValue",sx:{color:"#ea580c"},children:G(J,(R==null?void 0:R.baseCurrency)||"VND")})]})]})]})]})})]}),e.jsx(l,{sx:{backgroundColor:"rgba(255, 255, 255, 0.95)",borderBottom:"1px solid",borderColor:"divider",py:1,px:2,boxShadow:"0 2px 8px rgba(0,0,0,0.08)",backdropFilter:"blur(10px)"},children:e.jsxs(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:1},children:[e.jsx(he,{variant:f==="investor"?"contained":"outlined",icon:e.jsx(Sn,{}),startIcon:e.jsx(Sn,{}),onClick:()=>y("investor"),mobileText:r("portfolio.investorView"),desktopText:r("portfolio.investorView"),sx:{borderRadius:2,px:2,py:1,mt:.5,minWidth:{xs:"auto",sm:"140px"},transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(0,0,0,0.15)"}},children:r("portfolio.investorView")}),e.jsx(he,{variant:f==="fund-manager"?"contained":"outlined",icon:e.jsx(ks,{}),startIcon:e.jsx(ks,{}),onClick:()=>y("fund-manager"),mobileText:r("portfolio.fundManagerView"),desktopText:r("portfolio.fundManagerView"),sx:{borderRadius:2,px:2,py:1,mt:.5,minWidth:{xs:"auto",sm:"140px"},transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(0,0,0,0.15)"}},children:r("portfolio.fundManagerView")})]})}),f==="fund-manager"&&e.jsx(l,{className:"sticky-element",sx:{position:"sticky",top:{xs:-15,sm:-15,md:-20},zIndex:1200,backgroundColor:"rgba(255, 255, 255, 0.95)",borderBottom:"1px solid",borderColor:"divider",py:1,boxShadow:"0 4px 12px rgba(0,0,0,0.1)",backdropFilter:"blur(10px)",WebkitBackfaceVisibility:"hidden",backfaceVisibility:"hidden",transform:"translateZ(0)",willChange:"transform"},children:e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",px:{xs:1,sm:2},flexDirection:"row",gap:{xs:1,sm:2},flexWrap:"nowrap"},children:[e.jsxs(Tr,{ref:L,value:i,onChange:ne,"aria-label":"portfolio tabs",variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,sx:{minHeight:"40px",width:{xs:"calc(100% - 50px)",sm:"auto"},overflow:"auto",flex:1,"& .MuiTabs-scroller":{paddingLeft:{xs:"0px!important",sm:"0px",md:"0px"},paddingRight:{xs:"0px!important",sm:"0px",md:"0px"}},"& .MuiTabs-flexContainer":{justifyContent:"center",gap:{xs:.5,sm:1},paddingLeft:{xs:"0px!important",sm:"40px",md:"40px"},paddingRight:{xs:"0px!important",sm:"40px",md:"40px"},minWidth:"fit-content"},"& .MuiTab-root":{minHeight:"40px",fontWeight:600,textTransform:"none",fontSize:{xs:"0.75rem!important",sm:"0.85rem",md:"0.9rem"},minWidth:{xs:"80px!important",sm:"100px",md:"120px"},px:{xs:0,sm:1.5,md:2},py:{xs:.5,sm:1},flexShrink:0,whiteSpace:"nowrap","& .MuiTab-iconWrapper":{fontSize:{xs:"1rem!important",sm:"1.1rem",md:"1.2rem"},marginRight:{xs:.25,sm:.5}}},"& .MuiTabs-scrollButtons":{display:{xs:"flex",sm:"flex"},width:{xs:"32px!important",sm:"40px",md:"40px"},zIndex:1,"&.Mui-disabled":{opacity:.3}},"& .MuiTabs-indicator":{height:3,borderRadius:"3px 3px 0 0"}},children:[e.jsx(ht,{icon:N?void 0:e.jsx(He,{}),iconPosition:N?void 0:"start",label:r("portfolio.performance")}),e.jsx(ht,{icon:N?void 0:e.jsx(qt,{}),iconPosition:N?void 0:"start",label:r("portfolio.allocation")}),e.jsx(ht,{icon:N?void 0:e.jsx(yr,{}),iconPosition:N?void 0:"start",label:r("portfolio.trading")}),e.jsx(ht,{icon:N?void 0:e.jsx(Ue,{}),iconPosition:N?void 0:"start",label:r("portfolio.deposit")}),e.jsx(ht,{icon:N?void 0:e.jsx(ba,{}),iconPosition:N?void 0:"start",label:r("portfolio.cashFlow")}),e.jsx(ht,{icon:N?void 0:e.jsx(yc,{}),iconPosition:N?void 0:"start",label:r("navigation.holdings")})]}),!N&&e.jsx(Fe,{title:r(h?"portfolio.switchToNormal":"portfolio.switchToCompact"),sx:{ml:"auto"},children:e.jsx(Ie,{onClick:()=>m(!h),color:"primary",size:"small",sx:{ml:"auto",flexShrink:0,p:1,borderRadius:1,backgroundColor:h?"primary.main":"transparent",color:h?"primary.contrastText":"primary.main","&:hover":{backgroundColor:h?"primary.dark":"primary.light"},transition:"all 0.2s ease-in-out"},children:h?e.jsx(wo,{}):e.jsx(vo,{})})})]})}),f==="investor"?e.jsx(l,{sx:{backgroundColor:"background.paper",borderBottom:"1px solid",borderColor:"divider",py:1,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backdropFilter:"blur(10px)"},children:e.jsx(l,{sx:{p:{xs:0,sm:2,md:3}},children:e.jsx(Tx,{portfolioId:t,accountId:R.accountId})})}):e.jsxs(l,{sx:{backgroundColor:"background.paper",borderBottom:"1px solid",borderColor:"divider",py:1,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",backdropFilter:"blur(10px)"},children:[e.jsx(Gs,{value:i,index:0,children:e.jsx(Ok,{portfolioId:t,portfolio:R,isCompactMode:h,getUltraSpacing:E})}),e.jsx(Gs,{value:i,index:1,children:e.jsx(Qk,{portfolioId:t,portfolio:R,isCompactMode:h,getUltraSpacing:E})}),e.jsx(Gs,{value:i,index:2,children:e.jsx(n2,{portfolioId:t,isCompactMode:h,onCreateTrade:()=>u(!0)})}),e.jsx(Gs,{value:i,index:3,children:e.jsx(s2,{portfolioId:t,isCompactMode:h,getUltraSpacing:E})}),e.jsx(Gs,{value:i,index:4,children:e.jsx(u2,{portfolioId:t,isCompactMode:h,getUltraSpacing:E,onCashFlowUpdate:B})}),e.jsx(Gs,{value:i,index:5,children:e.jsx(b2,{portfolio:R,isCompactMode:h,getUltraSpacing:E,onPortfolioUpdate:B})})]}),e.jsxs(Gn,{anchorEl:v,open:!!v,onClose:pe,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{mt:1,minWidth:200,boxShadow:"0 4px 20px rgba(0,0,0,0.15)",borderRadius:2}},children:[Y&&e.jsxs(re,{onClick:Me,children:[e.jsx(tt,{children:e.jsx(Jt,{fontSize:"small"})}),e.jsx(ve,{children:r("portfolio.managePermissions")})]}),e.jsxs(re,{onClick:Le,disabled:w,children:[e.jsx(tt,{children:w?e.jsx(Ce,{size:16}):e.jsx(Mt,{fontSize:"small"})}),e.jsx(ve,{children:r(w?"snapshots.recalculating":"snapshots.recalculateAll")})]})]}),e.jsx(Cx,{open:k,onClose:de,onConfirm:qe,isRecalculating:w}),T.open&&e.jsx(jp,{container:document.body,children:e.jsx(je,{onClose:ie,severity:T.severity,sx:{position:"fixed",top:24,right:24,zIndex:9999,minWidth:300,borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.2)","& .MuiAlert-message":{fontWeight:500}},children:T.message})}),e.jsx(Ca,{open:d,onClose:()=>u(!1),onSubmit:oe,defaultPortfolioId:t,isLoading:_.isLoading,error:(Ve=_.error)==null?void 0:Ve.message,mode:"create",isModal:!0,showSubmitButton:!1}),e.jsx(Xc,{open:j,onClose:()=>b(!1),portfolioId:t,portfolioName:R.name,creatorAccountId:R.accountId,onPermissionUpdated:()=>{}})]})};function Sl(r){const{children:t,value:n,index:s,...a}=r;return e.jsx("div",{role:"tabpanel",hidden:n!==s,id:`trading-tabpanel-${s}`,"aria-labelledby":`trading-tab-${s}`,...a,children:n===s&&e.jsx(l,{sx:{p:0},children:t})})}const w2=()=>{var M,O;const{portfolioId:r}=So(),t=An(),[n,s]=p.useState(0),[a,i]=p.useState(!1),o=Kc(),d=Gc(r),u=d.data||[],h=(I,z)=>{s(z),is()},m=()=>{t(`/portfolios/${r}`)},x=async I=>{try{await o.mutateAsync(I),i(!1)}catch(z){console.error("Error creating trade:",z)}},g=async I=>{const z={...I,tradeDate:I.tradeDate};await x(z)},f=()=>{i(!1)},y=()=>{s(2)},j=async()=>{await d.refetch()},b=(u==null?void 0:u.length)||0,v=(u==null?void 0:u.filter(I=>I.side==="BUY").length)||0,P=(u==null?void 0:u.filter(I=>I.side==="SELL").length)||0,w=(u==null?void 0:u.reduce((I,z)=>I+(Number(z.totalValue)||0),0))||0,C=(u==null?void 0:u.reduce((I,z)=>I+(Number(z.fee)||0),0))||0,k=(u==null?void 0:u.reduce((I,z)=>I+(Number(z.tax)||0),0))||0,A=C+k,L=(u==null?void 0:u.reduce((I,z)=>I+(Number(z.realizedPl)||0),0))||0,T=[{title:"Total Trades",value:b.toString(),icon:e.jsx(ar,{sx:{fontSize:32}}),color:"primary"},{title:"Buy Orders",value:v.toString(),icon:e.jsx(Nl,{sx:{fontSize:32}}),color:"success"},{title:"Sell Orders",value:P.toString(),icon:e.jsx(vp,{sx:{fontSize:32}}),color:"error"},{title:"Total Volume",value:G(w),icon:e.jsx(mr,{sx:{fontSize:32}}),color:"info"}];return r?e.jsxs(l,{children:[e.jsx(l,{sx:{mb:4},children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsxs(l,{children:[e.jsx(D,{variant:"h4",gutterBottom:!0,children:"Trading Management"}),e.jsx(D,{variant:"body1",color:"text.secondary",children:"Manage your trades, analyze performance, and track positions"})]}),e.jsx(he,{variant:"outlined",icon:e.jsx(Kr,{}),startIcon:e.jsx(Kr,{}),onClick:m,mobileText:"Back",desktopText:"Back to Portfolio",sx:{borderRadius:2,textTransform:"none",px:3,py:1},children:"Back to Portfolio"})]})}),e.jsx(W,{container:!0,spacing:3,sx:{mb:4},children:T.map((I,z)=>e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(l,{children:[e.jsx(D,{color:"text.secondary",gutterBottom:!0,variant:"body2",children:I.title}),e.jsx(D,{variant:"h5",component:"div",children:I.value})]}),e.jsx(l,{sx:{color:`${I.color}.main`,display:"flex",alignItems:"center"},children:I.icon})]})})})},z))}),e.jsx(W,{container:!0,spacing:3,sx:{mb:4},children:e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{sx:{boxShadow:2},children:e.jsxs(me,{children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Trading Performance"}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(l,{textAlign:"center",p:2,sx:{bgcolor:"grey.50",borderRadius:2},children:[e.jsx(D,{variant:"h4",color:"text.primary",fontWeight:"bold",children:G(A)}),e.jsx(D,{variant:"body2",color:"text.secondary",mt:1,children:"Total Fees & Taxes"})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(l,{textAlign:"center",p:2,sx:{bgcolor:L>=0?"success.50":"error.50",borderRadius:2},children:[e.jsx(D,{variant:"h4",color:L>=0?"success.main":"error.main",fontWeight:"bold",children:G(L)}),e.jsx(D,{variant:"body2",color:"text.secondary",mt:1,children:"Realized P&L"})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(l,{textAlign:"center",p:2,sx:{bgcolor:"info.50",borderRadius:2},children:[e.jsx(D,{variant:"h4",color:"info.main",fontWeight:"bold",children:G(w)}),e.jsx(D,{variant:"body2",color:"text.secondary",mt:1,children:"Total Volume"})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(l,{textAlign:"center",p:2,sx:{bgcolor:"primary.50",borderRadius:2},children:[e.jsx(D,{variant:"h4",color:"primary.main",fontWeight:"bold",children:b}),e.jsx(D,{variant:"body2",color:"text.secondary",mt:1,children:"Total Trades"})]})})]})]})})})}),e.jsxs(Te,{sx:{width:"100%",boxShadow:2},children:[e.jsx(l,{sx:{borderBottom:1,borderColor:"divider",bgcolor:"grey.50"},children:e.jsxs(Tr,{value:n,onChange:h,"aria-label":"trading tabs",variant:"fullWidth",sx:{"& .MuiTab-root":{textTransform:"none",fontWeight:500,minHeight:48},"& .Mui-selected":{color:"primary.main",fontWeight:600}},children:[e.jsx(ht,{label:"Trade History",icon:e.jsx(Ue,{}),iconPosition:"start"}),e.jsx(ht,{label:"Analysis",icon:e.jsx(Zt,{}),iconPosition:"start"}),e.jsx(ht,{label:"Create Trade",icon:e.jsx(xt,{}),iconPosition:"start"})]})}),e.jsx(Sl,{value:n,index:0,children:e.jsx(jx,{portfolioId:r,onCreate:y})}),e.jsx(Sl,{value:n,index:1,children:e.jsx(bx,{portfolioId:r})}),e.jsx(Sl,{value:n,index:2,children:e.jsx(l,{sx:{p:2},children:e.jsx(Ca,{onSubmit:g,isLoading:o.isLoading,error:(M=o.error)==null?void 0:M.message,mode:"create",defaultPortfolioId:r,onAssetCreated:j})})})]}),e.jsx(Ca,{open:a,onClose:f,onSubmit:g,defaultPortfolioId:r,isLoading:o.isLoading,error:(O=o.error)==null?void 0:O.message,onAssetCreated:j,mode:"create",isModal:!0,showSubmitButton:!1})]}):e.jsx(l,{children:e.jsx(D,{variant:"h4",gutterBottom:!0,children:"Portfolio not found"})})},S2=()=>{const r=An(),[t]=vc(),{accountId:n}=Ge(),{portfolios:s,isLoading:a,error:i}=Un(n),[o,d]=p.useState(!1);return p.useEffect(()=>{if(!a&&s&&!o){if(d(!0),s.length===0){r("/portfolios/new");return}if(s.length===1){const u=t.get("tab")||"trading";r(`/portfolios/${s[0].portfolioId}?tab=${u}`);return}r("/portfolios")}},[s,a,r,o,t]),a?e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"50vh",gap:2},children:[e.jsx(Ce,{size:48}),e.jsx(D,{variant:"h6",color:"text.secondary",children:"Loading portfolios..."})]}):i?e.jsxs(l,{sx:{p:3},children:[e.jsx(je,{severity:"error",sx:{mb:2},children:"Failed to load portfolios. Please try again."}),e.jsx(he,{variant:"contained",onClick:()=>r("/portfolios"),children:"Go to Portfolios"})]}):s.length===0?e.jsxs(l,{sx:{p:3},children:[e.jsx(je,{severity:"info",sx:{mb:2},children:"No portfolios found. Create your first portfolio to start trading."}),e.jsx(he,{variant:"contained",onClick:()=>r("/portfolios/new"),children:"Create Portfolio"})]}):s.length>1?e.jsxs(l,{sx:{p:3},children:[e.jsx(je,{severity:"info",sx:{mb:2},children:"Multiple portfolios found. Please select a portfolio to view trading."}),e.jsx(he,{variant:"contained",onClick:()=>r("/portfolios"),children:"Select Portfolio"})]}):e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"50vh",gap:2},children:[e.jsx(Ce,{size:48}),e.jsx(D,{variant:"h6",color:"text.secondary",children:"Redirecting to trading..."})]})},T2=mi({symbol:sn().required("Symbol is required").min(1,"Symbol must be at least 1 character").max(20,"Symbol must be at most 20 characters").matches(/^[A-Z0-9-]+$/,"Symbol must contain only uppercase letters, numbers, and hyphens"),name:sn().required("Name is required").min(2,"Name must be at least 2 characters").max(100,"Name must be at most 100 characters"),type:sn().required("Asset type is required").oneOf(["STOCK","BOND","CRYPTO","COMMODITY","GOLD","REALESTATE","OTHER"],"Invalid asset type"),nation:sn().default("VN"),marketCode:sn().default("HOSE"),currency:sn().default("VND"),timezone:sn().default("Asia/Ho_Chi_Minh"),createdBy:sn().nullable().optional(),priceMode:sn().required("Price mode is required").oneOf(["AUTOMATIC","MANUAL"],"Invalid price mode"),isActive:dg().required("Status is required"),description:sn().nullable().max(500,"Description must be at most 500 characters")}),C2=[{value:"STOCK",label:"Stock"},{value:"BOND",label:"Bond"},{value:"CRYPTO",label:"Crypto"},{value:"COMMODITY",label:"Commodity"},{value:"GOLD",label:"Gold"},{value:"REALESTATE",label:"Real Estate"},{value:"OTHER",label:"Other"}],k2=[{value:"AUTOMATIC",label:"Automatic"},{value:"MANUAL",label:"Manual"}],P2=[{code:"VN",name:"Vietnam",currency:"VND",timezone:"Asia/Ho_Chi_Minh",marketCodes:[{code:"HOSE",name:"Ho Chi Minh Stock Exchange"},{code:"HNX",name:"Hanoi Stock Exchange"},{code:"UPCOM",name:"Unlisted Public Company Market"}],defaultPriceSource:"EXTERNAL_API",assetTypePatterns:{STOCK:"^[A-Z0-9-]+$",BOND:"^[A-Z0-9-]+$",CRYPTO:"^[A-Z0-9-]+$",COMMODITY:"^[A-Z0-9-]+$",GOLD:"^[A-Z0-9-]+$",REALESTATE:"^[A-Z0-9-]+$",OTHER:"^[A-Z0-9-]+$"},tradingHours:{timezone:"Asia/Ho_Chi_Minh",days:[{day:"Monday",open:"09:00",close:"15:00"},{day:"Tuesday",open:"09:00",close:"15:00"},{day:"Wednesday",open:"09:00",close:"15:00"},{day:"Thursday",open:"09:00",close:"15:00"},{day:"Friday",open:"09:00",close:"15:00"}]}},{code:"US",name:"United States",currency:"USD",timezone:"America/New_York",marketCodes:[{code:"NYSE",name:"New York Stock Exchange"},{code:"NASDAQ",name:"NASDAQ"},{code:"AMEX",name:"American Stock Exchange"}],defaultPriceSource:"EXTERNAL_API",assetTypePatterns:{STOCK:"^[A-Z0-9-]+$",BOND:"^[A-Z0-9-]+$",CRYPTO:"^[A-Z0-9-]+$",COMMODITY:"^[A-Z0-9-]+$",GOLD:"^[A-Z0-9-]+$",REALESTATE:"^[A-Z0-9-]+$",OTHER:"^[A-Z0-9-]+$"},tradingHours:{timezone:"America/New_York",days:[{day:"Monday",open:"09:30",close:"16:00"},{day:"Tuesday",open:"09:30",close:"16:00"},{day:"Wednesday",open:"09:30",close:"16:00"},{day:"Thursday",open:"09:30",close:"16:00"},{day:"Friday",open:"09:30",close:"16:00"}]}},{code:"UK",name:"United Kingdom",currency:"GBP",timezone:"Europe/London",marketCodes:[{code:"LSE",name:"London Stock Exchange"},{code:"AIM",name:"Alternative Investment Market"}],defaultPriceSource:"EXTERNAL_API",assetTypePatterns:{STOCK:"^[A-Z0-9-]+$",BOND:"^[A-Z0-9-]+$",CRYPTO:"^[A-Z0-9-]+$",COMMODITY:"^[A-Z0-9-]+$",GOLD:"^[A-Z0-9-]+$",REALESTATE:"^[A-Z0-9-]+$",OTHER:"^[A-Z0-9-]+$"},tradingHours:{timezone:"Europe/London",days:[{day:"Monday",open:"08:00",close:"16:30"},{day:"Tuesday",open:"08:00",close:"16:30"},{day:"Wednesday",open:"08:00",close:"16:30"},{day:"Thursday",open:"08:00",close:"16:30"},{day:"Friday",open:"08:00",close:"16:30"}]}}],D2=({open:r,onClose:t,onSubmit:n,initialData:s,mode:a,loading:i=!1})=>{const{accountId:o}=Ge(),[d,u]=p.useState({isValid:!0,message:""}),{control:h,handleSubmit:m,reset:x,watch:g,setValue:f,formState:{errors:y}}=xi({resolver:Si(T2),defaultValues:{symbol:"",name:"",type:"STOCK",nation:"VN",marketCode:"HOSE",currency:"VND",timezone:"Asia/Ho_Chi_Minh",description:"",createdBy:a==="create"?o:"",priceMode:"AUTOMATIC",isActive:!0,...s}}),j=g("nation"),b=g("type"),v=g("symbol");p.useEffect(()=>{s&&a==="edit"&&x({symbol:s.symbol||"",name:s.name||"",type:s.type||"STOCK",nation:s.nation||"VN",marketCode:s.marketCode||"HOSE",currency:s.currency||"VND",timezone:s.timezone||"Asia/Ho_Chi_Minh",description:s.description||"",createdBy:s.createdBy||"",priceMode:s.priceMode||"AUTOMATIC",isActive:s.isActive!==void 0?s.isActive:!0})},[s,a,x]),p.useEffect(()=>{r&&(x({symbol:"",name:"",type:"STOCK",nation:"VN",marketCode:"HOSE",currency:"VND",timezone:"Asia/Ho_Chi_Minh",description:"",createdBy:a==="create"?o:"",priceMode:"AUTOMATIC",isActive:!0,...s}),u({isValid:!0,message:""}))},[r,a,o,s,x]),p.useEffect(()=>{a==="create"&&o&&f("createdBy",o)},[a,o,f]),p.useEffect(()=>{if(v&&j&&b){const C=P2.find(k=>k.code===j);if(C&&C.assetTypePatterns[b]){const A=new RegExp(C.assetTypePatterns[b]).test(v);u({isValid:A,message:A?"":`Symbol format is invalid for ${b} in ${C.name}`})}else u({isValid:!0,message:""})}},[v,j,b]);const P=()=>{x(),u({isValid:!0,message:""}),t()},w=async C=>{try{const k={symbol:C.symbol,name:C.name,type:C.type,nation:C.nation,marketCode:C.marketCode,currency:C.currency,timezone:C.timezone,priceMode:C.priceMode,isActive:C.isActive,createdBy:C.createdBy};C.description!==void 0&&C.description!==null&&(k.description=C.description.trim()||null),await n(k),P()}catch(k){console.error("Form submission error:",k)}};return e.jsx(hr,{dateAdapter:Ar,children:e.jsxs(kt,{open:r,onClose:P,maxWidth:"md",fullWidth:!0,children:[e.jsx(Et,{children:e.jsx(D,{variant:"h6",component:"div",children:a==="create"?"Create New Global Asset":"Edit Global Asset"})}),e.jsxs("form",{onSubmit:m(w),children:[e.jsx(Pt,{children:e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(mn,{name:"symbol",control:h,render:({field:C})=>{var k;return e.jsx(Ae,{...C,label:"Symbol",fullWidth:!0,error:!!y.symbol||!d.isValid,helperText:((k=y.symbol)==null?void 0:k.message)||d.message,placeholder:"e.g., AAPL, HPG",disabled:a==="edit",onChange:A=>{const L=A.target.value.toUpperCase();C.onChange(L)}})}})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(mn,{name:"name",control:h,render:({field:C})=>{var k;return e.jsx(Ae,{...C,label:"Asset Name",fullWidth:!0,error:!!y.name,helperText:(k=y.name)==null?void 0:k.message,placeholder:"e.g., Apple Inc., Hoa Phat Group"})}})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(mn,{name:"type",control:h,render:({field:C})=>e.jsxs(nt,{fullWidth:!0,error:!!y.type,children:[e.jsx(st,{children:"Asset Type"}),e.jsx(Ze,{...C,label:"Asset Type",children:C2.map(k=>e.jsx(re,{value:k.value,children:k.label},k.value))}),y.type&&e.jsx(D,{variant:"caption",color:"error",children:y.type.message})]})})}),a==="edit"||a==="create"&&o?e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(mn,{name:"createdBy",control:h,render:({field:C})=>e.jsx(Ae,{...C,value:C.value||"",label:"Created By (Account ID)",fullWidth:!0,disabled:!0,helperText:a==="create"?"Account ID of the current user who will create this asset":"Account ID of the user who created this asset",sx:{"& .MuiInputBase-input.Mui-disabled":{color:"text.secondary",WebkitTextFillColor:"unset"}}})})}):null,e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(mn,{name:"priceMode",control:h,render:({field:C})=>e.jsxs(nt,{fullWidth:!0,error:!!y.priceMode,children:[e.jsx(st,{children:"Price Mode"}),e.jsx(Ze,{...C,label:"Price Mode",children:k2.map(k=>e.jsx(re,{value:k.value,children:k.label},k.value))}),y.priceMode&&e.jsx(D,{variant:"caption",color:"error",children:y.priceMode.message})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(mn,{name:"isActive",control:h,render:({field:C})=>e.jsxs(nt,{fullWidth:!0,error:!!y.isActive,children:[e.jsx(st,{children:"Status"}),e.jsxs(Ze,{...C,label:"Status",value:C.value?"true":"false",onChange:k=>C.onChange(k.target.value==="true"),children:[e.jsx(re,{value:"true",children:"Active"}),e.jsx(re,{value:"false",children:"Inactive"})]}),y.isActive&&e.jsx(D,{variant:"caption",color:"error",children:y.isActive.message})]})})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(mn,{name:"description",control:h,render:({field:C})=>{var k;return e.jsx(Ae,{...C,value:C.value||"",label:"Description",fullWidth:!0,multiline:!0,rows:2,error:!!y.description,helperText:(k=y.description)==null?void 0:k.message,placeholder:"Optional description of the asset"})}})})]})}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:P,disabled:i,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{type:"submit",variant:"contained",disabled:i||!d.isValid,icon:i?e.jsx(Ce,{size:20}):void 0,mobileText:i?"Saving...":a==="create"?"Create":"Update",desktopText:i?"Saving...":a==="create"?"Create Asset":"Update Asset",children:i?"Saving...":a==="create"?"Create Asset":"Update Asset"})]})]})]})})},A2={STOCK:"#1976d2",BOND:"#388e3c",CRYPTO:"#f57c00",COMMODITY:"#7b1fa2",CURRENCY:"#d32f2f",ETF:"#0288d1",MUTUAL_FUND:"#5d4037"},I2={VN:"Vietnam",US:"United States",UK:"United Kingdom",JP:"Japan",SG:"Singapore",AU:"Australia",CA:"Canada",DE:"Germany",FR:"France",CN:"China"},R2=({assets:r,loading:t=!1,onEdit:n,onDelete:s,onView:a,onRefresh:i,error:o,total:d=0,page:u=1,rowsPerPage:h=10,onChangePage:m,onChangeRowsPerPage:x})=>{const[g,f]=p.useState(0),[y,j]=p.useState(h),[b,v]=p.useState(""),[P,w]=p.useState(""),[C,k]=p.useState(""),[A,L]=p.useState("symbol"),[T,M]=p.useState("asc"),[O,I]=p.useState(null),[z,N]=p.useState(null),[E,R]=p.useState(!1),V=p.useMemo(()=>[...new Set(r.map(ae=>ae.type))].sort(),[r]),F=p.useMemo(()=>[...new Set(r.map(ae=>ae.nation))].sort(),[r]),B=p.useMemo(()=>{let J=r.filter(ae=>{var Me;const ue=ae.symbol.toLowerCase().includes(b.toLowerCase())||ae.name.toLowerCase().includes(b.toLowerCase())||((Me=ae.description)==null?void 0:Me.toLowerCase().includes(b.toLowerCase())),le=!P||ae.type===P,pe=!C||ae.nation===C;return ue&&le&&pe});return J.sort((ae,ue)=>{let le=ae[A],pe=ue[A];return A==="createdAt"?(le=new Date(le).getTime(),pe=new Date(pe).getTime()):typeof le=="string"&&(le=le.toLowerCase(),pe=pe.toLowerCase()),le<pe?T==="asc"?-1:1:le>pe?T==="asc"?1:-1:0}),J},[r,b,P,C,A,T]),$=p.useMemo(()=>{const J=g*y;return B.slice(J,J+y)},[B,g,y]),Y=(J,ae)=>{f(ae),m==null||m(J,ae)},_=J=>{const ae=parseInt(J.target.value,10);j(ae),f(0),x==null||x(J)},K=J=>{A===J?M(T==="asc"?"desc":"asc"):(L(J),M("asc"))},X=(J,ae)=>{I(J.currentTarget),N(ae)},ne=()=>{I(null),N(null)},oe=J=>{if(z)switch(J){case"view":a(z);break;case"edit":n(z);break;case"delete":s(z);break}ne()},ee=(J,ae)=>new Intl.NumberFormat("en-US",{style:"currency",currency:ae,minimumFractionDigits:2,maximumFractionDigits:2}).format(J),H=J=>{if(J==null)return e.jsx(D,{variant:"caption",color:"text.secondary",children:"N/A"});const ae=J>0?"success.main":J<0?"error.main":"text.secondary",ue=J>0?"+":"";return e.jsxs(D,{variant:"body2",sx:{color:ae,fontWeight:600},children:[ue,J.toFixed(2),"%"]})},Q=J=>A2[J]||"#666",Z=J=>I2[J]||J;return o?e.jsx(je,{severity:"error",action:e.jsx(he,{color:"inherit",size:"small",onClick:i,mobileText:"Retry",desktopText:"Retry",children:"Retry"}),children:o}):e.jsxs(l,{children:[e.jsx(l,{sx:{display:"flex",justifyContent:"flex-end",mb:1},children:e.jsx(Fe,{title:E?"Hide filters":"Show filters",children:e.jsx(Ie,{size:"medium",onClick:()=>R(J=>!J),children:e.jsx(Ir,{})})})}),E&&e.jsx(Te,{sx:{p:2,mb:2},children:e.jsxs(W,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsx(Ae,{fullWidth:!0,placeholder:"Search assets...",value:b,onChange:J=>v(J.target.value),InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx($n,{})})}})}),e.jsx(W,{item:!0,xs:12,sm:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Type"}),e.jsxs(Ze,{value:P,onChange:J=>w(J.target.value),label:"Type",children:[e.jsx(re,{value:"",children:"All Types"}),V.map(J=>e.jsx(re,{value:J,children:J},J))]})]})}),e.jsx(W,{item:!0,xs:12,sm:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Nation"}),e.jsxs(Ze,{value:C,onChange:J=>k(J.target.value),label:"Nation",children:[e.jsx(re,{value:"",children:"All Nations"}),F.map(J=>e.jsx(re,{value:J,children:Z(J)},J))]})]})}),e.jsx(W,{item:!0,xs:12,sm:2,children:e.jsx(he,{fullWidth:!0,variant:"outlined",icon:e.jsx(Mt,{}),onClick:i,disabled:t,mobileText:"Refresh",desktopText:"Refresh",children:"Refresh"})})]})}),e.jsxs(se,{children:[e.jsx(at,{children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:e.jsx(Na,{active:A==="symbol",direction:A==="symbol"?T:"asc",onClick:()=>K("symbol"),children:"Symbol"})}),e.jsx(S,{sx:{maxWidth:200},children:e.jsx(Na,{active:A==="name",direction:A==="name"?T:"asc",onClick:()=>K("name"),children:"Name"})}),e.jsx(S,{children:e.jsx(Na,{active:A==="type",direction:A==="type"?T:"asc",onClick:()=>K("type"),children:"Type"})}),e.jsx(S,{children:"Price"}),e.jsx(S,{children:"Change %"}),e.jsx(S,{children:e.jsx(Na,{active:A==="marketCode",direction:A==="marketCode"?T:"asc",onClick:()=>K("marketCode"),children:"Market"})}),e.jsx(S,{children:"Status"}),e.jsx(S,{children:e.jsx(Na,{active:A==="priceMode",direction:A==="priceMode"?T:"asc",onClick:()=>K("priceMode"),children:"Price Mode"})}),e.jsx(S,{align:"right",children:"Actions"})]})}),e.jsx(ot,{children:t?e.jsx(De,{children:e.jsx(S,{colSpan:9,align:"center",children:e.jsx(Ce,{})})}):$.length===0?e.jsx(De,{children:e.jsx(S,{colSpan:9,align:"center",children:e.jsx(D,{variant:"body2",color:"text.secondary",children:"No assets found"})})}):$.map(J=>{var ae;return e.jsx(Fe,{title:"Click to view asset details",placement:"top",arrow:!0,children:e.jsxs(De,{hover:!0,onClick:()=>a(J),sx:{cursor:"pointer","&:hover":{backgroundColor:"action.hover"}},children:[e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(D,{variant:"body2",fontWeight:"medium",children:J.symbol}),e.jsx(wp,{fontSize:"small",color:"action",sx:{opacity:.6}})]})}),e.jsx(S,{sx:{maxWidth:200},children:e.jsxs(l,{children:[e.jsx(D,{variant:"body2",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:J.name}),J.description&&e.jsx(l,{component:"span",sx:{fontSize:"0.75rem",color:"text.secondary",display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:J.description})]})}),e.jsx(S,{children:e.jsx(ce,{label:J.type,size:"small",sx:{backgroundColor:Q(J.type),color:"white"}})}),e.jsxs(S,{children:[e.jsx(D,{variant:"body2",children:J.assetPrice?ee(J.assetPrice.currentPrice,J.currency):"No price data"}),J.assetPrice&&e.jsxs(D,{variant:"caption",color:"text.secondary",children:[J.assetPrice.priceSource,"  ",Gt(J.assetPrice.lastPriceUpdate,"medium")]})]}),e.jsx(S,{children:H((ae=J.assetPrice)==null?void 0:ae.priceChangePercent)}),e.jsx(S,{children:e.jsx(D,{variant:"body2",children:Z(J.nation)})}),e.jsx(S,{children:e.jsx(ce,{label:J.isActive?"Active":"Inactive",size:"small",color:J.isActive?"success":"default"})}),e.jsx(S,{children:e.jsx(ce,{label:J.priceMode,size:"small",color:J.priceMode==="MANUAL"?"warning":"success",variant:J.priceMode==="MANUAL"?"outlined":"filled"})}),e.jsx(S,{align:"right",children:e.jsx(Ie,{onClick:ue=>{ue.stopPropagation(),X(ue,J)},size:"small",children:e.jsx(wr,{})})})]})},J.id)})})]})}),e.jsx(hi,{rowsPerPageOptions:[10,25,50,100],component:"div",count:d||B.length,rowsPerPage:h??y,page:u?u-1:g,onPageChange:Y,onRowsPerPageChange:_})]}),e.jsxs(Gn,{anchorEl:O,open:!!O,onClose:ne,children:[e.jsxs(re,{onClick:()=>oe("view"),children:[e.jsx(tt,{children:e.jsx(Xt,{fontSize:"small"})}),e.jsx(ve,{children:"View Details"})]}),e.jsxs(re,{onClick:()=>oe("edit"),children:[e.jsx(tt,{children:e.jsx(Tt,{fontSize:"small"})}),e.jsx(ve,{children:"Edit"})]}),e.jsxs(re,{onClick:()=>oe("delete"),children:[e.jsx(tt,{children:e.jsx(pt,{fontSize:"small"})}),e.jsx(ve,{children:"Delete"})]})]})]})};class Ei{static async getTrackingRecords(t={}){const n=new URLSearchParams;return t.status&&n.append("status",t.status),t.type&&n.append("type",t.type),t.source&&n.append("source",t.source),t.startDate&&n.append("startDate",t.startDate),t.endDate&&n.append("endDate",t.endDate),t.limit&&n.append("limit",t.limit.toString()),t.offset&&n.append("offset",t.offset.toString()),t.sortBy&&n.append("sortBy",t.sortBy),t.sortOrder&&n.append("sortOrder",t.sortOrder),await q.get(`/api/v1/global-asset-tracking?${n.toString()}`)}static async getTrackingByExecutionId(t){return(await q.get(`/api/v1/global-asset-tracking/${t}`)).data}static async getTrackingStats(t=30){return(await q.get(`/api/v1/global-asset-tracking/stats/summary?days=${t}`)).data}static async getRecentTracking(t=10){return(await q.get(`/api/v1/global-asset-tracking/recent/list?limit=${t}`)).data}static async getRunningSyncs(){return(await q.get("/api/v1/global-asset-tracking/running/list")).data}static async getApiCallDetails(t){return(await q.get(`/api/v1/global-asset-tracking/${t}/api-calls`)).data}static async cleanupOldData(t=90){return await q.post("/api/v1/global-asset-tracking/cleanup/execute",{days:t})}}function M2({open:r,onClose:t,onCleanup:n,loading:s,result:a}){const[i,o]=p.useState(30),d=async()=>{await n(i)},u=()=>{s||t()};return e.jsxs(kt,{open:r,onClose:u,maxWidth:"sm",fullWidth:!0,children:[e.jsx(Et,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(pt,{color:"warning"}),e.jsx(c,{variant:"h6",children:"Cleanup Old Data"})]})}),e.jsxs(Pt,{children:[e.jsx(c,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"This will permanently delete tracking records and API call details older than the specified number of days."}),e.jsx(Ae,{fullWidth:!0,label:"Days to Keep",type:"number",value:i,onChange:h=>o(parseInt(h.target.value)||30),inputProps:{min:1,max:365},sx:{mb:2},helperText:"Records older than this many days will be deleted",disabled:s}),a&&e.jsx(je,{severity:a.includes("Error")?"error":"success",sx:{mt:2},children:a})]}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:u,disabled:s,variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{onClick:d,color:"warning",variant:"contained",disabled:s,icon:s?e.jsx(Ce,{size:16}):e.jsx(pt,{}),forceTextOnly:!0,mobileText:s?"Cleaning...":"Cleanup",desktopText:s?"Cleaning...":"Cleanup",children:s?"Cleaning...":"Cleanup"})]})]})}function N2({open:r,onClose:t,selectedRecord:n,apiCallDetails:s,loadingApiCalls:a,onFetchApiCallDetails:i}){p.useEffect(()=>{r&&n&&i(n.executionId)},[r,n==null?void 0:n.executionId,i]);const o=m=>{switch(m.toLowerCase()){case"completed":return e.jsx(Xe,{color:"success",fontSize:"small"});case"failed":return e.jsx(qn,{color:"error",fontSize:"small"});case"running":return e.jsx(Ua,{color:"warning",fontSize:"small"});default:return e.jsx(Ua,{color:"disabled",fontSize:"small"})}},d=m=>{switch(m.toLowerCase()){case"success":return e.jsx(Xe,{color:"success",fontSize:"small"});case"error":return e.jsx(qn,{color:"error",fontSize:"small"});case"timeout":return e.jsx(Ua,{color:"warning",fontSize:"small"});default:return e.jsx(Ua,{color:"disabled",fontSize:"small"})}},u=m=>new Date(m).toLocaleString(),h=m=>m<1e3?`${m}ms`:m<6e4?`${(m/1e3).toFixed(1)}s`:`${(m/6e4).toFixed(1)}m`;return e.jsx(Rt,{open:r,onClose:t,title:"Auto Sync Details",icon:e.jsx(bc,{}),maxWidth:"xl",fullWidth:!0,size:"large",children:e.jsxs(l,{sx:{p:0},children:[n&&e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:e.jsx(ce,{label:n.executionId,variant:"outlined",size:"small",sx:{fontFamily:"monospace"}})}),n&&e.jsxs(l,{children:[e.jsx(l,{sx:{p:2,backgroundColor:"grey.50",borderBottom:1,borderColor:"divider"},children:e.jsxs(W,{container:!0,spacing:1,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(se,{variant:"outlined",sx:{p:1,height:"100%"},children:[e.jsx(c,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Status"}),e.jsxs(l,{display:"flex",alignItems:"center",gap:.5,children:[o(n.successRate===100?"completed":"failed"),e.jsx(c,{variant:"body2",fontWeight:"bold",children:n.successRate===100?"COMPLETED":"FAILED"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(se,{variant:"outlined",sx:{p:1,height:"100%"},children:[e.jsx(c,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Type & Source"}),e.jsxs(l,{display:"flex",gap:.3,flexWrap:"wrap",children:[e.jsx(ce,{label:n.type.toUpperCase(),variant:"outlined",size:"small",sx:{fontSize:"0.6rem",height:"18px"}}),e.jsx(ce,{label:n.source.replace("_"," ").toUpperCase(),variant:"outlined",size:"small",sx:{fontSize:"0.6rem",height:"18px"}})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(se,{variant:"outlined",sx:{p:1,height:"100%"},children:[e.jsx(c,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Duration & Success Rate"}),e.jsxs(l,{justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{variant:"body2",color:"primary",fontWeight:"bold",children:h(n.executionTimeMs)}),e.jsxs(c,{variant:"body2",fontWeight:"bold",color:n.successRate===100?"success.main":"error.main",children:[n.successRate?n.successRate.toFixed(1):"0.0","%"]})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(se,{variant:"outlined",sx:{p:1,height:"100%"},children:[e.jsx(c,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Started & Completed"}),e.jsxs(l,{children:[e.jsx(c,{variant:"body2",sx:{mb:.3},children:u(n.startedAt)}),e.jsx(c,{variant:"body2",children:n.completedAt?u(n.completedAt):"N/A"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(se,{variant:"outlined",sx:{p:1,height:"100%"},children:[e.jsx(c,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"Symbols Processed"}),e.jsx(c,{variant:"body2",color:"primary",fontWeight:"bold",children:n.totalSymbols}),e.jsxs(l,{display:"flex",gap:.3,mt:.2,children:[e.jsxs(c,{variant:"caption",color:"success.main",children:[" ",n.successfulUpdates]}),e.jsxs(c,{variant:"caption",color:"error.main",children:[" ",n.failedUpdates]})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(se,{variant:"outlined",sx:{p:1,height:"100%"},children:[e.jsx(c,{variant:"subtitle2",color:"text.secondary",gutterBottom:!0,children:"APIs Used"}),e.jsx(c,{variant:"body2",color:"primary",fontWeight:"bold",children:n.totalApis}),e.jsxs(l,{display:"flex",gap:.3,mt:.2,children:[e.jsxs(c,{variant:"caption",color:"success.main",children:[" ",n.successfulApis]}),e.jsxs(c,{variant:"caption",color:"error.main",children:[" ",n.failedApis]})]})]})})]})}),e.jsxs(l,{sx:{p:1.5},children:[e.jsx(l,{sx:{mb:1.5},children:e.jsxs(W,{container:!0,spacing:1,children:[n.failedSymbols&&n.failedSymbols.length>0&&e.jsx(W,{item:!0,xs:12,sm:6,md:6,children:e.jsxs(se,{variant:"outlined",sx:{p:1,borderColor:"error.main",height:"100%"},children:[e.jsxs(c,{variant:"subtitle2",color:"error",gutterBottom:!0,children:["Failed Symbols (",n.failedSymbols.length,")"]}),e.jsx(l,{display:"flex",gap:.3,flexWrap:"wrap",sx:{maxHeight:"60px",overflow:"auto"},children:n.failedSymbols.map((m,x)=>e.jsx(ce,{label:m,color:"error",variant:"outlined",size:"small",sx:{fontSize:"0.65rem",height:"18px"}},x))})]})}),n.errorMessage&&e.jsx(W,{item:!0,xs:12,sm:6,md:6,children:e.jsxs(se,{variant:"outlined",sx:{p:1,borderColor:"error.main",height:"100%"},children:[e.jsx(c,{variant:"subtitle2",color:"error",gutterBottom:!0,children:"Error Information"}),e.jsxs(c,{variant:"body2",sx:{mb:.5},children:[e.jsx("strong",{children:"Code:"})," ",n.errorCode]}),e.jsxs(c,{variant:"body2",sx:{mb:.5},children:[e.jsx("strong",{children:"Message:"})," ",n.errorMessage]}),n.stackTrace&&e.jsxs(Ll,{sx:{"& .MuiAccordionSummary-root":{minHeight:"24px"}},children:[e.jsx(El,{expandIcon:e.jsx(ln,{}),sx:{py:0},children:e.jsx(c,{variant:"caption",children:"Stack Trace"})}),e.jsx(Wl,{sx:{py:.5},children:e.jsx(l,{component:"pre",sx:{fontSize:"0.6rem",backgroundColor:"grey.100",p:.5,borderRadius:1,overflow:"auto",maxHeight:"80px"},children:n.stackTrace})})]})]})})]})}),e.jsxs(l,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,sx:{mb:.5},children:[e.jsx(c,{variant:"h6",children:"External API Calls"}),s&&s.length>0&&e.jsx(ce,{label:`${s.length} calls`,color:"primary",variant:"outlined",size:"small",sx:{fontSize:"0.7rem",height:"20px"}})]}),a?e.jsxs(l,{display:"flex",alignItems:"center",gap:2,sx:{p:3},children:[e.jsx(Ce,{size:20}),e.jsx(c,{variant:"body2",children:"Loading API call details..."})]}):s&&s.length>0?e.jsx(at,{component:Te,sx:{mt:.5,"& .MuiTable-root":{minWidth:"900px"}},children:e.jsxs(it,{size:"small",stickyHeader:!0,children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{sx:{minWidth:"90px",fontWeight:"bold",fontSize:"0.75rem"},children:"Provider"}),e.jsx(S,{sx:{maxWidth:"500px",fontWeight:"bold",fontSize:"0.75rem"},children:"Endpoint"}),e.jsx(S,{sx:{minWidth:"70px",fontWeight:"bold",fontSize:"0.75rem"},children:"Status"}),e.jsx(S,{sx:{minWidth:"110px",fontWeight:"bold",fontSize:"0.75rem"},children:"Response Time"}),e.jsx(S,{sx:{minWidth:"70px",fontWeight:"bold",fontSize:"0.75rem"},children:"Code"}),e.jsx(S,{sx:{minWidth:"90px",fontWeight:"bold",fontSize:"0.75rem"},children:"Symbols"}),e.jsx(S,{sx:{minWidth:"70px",fontWeight:"bold",fontSize:"0.75rem"},children:"Success"})]})}),e.jsx(ot,{children:s.map(m=>e.jsxs(rt.Fragment,{children:[e.jsxs(De,{hover:!0,onClick:()=>{const x=document.getElementById(`details-${m.id}`);x&&(x.style.display=x.style.display==="none"?"table-row":"none")},sx:{cursor:"pointer","&:hover":{backgroundColor:"action.hover"}},children:[e.jsx(S,{sx:{minWidth:"90px"},children:e.jsx(c,{variant:"body2",fontWeight:"medium",children:m.provider})}),e.jsx(S,{sx:{maxWidth:"500px"},children:e.jsxs(c,{variant:"body2",children:[m.method," ",m.endpoint]})}),e.jsx(S,{sx:{minWidth:"70px"},children:e.jsx(l,{display:"flex",alignItems:"center",gap:.3,children:d(m.status)})}),e.jsx(S,{sx:{minWidth:"110px"},children:e.jsx(c,{variant:"body2",fontWeight:"medium",children:h(m.responseTime)})}),e.jsx(S,{sx:{minWidth:"70px"},children:e.jsx(c,{variant:"body2",fontWeight:"medium",color:m.statusCode&&m.statusCode>=400?"error":"text.primary",children:m.statusCode||"N/A"})}),e.jsx(S,{sx:{minWidth:"90px"},children:e.jsxs(l,{children:[e.jsx(c,{variant:"body2",fontWeight:"medium",children:m.symbolsProcessed}),e.jsxs(l,{display:"flex",gap:.3,mt:.1,children:[e.jsxs(c,{variant:"caption",color:"success.main",children:[" ",m.successfulSymbols]}),e.jsxs(c,{variant:"caption",color:"error.main",children:[" ",m.failedSymbols]})]})]})}),e.jsx(S,{sx:{minWidth:"70px"},children:e.jsxs(c,{variant:"body2",fontWeight:"medium",color:m.symbolsProcessed>0&&m.successfulSymbols/m.symbolsProcessed>=.9?"success.main":"warning.main",children:[m.symbolsProcessed>0?(m.successfulSymbols/m.symbolsProcessed*100).toFixed(0):0,"%"]})})]}),e.jsx(De,{id:`details-${m.id}`,style:{display:"none"},children:e.jsx(S,{colSpan:8,sx:{py:0,border:"none"},children:e.jsx(l,{sx:{p:1,backgroundColor:"grey.50",borderTop:1,borderColor:"divider"},children:e.jsxs(W,{container:!0,spacing:1,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{variant:"outlined",sx:{p:1,height:"100%"},children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,color:"primary",children:"Timing"}),e.jsxs(c,{variant:"body2",color:"text.secondary",sx:{mb:.3},children:[e.jsx("strong",{children:"Started:"})," ",u(m.startedAt)]}),e.jsxs(c,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Completed:"})," ",m.completedAt?u(m.completedAt):"N/A"]})]})}),m.errorMessage&&e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{variant:"outlined",sx:{p:1,height:"100%",borderColor:"error.main"},children:[e.jsx(c,{variant:"subtitle2",color:"error",gutterBottom:!0,children:"Error"}),e.jsx(c,{variant:"body2",children:m.errorMessage})]})}),m.requestData&&e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{variant:"outlined",sx:{p:1,height:"100%"},children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,color:"info",children:"Request"}),e.jsx(l,{component:"pre",sx:{fontSize:"0.6rem",backgroundColor:"grey.100",p:.5,borderRadius:1,overflow:"auto",maxHeight:100,border:1,borderColor:"divider"},children:JSON.stringify(m.requestData,null,2)})]})}),m.responseData&&e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(se,{variant:"outlined",sx:{p:1,height:"100%"},children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,color:"success",children:"Response"}),e.jsx(l,{component:"pre",sx:{fontSize:"0.6rem",backgroundColor:"grey.100",p:.5,borderRadius:1,overflow:"auto",maxHeight:100,border:1,borderColor:"divider"},children:JSON.stringify(m.responseData,null,2)})]})})]})})})})]},m.id))})]})}):e.jsx(l,{sx:{p:3,textAlign:"center"},children:e.jsx(c,{variant:"body2",color:"text.secondary",children:"No API call details available"})})]}),n.metadata&&e.jsx(l,{sx:{mt:1},children:e.jsxs(Ll,{children:[e.jsx(El,{expandIcon:e.jsx(ln,{}),sx:{py:.3},children:e.jsx(c,{variant:"subtitle2",children:"Metadata"})}),e.jsx(Wl,{sx:{py:.5},children:e.jsx(l,{component:"pre",sx:{fontSize:"0.6rem",backgroundColor:"grey.100",p:.5,borderRadius:1,overflow:"auto",maxHeight:120},children:JSON.stringify(n.metadata,null,2)})})]})})]})]})]})})}function L2({className:r}){var _;const[t,n]=p.useState([]),[s,a]=p.useState(null),[i,o]=p.useState(!0),[d,u]=p.useState(!1),[h,m]=p.useState(null),[x,g]=p.useState([]),[f,y]=p.useState(!1),[j,b]=p.useState(null),[v,P]=p.useState(!1),[w,C]=p.useState(!1),[k,A]=p.useState(null),[L,T]=p.useState({status:"",type:"",source:"",limit:50,offset:0,sortBy:"createdAt",sortOrder:"DESC"}),[M,O]=p.useState(!1);p.useEffect(()=>{I(),z()},[L]);const I=async()=>{try{o(!0);const K=await Ei.getTrackingRecords(L);n(K.data||[])}catch(K){console.error("Error fetching tracking records:",K)}finally{o(!1)}},z=async()=>{try{const K=await Ei.getTrackingStats(30);a(K)}catch(K){console.error("Error fetching stats:",K)}},N=p.useCallback(async K=>{if(!(j===K&&x.length>0))try{y(!0);const X=await Ei.getApiCallDetails(K);g(X||[]),b(K)}catch(X){console.error("Error fetching API call details:",X),g([])}finally{y(!1)}},[j,x.length]),E=K=>{m(K),u(!0),g([]),b(null),N(K.executionId)},R=()=>{u(!1),m(null),g([]),b(null)},V=async K=>{try{C(!0),A(null);const X=await Ei.cleanupOldData(K);A(`Successfully cleaned up ${X.deletedRecords} records older than ${K} days.`),await I(),await z(),setTimeout(()=>{P(!1),A(null)},2e3)}catch(X){console.error("Error cleaning up old data:",X),A(`Error: ${X instanceof Error?X.message:"Unknown error"}`)}finally{C(!1)}},F=K=>new Date(K).toLocaleString(),B=K=>K<1e3?`${K}ms`:K<6e4?`${(K/1e3).toFixed(1)}s`:`${(K/6e4).toFixed(1)}m`,$=K=>{switch(K){case"completed":return e.jsx(Xe,{color:"success"});case"failed":return e.jsx(qn,{color:"error"});case"running":return e.jsx(ti,{color:"primary"});case"started":return e.jsx(Ua,{color:"info"});default:return e.jsx(on,{color:"warning"})}},Y=K=>{const X={completed:"success",failed:"error",running:"primary",started:"info"};return e.jsx(ce,{label:K.toUpperCase(),color:X[K]||"default",size:"small"})};return e.jsxs(l,{className:r,children:[e.jsxs(W,{container:!0,spacing:3,sx:{mb:3},children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Sp,{color:"primary"}),e.jsxs(l,{children:[e.jsx(c,{variant:"h6",color:"primary",children:(s==null?void 0:s.totalExecutions)||0}),e.jsx(c,{variant:"body2",color:"text.secondary",children:"Total Executions"})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Xe,{color:"success"}),e.jsxs(l,{children:[e.jsx(c,{variant:"h6",color:"success.main",children:(s==null?void 0:s.successfulExecutions)||0}),e.jsx(c,{variant:"body2",color:"text.secondary",children:"Successful"})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(qn,{color:"error"}),e.jsxs(l,{children:[e.jsx(c,{variant:"h6",color:"error.main",children:(s==null?void 0:s.failedExecutions)||0}),e.jsx(c,{variant:"body2",color:"text.secondary",children:"Failed"})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(He,{color:"info"}),e.jsxs(l,{children:[e.jsxs(c,{variant:"h6",color:"info.main",children:[s!=null&&s.averageSuccessRate?s.averageSuccessRate.toFixed(1):"0.0","%"]}),e.jsx(c,{variant:"body2",color:"text.secondary",children:"Success Rate"})]})]})})})})]}),e.jsxs(l,{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:1,sx:{mb:1},children:[e.jsx(Fe,{title:M?"Hide filters":"Show filters",children:e.jsx(Ie,{size:"medium",onClick:()=>O(K=>!K),children:e.jsx(Ir,{})})}),e.jsx(ut,{variant:"outlined",color:"warning",startIcon:e.jsx(pt,{}),onClick:()=>P(!0),children:"Cleanup Old Data"})]}),M&&e.jsx(se,{sx:{mb:3},children:e.jsxs(me,{children:[e.jsx(l,{display:"flex",justifyContent:"space-between",alignItems:"center",sx:{mb:2},children:e.jsx(c,{variant:"h6",children:"Filters"})}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Status"}),e.jsxs(Ze,{value:L.status,onChange:K=>T({...L,status:K.target.value}),label:"Status",children:[e.jsx(re,{value:"",children:"All statuses"}),e.jsx(re,{value:"completed",children:"Completed"}),e.jsx(re,{value:"failed",children:"Failed"}),e.jsx(re,{value:"running",children:"Running"}),e.jsx(re,{value:"started",children:"Started"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Type"}),e.jsxs(Ze,{value:L.type,onChange:K=>T({...L,type:K.target.value}),label:"Type",children:[e.jsx(re,{value:"",children:"All types"}),e.jsx(re,{value:"scheduled",children:"Scheduled"}),e.jsx(re,{value:"manual",children:"Manual"}),e.jsx(re,{value:"triggered",children:"Triggered"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Source"}),e.jsxs(Ze,{value:L.source,onChange:K=>T({...L,source:K.target.value}),label:"Source",children:[e.jsx(re,{value:"",children:"All sources"}),e.jsx(re,{value:"cron_job",children:"Cron Job"}),e.jsx(re,{value:"api_trigger",children:"API Trigger"}),e.jsx(re,{value:"manual_trigger",children:"Manual Trigger"}),e.jsx(re,{value:"system_recovery",children:"System Recovery"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Limit"}),e.jsxs(Ze,{value:((_=L.limit)==null?void 0:_.toString())||"50",onChange:K=>T({...L,limit:parseInt(K.target.value)}),label:"Limit",children:[e.jsx(re,{value:"10",children:"10"}),e.jsx(re,{value:"25",children:"25"}),e.jsx(re,{value:"50",children:"50"}),e.jsx(re,{value:"100",children:"100"})]})]})})]})]})}),e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Tracking Records"}),e.jsx(at,{component:Te,children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:"Execution ID"}),e.jsx(S,{children:"Status"}),e.jsx(S,{children:"Type"}),e.jsx(S,{children:"Source"}),e.jsx(S,{children:"Started At"}),e.jsx(S,{children:"Duration"}),e.jsx(S,{children:"Success Rate"}),e.jsx(S,{children:"Total/Success/Fail"})]})}),e.jsx(ot,{children:t&&t.length>0?t.map(K=>e.jsxs(De,{hover:!0,onClick:()=>E(K),sx:{cursor:"pointer","&:hover":{backgroundColor:"action.hover"}},children:[e.jsx(S,{sx:{fontFamily:"monospace"},children:e.jsx(c,{variant:"body2",children:K.executionId})}),e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[$(K.successRate===100?"completed":"failed"),Y(K.successRate===100?"completed":"failed")]})}),e.jsx(S,{children:e.jsx(ce,{label:K.type.toUpperCase(),variant:"outlined",size:"small"})}),e.jsx(S,{children:e.jsx(ce,{label:K.source.replace("_"," ").toUpperCase(),variant:"outlined",size:"small"})}),e.jsx(S,{children:e.jsx(c,{variant:"body2",children:F(K.startedAt)})}),e.jsx(S,{children:e.jsx(c,{variant:"body2",children:B(K.executionTimeMs)})}),e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[K.successRate===100?e.jsx(He,{color:"success"}):e.jsx(Bt,{color:"error"}),e.jsxs(c,{variant:"body2",fontWeight:"medium",color:K.successRate===100?"success.main":"error.main",children:[K!=null&&K.successRate?K.successRate.toFixed(1):"0.0","%"]})]})}),e.jsx(S,{children:e.jsxs(c,{variant:"body2",color:"text.secondary",children:[K.totalSymbols,"/",K.successfulUpdates,"/",K.failedUpdates]})})]},K.id)):e.jsx(De,{children:e.jsx(S,{colSpan:9,align:"center",children:i?e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Ce,{size:20}),e.jsx(c,{variant:"body2",children:"Loading tracking records..."})]}):e.jsx(c,{variant:"body2",color:"text.secondary",children:"No tracking records found"})})})})]})})]})}),e.jsx(N2,{open:d,onClose:R,selectedRecord:h,apiCallDetails:x,loadingApiCalls:f,onFetchApiCallDetails:N}),e.jsx(M2,{open:v,onClose:()=>P(!1),onCleanup:V,loading:w,result:k})]})}class E2{async getPriceHistory(t,n={}){const s=new URLSearchParams;return n.startDate&&s.append("startDate",n.startDate),n.endDate&&s.append("endDate",n.endDate),n.priceType&&s.append("priceType",n.priceType),n.priceSource&&s.append("priceSource",n.priceSource),n.limit&&s.append("limit",n.limit.toString()),n.offset&&s.append("offset",n.offset.toString()),n.sortBy&&s.append("sortBy",n.sortBy),n.sortOrder&&s.append("sortOrder",n.sortOrder),(await q.api.get(`/api/v1/price-history/asset/${t}?${s.toString()}`)).data}async getLatestPriceHistory(t,n=10){return this.getPriceHistory(t,{limit:n,sortBy:"createdAt",sortOrder:"DESC"})}async getPriceHistoryByDateRange(t,n,s,a){return this.getPriceHistory(t,{startDate:n,endDate:s,limit:a,sortBy:"createdAt",sortOrder:"ASC"})}async getPriceHistoryByType(t,n,s){return this.getPriceHistory(t,{priceType:n,limit:s,sortBy:"createdAt",sortOrder:"DESC"})}async getPriceHistoryBySource(t,n,s){return this.getPriceHistory(t,{priceSource:n,limit:s,sortBy:"createdAt",sortOrder:"DESC"})}}const Wi=new E2,W2=r=>{const{assetId:t,query:n={},enabled:s=!0}=r,a=Kt(),{data:i,isLoading:o,error:d,refetch:u}=yt({queryKey:["priceHistory",t,n],queryFn:()=>Wi.getPriceHistory(t,n),enabled:s&&!!t,staleTime:5*60*1e3,cacheTime:10*60*1e3}),h=i?i.page<i.totalPages:!1,m=i?i.page>1:!1,x=(i==null?void 0:i.page)||1,g=(i==null?void 0:i.totalPages)||0,f=(i==null?void 0:i.total)||0,y=p.useCallback(()=>{if(h&&i){const v={...n,offset:i.page*i.limit||0};a.prefetchQuery({queryKey:["priceHistory",t,v],queryFn:()=>Wi.getPriceHistory(t,v)})}},[h,i,n,t,a]),j=p.useCallback(()=>{if(m&&i){const v={...n,offset:Math.max(0,(i.page-2)*i.limit||0)};a.prefetchQuery({queryKey:["priceHistory",t,v],queryFn:()=>Wi.getPriceHistory(t,v)})}},[m,i,n,t,a]),b=p.useCallback(v=>{if(i&&v>=1&&v<=i.totalPages){const P={...n,offset:(v-1)*i.limit||0};a.prefetchQuery({queryKey:["priceHistory",t,P],queryFn:()=>Wi.getPriceHistory(t,P)})}},[i,n,t,a]);return{data:i,isLoading:o,error:d,refetch:u,hasNextPage:h,hasPreviousPage:m,nextPage:y,previousPage:j,goToPage:b,currentPage:x,totalPages:g,totalRecords:f}},F2=mi({price:Ka().required("Price is required").positive("Price must be positive").min(.01,"Price must be at least 0.01"),priceType:sn().required("Price type is required").oneOf(["MANUAL","EXTERNAL"],"Invalid price type"),priceSource:sn().required("Price source is required").oneOf(["USER_INPUT","EXTERNAL_API"],"Invalid price source"),changeReason:sn().max(200,"Change reason must be at most 200 characters")}),Au=[{value:"MANUAL",label:"Manual Entry",color:"#1976d2"},{value:"EXTERNAL",label:"External Source",color:"#f57c00"}],Iu=[{value:"USER_INPUT",label:"User Input",color:"#1976d2"},{value:"EXTERNAL_API",label:"External API",color:"#f57c00"}],z2=({asset:r,onPriceUpdate:t,onPriceHistoryRefresh:n,loading:s=!1,error:a})=>{var K,X,ne,oe,ee;const[i,o]=p.useState(!1),[d,u]=p.useState(1),[h,m]=p.useState(10),x=Kt(),{data:g,isLoading:f,error:y,refetch:j,goToPage:b,totalPages:v,totalRecords:P}=W2({assetId:r.id,query:{limit:h,offset:(d-1)*h,sortBy:"createdAt",sortOrder:"DESC"}}),w=(g==null?void 0:g.data)||[],{control:C,handleSubmit:k,reset:A,formState:{errors:L}}=xi({resolver:Si(F2),defaultValues:{price:((K=r.assetPrice)==null?void 0:K.currentPrice)||0,priceType:((X=r.assetPrice)==null?void 0:X.priceType)||"MANUAL",priceSource:((ne=r.assetPrice)==null?void 0:ne.priceSource)||"USER_INPUT",changeReason:""}}),T=p.useMemo(()=>{if(w.length<2)return 0;const H=typeof w[0].price=="string"?parseFloat(w[0].price):w[0].price,Q=typeof w[1].price=="string"?parseFloat(w[1].price):w[1].price;return(H-Q)/Q*100},[w]),M=(H,Q)=>{const Z=typeof H=="string"?parseFloat(H):H;return new Intl.NumberFormat("en-US",{style:"currency",currency:Q,minimumFractionDigits:2,maximumFractionDigits:2}).format(Z)},O=H=>new Date(H).toLocaleString(),I=()=>T>.1?e.jsx(He,{color:"success"}):T<-.1?e.jsx(Bt,{color:"error"}):e.jsx(ja,{color:"disabled"}),z=H=>{const Q=Au.find(Z=>Z.value===H);return(Q==null?void 0:Q.color)||"#666"},N=H=>{const Q=Iu.find(Z=>Z.value===H);return(Q==null?void 0:Q.color)||"#666"},E=async H=>{try{await t(r.id,H.price,H.priceType,H.priceSource,H.changeReason),o(!1),A(),x.invalidateQueries(["priceHistory",r.id]),await j()}catch(Q){console.error("Price update error:",Q)}},R=async()=>{try{await n(r.id),x.invalidateQueries(["priceHistory",r.id]),await j()}catch(H){console.error("Price history refresh error:",H)}},V=(H,Q)=>{u(Q),b(Q)},F=H=>{const Q=H.target.value;m(Q),u(1)},B=H=>{const Q=new Date,Z=new Date(H),J=Math.floor((Q.getTime()-Z.getTime())/(1e3*60*60));return J<1?"Just now":J<24?`${J}h ago`:`${Math.floor(J/24)}d ago`},$=H=>{const Q=new Date,Z=new Date(H),J=Math.floor((Q.getTime()-Z.getTime())/(1e3*60*60));return J<1?"success":J<24?"warning":"error"},Y=((oe=r.assetPrice)==null?void 0:oe.lastPriceUpdate)||(w.length>0?w[0].createdAt:null),_=Y?new Date(new Date(Y).getTime()+24*60*60*1e3).toISOString():null;return a?e.jsx(je,{severity:"error",children:a}):e.jsx(hr,{dateAdapter:Ar,children:e.jsxs(l,{sx:{overflow:"auto",py:2,px:0},children:[e.jsx(se,{sx:{mb:3,borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.1)",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",overflow:"hidden"},children:e.jsx(me,{sx:{p:2},children:e.jsxs(W,{container:!0,spacing:2,alignItems:"center",children:[e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsxs(l,{sx:{mb:2},children:[e.jsx(D,{variant:"h3",sx:{fontWeight:700,mb:2},children:M(((ee=r.assetPrice)==null?void 0:ee.currentPrice)||0,r.currency)}),e.jsxs(D,{variant:"h6",sx:{fontWeight:400,mb:2},children:[r.symbol,"  ",r.name]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[I(),e.jsxs(D,{variant:"h6",sx:{fontWeight:600,color:T>0?"#4caf50":T<0?"#f44336":"rgba(255,255,255,0.8)"},children:[T>0?"+":"",T.toFixed(2),"%"]}),e.jsx(D,{variant:"body1",sx:{opacity:.8},children:"vs previous"})]})]}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsxs(l,{sx:{display:"flex",gap:1.5,flexWrap:"wrap",mb:1,justifyContent:"flex-end"},children:[r.assetPrice&&e.jsxs(e.Fragment,{children:[e.jsx(ce,{label:r.assetPrice.priceType,size:"small",sx:{backgroundColor:"rgba(255,255,255,0.2)",color:"white",border:"1px solid rgba(255,255,255,0.3)"}}),e.jsx(ce,{label:r.assetPrice.priceSource,size:"small",sx:{backgroundColor:"rgba(255,255,255,0.2)",color:"white",border:"1px solid rgba(255,255,255,0.3)"}}),e.jsx(ce,{label:B(r.assetPrice.lastPriceUpdate),size:"small",sx:{backgroundColor:$(r.assetPrice.lastPriceUpdate)==="success"?"rgba(76,175,80,0.8)":$(r.assetPrice.lastPriceUpdate)==="warning"?"rgba(255,152,0,0.8)":"rgba(244,67,54,0.8)",color:"white"}})]}),e.jsxs(D,{variant:"subtitle2",sx:{fontWeight:500},children:["Last updated: ",r.assetPrice?O(r.assetPrice.lastPriceUpdate):"N/A"]})]})})]})})}),e.jsx(l,{sx:{py:2,px:0},children:e.jsxs(l,{children:[e.jsx(l,{sx:{mb:2}}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,p:2,backgroundColor:"rgba(102,126,234,0.05)",borderRadius:2,border:"1px solid rgba(102,126,234,0.1)"},children:[e.jsxs(l,{children:[e.jsxs(D,{variant:"h6",sx:{fontWeight:600,color:"#667eea"},children:[w.length," Price Records"]}),e.jsxs(l,{sx:{display:"flex",gap:3,mt:.5,flexWrap:"wrap"},children:[e.jsxs(D,{variant:"body2",color:"text.secondary",children:["Last update: ",Y?O(Y):"N/A"]}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:["Next run: ",_?O(_):"N/A"]})]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(he,{variant:"outlined",icon:e.jsx(Mt,{}),onClick:R,disabled:f,mobileText:"Refresh",desktopText:"Refresh",sx:{borderColor:"#667eea",color:"#667eea",fontWeight:600,"&:hover":{borderColor:"#5a6fd8",backgroundColor:"rgba(102,126,234,0.05)"}},children:"Refresh"}),e.jsx(We,{onClick:()=>o(!0),variant:"contained",icon:e.jsx(Tt,{}),disabled:s,mobileText:"Update",desktopText:"Update Price",sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",fontWeight:600,px:3,py:1.5,borderRadius:2,boxShadow:"0 4px 16px rgba(102,126,234,0.3)","&:hover":{transform:"translateY(-2px)",boxShadow:"0 6px 20px rgba(102,126,234,0.4)"}},children:"Update Price"})]})]}),y?e.jsxs(je,{severity:"error",sx:{mb:3,borderRadius:2},children:["Failed to load price history: ",y instanceof Error?y.message:"Unknown error"]}):null,f?e.jsxs(l,{sx:{mb:3},children:[e.jsx(ds,{sx:{borderRadius:1,height:6}}),e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mt:1,textAlign:"center"},children:"Loading price history..."})]}):w.length===0?e.jsx(se,{sx:{borderRadius:3,boxShadow:"0 4px 20px rgba(0,0,0,0.08)",border:"1px solid rgba(0,0,0,0.05)"},children:e.jsxs(me,{sx:{p:4,textAlign:"center"},children:[e.jsx(D,{variant:"h6",color:"text.secondary",sx:{mb:1},children:"No Price History Available"}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"This asset doesn't have any price history records yet."})]})}):e.jsxs(se,{sx:{borderRadius:3,boxShadow:"0 4px 20px rgba(0,0,0,0.08)",border:"1px solid rgba(0,0,0,0.05)",overflow:"hidden"},children:[e.jsx(at,{sx:{"&::-webkit-scrollbar":{height:8},"&::-webkit-scrollbar-track":{backgroundColor:"rgba(0,0,0,0.1)",borderRadius:4},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(102,126,234,0.3)",borderRadius:4,"&:hover":{backgroundColor:"rgba(102,126,234,0.5)"}}},children:e.jsxs(it,{sx:{minWidth:600},children:[e.jsx(ct,{sx:{backgroundColor:"rgba(102,126,234,0.05)"},children:e.jsxs(De,{children:[e.jsx(S,{sx:{fontWeight:700,color:"#667eea",width:"18%",fontSize:"0.875rem"},children:"Price"}),e.jsx(S,{sx:{fontWeight:700,color:"#667eea",width:"12%",fontSize:"0.875rem"},children:"Type"}),e.jsx(S,{sx:{fontWeight:700,color:"#667eea",width:"12%",fontSize:"0.875rem"},children:"Source"}),e.jsx(S,{sx:{fontWeight:700,color:"#667eea",width:"28%",fontSize:"0.875rem"},children:"Reason"}),e.jsx(S,{sx:{fontWeight:700,color:"#667eea",width:"30%",fontSize:"0.875rem"},children:"Date"})]})}),e.jsx(ot,{children:w.map(H=>e.jsxs(De,{sx:{"&:hover":{backgroundColor:"rgba(102,126,234,0.02)"},"&:nth-of-type(even)":{backgroundColor:"rgba(0,0,0,0.02)"}},children:[e.jsx(S,{sx:{py:1.5},children:e.jsx(D,{variant:"body2",fontWeight:"600",sx:{color:"#667eea",fontSize:"0.875rem"},children:M(H.price,r.currency)})}),e.jsx(S,{sx:{py:1.5},children:e.jsx(ce,{label:H.priceType,size:"small",sx:{backgroundColor:z(H.priceType),color:"white",fontWeight:600,fontSize:"0.7rem",height:22,"& .MuiChip-label":{fontSize:"0.7rem",padding:"0 8px"}}})}),e.jsx(S,{sx:{py:1.5},children:e.jsx(ce,{label:H.priceSource,size:"small",sx:{backgroundColor:N(H.priceSource),color:"white",fontWeight:600,fontSize:"0.7rem",height:22,"& .MuiChip-label":{fontSize:"0.7rem",padding:"0 8px"}}})}),e.jsx(S,{sx:{py:1.5},children:e.jsx(D,{variant:"body2",sx:{fontSize:"0.7rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100%"},children:H.changeReason||"N/A"})}),e.jsx(S,{sx:{py:1.5},children:e.jsx(D,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.7rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:O(H.createdAt)})})]},H.id))})]})}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:1,px:2,py:1,backgroundColor:"grey.50",borderRadius:1},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(D,{variant:"body2",color:"text.secondary",children:["Showing ",w.length," of ",P||0," records"]}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:["Page ",d," of ",v||1]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(D,{variant:"body2",color:"text.secondary",children:"Rows per page:"}),e.jsx(nt,{size:"small",sx:{minWidth:80},children:e.jsxs(Ze,{value:h,onChange:F,variant:"outlined",children:[e.jsx(re,{value:10,children:"10"}),e.jsx(re,{value:20,children:"20"}),e.jsx(re,{value:50,children:"50"}),e.jsx(re,{value:100,children:"100"})]})})]})]}),e.jsx(l,{sx:{display:"flex",justifyContent:"center",mt:1,mb:2},children:e.jsx(la,{count:v||1,page:d,onChange:V,color:"primary",size:"small",showFirstButton:!0,showLastButton:!0,disabled:v<=1})})]})]})}),e.jsxs(kt,{open:i,onClose:()=>o(!1),maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.2)"}},children:[e.jsxs(Et,{sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontWeight:700,fontSize:"1.5rem",py:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{children:["Update Price - ",r.symbol]}),e.jsx(he,{onClick:()=>o(!1),icon:e.jsx(sr,{}),forceIconOnly:!0,mobileText:"",desktopText:"",sx:{color:"white",minWidth:"auto",p:1,"&:hover":{backgroundColor:"rgba(255,255,255,0.1)"}},children:"Close"})]}),e.jsxs("form",{onSubmit:k(E),children:[e.jsxs(Pt,{sx:{p:4},children:[e.jsx(l,{sx:{mb:3},children:e.jsxs(D,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Update the current price for ",e.jsx("strong",{children:r.name})]})}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,children:e.jsx(mn,{name:"price",control:C,render:({field:H})=>{var Q;return e.jsx(Ae,{...H,label:"New Price",type:"number",fullWidth:!0,error:!!L.price,helperText:(Q=L.price)==null?void 0:Q.message,InputProps:{startAdornment:e.jsx(D,{sx:{mr:1,fontWeight:600,color:"#667eea"},children:r.currency})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#667eea"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#667eea",borderWidth:2}}}})}})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(mn,{name:"priceType",control:C,render:({field:H})=>e.jsxs(nt,{fullWidth:!0,error:!!L.priceType,children:[e.jsx(st,{children:"Price Type"}),e.jsx(Ze,{...H,label:"Price Type",sx:{borderRadius:2,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#667eea"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#667eea",borderWidth:2}},children:Au.map(Q=>e.jsx(re,{value:Q.value,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(l,{sx:{width:12,height:12,borderRadius:"50%",backgroundColor:Q.color}}),Q.label]})},Q.value))}),L.priceType&&e.jsx(D,{variant:"caption",color:"error",sx:{mt:1,display:"block"},children:L.priceType.message})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(mn,{name:"priceSource",control:C,render:({field:H})=>e.jsxs(nt,{fullWidth:!0,error:!!L.priceSource,children:[e.jsx(st,{children:"Price Source"}),e.jsx(Ze,{...H,label:"Price Source",sx:{borderRadius:2,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#667eea"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#667eea",borderWidth:2}},children:Iu.map(Q=>e.jsx(re,{value:Q.value,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(l,{sx:{width:12,height:12,borderRadius:"50%",backgroundColor:Q.color}}),Q.label]})},Q.value))}),L.priceSource&&e.jsx(D,{variant:"caption",color:"error",sx:{mt:1,display:"block"},children:L.priceSource.message})]})})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(mn,{name:"changeReason",control:C,render:({field:H})=>{var Q;return e.jsx(Ae,{...H,label:"Change Reason (Optional)",fullWidth:!0,multiline:!0,rows:3,error:!!L.changeReason,helperText:(Q=L.changeReason)==null?void 0:Q.message,placeholder:"Enter a reason for this price change...",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"#667eea"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#667eea",borderWidth:2}}}})}})})]})]}),e.jsx(Dt,{sx:{p:3,pt:2,gap:2,borderTop:"1px solid rgba(0,0,0,0.1)",justifyContent:"flex-end"},children:e.jsx(We,{type:"submit",variant:"contained",disabled:s,icon:s?e.jsx(Ce,{size:20}):e.jsx(Tt,{}),mobileText:s?"Updating...":"Update",desktopText:s?"Updating...":"Update Price",forceTextOnly:!0,sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",fontWeight:700,minWidth:140,borderRadius:2,boxShadow:"0 4px 16px rgba(102,126,234,0.3)","&:hover":{transform:"translateY(-2px)",boxShadow:"0 6px 20px rgba(102,126,234,0.4)"}},children:s?"Updating...":"Update Price"})})]})]})]})})},O2=({open:r,onClose:t,asset:n,onPriceUpdate:s,onPriceHistoryRefresh:a,loading:i=!1,error:o})=>{if(!n)return null;const d=h=>{switch(h){case"AUTOMATIC":return"success";case"MANUAL":return"warning";default:return"default"}},u=h=>{switch(h){case"AUTOMATIC":return e.jsx(Tp,{fontSize:"small"});case"MANUAL":return e.jsx(Tt,{fontSize:"small"});default:return}};return e.jsxs(Rt,{open:r,onClose:t,title:`Price Management - ${n.symbol}`,maxWidth:"lg",loading:i,size:"medium",actions:e.jsx(he,{onClick:t,mobileText:"Close",desktopText:"Close",children:"Close"}),children:[e.jsx(l,{sx:{p:2,backgroundColor:"grey.50",borderRadius:2,border:"1px solid",borderColor:"grey.200"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(D,{variant:"body2",color:"text.secondary",sx:{fontWeight:500},children:"Price Mode:"}),e.jsx(ce,{label:n.priceMode,color:d(n.priceMode),icon:u(n.priceMode),size:"small",sx:{fontWeight:500,"& .MuiChip-icon":{fontSize:"16px"}}})]})}),e.jsx(z2,{asset:{id:n.id,symbol:n.symbol,name:n.name,currency:n.currency,assetPrice:n.assetPrice?{id:"",assetId:n.id,currentPrice:n.assetPrice.currentPrice,priceType:n.assetPrice.priceType,priceSource:n.assetPrice.priceSource,lastPriceUpdate:n.assetPrice.lastPriceUpdate}:void 0},onPriceUpdate:s,onPriceHistoryRefresh:a,loading:i,error:o})]})},V2=({assets:r,loading:t=!1,error:n,onRefresh:s,onCreateAsset:a,onUpdateAsset:i,total:o=0,page:d=1,totalPages:u=1,rowsPerPage:h,onChangePage:m,onChangeRowsPerPage:x,onPriceUpdate:g,onPriceHistoryRefresh:f,onUpdateAllPrices:y})=>{const[j,b]=p.useState(0),[v,P]=p.useState(!1),[w,C]=p.useState(null),[k,A]=p.useState(!1),[L,T]=p.useState("create"),[M,O]=p.useState(!1),[I,z]=p.useState(!1),[N,E]=p.useState(null),[R,V]=p.useState(!1),[F,B]=p.useState({open:!1,message:"",severity:"info"}),[$,Y]=p.useState(!1),_=hk(),K=(Le,qe)=>{b(qe)},X=()=>{T("create"),C(null),P(!0)},ne=Le=>{T("edit"),C(Le),P(!0)},oe=Le=>{E(Le),z(!0)},ee=async()=>{if(N){V(!0);try{await _.mutateAsync(N.id),B({open:!0,message:`Asset "${N.symbol}" has been deleted successfully`,severity:"success"}),s(),z(!1),E(null)}catch(Le){console.error("Delete error:",Le);const qe=Le instanceof Error?Le.message:"Failed to delete asset";B({open:!0,message:`Failed to delete asset: ${qe}`,severity:"error"})}finally{V(!1)}}},H=()=>{z(!1),E(null)},Q=()=>{B(Le=>({...Le,open:!1}))},Z=Le=>{C(Le),A(!0)},J=async Le=>{O(!0);try{L==="create"?await a(Le):w&&await i(w.id,Le),P(!1),s()}catch(qe){console.error("Form submission error:",qe)}finally{O(!1)}},ae=()=>{P(!1),C(null)},ue=()=>{A(!1),C(null)},le=async()=>{Y(!0);try{await y(),B({open:!0,message:"All prices have been updated successfully",severity:"success"})}catch(Le){console.error("Update all prices error:",Le);const qe=Le instanceof Error?Le.message:"Failed to update all prices";B({open:!0,message:`Failed to update all prices: ${qe}`,severity:"error"})}finally{Y(!1)}},pe=Le=>({STOCK:"#1976d2",BOND:"#388e3c",CRYPTO:"#f57c00",COMMODITY:"#7b1fa2",CURRENCY:"#d32f2f",ETF:"#0288d1",MUTUAL_FUND:"#5d4037"})[Le]||"#666",Me=Le=>({VN:"Vietnam",US:"United States"})[Le]||Le;return n?e.jsx(je,{severity:"error",action:e.jsx(he,{color:"inherit",size:"small",onClick:s,mobileText:"Retry",desktopText:"Retry",children:"Retry"}),children:n}):e.jsxs(l,{sx:{minHeight:"100vh",p:{xs:1.5,sm:2}},children:[e.jsx(se,{sx:{mb:{xs:2,sm:3},borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.1)",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white"},children:e.jsx(me,{sx:{p:{xs:2,sm:3}},children:e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{children:[e.jsx(D,{variant:"h3",component:"h1",sx:{fontWeight:700,mb:1,textShadow:"0 2px 4px rgba(0,0,0,0.3)"},children:"Global Asset Management"}),e.jsxs(D,{variant:"h6",sx:{opacity:.9,fontWeight:400,display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{label:`${r.length} Assets`,size:"small",sx:{backgroundColor:"rgba(255,255,255,0.2)",color:"white",fontWeight:600}}),e.jsx("span",{children:""}),e.jsxs("span",{children:["Page ",d," of ",u]}),e.jsx("span",{children:""}),e.jsxs("span",{children:[o," Total"]})]})]}),e.jsxs(l,{sx:{display:"flex",gap:2},children:[e.jsx(he,{variant:"outlined",icon:e.jsx(Mt,{}),onClick:s,disabled:t,mobileText:"Refresh",desktopText:"Refresh",sx:{backgroundColor:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.3)",color:"white",fontWeight:600,px:3,py:1.5,borderRadius:2,"&:hover":{backgroundColor:"rgba(255,255,255,0.2)",borderColor:"rgba(255,255,255,0.5)"}},children:"Refresh"}),e.jsx(We,{variant:"outlined",icon:$?e.jsx(Ce,{size:20,color:"inherit"}):e.jsx(bc,{}),onClick:le,disabled:$||t,mobileText:$?"Updating...":"Update All",desktopText:$?"Updating...":"Update All Prices",sx:{backgroundColor:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.3)",color:"white",fontWeight:600,px:3,py:1.5,borderRadius:2,"&:hover":{backgroundColor:"rgba(255,255,255,0.2)",borderColor:"rgba(255,255,255,0.5)"}},children:$?"Updating...":"Update All Prices"}),e.jsx(We,{variant:"contained",icon:e.jsx(xt,{}),onClick:X,disabled:t,mobileText:"Add",desktopText:"Add Asset",sx:{backgroundColor:"rgba(255,255,255,0.9)",color:"#667eea",fontWeight:700,px:4,py:1.5,borderRadius:2,boxShadow:"0 4px 16px rgba(0,0,0,0.2)","&:hover":{backgroundColor:"white",transform:"translateY(-2px)",boxShadow:"0 6px 20px rgba(0,0,0,0.25)"}},children:"Add Asset"})]})]})})}),e.jsxs(se,{sx:{borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.1)",overflow:"hidden"},children:[e.jsx(l,{sx:{background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)",borderBottom:"1px solid rgba(0,0,0,0.1)"},children:e.jsxs(Tr,{value:j,onChange:K,variant:"scrollable",scrollButtons:"auto",sx:{"& .MuiTab-root":{fontWeight:600,fontSize:{xs:"0.875rem",sm:"1rem"},py:2,px:{xs:2,sm:4},textTransform:"none",minHeight:64,minWidth:{xs:"auto",sm:120},"&.Mui-selected":{color:"#667eea",fontWeight:700}},"& .MuiTabs-indicator":{height:4,borderRadius:"2px 2px 0 0",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"},"& .MuiTabs-scrollButtons":{"&.Mui-disabled":{opacity:.3}}},children:[e.jsx(ht,{label:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(l,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:j===0?"#667eea":"#6c757d"}}),"Assets"]})}),e.jsx(ht,{label:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(l,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:j===1?"#667eea":"#6c757d"}}),"Auto Sync Tracking"]})})]})}),e.jsxs(l,{sx:{p:4,minHeight:600},children:[j===0&&e.jsx(l,{children:e.jsx(R2,{assets:r,loading:t,onEdit:ne,onDelete:oe,onView:Z,onRefresh:s,error:n,total:o,page:d,rowsPerPage:h,onChangePage:m,onChangeRowsPerPage:x})}),j===1&&e.jsx(l,{children:e.jsx(L2,{})})]})]}),e.jsx(D2,{open:v,onClose:ae,onSubmit:J,initialData:w||void 0,mode:L,loading:M}),e.jsx(O2,{open:k,onClose:ue,asset:w,onPriceUpdate:g,onPriceHistoryRefresh:f,loading:t,error:n}),e.jsxs(kt,{open:I,onClose:H,maxWidth:"sm",fullWidth:!0,PaperProps:{sx:{borderRadius:2,boxShadow:"0 8px 32px rgba(0,0,0,0.12)"}},children:[e.jsxs(Et,{sx:{display:"flex",alignItems:"center",gap:1,pb:1,borderBottom:"1px solid",borderColor:"divider"},children:[e.jsx(on,{color:"error",sx:{fontSize:28}}),e.jsx(D,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Delete Asset"}),e.jsx(Ie,{onClick:H,size:"small",sx:{color:"text.secondary","&:hover":{color:"text.primary"}},children:e.jsx(sr,{})})]}),e.jsx(Pt,{sx:{pt:3,pb:2},children:e.jsxs(ft,{spacing:3,children:[e.jsx(je,{severity:"warning",sx:{borderRadius:1,"& .MuiAlert-icon":{fontSize:20}},children:e.jsx(D,{variant:"body2",fontWeight:"medium",children:"This action cannot be undone"})}),N&&e.jsxs(l,{children:[e.jsx(D,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"You are about to delete the following asset:"}),e.jsx(se,{variant:"outlined",sx:{mt:1,bgcolor:"grey.50"},children:e.jsx(me,{sx:{p:2},children:e.jsxs(ft,{spacing:2,children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(l,{sx:{width:40,height:40,borderRadius:1,bgcolor:pe(N.type),display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:"0.875rem"},children:N.symbol.charAt(0)}),e.jsxs(l,{sx:{flexGrow:1},children:[e.jsx(D,{variant:"h6",sx:{fontSize:"1.1rem",fontWeight:600},children:N.symbol}),e.jsx(D,{variant:"body2",color:"text.secondary",children:N.name})]}),e.jsx(ce,{label:N.type,size:"small",sx:{backgroundColor:pe(N.type),color:"white",fontWeight:500}})]}),e.jsx(bt,{}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:6,children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Nation"}),e.jsx(D,{variant:"body2",fontWeight:"medium",children:Me(N.nation)})]}),e.jsxs(W,{item:!0,xs:6,children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Market Code"}),e.jsx(D,{variant:"body2",fontWeight:"medium",children:N.marketCode})]}),e.jsxs(W,{item:!0,xs:6,children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Currency"}),e.jsx(D,{variant:"body2",fontWeight:"medium",children:N.currency})]}),e.jsxs(W,{item:!0,xs:6,children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Status"}),e.jsx(ce,{label:N.isActive?"Active":"Inactive",size:"small",color:N.isActive?"success":"default",variant:"outlined"})]})]}),N.assetPrice&&e.jsxs(e.Fragment,{children:[e.jsx(bt,{}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Current Price"}),e.jsx(D,{variant:"h6",color:"primary",fontWeight:"bold",children:G(N.assetPrice.currentPrice,N.currency)}),e.jsxs(D,{variant:"caption",color:"text.secondary",children:["Last updated: ",Gt(N.assetPrice.lastPriceUpdate,"full")]})]})]})]})})})]}),e.jsx(D,{variant:"body2",color:"text.secondary",sx:{textAlign:"center"},children:"Are you sure you want to delete this asset? This will permanently remove all associated data including price history and trading records."})]})}),e.jsxs(Dt,{sx:{p:3,pt:2,gap:1,borderTop:"1px solid",borderColor:"divider"},children:[e.jsx(he,{onClick:H,variant:"outlined",disabled:R,mobileText:"Cancel",desktopText:"Cancel",sx:{minWidth:100},children:"Cancel"}),e.jsx(We,{onClick:ee,variant:"contained",color:"error",disabled:R,icon:R?e.jsx(Ce,{size:16}):e.jsx(pt,{}),mobileText:R?"Deleting...":"Delete",desktopText:R?"Deleting...":"Delete Asset",sx:{minWidth:120,fontWeight:600,"&:hover":{backgroundColor:"error.dark"}},children:R?"Deleting...":"Delete Asset"})]})]}),e.jsx(di,{open:F.open,autoHideDuration:6e3,onClose:Q,anchorOrigin:{vertical:"top",horizontal:"right"},sx:{"& .MuiSnackbarContent-root":{borderRadius:3,boxShadow:"0 8px 32px rgba(0,0,0,0.2)"}},children:e.jsx(je,{onClose:Q,severity:F.severity,variant:"filled",sx:{width:"100%",borderRadius:3,fontWeight:600,"& .MuiAlert-icon":{fontSize:24},"& .MuiAlert-message":{fontSize:"1rem"}},icon:F.severity==="success"?e.jsx(Xe,{}):F.severity==="error"?e.jsx(qn,{}):F.severity==="warning"?e.jsx(on,{}):void 0,children:F.message})})]})},$2=({onToggle:r,disabled:t=!1})=>{const[n,s]=p.useState(!1),[a,i]=p.useState(!1),{toggleAutoSync:o,getAutoSyncStatus:d}=ux();p.useEffect(()=>{(async()=>{try{const m=await d();s(!!m.enabled)}catch(m){console.error("Failed to load auto sync status:",m)}})()},[d]);const u=async h=>{const m=!!h.target.checked;i(!0);try{await o(m),s(m),r==null||r(m)}catch(x){console.error("Failed to toggle auto sync:",x),s(!m)}finally{i(!1)}};return e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(an,{control:e.jsx(jn,{checked:n,onChange:u,disabled:t||a,color:"primary",size:"medium"}),label:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[n?e.jsx(bc,{color:"primary",fontSize:"small"}):e.jsx(Cp,{color:"disabled",fontSize:"small"}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Auto Sync Market Price"})]})}),a&&e.jsx(ce,{label:"Updating...",size:"small",color:"info",variant:"outlined"})]})};var H2={lessThanXSeconds:{one:"di 1 giy",other:"di {{count}} giy"},xSeconds:{one:"1 giy",other:"{{count}} giy"},halfAMinute:"na pht",lessThanXMinutes:{one:"di 1 pht",other:"di {{count}} pht"},xMinutes:{one:"1 pht",other:"{{count}} pht"},aboutXHours:{one:"khong 1 gi",other:"khong {{count}} gi"},xHours:{one:"1 gi",other:"{{count}} gi"},xDays:{one:"1 ngy",other:"{{count}} ngy"},aboutXWeeks:{one:"khong 1 tun",other:"khong {{count}} tun"},xWeeks:{one:"1 tun",other:"{{count}} tun"},aboutXMonths:{one:"khong 1 thng",other:"khong {{count}} thng"},xMonths:{one:"1 thng",other:"{{count}} thng"},aboutXYears:{one:"khong 1 nm",other:"khong {{count}} nm"},xYears:{one:"1 nm",other:"{{count}} nm"},overXYears:{one:"hn 1 nm",other:"hn {{count}} nm"},almostXYears:{one:"gn 1 nm",other:"gn {{count}} nm"}},B2=function(t,n,s){var a,i=H2[t];return typeof i=="string"?a=i:n===1?a=i.one:a=i.other.replace("{{count}}",String(n)),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?a+" na":a+" trc":a},U2={full:"EEEE, 'ngy' d MMMM 'nm' y",long:"'ngy' d MMMM 'nm' y",medium:"d MMM 'nm' y",short:"dd/MM/y"},_2={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Y2={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},q2={date:da({formats:U2,defaultWidth:"full"}),time:da({formats:_2,defaultWidth:"full"}),dateTime:da({formats:Y2,defaultWidth:"full"})},G2={lastWeek:"eeee 'tun trc vo lc' p",yesterday:"'hm qua vo lc' p",today:"'hm nay vo lc' p",tomorrow:"'ngy mai vo lc' p",nextWeek:"eeee 'ti vo lc' p",other:"P"},K2=function(t,n,s,a){return G2[t]},Q2={narrow:["TCN","SCN"],abbreviated:["trc CN","sau CN"],wide:["trc Cng Nguyn","sau Cng Nguyn"]},X2={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["Qu 1","Qu 2","Qu 3","Qu 4"]},J2={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["qu I","qu II","qu III","qu IV"]},Z2={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["Thg 1","Thg 2","Thg 3","Thg 4","Thg 5","Thg 6","Thg 7","Thg 8","Thg 9","Thg 10","Thg 11","Thg 12"],wide:["Thng Mt","Thng Hai","Thng Ba","Thng T","Thng Nm","Thng Su","Thng By","Thng Tm","Thng Chn","Thng Mi","Thng Mi Mt","Thng Mi Hai"]},eP={narrow:["01","02","03","04","05","06","07","08","09","10","11","12"],abbreviated:["thg 1","thg 2","thg 3","thg 4","thg 5","thg 6","thg 7","thg 8","thg 9","thg 10","thg 11","thg 12"],wide:["thng 01","thng 02","thng 03","thng 04","thng 05","thng 06","thng 07","thng 08","thng 09","thng 10","thng 11","thng 12"]},tP={narrow:["CN","T2","T3","T4","T5","T6","T7"],short:["CN","Th 2","Th 3","Th 4","Th 5","Th 6","Th 7"],abbreviated:["CN","Th 2","Th 3","Th 4","Th 5","Th 6","Th 7"],wide:["Ch Nht","Th Hai","Th Ba","Th T","Th Nm","Th Su","Th By"]},nP={narrow:{am:"am",pm:"pm",midnight:"na m",noon:"tr",morning:"sg",afternoon:"ch",evening:"ti",night:"m"},abbreviated:{am:"AM",pm:"PM",midnight:"na m",noon:"tra",morning:"sng",afternoon:"chiu",evening:"ti",night:"m"},wide:{am:"SA",pm:"CH",midnight:"na m",noon:"tra",morning:"sng",afternoon:"chiu",evening:"ti",night:"m"}},rP={narrow:{am:"am",pm:"pm",midnight:"na m",noon:"tr",morning:"sg",afternoon:"ch",evening:"ti",night:"m"},abbreviated:{am:"AM",pm:"PM",midnight:"na m",noon:"tra",morning:"sng",afternoon:"chiu",evening:"ti",night:"m"},wide:{am:"SA",pm:"CH",midnight:"na m",noon:"gia tra",morning:"vo bui sng",afternoon:"vo bui chiu",evening:"vo bui ti",night:"vo ban m"}},sP=function(t,n){var s=Number(t),a=n==null?void 0:n.unit;if(a==="quarter")switch(s){case 1:return"I";case 2:return"II";case 3:return"III";case 4:return"IV"}else if(a==="day")switch(s){case 1:return"th 2";case 2:return"th 3";case 3:return"th 4";case 4:return"th 5";case 5:return"th 6";case 6:return"th 7";case 7:return"ch nht"}else{if(a==="week")return s===1?"th nht":"th "+s;if(a==="dayOfYear")return s===1?"u tin":"th "+s}return String(s)},aP={ordinalNumber:sP,era:Or({values:Q2,defaultWidth:"wide"}),quarter:Or({values:X2,defaultWidth:"wide",formattingValues:J2,defaultFormattingWidth:"wide",argumentCallback:function(t){return t-1}}),month:Or({values:Z2,defaultWidth:"wide",formattingValues:eP,defaultFormattingWidth:"wide"}),day:Or({values:tP,defaultWidth:"wide"}),dayPeriod:Or({values:nP,defaultWidth:"wide",formattingValues:rP,defaultFormattingWidth:"wide"})},iP=/^(\d+)/i,oP=/\d+/i,lP={narrow:/^(tcn|scn)/i,abbreviated:/^(trc CN|sau CN)/i,wide:/^(trc Cng Nguyn|sau Cng Nguyn)/i},cP={any:[/^t/i,/^s/i]},dP={narrow:/^([1234]|i{1,3}v?)/i,abbreviated:/^q([1234]|i{1,3}v?)/i,wide:/^qu ([1234]|i{1,3}v?)/i},uP={any:[/(1|i)$/i,/(2|ii)$/i,/(3|iii)$/i,/(4|iv)$/i]},hP={narrow:/^(0?[2-9]|10|11|12|0?1)/i,abbreviated:/^thg[ _]?(0?[1-9](?!\d)|10|11|12)/i,wide:/^thng ?(Mt|Hai|Ba|T|Nm|Su|By|Tm|Chn|Mi|Mi ?Mt|Mi ?Hai|0?[1-9](?!\d)|10|11|12)/i},mP={narrow:[/0?1$/i,/0?2/i,/3/,/4/,/5/,/6/,/7/,/8/,/9/,/10/,/11/,/12/],abbreviated:[/^thg[ _]?0?1(?!\d)/i,/^thg[ _]?0?2/i,/^thg[ _]?0?3/i,/^thg[ _]?0?4/i,/^thg[ _]?0?5/i,/^thg[ _]?0?6/i,/^thg[ _]?0?7/i,/^thg[ _]?0?8/i,/^thg[ _]?0?9/i,/^thg[ _]?10/i,/^thg[ _]?11/i,/^thg[ _]?12/i],wide:[/^thng ?(Mt|0?1(?!\d))/i,/^thng ?(Hai|0?2)/i,/^thng ?(Ba|0?3)/i,/^thng ?(T|0?4)/i,/^thng ?(Nm|0?5)/i,/^thng ?(Su|0?6)/i,/^thng ?(By|0?7)/i,/^thng ?(Tm|0?8)/i,/^thng ?(Chn|0?9)/i,/^thng ?(Mi|10)/i,/^thng ?(Mi ?Mt|11)/i,/^thng ?(Mi ?Hai|12)/i]},xP={narrow:/^(CN|T2|T3|T4|T5|T6|T7)/i,short:/^(CN|Th ?2|Th ?3|Th ?4|Th ?5|Th ?6|Th ?7)/i,abbreviated:/^(CN|Th ?2|Th ?3|Th ?4|Th ?5|Th ?6|Th ?7)/i,wide:/^(Ch ?Nht|Cha ?Nht|th ?Hai|th ?Ba|th ?T|th ?Nm|th ?Su|th ?By)/i},pP={narrow:[/CN/i,/2/i,/3/i,/4/i,/5/i,/6/i,/7/i],short:[/CN/i,/2/i,/3/i,/4/i,/5/i,/6/i,/7/i],abbreviated:[/CN/i,/2/i,/3/i,/4/i,/5/i,/6/i,/7/i],wide:[/(Ch|Cha) ?Nht/i,/Hai/i,/Ba/i,/T/i,/Nm/i,/Su/i,/By/i]},gP={narrow:/^(a|p|na m|tra|(gi) (sng|chiu|ti|m))/i,abbreviated:/^(am|pm|na m|tra|(gi) (sng|chiu|ti|m))/i,wide:/^(ch[^i]*|sa|na m|tra|(gi) (sng|chiu|ti|m))/i},fP={any:{am:/^(a|sa)/i,pm:/^(p|ch[^i]*)/i,midnight:/na m/i,noon:/tra/i,morning:/sng/i,afternoon:/chiu/i,evening:/ti/i,night:/^m/i}},yP={ordinalNumber:Ch({matchPattern:iP,parsePattern:oP,valueCallback:function(t){return parseInt(t,10)}}),era:Vr({matchPatterns:lP,defaultMatchWidth:"wide",parsePatterns:cP,defaultParseWidth:"any"}),quarter:Vr({matchPatterns:dP,defaultMatchWidth:"wide",parsePatterns:uP,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Vr({matchPatterns:hP,defaultMatchWidth:"wide",parsePatterns:mP,defaultParseWidth:"wide"}),day:Vr({matchPatterns:xP,defaultMatchWidth:"wide",parsePatterns:pP,defaultParseWidth:"wide"}),dayPeriod:Vr({matchPatterns:gP,defaultMatchWidth:"wide",parsePatterns:fP,defaultParseWidth:"any"})},kx={code:"vi",formatDistance:B2,formatLong:q2,formatRelative:K2,localize:aP,match:yP,options:{weekStartsOn:1,firstWeekContainsDate:1}};const bP=()=>{const[r,t]=p.useState(!1),[n,s]=p.useState(null),a=p.useCallback(async(d,u)=>{var h,m;t(!0),s(null);try{const x=new URLSearchParams;return x.append("targetDate",d),u&&u.length>0&&x.append("assetIds",u.join(",")),(await q.api.get(`/api/v1/asset-prices/bulk/historical-prices?${x.toString()}`)).data}catch(x){const g=((m=(h=x.response)==null?void 0:h.data)==null?void 0:m.message)||x.message||"Failed to get assets with historical prices";throw s(g),new Error(g)}finally{t(!1)}},[]),i=p.useCallback(async(d,u,h)=>{var m,x;t(!0),s(null);try{return(await q.api.post("/api/v1/asset-prices/bulk/update-by-date",{targetDate:d,assetIds:u,reason:h||"Bulk update from historical data"})).data}catch(g){const f=((x=(m=g.response)==null?void 0:m.data)==null?void 0:x.message)||g.message||"Failed to bulk update prices";throw s(f),new Error(f)}finally{t(!1)}},[]),o=p.useCallback(async(d=30)=>{var u,h;t(!0),s(null);try{return(await q.api.get(`/api/v1/asset-prices/bulk/available-dates?limit=${d}`)).data}catch(m){const x=((h=(u=m.response)==null?void 0:u.data)==null?void 0:h.message)||m.message||"Failed to get available dates";throw s(x),new Error(x)}finally{t(!1)}},[]);return{loading:r,error:n,getAssetsWithHistoricalPrice:a,bulkUpdatePricesByDate:i,getAvailableHistoricalDates:o}},jP=({open:r,onClose:t,onSuccess:n})=>{const{loading:s,error:a,getAssetsWithHistoricalPrice:i,bulkUpdatePricesByDate:o}=bP(),[d,u]=p.useState(null),[h,m]=p.useState([]),[x,g]=p.useState(""),[f,y]=p.useState("date"),[j,b]=p.useState(null);p.useEffect(()=>{r&&!d&&u(new Date)},[r,d]);const v=p.useCallback(async()=>{if(d)try{const V=(await i(d.toISOString().split("T")[0])).map(F=>({...F,selected:F.hasHistoricalData}));m(V)}catch(R){console.error("Failed to load assets:",R)}},[d,i]),P=R=>{u(R),m([])},w=(R,V)=>{m(F=>F.map(B=>B.assetId===R?{...B,selected:V}:B))},C=R=>{m(V=>V.map(F=>({...F,selected:R?F.hasHistoricalData:!1})))},k=h.filter(R=>R.selected),A=k.filter(R=>R.hasHistoricalData),L=k.filter(R=>!R.hasHistoricalData),T=async()=>{if(!d||k.length===0)return;const R=k.filter(V=>V.hasHistoricalData&&V.historicalPrice&&V.historicalPrice>0&&isFinite(V.historicalPrice));if(R.length===0){console.error("No valid assets with historical data found");return}try{const V=await o(d.toISOString().split("T")[0],R.map(F=>F.assetId),x);b(V),y("result"),n&&n(V)}catch(V){console.error("Failed to bulk update:",V)}},M=()=>{y("date"),m([]),g(""),b(null),t()},O=()=>e.jsxs(l,{children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Chn ngy  ly gi lch s"}),e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"H thng s tm gi cui cng ca ngy c chn v cp nht vo gi hin ti."}),e.jsxs(l,{sx:{display:"flex",gap:2,alignItems:"flex-start"},children:[e.jsx(l,{sx:{flex:1},children:e.jsx(hr,{dateAdapter:Ar,adapterLocale:kx,children:e.jsx(ls,{label:"Ngy ly gi lch s",value:d,onChange:P,maxDate:new Date,slotProps:{textField:{fullWidth:!0,helperText:"Chn ngy hin ti hoc trong qu kh  ly gi lch s"}}})})}),e.jsx(l,{sx:{mt:1},children:e.jsx(he,{variant:"contained",onClick:v,disabled:!d||s,icon:s?e.jsx(Ce,{size:20}):e.jsx(Mt,{}),mobileText:"Ti",desktopText:"Ti d liu",size:"large",children:s?"ang ti...":"Ti d liu"})})]}),a&&e.jsx(je,{severity:"error",sx:{mt:2},children:a}),h.length>0&&e.jsxs(l,{sx:{mt:3},children:[e.jsxs(D,{variant:"h6",gutterBottom:!0,children:["Danh sch ti sn (",h.length,")"]}),e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Ti sn c d liu lch s s c t ng chn. Bn c th b chn nu khng mun cp nht."}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(D,{variant:"body2",color:"text.secondary",children:["Tng cng: ",h.length," ti sn |  chn: ",h.filter(R=>R.selected).length," | C d liu: ",h.filter(R=>R.hasHistoricalData).length," | Khng c d liu: ",h.filter(R=>!R.hasHistoricalData).length]}),e.jsxs(l,{children:[e.jsx(he,{size:"small",onClick:()=>C(!0),icon:e.jsx(Xe,{}),mobileText:"Chn",desktopText:"Chn c d liu",sx:{mr:1},children:"Chn c d liu"}),e.jsx(he,{size:"small",onClick:()=>C(!1),icon:e.jsx(qn,{}),mobileText:"B chn",desktopText:"B chn tt c",children:"B chn tt c"})]})]}),e.jsx(l,{sx:{maxHeight:400,overflow:"auto",border:"1px solid",borderColor:"divider",borderRadius:1},children:h.map(R=>e.jsxs(l,{sx:{p:1.5,borderBottom:"1px solid",borderColor:"divider",display:"flex",alignItems:"center",justifyContent:"space-between",opacity:R.hasHistoricalData?1:.6,backgroundColor:R.hasHistoricalData?"transparent":"action.hover","&:last-child":{borderBottom:"none"},"&:hover":{backgroundColor:R.hasHistoricalData?"action.hover":"action.selected"}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",flex:1},children:[e.jsx(rn,{checked:R.selected,onChange:V=>w(R.assetId,V.target.checked),disabled:!R.hasHistoricalData,size:"small"}),e.jsxs(l,{sx:{ml:1,flex:1},children:[e.jsxs(D,{variant:"body2",fontWeight:"medium",sx:{color:R.hasHistoricalData?"text.primary":"text.disabled",fontSize:"0.875rem"},children:[R.symbol," - ",R.name]}),e.jsxs(D,{variant:"caption",sx:{color:R.hasHistoricalData?"text.secondary":"text.disabled",fontSize:"0.75rem"},children:["Loi: ",R.type," | Tin t: ",R.currency]})]})]}),e.jsxs(l,{sx:{textAlign:"right",minWidth:180},children:[e.jsxs(D,{variant:"body2",sx:{color:R.hasHistoricalData?"text.primary":"text.disabled",fontSize:"0.875rem"},children:["Gi hin ti: ",dn(R.currentPrice)," ",R.currency]}),R.hasHistoricalData?e.jsxs(D,{variant:"body2",color:"success.main",sx:{fontSize:"0.875rem"},children:["Gi lch s: ",dn(R.historicalPrice)," ",R.currency]}):e.jsx(D,{variant:"body2",color:"error.main",sx:{fontSize:"0.875rem"},children:"Khng c d liu"})]})]},R.assetId))}),e.jsx(l,{sx:{mt:2,display:"flex",justifyContent:"center"},children:e.jsxs(We,{variant:"contained",onClick:()=>y("confirm"),disabled:h.filter(R=>R.selected).length===0,icon:e.jsx(Xe,{}),mobileText:`Tip tc (${h.filter(R=>R.selected).length})`,desktopText:`Tip tc (${h.filter(R=>R.selected).length} ti sn)`,forceTextOnly:!0,children:["Tip tc (",h.filter(R=>R.selected).length," ti sn)"]})})]})]}),I=()=>e.jsxs(l,{children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Xc nhn cp nht gi"}),e.jsx(je,{severity:"info",sx:{mb:3},children:e.jsxs(D,{variant:"body2",children:["Bn sp cp nht gi cho ",k.length," ti sn t ngy ",d==null?void 0:d.toLocaleDateString("vi-VN"),". Thao tc ny khng th hon tc."]})}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:6,children:e.jsxs(Te,{sx:{p:2,textAlign:"center"},children:[e.jsx(D,{variant:"h4",color:"success.main",children:A.length}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Ti sn s c cp nht"})]})}),e.jsx(W,{item:!0,xs:6,children:e.jsxs(Te,{sx:{p:2,textAlign:"center"},children:[e.jsx(D,{variant:"h4",color:"warning.main",children:L.length}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Ti sn khng c d liu"})]})})]}),x&&e.jsx(l,{sx:{mt:2},children:e.jsxs(D,{variant:"body2",color:"text.secondary",children:["L do: ",x]})})]}),z=()=>j?e.jsxs(l,{children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Kt qu cp nht"}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:2,p:1.5,backgroundColor:"background.paper",borderRadius:1,border:"1px solid",borderColor:"divider"},children:[e.jsxs(l,{sx:{textAlign:"center",flex:1},children:[e.jsx(D,{variant:"h5",color:"success.main",sx:{fontWeight:"bold"},children:j.successCount}),e.jsx(D,{variant:"caption",color:"text.secondary",children:"Thnh cng"})]}),e.jsxs(l,{sx:{textAlign:"center",flex:1},children:[e.jsx(D,{variant:"h5",color:"error.main",sx:{fontWeight:"bold"},children:j.failedCount}),e.jsx(D,{variant:"caption",color:"text.secondary",children:"Tht bi"})]}),e.jsxs(l,{sx:{textAlign:"center",flex:1},children:[e.jsx(D,{variant:"h5",color:"primary.main",sx:{fontWeight:"bold"},children:j.totalCount}),e.jsx(D,{variant:"caption",color:"text.secondary",children:"Tng cng"})]})]}),e.jsx(l,{sx:{maxHeight:400,overflow:"auto",border:"1px solid",borderColor:"divider",borderRadius:1,backgroundColor:"background.paper"},children:j.results.map((R,V)=>e.jsxs(l,{sx:{p:1.5,borderBottom:V<j.results.length-1?"1px solid":"none",borderColor:"divider",display:"flex",alignItems:"center",justifyContent:"space-between","&:hover":{backgroundColor:"action.hover"}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",flex:1},children:[R.success?e.jsx(Xe,{color:"success",sx:{mr:1,fontSize:20}}):e.jsx(qn,{color:"error",sx:{mr:1,fontSize:20}}),e.jsx(l,{children:e.jsx(D,{variant:"body2",fontWeight:"medium",children:R.symbol})})]}),R.oldPrice&&R.newPrice&&e.jsxs(l,{sx:{textAlign:"right",minWidth:120},children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:G(R.oldPrice)}),e.jsx(D,{variant:"caption",sx:{mx:.5},children:""}),e.jsx(D,{variant:"caption",color:"primary.main",fontWeight:"medium",children:G(R.newPrice)})]})]},V))})]}):null,N=()=>{switch(f){case"date":return O();case"confirm":return I();case"result":return z();default:return O()}},E=()=>{switch(f){case"date":return null;case"confirm":return e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:()=>y("date"),icon:e.jsx(qn,{}),mobileText:"Quay li",desktopText:"Quay li",children:"Quay li"}),e.jsx(We,{variant:"contained",onClick:T,disabled:s||A.length===0,icon:s?e.jsx(Ce,{size:20}):e.jsx(Mt,{}),mobileText:s?"ang cp nht...":"Cp nht",desktopText:s?"ang cp nht...":"Cp nht gi",forceTextOnly:!0,children:s?"ang cp nht...":"Cp nht gi"})]});case"result":return null;default:return null}};return e.jsxs(kt,{open:r,onClose:M,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:500}},children:[e.jsx(Et,{sx:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontWeight:700,fontSize:"1.25rem",py:2},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(va,{sx:{mr:1.5,fontSize:"1.5rem"}}),"Cp nht gi theo ngy lch s"]}),e.jsx(he,{onClick:M,size:"small",icon:e.jsx(qn,{}),mobileText:"",desktopText:"",sx:{color:"white",minWidth:"auto",p:1,borderRadius:"50%","&:hover":{backgroundColor:"rgba(255,255,255,0.1)"}},children:""})]})}),e.jsx(Pt,{children:N()}),e.jsx(Dt,{children:E()})]})},vP=({onUpdateSuccess:r,variant:t="outlined",size:n="medium",disabled:s=!1,fullWidth:a=!1})=>{const[i,o]=p.useState(!1),d=()=>{o(!0)},u=()=>{o(!1)},h=m=>{r&&r(m)};return e.jsxs(e.Fragment,{children:[e.jsx(Fe,{title:"Cp nht gi t d liu lch s theo ngy c chn",children:e.jsx(he,{variant:t,size:n,disabled:s,fullWidth:a,icon:e.jsx(va,{}),mobileText:"Cp nht gi",desktopText:"Cp nht gi theo ngy",onClick:d,children:"Cp nht gi theo ngy"})}),e.jsx(jP,{open:i,onClose:u,onSuccess:h})]})};class Fi{static async updateHistoricalPrices(t){try{return await q.updateHistoricalPrices(t)}catch(n){throw console.error("Failed to update historical prices:",n),n}}static async getHistoricalPrices(t){try{return await q.getHistoricalPrices(t)}catch(n){throw console.error("Failed to get historical prices:",n),n}}static getAssetTypes(){return[{value:"STOCK",label:"Stock"},{value:"ETF",label:"ETF"},{value:"FUND",label:"Fund"},{value:"GOLD",label:"Gold"},{value:"EXCHANGE_RATE",label:"Exchange Rate"},{value:"CRYPTO",label:"Cryptocurrency"},{value:"BOND",label:"Bond"}]}static getCommonSymbols(){return{STOCK:["VFF","HPG","VCB","VIC","VHM","VRE","VNM","MSN","FPT","CTG"],ETF:["VESAF","VESAF","VESAF","VESAF"],FUND:["VESAF","VESAF","VESAF","VESAF"],GOLD:["DOJI","SJC","PNJ"],EXCHANGE_RATE:["USD","EUR","JPY","GBP"],CRYPTO:["BTC","ETH","BNB","ADA","SOL"],BOND:["GOVB","CORPB","MUNIB"]}}}const wP=(r={})=>{const{symbols:t,startDate:n,endDate:s,enabled:a=!0}=r,{data:i=[],isLoading:o,error:d,refetch:u}=yt({queryKey:["historicalPrices",t,n,s],queryFn:()=>Fi.getHistoricalPrices({symbols:t,startDate:n,endDate:s}),enabled:a&&(!!t||!!n||!!s),staleTime:5*60*1e3,cacheTime:10*60*1e3}),{mutateAsync:h,isLoading:m,error:x,data:g,reset:f}=jt({mutationFn:v=>Fi.updateHistoricalPrices(v),onSuccess:()=>{u()}}),y=p.useCallback(v=>{v?console.error("Update error:",v):f()},[f]),j=p.useCallback(()=>Fi.getAssetTypes(),[]),b=p.useCallback(()=>Fi.getCommonSymbols(),[]);return{historicalPrices:i,isLoading:o,error:d,refetch:u,updateHistoricalPrices:h,isUpdating:m,updateError:x,updateResult:g||null,setUpdateError:y,getAssetTypes:j,getCommonSymbols:b}},SP=({open:r,onClose:t,onSuccess:n})=>{const[s,a]=p.useState(null),[i,o]=p.useState(null),[d,u]=p.useState(!1),[h,m]=p.useState("external_api"),[x,g]=p.useState([]),[f,y]=p.useState(!1),[j,b]=p.useState("date"),[v,P]=p.useState(null),{updateHistoricalPrices:w,isUpdating:C,updateError:k,setUpdateError:A}=wP(),{data:L,isLoading:T,error:M}=ck();p.useEffect(()=>{if(r){const _=new Date,K=new Date;if(K.setDate(_.getDate()-30),a(K),o(_),u(!1),m("external_api"),y(!1),b("date"),P(null),A(null),L&&L.length>0){const X=L.map(ne=>({id:ne.id,symbol:ne.symbol,name:ne.name,type:ne.type,priceMode:ne.priceMode,currency:ne.currency,selected:!1,assetPrice:ne.assetPrice}));g(X)}}},[r,L]);const O=async()=>{if(!s||!i)return;const _=x.filter(X=>X.selected);if(_.length===0)return;const K=_.map(X=>({symbol:X.symbol,assetType:X.type}));try{A(null);const X=await w({symbols:K,startDate:s.toISOString().split("T")[0],endDate:i.toISOString().split("T")[0],forceUpdate:d,cleanup:h});P(X),b("result")}catch(X){console.error("Failed to update historical prices:",X),A(X),b("result")}},I=(_,K)=>{g(X=>X.map(ne=>ne.id===_?{...ne,selected:K}:ne))},z=_=>{g(K=>K.map(X=>({...X,selected:_})))},N=()=>[...new Set(x.map(K=>K.type))].sort(),E=(_,K)=>{g(X=>X.map(ne=>ne.type===_?{...ne,selected:K}:ne))},R=_=>{const K=x.filter(ne=>ne.type===_),X=K.filter(ne=>ne.selected);return{total:K.length,selected:X.length}},V=x.filter(_=>_.selected),F=C,B=[{label:"Chn thi gian",icon:e.jsx(Zn,{}),description:"Chn khong thi gian cn cp nht gi"},{label:"Chn ti sn",icon:e.jsx(Gu,{}),description:"Chn cc ti sn cn cp nht"},{label:"Xc nhn",icon:e.jsx(Xe,{}),description:"Xc nhn thng tin cp nht"},{label:"Kt qu",icon:e.jsx(va,{}),description:"Kt qu cp nht"}],$=()=>{switch(j){case"date":return 0;case"assets":return 1;case"confirm":return 2;case"result":return 3;default:return 0}},Y=()=>{switch(j){case"date":return e.jsxs(ft,{spacing:3,children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Chn khong thi gian cp nht"}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:6,children:e.jsx(ls,{label:"Ngy bt u",value:s,onChange:_=>a(_),slotProps:{textField:{fullWidth:!0}},maxDate:i||new Date})}),e.jsx(W,{item:!0,xs:6,children:e.jsx(ls,{label:"Ngy kt thc",value:i,onChange:_=>o(_),slotProps:{textField:{fullWidth:!0}},minDate:s,maxDate:new Date})})]})]});case"assets":return e.jsxs(ft,{spacing:3,children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Chn ti sn cn cp nht"}),e.jsx(c,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Chn cc ti sn cn cp nht gi lch s. Bn c th chn tt c hoc chn tng ti sn c th."}),T?e.jsx(l,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(Ce,{})}):M?e.jsxs(je,{severity:"error",sx:{mb:2},children:["Li ti danh sch ti sn: ",String(M)]}):x.length===0?e.jsx(je,{severity:"info",sx:{mb:2},children:"Khng c ti sn no trong h thng"}):e.jsxs(e.Fragment,{children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:["Tng cng: ",x.length," ti sn |  chn: ",V.length]}),e.jsxs(l,{children:[e.jsx(he,{size:"small",icon:e.jsx(Ou,{}),mobileText:"Chn tt c",desktopText:"Chn tt c",onClick:()=>z(!0),sx:{mr:1},children:"Chn tt c"}),e.jsx(he,{size:"small",icon:e.jsx(ei,{}),mobileText:"B chn tt c",desktopText:"B chn tt c",onClick:()=>z(!1),children:"B chn tt c"})]})]}),e.jsxs(l,{sx:{mb:2},children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,children:"Chn theo loi ti sn:"}),e.jsx(l,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:N().map(_=>{const{total:K,selected:X}=R(_),ne=X===K,oe=X>0&&X<K;return e.jsx(ce,{label:`${_} (${X}/${K})`,variant:ne?"filled":"outlined",color:ne||oe?"primary":"default",onClick:()=>E(_,!ne),sx:{cursor:"pointer","&:hover":{backgroundColor:ne?"primary.dark":"primary.light",color:"white"}}},_)})})]}),e.jsx(l,{sx:{maxHeight:400,overflow:"auto",border:"1px solid",borderColor:"divider",borderRadius:1},children:x.map(_=>e.jsxs(l,{sx:{p:1.5,borderBottom:"1px solid",borderColor:"divider",display:"flex",alignItems:"center",justifyContent:"space-between","&:last-child":{borderBottom:"none"},"&:hover":{backgroundColor:"action.hover"}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",flex:1},children:[e.jsx(rn,{checked:_.selected,onChange:K=>I(_.id,K.target.checked),size:"small"}),e.jsxs(l,{sx:{ml:1,flex:1},children:[e.jsxs(c,{variant:"body2",fontWeight:"medium",sx:{fontSize:"0.875rem"},children:[_.symbol," - ",_.name]}),e.jsxs(c,{variant:"caption",sx:{color:"text.secondary",fontSize:"0.75rem"},children:["Loi: ",_.type]})]})]}),e.jsx(l,{sx:{textAlign:"right",minWidth:180},children:_.assetPrice?e.jsxs(e.Fragment,{children:[e.jsxs(c,{variant:"body2",sx:{fontSize:"0.875rem",fontWeight:"medium"},children:["Gi hin ti: ",G(_.assetPrice.currentPrice)," ",_.currency]}),e.jsxs(c,{variant:"caption",sx:{color:"text.secondary",fontSize:"0.75rem"},children:[_.selected?" chn":"Cha chn","  ",_.assetPrice.priceSource]})]}):e.jsxs(c,{variant:"body2",sx:{fontSize:"0.875rem",color:"text.disabled"},children:[_.selected?" chn":"Cha chn","  Cha c gi"]})})]},_.id))})]})]});case"confirm":return e.jsxs(ft,{spacing:3,children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Xc nhn cp nht gi"}),e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(c,{variant:"subtitle1",gutterBottom:!0,children:"Thng tin cp nht"}),e.jsxs(ft,{spacing:1,children:[e.jsxs(c,{variant:"body2",children:[e.jsx("strong",{children:"Khong thi gian:"})," ",s==null?void 0:s.toLocaleDateString("vi-VN")," - ",i==null?void 0:i.toLocaleDateString("vi-VN")]}),e.jsxs(c,{variant:"body2",children:[e.jsx("strong",{children:"S ti sn  chn:"})," ",V.length," ti sn"]}),e.jsxs(c,{variant:"body2",children:[e.jsx("strong",{children:"Force Update:"})," ",d?"C":"Khng"]}),e.jsxs(c,{variant:"body2",children:[e.jsx("strong",{children:"Cleanup:"})," ",h==="none"?"Khng xa":h==="external_api"?"Ch xa External API":"Xa ton b"]})]})]})}),e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(c,{variant:"subtitle1",gutterBottom:!0,children:"Danh sch ti sn s c cp nht"}),e.jsx(l,{sx:{maxHeight:200,overflow:"auto"},children:V.map(_=>e.jsx(l,{sx:{display:"flex",alignItems:"center",py:.5},children:e.jsxs(c,{variant:"body2",children:[_.symbol," - ",_.name," (",_.type,")"]})},_.id))})]})}),e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:e.jsx(he,{size:"small",icon:e.jsx(Ss,{}),mobileText:"Ty chn nng cao",desktopText:"Ty chn nng cao",onClick:()=>y(!f),children:"Ty chn nng cao"})}),f&&e.jsxs(ft,{spacing:2,children:[e.jsx(an,{control:e.jsx(jn,{checked:d,onChange:_=>u(_.target.checked),name:"forceUpdate"}),label:e.jsxs(l,{children:[e.jsx(c,{variant:"body2",children:"Force Update - Lun thm record mi (gi li lch s)"}),e.jsx(c,{variant:"caption",color:"text.secondary",children:"Nu chn, h thng s lun thm cc bn ghi gi mi, gi li cc bn ghi c"})]})}),e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Cleanup Options"}),e.jsxs(Ze,{value:h,onChange:_=>m(_.target.value),label:"Cleanup Options",children:[e.jsx(re,{value:"none",children:"Thm nu cha tn ti (gi d liu c)"}),e.jsx(re,{value:"external_api",children:"Ch xa External API (gi User Input)"}),e.jsx(re,{value:"all",children:"Xa ton b (xa tt c d liu c)"})]})]}),h!=="none"&&e.jsx(je,{severity:"warning",icon:e.jsx(on,{}),children:h==="external_api"?"Cnh bo: S xa d liu t External API, gi li d liu User Input.":"Cnh bo: S xa TT C d liu gi lch s hin c trc khi cp nht."})]})]})})]});case"result":return e.jsxs(ft,{spacing:3,children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:"Kt qu cp nht gi lch s"}),k?e.jsxs(je,{severity:"error",children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,children:"Cp nht tht bi"}),e.jsx(c,{variant:"body2",children:k.message})]}):v?e.jsxs(ft,{spacing:2,children:[e.jsxs(je,{severity:v.success>0?"success":"error",children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,children:v.success>0?"Cp nht thnh cng!":"Cp nht tht bi"}),e.jsxs(c,{variant:"body2",children:[" x l ",v.totalRecords," bn ghi cho ",v.success," ti sn."]}),v.failed>0&&e.jsxs(c,{variant:"body2",color:"warning.main",children:[v.failed," ti sn cp nht tht bi."]})]}),e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,children:"Chi tit kt qu:"}),e.jsxs(ft,{spacing:1,children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c,{variant:"body2",children:"Tng s bn ghi:"}),e.jsx(c,{variant:"body2",fontWeight:"medium",children:v.totalRecords})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c,{variant:"body2",children:"Thnh cng:"}),e.jsx(c,{variant:"body2",color:"success.main",fontWeight:"medium",children:v.success})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(c,{variant:"body2",children:"Tht bi:"}),e.jsx(c,{variant:"body2",color:"error.main",fontWeight:"medium",children:v.failed})]})]})]})}),v.processedSymbols&&v.processedSymbols.length>0&&e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,children:"Ti sn  x l:"}),e.jsx(ft,{spacing:1,children:v.processedSymbols.map((_,K)=>e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(c,{variant:"body2",children:_.symbol}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ce,{label:`${_.recordCount} bn ghi`,size:"small",color:"primary",variant:"outlined"}),_.dateRange&&e.jsxs(c,{variant:"caption",color:"text.secondary",children:[_.dateRange.start," - ",_.dateRange.end]})]})]},K))})]})}),v.errors&&v.errors.length>0&&e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(c,{variant:"subtitle2",gutterBottom:!0,color:"error",children:"Li chi tit:"}),e.jsx(ft,{spacing:1,children:v.errors.map((_,K)=>e.jsx(je,{severity:"error",sx:{py:.5},children:e.jsx(c,{variant:"body2",children:_})},K))})]})})]}):e.jsx(l,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsx(Ce,{})})]});default:return null}};return e.jsx(hr,{dateAdapter:Ar,adapterLocale:kx,children:e.jsxs(kt,{open:r,onClose:t,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:"600px"}},children:[e.jsx(Et,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(va,{color:"primary"}),e.jsx(c,{variant:"h6",children:"Cp nht gi lch s"})]}),e.jsx(he,{onClick:t,color:"secondary",size:"small",icon:e.jsx(sr,{}),mobileText:"Hy",desktopText:"Hy",sx:{minWidth:"auto",px:1},children:"Hy"})]})}),e.jsxs(Pt,{dividers:!0,children:[e.jsx(Dr,{activeStep:$(),alternativeLabel:!0,sx:{mb:3},children:B.map((_,K)=>e.jsx(_n,{children:e.jsx(Yn,{icon:_.icon,optional:K<$()?e.jsx(ce,{label:"Hon thnh",size:"small",color:"success"}):null,children:_.label})},_.label))}),Y()]}),e.jsx(Dt,{children:j==="result"?e.jsxs(e.Fragment,{children:[k&&e.jsx(he,{onClick:()=>{b("date"),A(null),P(null)},color:"secondary",variant:"outlined",icon:e.jsx(Mt,{}),mobileText:"Th li",desktopText:"Th li",sx:{mr:1},children:"Th li"}),e.jsx(he,{onClick:()=>{n==null||n(v),t()},color:"primary",variant:"contained",icon:e.jsx(Xe,{}),mobileText:"Hon thnh",desktopText:"Hon thnh",children:"Hon thnh"})]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:t,color:"inherit",icon:e.jsx(sr,{}),mobileText:"Hy",desktopText:"Hy",children:"Hy"}),e.jsx(l,{sx:{flex:1}}),e.jsx(he,{onClick:()=>{j==="assets"?b("date"):j==="confirm"&&b("assets")},disabled:j==="date",icon:e.jsx(Kr,{}),mobileText:"Quay li",desktopText:"Quay li",sx:{mr:1},children:"Quay li"}),e.jsxs(he,{onClick:()=>{j==="date"&&s&&i?b("assets"):j==="assets"&&V.length>0?b("confirm"):j==="confirm"&&O()},variant:"contained",icon:j==="confirm"&&F?e.jsx(Ce,{size:20,color:"inherit"}):e.jsx(wa,{}),mobileText:j==="confirm"?F?"ang cp nht...":"Xc nhn cp nht":"Tip theo",desktopText:j==="confirm"?F?"ang cp nht...":"Xc nhn cp nht":"Tip theo",disabled:j==="date"&&(!s||!i)||j==="assets"&&V.length===0||j==="confirm"&&F,children:[j==="date"&&"Tip theo",j==="assets"&&"Tip theo",j==="confirm"&&(F?"ang cp nht...":"Xc nhn cp nht")]})]})})]})})},TP=({variant:r="button",size:t="medium",color:n="primary",startIcon:s,children:a,onSuccess:i,className:o})=>{const[d,u]=p.useState(!1),h=()=>{u(!0)},m=()=>{u(!1)},x=j=>{i==null||i(j),u(!1)},g=()=>{switch(r){case"icon":return e.jsx(va,{});case"text":return e.jsx(Pp,{});default:return e.jsx(kp,{})}},f=()=>{switch(r){case"icon":return"Cp nht gi lch s";case"text":return"Cp nht gi lch s";default:return"Cp nht gi lch s"}},y=()=>{const j={onClick:h,size:t,color:n,className:o,startIcon:s||g()};switch(r){case"icon":return e.jsx(Fe,{title:f(),children:e.jsx(Ie,{...j,children:g()})});case"text":return e.jsx(ut,{...j,variant:"text",sx:{textTransform:"none"},children:a||f()});default:return e.jsx(ut,{...j,variant:"contained",children:a||f()})}};return e.jsxs(e.Fragment,{children:[y(),e.jsx(SP,{open:d,onClose:m,onSuccess:x})]})},Go=({children:r,permission:t,permissions:n,requireAll:s=!1,role:a,roles:i,requireAllRoles:o=!1,requireBoth:d=!1,fallback:u,showAccessDenied:h=!0,hide:m=!1,hiddenContent:x,mode:g="deny",admin:f=!1,can:y})=>{const{hasPermission:j,hasAnyPermission:b,hasAllPermissions:v,hasRole:P,hasAnyRole:w,hasAllRoles:C,isLoading:k}=Zr(),A=An(),[L,T]=p.useState(!0),[M,O]=p.useState(null);if(p.useEffect(()=>{if(!k){let I=!0,z=!0;const N=f?["admin","super_admin"]:i,E=y?Array.isArray(y)?y:[y]:n;t?I=j(t):E&&E.length>0&&(s?I=v(E):I=b(E)),a?z=P(a):N&&N.length>0&&(o?z=C(N):z=w(N));let R=!1;R=I&&z,O(R),T(!1)}},[k,t,n,s,a,i,o,d,j,b,v,P,w,C,f,y]),k||L)return e.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh",p:3},children:e.jsxs(l,{sx:{textAlign:"center"},children:[e.jsx(Ce,{size:48,sx:{mb:2}}),e.jsx(c,{variant:"body1",color:"text.secondary",children:"Checking permissions..."})]})});if(M===!0)return e.jsx(e.Fragment,{children:r});switch(g){case"hide":return x?e.jsx(e.Fragment,{children:x}):null;case"show":return e.jsx(e.Fragment,{children:r});case"fallback":return u?e.jsx(e.Fragment,{children:u}):null}return m?x?e.jsx(e.Fragment,{children:x}):null:u?e.jsx(e.Fragment,{children:u}):h?e.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh",p:3},children:e.jsxs(l,{sx:{textAlign:"center",maxWidth:500},children:[e.jsx(Jt,{sx:{fontSize:64,color:"error.main",mb:2}}),e.jsx(c,{variant:"h5",gutterBottom:!0,children:"Access Denied"}),e.jsx(c,{variant:"body1",color:"text.secondary",sx:{mb:3},children:"You don't have the required access to this resource."}),e.jsx(he,{variant:"contained",icon:e.jsx(Kr,{}),onClick:()=>A(-1),mobileText:"Back",desktopText:"Go Back",children:"Go Back"})]})}):null},CP=()=>e.jsx(Go,{roles:["admin","super_admin"],requireAllRoles:!1,children:e.jsx(kP,{})}),kP=()=>{const[r,t]=rt.useState(1),[n,s]=rt.useState(50),{data:a=[],isLoading:i,error:o,refetch:d,total:u,page:h,totalPages:m}=dx({limit:n,page:r}),x=mk(),g=xk(),f=dk(),y=uk();ux();const{lastDataUpdate:j,nextUpdate:b,isAutoSyncEnabled:v,isLoading:P}=ax(),w=async()=>{await d()},C=async(E,R)=>{t(R+1),await d()},k=async E=>{const R=parseInt(E.target.value,10);s(R),t(1),await d()},A=async E=>{try{await f.mutateAsync(E),await d()}catch(R){throw console.error("Create asset error:",R),R}},L=async(E,R)=>{try{await y.mutateAsync({id:E,data:R}),await d()}catch(V){throw console.error("Update asset error:",V),V}},T=async(E,R,V,F,B)=>{try{await x.mutateAsync({assetId:E,price:R,priceType:V,priceSource:F,changeReason:B})}catch($){throw console.error("Price update error:",$),$}},M=async E=>{},O=async()=>{try{await q.triggerGlobalAssetsSync(),await d()}catch(E){throw console.error("Failed to trigger manual sync:",E),E}},I=i||x.isLoading||g.isLoading||f.isLoading||y.isLoading,z=o,N=z?(z==null?void 0:z.message)||String(z):void 0;return e.jsxs(l,{children:[e.jsxs(Te,{sx:{p:2,mb:3,bgcolor:"background.paper"},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(c,{variant:"pageHeader",children:"Market Price Auto Sync"}),e.jsxs(ft,{direction:"row",spacing:1,children:[e.jsx(vP,{onUpdateSuccess:E=>{w()},variant:"outlined",size:"small"}),e.jsx(TP,{variant:"button",size:"small",color:"secondary",onSuccess:E=>{w()}})]})]}),e.jsxs(l,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},gap:{xs:2,sm:0},mb:1},children:[e.jsxs(ft,{direction:"row",spacing:3,sx:{flexWrap:"wrap"},children:[e.jsxs(c,{variant:"cardLabel",children:["Status: ",e.jsx("strong",{children:v?"Enabled":"Disabled"})]}),e.jsxs(c,{variant:"cardLabel",children:["Last update: ",e.jsx("strong",{children:j?new Date(j).toLocaleString():P?"Loading...":"N/A"})]}),e.jsxs(c,{variant:"cardLabel",children:["Next run: ",e.jsx("strong",{children:b?new Date(b).toLocaleString():P?"Loading...":"N/A"})]})]}),e.jsx($2,{onToggle:E=>{}})]})]}),e.jsx(V2,{assets:a,loading:I,error:N,onRefresh:w,onCreateAsset:A,onUpdateAsset:L,total:u,page:h,totalPages:m,onPriceUpdate:T,onPriceHistoryRefresh:M,onUpdateAllPrices:O,onChangePage:C,onChangeRowsPerPage:k,rowsPerPage:n})]})},Px=r=>{const{accountId:t}=Ge(),[n,s]=p.useState({snapshots:[],loading:!1,error:null,pagination:null}),[a,i]=p.useState(r);p.useEffect(()=>{i(r)},[r]);const o=w=>{s(C=>({...C,loading:w}))},d=w=>{s(C=>({...C,error:w}))},u=p.useCallback(async w=>{o(!0),d(null);try{const C=w||a,k=await yn.getSnapshots(C,t);s(A=>({...A,snapshots:k,pagination:null}))}catch(C){d(C instanceof Error?C.message:"Failed to fetch snapshots")}finally{o(!1)}},[]),h=p.useCallback(async w=>{o(!0),d(null);try{const C=w||a,k=await yn.getSnapshotsPaginated(C,t);s(A=>({...A,snapshots:k.data,pagination:{total:k.total,page:k.page,limit:k.limit,totalPages:k.totalPages}}))}catch(C){d(C instanceof Error?C.message:"Failed to fetch snapshots")}finally{o(!1)}},[]),m=p.useCallback(async w=>{o(!0),d(null);try{const C=await yn.createSnapshot(w);return s(k=>({...k,snapshots:[C,...k.snapshots]})),C}catch(C){const k=C instanceof Error?C.message:"Failed to create snapshot";throw d(k),new Error(k)}finally{o(!1)}},[]),x=p.useCallback(async(w,C)=>{o(!0),d(null);try{const k=await yn.updateSnapshot(w,C);return s(A=>({...A,snapshots:A.snapshots.map(L=>L.id===w?k:L)})),k}catch(k){const A=k instanceof Error?k.message:"Failed to update snapshot";throw d(A),new Error(A)}finally{o(!1)}},[]),g=p.useCallback(async w=>{o(!0),d(null);try{await yn.deleteSnapshot(w),s(C=>({...C,snapshots:C.snapshots.filter(k=>k.id!==w)}))}catch(C){const k=C instanceof Error?C.message:"Failed to delete snapshot";throw d(k),new Error(k)}finally{o(!1)}},[]),f=p.useCallback(async w=>{o(!0),d(null);try{const C=await yn.recalculateSnapshot(w);return s(k=>({...k,snapshots:k.snapshots.map(A=>A.id===w?C:A)})),C}catch(C){const k=C instanceof Error?C.message:"Failed to recalculate snapshot";throw d(k),new Error(k)}finally{o(!1)}},[]),y=p.useCallback(async(w,C,k)=>{o(!0),d(null);try{return await yn.bulkRecalculateSnapshots(w,C,k)}catch(A){const L=A instanceof Error?A.message:"Failed to bulk recalculate snapshots";throw d(L),new Error(L)}finally{o(!1)}},[]),j=p.useCallback(async(w,C)=>{o(!0),d(null);try{const k=await yn.createBulkPortfolioSnapshots(w,C);return await u(a),k}catch(k){const A=k instanceof Error?k.message:"Failed to create bulk portfolio snapshots";throw d(A),new Error(A)}finally{o(!1)}},[u,a]),b=p.useCallback(async()=>{await u(a)},[a,u]),v=p.useCallback(()=>{d(null)},[]);return p.useEffect(()=>{a&&u(a)},[a]),{...n,...{fetchSnapshots:u,fetchSnapshotsPaginated:h,createSnapshot:m,updateSnapshot:x,deleteSnapshot:g,recalculateSnapshot:f,bulkRecalculateSnapshots:y,createBulkPortfolioSnapshots:j,refreshSnapshots:b,clearError:v},params:a,setParams:i}},Dx=(r={})=>{const{portfolioId:t,autoFetch:n=!0,page:s=1,limit:a=10}=r,[i,o]=p.useState({portfolioSnapshots:[],loading:!1,error:null,pagination:null}),{portfolioSnapshots:d,loading:u,error:h,pagination:m}=i,x=b=>{o(v=>({...v,loading:b}))},g=b=>{o(v=>({...v,error:b}))},f=p.useCallback(async()=>{if(t){x(!0),g(null);try{const b=await yn.getPortfolioSnapshotsPaginated(t,{page:s,limit:a}),v=Math.ceil(b.count/a);o(P=>({...P,portfolioSnapshots:b.data||[],pagination:{page:b.page||s,limit:b.limit||a,total:b.count||0,totalPages:v,hasNext:(b.page||s)<v,hasPrev:(b.page||s)>1}}))}catch(b){g(b instanceof Error?b.message:"Failed to fetch portfolio snapshots")}finally{x(!1)}}},[t,s,a]),y=p.useCallback(async()=>{await f()},[]),j=p.useCallback(()=>{g(null)},[]);return p.useEffect(()=>{n&&t&&f()},[n,t,s,a]),{portfolioSnapshots:d,loading:u,error:h,pagination:m,refreshPortfolioSnapshots:y,clearError:j}},Tl=(r=10)=>{const[t,n]=p.useState({page:1,limit:r,total:0,totalPages:0,hasNext:!1,hasPrev:!1}),s=p.useCallback(m=>{n(x=>({...x,...m}))},[]),a=p.useCallback(m=>{n(x=>({...x,page:m}))},[]),i=p.useCallback(m=>{n(x=>({...x,limit:m,page:1}))},[]),o=p.useCallback(()=>{n(m=>({...m,page:m.page+1}))},[]),d=p.useCallback(()=>{n(m=>({...m,page:Math.max(1,m.page-1)}))},[]),u=p.useCallback(m=>{n(x=>({...x,page:Math.max(1,Math.min(m,x.totalPages))}))},[]),h=p.useCallback(()=>{n({page:1,limit:r,total:0,totalPages:0,hasNext:!1,hasPrev:!1})},[r]);return{pagination:t,updatePagination:s,setPage:a,setLimit:i,nextPage:o,prevPage:d,goToPage:u,resetPagination:h}};var lr=(r=>(r.DAILY="DAILY",r.WEEKLY="WEEKLY",r.MONTHLY="MONTHLY",r))(lr||{});const Ko=({page:r,limit:t,total:n,totalPages:s,hasNext:a,hasPrev:i,onPageChange:o,onLimitChange:d,limitOptions:u=[5,10,25,50,100],showLimitSelector:h=!0,showPageInfo:m=!0})=>{const x=()=>o(1),g=()=>o(r-1),f=()=>o(r+1),y=()=>o(s),j=(r-1)*t+1,b=Math.min(r*t,n);return e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:2,p:2,borderTop:1,borderColor:"divider",backgroundColor:"grey.50"},children:[m&&e.jsxs(D,{variant:"body2",color:"text.secondary",children:["Showing ",j,"-",b," of ",n," items"]}),h&&e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(D,{variant:"body2",children:"Items per page:"}),e.jsx(nt,{size:"small",sx:{minWidth:80},children:e.jsx(Ze,{value:t,onChange:v=>d(Number(v.target.value)),displayEmpty:!0,children:u.map(v=>e.jsx(re,{value:v,children:v},v))})})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Fe,{title:"First page",children:e.jsx("span",{children:e.jsx(Ie,{onClick:x,disabled:!i,size:"small",children:e.jsx(Dp,{})})})}),e.jsx(Fe,{title:"Previous page",children:e.jsx("span",{children:e.jsx(Ie,{onClick:g,disabled:!i,size:"small",children:e.jsx(Ap,{})})})}),e.jsxs(D,{variant:"body2",sx:{mx:1},children:["Page ",r," of ",s]}),e.jsx(Fe,{title:"Next page",children:e.jsx("span",{children:e.jsx(Ie,{onClick:f,disabled:!a,size:"small",children:e.jsx(Ip,{})})})}),e.jsx(Fe,{title:"Last page",children:e.jsx("span",{children:e.jsx(Ie,{onClick:y,disabled:!a,size:"small",children:e.jsx(Rp,{})})})})]})]})},PP=({portfolioSnapshots:r,portfolioSnapshotsLoading:t,portfolioSnapshotsError:n,portfolioSnapshotsPagination:s,baseCurrency:a,onPageChange:i,onLimitChange:o})=>{const{t:d}=Ne();return e.jsxs(l,{children:[e.jsx(c,{variant:"pageSubtitle",sx:{mb:2,color:"text.secondary",lineHeight:1.6},children:d("portfolio.cashBalanceNote")}),t&&e.jsx(l,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(Ce,{size:24})}),n&&e.jsx(je,{severity:"error",sx:{mb:2},children:n}),r&&r.length>0?e.jsx(at,{component:Te,elevation:0,sx:{border:1,borderColor:"divider",overflowX:"auto"},children:e.jsxs(it,{size:"small",sx:{minWidth:4880},children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:"grey.50"},children:[e.jsx(S,{sx:{py:1,minWidth:100,position:"sticky",left:0,zIndex:1,borderRight:"1px solid",borderColor:"divider",letterSpacing:"0.5px",backgroundColor:"background.paper"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Date"})}),e.jsx(S,{sx:{py:1,minWidth:120,letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Portfolio"})}),e.jsx(S,{sx:{py:1,minWidth:140,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Total Portfolio Value"})}),e.jsx(S,{sx:{py:1,minWidth:140,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Total Portfolio Invested"})}),e.jsx(S,{sx:{py:1,minWidth:120,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Portfolio P&L"})}),e.jsx(S,{sx:{py:1,minWidth:120,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Portfolio Unrealized"})}),e.jsx(S,{sx:{py:1,minWidth:120,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Portfolio Realized"})}),e.jsx(S,{sx:{py:1,minWidth:140,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Total Asset Value"})}),e.jsx(S,{sx:{py:1,minWidth:140,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Total Asset Invested"})}),e.jsx(S,{sx:{py:1,minWidth:120,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Asset P&L"})}),e.jsx(S,{sx:{py:1,minWidth:120,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Asset Unrealized"})}),e.jsx(S,{sx:{py:1,minWidth:120,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Asset Realized"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Deposits"})}),e.jsx(S,{sx:{py:1,minWidth:140,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Deposit Value"})}),e.jsx(S,{sx:{py:1,minWidth:140,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Deposit Principal"})}),e.jsx(S,{sx:{py:1,minWidth:140,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Deposit Interest"})}),e.jsx(S,{sx:{py:1,minWidth:140,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Deposit Unrealized"})}),e.jsx(S,{sx:{py:1,minWidth:140,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Deposit Realized"})}),e.jsx(S,{sx:{py:1,minWidth:140,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Cash"})}),e.jsx(S,{sx:{py:1,minWidth:120,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Outstanding Units"})}),e.jsx(S,{sx:{py:1,minWidth:100,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"NAV per Unit"})}),e.jsx(S,{sx:{py:1,minWidth:100,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Investors"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"center",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Is Fund"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Daily Return %"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Weekly Return %"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Monthly Return %"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"YTD Return %"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Total Return %"})}),e.jsx(S,{sx:{py:1,minWidth:60,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Assets"})}),e.jsx(S,{sx:{py:1,minWidth:60,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Active"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Type"})})]})}),e.jsx(ot,{children:r.sort((u,h)=>new Date(h.snapshotDate).getTime()-new Date(u.snapshotDate).getTime()).map(u=>e.jsxs(De,{hover:!0,children:[e.jsx(S,{sx:{py:.5,position:"sticky",left:0,zIndex:1,borderRight:"1px solid",borderColor:"divider",backgroundColor:"background.paper"},children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.2px"},children:Gt(u.snapshotDate)})}),e.jsx(S,{sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.2px"},children:u.portfolioName})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px"},children:G(Number(u.totalPortfolioValue||0),a)})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",children:G(Number(u.totalPortfolioInvested||0),a)})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.totalPortfolioPl&&Number(u.totalPortfolioPl)>=0?"success.main":"error.main"},children:[u.totalPortfolioPl&&Number(u.totalPortfolioPl)>=0?"+":"",G(Number(u.totalPortfolioPl||0),a)]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.unrealizedPortfolioPl&&Number(u.unrealizedPortfolioPl)>=0?"success.main":"error.main"},children:[u.unrealizedPortfolioPl&&Number(u.unrealizedPortfolioPl)>=0?"+":"",G(Number(u.unrealizedPortfolioPl||0),a)]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.realizedPortfolioPl&&Number(u.realizedPortfolioPl)>=0?"success.main":"error.main"},children:[u.realizedPortfolioPl&&Number(u.realizedPortfolioPl)>=0?"+":"",G(Number(u.realizedPortfolioPl||0),a)]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",children:G(Number(u.totalAssetValue||0),a)})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",children:G(Number(u.totalAssetInvested||0),a)})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.totalAssetPl&&Number(u.totalAssetPl)>=0?"success.main":"error.main"},children:[u.totalAssetPl&&Number(u.totalAssetPl)>=0?"+":"",G(Number(u.totalAssetPl||0),a)]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.unrealizedAssetPl&&Number(u.unrealizedAssetPl)>=0?"success.main":"error.main"},children:[u.unrealizedAssetPl&&Number(u.unrealizedAssetPl)>=0?"+":"",G(Number(u.unrealizedAssetPl||0),a)]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.realizedAssetPl&&Number(u.realizedAssetPl)>=0?"success.main":"error.main"},children:[u.realizedAssetPl&&Number(u.realizedAssetPl)>=0?"+":"",G(Number(u.realizedAssetPl||0),a)]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",children:u.totalDepositCount||0})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",children:G(Number(u.totalDepositValue||0),a)})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",children:G(Number(u.totalDepositPrincipal||0),a)})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.totalDepositInterest&&Number(u.totalDepositInterest)>=0?"success.main":"error.main"},children:[u.totalDepositInterest&&Number(u.totalDepositInterest)>=0?"+":"",G(Number(u.totalDepositInterest||0),a)]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.unrealizedDepositPnL&&Number(u.unrealizedDepositPnL)>=0?"success.main":"error.main"},children:[u.unrealizedDepositPnL&&Number(u.unrealizedDepositPnL)>=0?"+":"",G(Number(u.unrealizedDepositPnL||0),a)]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.realizedDepositPnL&&Number(u.realizedDepositPnL)>=0?"success.main":"error.main"},children:[u.realizedDepositPnL&&Number(u.realizedDepositPnL)>=0?"+":"",G(Number(u.realizedDepositPnL||0),a)]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",children:G(Number(u.cashBalance||0),a)})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",children:dn(Number(u.totalOutstandingUnits||0))})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",sx:{color:"primary.main"},children:G(Number(u.navPerUnit||0),a)})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",children:dn(Number(u.numberOfInvestors||0),0)})}),e.jsx(S,{align:"center",sx:{py:1},children:e.jsx(ce,{label:u.isFund?"Yes":"No",size:"small",color:u.isFund?"primary":"default",sx:{fontSize:"0.6rem",height:20}})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.dailyReturn&&Number(u.dailyReturn)>=0?"success.main":"error.main"},children:[u.dailyReturn&&Number(u.dailyReturn)>=0?"+":"",ye(Number(u.dailyReturn||0))]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.weeklyReturn&&Number(u.weeklyReturn)>=0?"success.main":"error.main"},children:[u.weeklyReturn&&Number(u.weeklyReturn)>=0?"+":"",ye(Number(u.weeklyReturn||0))]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.monthlyReturn&&Number(u.monthlyReturn)>=0?"success.main":"error.main"},children:[u.monthlyReturn&&Number(u.monthlyReturn)>=0?"+":"",ye(Number(u.monthlyReturn||0))]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.ytdReturn&&Number(u.ytdReturn)>=0?"success.main":"error.main"},children:[u.ytdReturn&&Number(u.ytdReturn)>=0?"+":"",ye(Number(u.ytdReturn||0))]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:u.totalReturn&&Number(u.totalReturn)>=0?"success.main":"error.main"},children:[u.totalReturn&&Number(u.totalReturn)>=0?"+":"",ye(Number(u.totalReturn||0))]})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",children:u.assetCount||0})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(c,{variant:"tableCellSmall",children:u.activeAssetCount||0})}),e.jsx(S,{align:"right",sx:{py:1},children:e.jsx(ce,{label:u.granularity,size:"small",variant:"outlined",color:"primary",sx:{fontSize:"0.65rem",height:18}})})]},u.id))})]})}):e.jsx(l,{sx:{p:3,textAlign:"center",color:"text.secondary"},children:e.jsx(c,{variant:"pageSubtitle",sx:{fontWeight:500,letterSpacing:"0.3px"},children:"No portfolio snapshots available"})}),r&&r.length>0&&s&&e.jsx(l,{sx:{mt:2},children:e.jsx(Ko,{page:s.page,limit:s.limit,total:s.total,totalPages:s.totalPages,hasNext:s.page<s.totalPages,hasPrev:s.page>1,onPageChange:i,onLimitChange:o})})]})},DP=({portfolioPerformanceData:r,performanceLoading:t,baseCurrency:n,onPageChange:s,onLimitChange:a})=>e.jsxs(l,{children:[e.jsx(c,{variant:"pageSubtitle",sx:{mb:2,color:"text.secondary",lineHeight:1.6},children:"Cash Inflows | Cash Outflows | Net Cash Flow c tnh t Cash Flows v filter theo ngy snapshot"}),t&&e.jsx(l,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(Ce,{size:24})}),r.data&&r.data.length>0?e.jsx(at,{component:Te,elevation:0,sx:{border:1,borderColor:"divider",overflowX:"auto"},children:e.jsxs(it,{size:"small",sx:{minWidth:2e3},children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:"grey.50"},children:[e.jsx(S,{sx:{py:1,minWidth:100,position:"sticky",left:0,backgroundColor:"grey.50",zIndex:1,borderRight:"1px solid",borderColor:"divider",letterSpacing:"0.5px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Date"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1D"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1W"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1M"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 3M"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 6M"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1Y"})}),e.jsx(S,{sx:{py:1,minWidth:80,letterSpacing:"0.3px"},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR YTD"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"MWR 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"MWR 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"MWR 6M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"MWR 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"MWR YTD"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 6M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR YTD"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 6M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha YTD"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Beta 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Beta 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Beta 6M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Beta 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Beta YTD"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Info Ratio 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Info Ratio 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Info Ratio 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Track Error 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Track Error 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Track Error 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:120},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Cash Inflows"})}),e.jsx(S,{sx:{py:.5,minWidth:120},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Cash Outflows"})}),e.jsx(S,{sx:{py:.5,minWidth:120},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Net Cash Flow"})}),e.jsx(S,{sx:{py:.5,minWidth:80},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Granularity"})})]})}),e.jsx(ot,{children:r.data.sort((i,o)=>new Date(o.snapshotDate).getTime()-new Date(i.snapshotDate).getTime()).map(i=>e.jsxs(De,{hover:!0,children:[e.jsx(S,{sx:{py:.5,position:"sticky",left:0,backgroundColor:"background.paper",zIndex:1,borderRight:"1px solid",borderColor:"divider"},children:e.jsx(c,{variant:"tableCellSmall",sx:{fontWeight:500,letterSpacing:"0.2px"},children:Gt(i.snapshotDate)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioTWR1D&&Number(i.portfolioTWR1D)>=0?"success.main":"error.main"},children:[i.portfolioTWR1D&&Number(i.portfolioTWR1D)>=0?"+":"",ye(i.portfolioTWR1D)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioTWR1W&&Number(i.portfolioTWR1W)>=0?"success.main":"error.main"},children:[i.portfolioTWR1W&&Number(i.portfolioTWR1W)>=0?"+":"",ye(i.portfolioTWR1W)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioTWR1M&&Number(i.portfolioTWR1M)>=0?"success.main":"error.main"},children:[i.portfolioTWR1M&&Number(i.portfolioTWR1M)>=0?"+":"",ye(i.portfolioTWR1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioTWR3M&&Number(i.portfolioTWR3M)>=0?"success.main":"error.main"},children:[i.portfolioTWR3M&&Number(i.portfolioTWR3M)>=0?"+":"",ye(i.portfolioTWR3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioTWR6M&&Number(i.portfolioTWR6M)>=0?"success.main":"error.main"},children:[i.portfolioTWR6M&&Number(i.portfolioTWR6M)>=0?"+":"",ye(i.portfolioTWR6M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioTWR1Y&&Number(i.portfolioTWR1Y)>=0?"success.main":"error.main"},children:[i.portfolioTWR1Y&&Number(i.portfolioTWR1Y)>=0?"+":"",ye(i.portfolioTWR1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioTWRYTD&&Number(i.portfolioTWRYTD)>=0?"success.main":"error.main"},children:[i.portfolioTWRYTD&&Number(i.portfolioTWRYTD)>=0?"+":"",ye(i.portfolioTWRYTD)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioMWR1M&&Number(i.portfolioMWR1M)>=0?"success.main":"error.main"},children:[i.portfolioMWR1M&&Number(i.portfolioMWR1M)>=0?"+":"",ye(i.portfolioMWR1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioMWR3M&&Number(i.portfolioMWR3M)>=0?"success.main":"error.main"},children:[i.portfolioMWR3M&&Number(i.portfolioMWR3M)>=0?"+":"",ye(i.portfolioMWR3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioMWR6M&&Number(i.portfolioMWR6M)>=0?"success.main":"error.main"},children:[i.portfolioMWR6M&&Number(i.portfolioMWR6M)>=0?"+":"",ye(i.portfolioMWR6M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioMWR1Y&&Number(i.portfolioMWR1Y)>=0?"success.main":"error.main"},children:[i.portfolioMWR1Y&&Number(i.portfolioMWR1Y)>=0?"+":"",ye(i.portfolioMWR1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioMWRYTD&&Number(i.portfolioMWRYTD)>=0?"success.main":"error.main"},children:[i.portfolioMWRYTD&&Number(i.portfolioMWRYTD)>=0?"+":"",ye(i.portfolioMWRYTD)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioIRR1M&&Number(i.portfolioIRR1M)>=0?"success.main":"error.main"},children:[i.portfolioIRR1M&&Number(i.portfolioIRR1M)>=0?"+":"",ye(i.portfolioIRR1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioIRR3M&&Number(i.portfolioIRR3M)>=0?"success.main":"error.main"},children:[i.portfolioIRR3M&&Number(i.portfolioIRR3M)>=0?"+":"",ye(i.portfolioIRR3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioIRR6M&&Number(i.portfolioIRR6M)>=0?"success.main":"error.main"},children:[i.portfolioIRR6M&&Number(i.portfolioIRR6M)>=0?"+":"",ye(i.portfolioIRR6M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioIRR1Y&&Number(i.portfolioIRR1Y)>=0?"success.main":"error.main"},children:[i.portfolioIRR1Y&&Number(i.portfolioIRR1Y)>=0?"+":"",ye(i.portfolioIRR1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioIRRYTD&&Number(i.portfolioIRRYTD)>=0?"success.main":"error.main"},children:[i.portfolioIRRYTD&&Number(i.portfolioIRRYTD)>=0?"+":"",ye(i.portfolioIRRYTD)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioAlpha1M&&Number(i.portfolioAlpha1M)>=0?"success.main":"error.main"},children:[i.portfolioAlpha1M&&Number(i.portfolioAlpha1M)>=0?"+":"",ye(i.portfolioAlpha1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioAlpha3M&&Number(i.portfolioAlpha3M)>=0?"success.main":"error.main"},children:[i.portfolioAlpha3M&&Number(i.portfolioAlpha3M)>=0?"+":"",ye(i.portfolioAlpha3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioAlpha6M&&Number(i.portfolioAlpha6M)>=0?"success.main":"error.main"},children:[i.portfolioAlpha6M&&Number(i.portfolioAlpha6M)>=0?"+":"",ye(i.portfolioAlpha6M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioAlpha1Y&&Number(i.portfolioAlpha1Y)>=0?"success.main":"error.main"},children:[i.portfolioAlpha1Y&&Number(i.portfolioAlpha1Y)>=0?"+":"",ye(i.portfolioAlpha1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.portfolioAlphaYTD&&Number(i.portfolioAlphaYTD)>=0?"success.main":"error.main"},children:[i.portfolioAlphaYTD&&Number(i.portfolioAlphaYTD)>=0?"+":"",ye(i.portfolioAlphaYTD)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:(parseFloat(i.portfolioBeta1M)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:(parseFloat(i.portfolioBeta3M)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:(parseFloat(i.portfolioBeta6M)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:(parseFloat(i.portfolioBeta1Y)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:(parseFloat(i.portfolioBetaYTD)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",sx:{color:i.portfolioInformationRatio1M&&Number(i.portfolioInformationRatio1M)>=0?"success.main":"error.main"},children:(parseFloat(i.portfolioInformationRatio1M)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",sx:{color:i.portfolioInformationRatio3M&&Number(i.portfolioInformationRatio3M)>=0?"success.main":"error.main"},children:(parseFloat(i.portfolioInformationRatio3M)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",sx:{color:i.portfolioInformationRatio1Y&&Number(i.portfolioInformationRatio1Y)>=0?"success.main":"error.main"},children:(parseFloat(i.portfolioInformationRatio1Y)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:ye(i.portfolioTrackingError1M)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:ye(i.portfolioTrackingError3M)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:ye(i.portfolioTrackingError1Y)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:G(i.totalCashInflows||0,n)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:G(i.totalCashOutflows||0,n)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:i.netCashFlow&&Number(i.netCashFlow)>=0?"success.main":"error.main"},children:[i.netCashFlow&&Number(i.netCashFlow)>=0?"+":"",G(i.netCashFlow||0,n)]})}),e.jsx(S,{sx:{py:.5},children:e.jsx(ce,{label:i.granularity,size:"small",variant:"outlined",color:"primary",sx:{fontSize:"0.65rem",height:18}})})]},i.id))})]})}):e.jsx(l,{sx:{p:3,textAlign:"center",color:"text.secondary"},children:e.jsx(c,{variant:"pageSubtitle",sx:{fontWeight:500,letterSpacing:"0.3px"},children:"No portfolio performance snapshots available"})}),r.data&&r.data.length>0&&e.jsx(l,{sx:{mt:2},children:e.jsx(Ko,{page:r.page,limit:r.limit,total:r.total,totalPages:r.totalPages,hasNext:r.hasNext,hasPrev:r.hasPrev,onPageChange:s,onLimitChange:a})})]}),AP=({assetGroupPerformanceData:r,performanceLoading:t,onPageChange:n,onLimitChange:s})=>e.jsxs(l,{children:[t&&e.jsx(l,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(Ce,{size:24})}),r.data.length>0?e.jsx(at,{component:Te,elevation:0,sx:{border:1,borderColor:"divider",overflowX:"auto"},children:e.jsxs(it,{size:"small",sx:{minWidth:1e3},children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:"grey.50"},children:[e.jsx(S,{sx:{py:1,minWidth:100,position:"sticky",left:0,backgroundColor:"grey.50",zIndex:1,borderRight:"1px solid",borderColor:"divider",letterSpacing:"0.5px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Date"})}),e.jsx(S,{sx:{py:1,minWidth:120,letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Asset Type"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1D"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1W"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 6M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR YTD"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 6M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR YTD"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 6M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha YTD"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Sharpe 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Sharpe 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Sharpe 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Volatility 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Volatility 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Volatility 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Max DD 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Max DD 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Max DD 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Risk Adj 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Risk Adj 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Risk Adj 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Granularity"})})]})}),e.jsx(ot,{children:r.data.sort((a,i)=>new Date(i.snapshotDate).getTime()-new Date(a.snapshotDate).getTime()).map(a=>e.jsxs(De,{hover:!0,children:[e.jsx(S,{sx:{py:.5,position:"sticky",left:0,backgroundColor:"background.paper",zIndex:1,borderRight:"1px solid",borderColor:"divider"},children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.2px"},children:Gt(a.snapshotDate)})}),e.jsx(S,{sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.2px"},children:a.assetType||"Unknown Type"})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupTWR1D&&Number(a.groupTWR1D)>=0?"success.main":"error.main"},children:[a.groupTWR1D&&Number(a.groupTWR1D)>=0?"+":"",ye(a.groupTWR1D)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupTWR1W&&Number(a.groupTWR1W)>=0?"success.main":"error.main"},children:[a.groupTWR1W&&Number(a.groupTWR1W)>=0?"+":"",ye(a.groupTWR1W)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupTWR1M&&Number(a.groupTWR1M)>=0?"success.main":"error.main"},children:[a.groupTWR1M&&Number(a.groupTWR1M)>=0?"+":"",ye(a.groupTWR1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupTWR3M&&Number(a.groupTWR3M)>=0?"success.main":"error.main"},children:[a.groupTWR3M&&Number(a.groupTWR3M)>=0?"+":"",ye(a.groupTWR3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupTWR6M&&Number(a.groupTWR6M)>=0?"success.main":"error.main"},children:[a.groupTWR6M&&Number(a.groupTWR6M)>=0?"+":"",ye(a.groupTWR6M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupTWR1Y&&Number(a.groupTWR1Y)>=0?"success.main":"error.main"},children:[a.groupTWR1Y&&Number(a.groupTWR1Y)>=0?"+":"",ye(a.groupTWR1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupTWRYTD&&Number(a.groupTWRYTD)>=0?"success.main":"error.main"},children:[a.groupTWRYTD&&Number(a.groupTWRYTD)>=0?"+":"",ye(a.groupTWRYTD)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupIRR1M&&Number(a.groupIRR1M)>=0?"success.main":"error.main"},children:[a.groupIRR1M&&Number(a.groupIRR1M)>=0?"+":"",ye(a.groupIRR1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupIRR3M&&Number(a.groupIRR3M)>=0?"success.main":"error.main"},children:[a.groupIRR3M&&Number(a.groupIRR3M)>=0?"+":"",ye(a.groupIRR3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupIRR6M&&Number(a.groupIRR6M)>=0?"success.main":"error.main"},children:[a.groupIRR6M&&Number(a.groupIRR6M)>=0?"+":"",ye(a.groupIRR6M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupIRR1Y&&Number(a.groupIRR1Y)>=0?"success.main":"error.main"},children:[a.groupIRR1Y&&Number(a.groupIRR1Y)>=0?"+":"",ye(a.groupIRR1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupIRRYTD&&Number(a.groupIRRYTD)>=0?"success.main":"error.main"},children:[a.groupIRRYTD&&Number(a.groupIRRYTD)>=0?"+":"",ye(a.groupIRRYTD)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupAlpha1M&&Number(a.groupAlpha1M)>=0?"success.main":"error.main"},children:[a.groupAlpha1M&&Number(a.groupAlpha1M)>=0?"+":"",ye(a.groupAlpha1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupAlpha3M&&Number(a.groupAlpha3M)>=0?"success.main":"error.main"},children:[a.groupAlpha3M&&Number(a.groupAlpha3M)>=0?"+":"",ye(a.groupAlpha3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupAlpha6M&&Number(a.groupAlpha6M)>=0?"success.main":"error.main"},children:[a.groupAlpha6M&&Number(a.groupAlpha6M)>=0?"+":"",ye(a.groupAlpha6M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupAlpha1Y&&Number(a.groupAlpha1Y)>=0?"success.main":"error.main"},children:[a.groupAlpha1Y&&Number(a.groupAlpha1Y)>=0?"+":"",ye(a.groupAlpha1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupAlphaYTD&&Number(a.groupAlphaYTD)>=0?"success.main":"error.main"},children:[a.groupAlphaYTD&&Number(a.groupAlphaYTD)>=0?"+":"",ye(a.groupAlphaYTD)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",sx:{color:a.groupSharpeRatio1M&&Number(a.groupSharpeRatio1M)>=0?"success.main":"error.main"},children:(parseFloat(a.groupSharpeRatio1M)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",sx:{color:a.groupSharpeRatio3M&&Number(a.groupSharpeRatio3M)>=0?"success.main":"error.main"},children:(parseFloat(a.groupSharpeRatio3M)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",sx:{color:a.groupSharpeRatio1Y&&Number(a.groupSharpeRatio1Y)>=0?"success.main":"error.main"},children:(parseFloat(a.groupSharpeRatio1Y)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:ye(a.groupVolatility1M)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:ye(a.groupVolatility3M)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:ye(a.groupVolatility1Y)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",color:"error.main",children:["-",ye(a.groupMaxDrawdown1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",color:"error.main",children:["-",ye(a.groupMaxDrawdown3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",color:"error.main",children:["-",ye(a.groupMaxDrawdown1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupRiskAdjustedReturn1M&&Number(a.groupRiskAdjustedReturn1M)>=0?"success.main":"error.main"},children:[a.groupRiskAdjustedReturn1M&&Number(a.groupRiskAdjustedReturn1M)>=0?"+":"",ye(a.groupRiskAdjustedReturn1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupRiskAdjustedReturn3M&&Number(a.groupRiskAdjustedReturn3M)>=0?"success.main":"error.main"},children:[a.groupRiskAdjustedReturn3M&&Number(a.groupRiskAdjustedReturn3M)>=0?"+":"",ye(a.groupRiskAdjustedReturn3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.groupRiskAdjustedReturn1Y&&Number(a.groupRiskAdjustedReturn1Y)>=0?"success.main":"error.main"},children:[a.groupRiskAdjustedReturn1Y&&Number(a.groupRiskAdjustedReturn1Y)>=0?"+":"",ye(a.groupRiskAdjustedReturn1Y)]})}),e.jsx(S,{sx:{py:.5},children:e.jsx(ce,{label:a.granularity,size:"small",variant:"outlined",color:"primary",sx:{fontSize:"0.65rem",height:18}})})]},a.id))})]})}):e.jsx(l,{sx:{p:3,textAlign:"center",color:"text.secondary"},children:e.jsx(c,{variant:"pageSubtitle",sx:{fontWeight:500,letterSpacing:"0.3px"},children:"No asset group performance snapshots available"})}),r.data.length>0&&e.jsx(Ko,{page:r.page,limit:r.limit,total:r.total,totalPages:r.totalPages,hasNext:r.hasNext,hasPrev:r.hasPrev,onPageChange:n,onLimitChange:s,limitOptions:[5,10,25,50,100]})]}),IP=({assetPerformanceData:r,performanceLoading:t,onPageChange:n,onLimitChange:s})=>e.jsxs(l,{children:[t&&e.jsx(l,{sx:{display:"flex",justifyContent:"center",p:2},children:e.jsx(Ce,{size:24})}),r.data.length>0?e.jsx(at,{component:Te,elevation:0,sx:{border:1,borderColor:"divider",overflowX:"auto"},children:e.jsxs(it,{size:"small",sx:{minWidth:1e3},children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:"grey.50"},children:[e.jsx(S,{sx:{py:1,minWidth:100,position:"sticky",left:0,backgroundColor:"grey.50",zIndex:1,borderRight:"1px solid",borderColor:"divider",letterSpacing:"0.5px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Date"})}),e.jsx(S,{sx:{py:1,minWidth:120,letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Asset Symbol"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1D"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1W"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 6M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"TWR YTD"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 6M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"IRR YTD"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 6M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Alpha YTD"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Sharpe 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Sharpe 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Sharpe 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Volatility 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Volatility 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Volatility 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Max DD 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Max DD 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Max DD 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Risk Adj 1M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Risk Adj 3M"})}),e.jsx(S,{sx:{py:.5,minWidth:80},align:"right",children:e.jsx(c,{variant:"tableHeaderSmall",children:"Risk Adj 1Y"})}),e.jsx(S,{sx:{py:.5,minWidth:80},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Granularity"})})]})}),e.jsx(ot,{children:r.data.sort((a,i)=>new Date(i.snapshotDate).getTime()-new Date(a.snapshotDate).getTime()).map(a=>e.jsxs(De,{hover:!0,children:[e.jsx(S,{sx:{py:.5,position:"sticky",left:0,backgroundColor:"background.paper",zIndex:1,borderRight:"1px solid",borderColor:"divider"},children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.2px"},children:Gt(a.snapshotDate)})}),e.jsx(S,{sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.2px"},children:a.assetSymbol||"Unknown"})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1D&&Number(a.assetTWR1D)>=0?"success.main":"error.main"},children:[a.assetTWR1D&&Number(a.assetTWR1D)>=0?"+":"",ye(a.assetTWR1D)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetTWR1W&&Number(a.assetTWR1W)>=0?"+":"",ye(a.assetTWR1W)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetTWR1M&&Number(a.assetTWR1M)>=0?"+":"",ye(a.assetTWR1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetTWR3M&&Number(a.assetTWR3M)>=0?"+":"",ye(a.assetTWR3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetTWR6M&&Number(a.assetTWR6M)>=0?"+":"",ye(a.assetTWR6M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetTWR1Y&&Number(a.assetTWR1Y)>=0?"+":"",ye(a.assetTWR1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetTWRYTD&&Number(a.assetTWRYTD)>=0?"+":"",ye(a.assetTWRYTD)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetIRR1M&&Number(a.assetIRR1M)>=0?"+":"",ye(a.assetIRR1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetIRR3M&&Number(a.assetIRR3M)>=0?"+":"",ye(a.assetIRR3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetIRR6M&&Number(a.assetIRR6M)>=0?"+":"",ye(a.assetIRR6M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetIRR1Y&&Number(a.assetIRR1Y)>=0?"+":"",ye(a.assetIRR1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetIRRYTD&&Number(a.assetIRRYTD)>=0?"+":"",ye(a.assetIRRYTD)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetAlpha1M&&Number(a.assetAlpha1M)>=0?"+":"",ye(a.assetAlpha1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetAlpha3M&&Number(a.assetAlpha3M)>=0?"+":"",ye(a.assetAlpha3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetAlpha6M&&Number(a.assetAlpha6M)>=0?"+":"",ye(a.assetAlpha6M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetAlpha1Y&&Number(a.assetAlpha1Y)>=0?"+":"",ye(a.assetAlpha1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetAlphaYTD&&Number(a.assetAlphaYTD)>=0?"+":"",ye(a.assetAlphaYTD)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:(parseFloat(a.assetSharpeRatio1M)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:(parseFloat(a.assetSharpeRatio3M)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:(parseFloat(a.assetSharpeRatio1Y)||0).toFixed(2)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:ye(a.assetVolatility1M)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:ye(a.assetVolatility3M)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsx(c,{variant:"tableCellSmall",children:ye(a.assetVolatility1Y)})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:"error.main"},children:["-",ye(a.assetMaxDrawdown1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:"error.main"},children:["-",ye(a.assetMaxDrawdown3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:"error.main"},children:["-",ye(a.assetMaxDrawdown1Y)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetRiskAdjustedReturn1M&&Number(a.assetRiskAdjustedReturn1M)>=0?"+":"",ye(a.assetRiskAdjustedReturn1M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetRiskAdjustedReturn3M&&Number(a.assetRiskAdjustedReturn3M)>=0?"+":"",ye(a.assetRiskAdjustedReturn3M)]})}),e.jsx(S,{align:"right",sx:{py:.5},children:e.jsxs(c,{variant:"tableCellSmall",sx:{color:a.assetTWR1W&&Number(a.assetTWR1W)>=0?"success.main":"error.main"},children:[a.assetRiskAdjustedReturn1Y&&Number(a.assetRiskAdjustedReturn1Y)>=0?"+":"",ye(a.assetRiskAdjustedReturn1Y)]})}),e.jsx(S,{sx:{py:.5},children:e.jsx(ce,{label:a.granularity,size:"small",variant:"outlined",color:"primary",sx:{fontSize:"0.65rem",height:18}})})]},a.id))})]})}):e.jsx(l,{sx:{p:3,textAlign:"center",color:"text.secondary"},children:e.jsx(c,{variant:"pageSubtitle",sx:{letterSpacing:"0.3px"},children:"No asset performance snapshots available"})}),r.data.length>0&&e.jsx(Ko,{page:r.page,limit:r.limit,total:r.total,totalPages:r.totalPages,hasNext:r.hasNext,hasPrev:r.hasPrev,onPageChange:n,onLimitChange:s,limitOptions:[5,10,25,50,100]})]}),RP=({transformedSnapshots:r,expandedAssetTypes:t,allExpanded:n,toggleAssetType:s,toggleAll:a,getAssetTypeIcon:i,baseCurrency:o,showActions:d,onSnapshotSelect:u,onSnapshotEdit:h,onSnapshotDelete:m,loading:x,pagination:g,page:f,rowsPerPage:y,handleChangePage:j,handleChangeRowsPerPage:b,snapshots:v,portfolios:P})=>e.jsxs(l,{children:[v&&P.length>0&&(()=>{const w=v.map(C=>C.portfolioId).filter((C,k,A)=>A.indexOf(C)===k&&!P.find(L=>L.portfolioId===C));return w.length>0?e.jsxs(je,{severity:"warning",sx:{mb:2},children:["Some snapshots reference portfolios that are not found: ",w.map(C=>C.substring(0,8)+"...").join(", ")]}):null})(),e.jsx(at,{component:Te,elevation:0,sx:{border:1,borderColor:"divider"},children:e.jsxs(it,{size:"small",children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{sx:{minWidth:100,position:"sticky",left:0,backgroundColor:"grey.50",zIndex:1,borderRight:"1px solid",borderColor:"divider"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Fe,{title:n?"Collapse All":"Expand All",children:e.jsx(Ie,{size:"small",onClick:a,disabled:x,sx:{p:.5},children:n?e.jsx(Dn,{}):e.jsx(ln,{})})}),e.jsx(c,{variant:"tableHeaderSmall",sx:{letterSpacing:"0.3px"},children:"Date"}),e.jsx(l,{sx:{flexGrow:1}})]})}),e.jsx(S,{sx:{letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Asset"})}),e.jsx(S,{sx:{letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Quantity"})}),e.jsx(S,{sx:{letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Price"})}),e.jsx(S,{sx:{letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Value"})}),e.jsx(S,{sx:{letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Total P&L"})}),e.jsx(S,{sx:{letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Unrealized P&L"})}),e.jsx(S,{sx:{letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Realized P&L"})}),e.jsx(S,{sx:{letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Return %"})}),e.jsx(S,{sx:{letterSpacing:"0.3px"},children:e.jsx(c,{variant:"tableHeaderSmall",children:"Granularity"})}),d&&e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",children:"Actions"})})]})}),e.jsx(ot,{children:(()=>{const w=r.reduce((k,A)=>{const L=A.snapshotDate;k[L]||(k[L]={});const T=A.displayType;return k[L][T]||(k[L][T]=[]),k[L][T].push(A),k},{});return Object.keys(w).sort((k,A)=>new Date(A).getTime()-new Date(k).getTime()).map(k=>{const A=w[k];return Object.keys(A).sort().map(T=>{var B;const M=A[T],O=t.has(`${k}_${T}`),I=M.reduce(($,Y)=>$+Number(Y.currentValue||0),0),z=M.reduce(($,Y)=>$+Number(Y.totalPl||0),0),N=M.reduce(($,Y)=>$+Number(Y.unrealizedPl||0),0),E=M.reduce(($,Y)=>$+Number(Y.realizedPl||0),0),R=M.reduce(($,Y)=>$+Number(Y.quantity||0),0),V=R>0?I/R:0,F=M.length>0?M.reduce(($,Y)=>$+Number(Y.returnPercentage||0),0)/M.length:0;return e.jsxs(rt.Fragment,{children:[e.jsxs(De,{hover:!0,sx:{bgcolor:O?"action.hover":"transparent",cursor:"pointer","&:hover":{bgcolor:"action.hover"}},onClick:()=>s(`${k}_${T}`),children:[e.jsx(S,{sx:{position:"sticky",left:0,backgroundColor:"background.paper",zIndex:1,borderRight:"1px solid",borderColor:"divider"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[O?e.jsx(Dn,{}):e.jsx(ln,{}),e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.2px"},children:Gt(k)})]})}),e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[i(T),e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.3px"},children:T.toUpperCase()}),e.jsx(ce,{label:`${M.length} assets`,size:"small",color:"primary",variant:"outlined"})]})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px"},children:dn(R,4)})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px"},children:G(V,o)})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px"},children:G(I,o)})}),e.jsx(S,{children:e.jsxs(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px",color:z>=0?"success.main":"error.main"},children:[z>=0?"+":"",G(z,o)]})}),e.jsx(S,{children:e.jsxs(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px",color:N>=0?"success.main":"error.main"},children:[N>=0?"+":"",G(N,o)]})}),e.jsx(S,{children:e.jsxs(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px",color:E>=0?"success.main":"error.main"},children:[E>=0?"+":"",G(E,o)]})}),e.jsx(S,{children:e.jsxs(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px",color:F>=0?"success.main":"error.main"},children:[F>=0?"+":"",ye(F)]})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px"},children:((B=M[0])==null?void 0:B.granularity)||"DAILY"})}),d&&e.jsx(S,{children:e.jsx(l,{sx:{display:"flex",gap:.5},children:e.jsx(Fe,{title:"View Details",children:e.jsx(Ie,{size:"small",onClick:$=>{$.stopPropagation()},children:e.jsx(Xt,{fontSize:"small"})})})})})]}),M.map(($,Y)=>e.jsxs(De,{hover:!0,sx:{display:O?"table-row":"none","& td":{borderTop:0}},children:[e.jsx(S,{sx:{pl:4,position:"sticky",left:0,backgroundColor:"background.paper",zIndex:1,borderRight:"1px solid",borderColor:"divider"},children:Gt($.snapshotDate)}),e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(He,{fontSize:"small",color:"primary"}),e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px"},children:$.displayName})]})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px"},children:dn(Number($.quantity||0),4)})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px"},children:G(Number($.currentPrice||0),o)})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px"},children:G(Number($.currentValue||0),o)})}),e.jsx(S,{children:e.jsxs(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px",color:Number($.totalPl||0)>=0?"success.main":"error.main"},children:[Number($.totalPl||0)>=0?"+":"",G(Number($.totalPl||0),o)]})}),e.jsx(S,{children:e.jsxs(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px",color:Number($.unrealizedPl||0)>=0?"success.main":"error.main"},children:[Number($.unrealizedPl||0)>=0?"+":"",G(Number($.unrealizedPl||0),o)]})}),e.jsx(S,{children:e.jsxs(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px",color:Number($.realizedPl||0)>=0?"success.main":"error.main"},children:[Number($.realizedPl||0)>=0?"+":"",G(Number($.realizedPl||0),o)]})}),e.jsx(S,{children:e.jsxs(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px",color:Number($.returnPercentage||0)>=0?"success.main":"error.main"},children:[Number($.returnPercentage||0)>=0?"+":"",ye(Number($.returnPercentage||0))]})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",sx:{letterSpacing:"0.1px"},children:$.granularity})}),d&&e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",gap:.5},children:[e.jsx(Fe,{title:"View Details",children:e.jsx(Ie,{size:"small",onClick:()=>u==null?void 0:u($),children:e.jsx(Xt,{fontSize:"small"})})}),e.jsx(Fe,{title:"Edit",children:e.jsx(Ie,{size:"small",onClick:()=>h==null?void 0:h($),children:e.jsx(Tt,{fontSize:"small"})})}),e.jsx(Fe,{title:"Delete",children:e.jsx(Ie,{size:"small",color:"error",onClick:()=>m==null?void 0:m($),children:e.jsx(pt,{fontSize:"small"})})})]})})]},$.id||`${$.assetSymbol}_${Y}`))]},`${k}_${T}`)})}).flat()})()})]})}),g&&e.jsx(hi,{rowsPerPageOptions:[10,25,50,100],component:"div",count:g.total,rowsPerPage:y,page:f,onPageChange:j,onRowsPerPageChange:b,sx:{borderTop:1,borderColor:"divider"}})]}),MP=({portfolioId:r,onSnapshotSelect:t,onSnapshotEdit:n,onSnapshotDelete:s,showActions:a=!0,pageSize:i=10})=>{var xe;const{t:o}=Ne(),[d,u]=p.useState(0),[h,m]=p.useState(i),[x,g]=p.useState(0),[f,y]=p.useState(i),[j,b]=p.useState(new Set),[v,P]=p.useState(!1),[w,C]=p.useState(0),[k,A]=p.useState({data:[],page:1,limit:10,total:0,totalPages:0,hasNext:!1,hasPrev:!1}),[L,T]=p.useState({data:[],page:1,limit:10,total:0,totalPages:0,hasNext:!1,hasPrev:!1}),[M,O]=p.useState({data:[],page:1,limit:10,total:0,totalPages:0,hasNext:!1,hasPrev:!1}),[I,z]=p.useState(!1),N=Tl(10),E=Tl(10),R=Tl(10),V=p.useCallback(async()=>{if(r){z(!0);try{const te=await yn.getPortfolioPerformanceSnapshotsPaginated(r,{granularity:lr.DAILY,page:N.pagination.page,limit:N.pagination.limit});A(te||{data:[],page:1,limit:10,total:0,totalPages:0,hasNext:!1,hasPrev:!1}),te&&N.updatePagination({page:te.page,limit:te.limit,total:te.total,totalPages:te.totalPages,hasNext:te.hasNext,hasPrev:te.hasPrev})}catch(te){console.error("Error loading portfolio performance data:",te)}finally{z(!1)}}},[r,N.pagination]),F=p.useCallback(async()=>{if(r){z(!0);try{const te=await yn.getAssetGroupPerformanceSnapshotsPaginated(r,{granularity:lr.DAILY,page:E.pagination.page,limit:E.pagination.limit});T(te||{data:[],page:1,limit:10,total:0,totalPages:0,hasNext:!1,hasPrev:!1}),te&&E.updatePagination({page:te.page,limit:te.limit,total:te.total,totalPages:te.totalPages,hasNext:te.hasNext,hasPrev:te.hasPrev})}catch(te){console.error("Error loading asset group performance data:",te)}finally{z(!1)}}},[r,E.pagination]),B=p.useCallback(async()=>{if(r){z(!0);try{const te=await yn.getAssetPerformanceSnapshotsPaginated(r,{granularity:lr.DAILY,page:R.pagination.page,limit:R.pagination.limit});O(te||{data:[],page:1,limit:10,total:0,totalPages:0,hasNext:!1,hasPrev:!1}),te&&R.updatePagination({page:te.page,limit:te.limit,total:te.total,totalPages:te.totalPages,hasNext:te.hasNext,hasPrev:te.hasPrev})}catch(te){console.error("Error loading asset performance data:",te)}finally{z(!1)}}},[r,R.pagination]),$=te=>{const Ee=new Set(j);Ee.has(te)?Ee.delete(te):Ee.add(te),b(Ee);const Ke=Re.reduce((Qt,cn)=>{const Ut=cn.snapshotDate,xr=cn.displayType,mt=`${Ut}_${xr}`;return Qt.has(mt)||Qt.add(mt),Qt},new Set);P(Ee.size===Ke.size)},Y=()=>{if(v)b(new Set);else{const te=Re.reduce((Ke,Qt)=>{const cn=Qt.snapshotDate;Ke[cn]||(Ke[cn]={});const Ut=Qt.displayType;return Ke[cn][Ut]||(Ke[cn][Ut]=[]),Ke[cn][Ut].push(Qt),Ke},{}),Ee=new Set;Object.keys(te).forEach(Ke=>{Object.keys(te[Ke]).forEach(Qt=>{Ee.add(`${Ke}_${Qt}`)})}),b(Ee)}P(!v)},_=te=>{switch(te.toLowerCase()){case"stock":case"equity":return e.jsx(ar,{});case"gold":case"commodity":return e.jsx(Ep,{});case"bond":case"fixed income":return e.jsx(qt,{});case"forex":case"currency":return e.jsx(Lp,{});default:return e.jsx(Np,{})}},{accountId:K}=Ge(),{portfolios:X,isLoading:ne}=Un(K),oe=((xe=X.find(te=>te.portfolioId===r))==null?void 0:xe.baseCurrency)||"VND",{assets:ee,loading:H}=Yc({autoFetch:!0}),Q=p.useMemo(()=>({portfolioId:r,autoFetch:!0,page:x+1,limit:f}),[r,x,f]),{portfolioSnapshots:Z,loading:J,error:ae,pagination:ue,refreshPortfolioSnapshots:le}=Dx(Q);p.useEffect(()=>{r&&(w===0?r&&le():w===1?V():w===2?F():w===3?B():w===4&&r&&fe(pe))},[w,r]),p.useEffect(()=>{r&&w===1&&V()},[N.pagination.page,N.pagination.limit]),p.useEffect(()=>{r&&w===2&&F()},[E.pagination.page,E.pagination.limit]),p.useEffect(()=>{r&&w===3&&B()},[R.pagination.page,R.pagination.limit]);const pe=p.useMemo(()=>{const te={page:d+1,limit:h};return r&&(te.portfolioId=r),te},[r,d,h]),{snapshots:Me,loading:Le,error:qe,pagination:de,fetchSnapshotsPaginated:fe}=Px(),ie=(te,Ee)=>{u(Ee),w===4&&r&&fe(pe)},Se=te=>{m(parseInt(te.target.value,10)),u(0),w===4&&r&&fe(pe)},Ve=async()=>{try{r&&le(),w===1?V():w===2?F():w===3?B():w===4&&fe(pe)}catch(te){console.error(" Error refreshing data:",te)}},Re=p.useMemo(()=>!Me||Me.length===0?[]:Me.map(te=>{var Ee;return{...te,displayName:te.assetSymbol,displayType:te.assetType||((Ee=ee.find(Ke=>Ke.symbol===te.assetSymbol))==null?void 0:Ee.type)||"Unknown",displayIcon:e.jsx(He,{fontSize:"small"})}}).sort((te,Ee)=>new Date(Ee.snapshotDate).getTime()-new Date(te.snapshotDate).getTime()),[Me,ee]);return e.jsx(l,{sx:{display:"flex",flexDirection:"column"},children:e.jsxs(Te,{elevation:0,sx:{display:"flex",flexDirection:"column",borderRadius:2,border:1,borderColor:"divider"},children:[(Le||ne||H||J)&&e.jsx(ds,{}),(qe||ae)&&e.jsx(je,{severity:"error",sx:{m:2},children:qe||ae}),e.jsxs(l,{sx:{borderBottom:1,borderColor:"divider",display:"flex",alignItems:"center"},children:[e.jsxs(Tr,{value:w,onChange:(te,Ee)=>C(Ee),variant:"scrollable",scrollButtons:"auto",sx:{borderBottom:1,borderColor:"divider",flexGrow:1},children:[e.jsx(ht,{icon:e.jsx(pc,{}),iconPosition:"start",label:o("snapshots.tabs.portfolioSummary"),sx:{minWidth:120,fontWeight:600,letterSpacing:"0.3px"}}),e.jsx(ht,{icon:e.jsx(Qu,{}),iconPosition:"start",label:o("snapshots.tabs.portfolioPerformance"),sx:{minWidth:160,fontWeight:600,letterSpacing:"0.3px"}}),e.jsx(ht,{icon:e.jsx(Mp,{}),iconPosition:"start",label:o("snapshots.tabs.assetGroupPerformance"),sx:{minWidth:180,fontWeight:600,letterSpacing:"0.3px"}}),e.jsx(ht,{icon:e.jsx(Zt,{}),iconPosition:"start",label:o("snapshots.tabs.assetPerformance"),sx:{minWidth:160,fontWeight:600,letterSpacing:"0.3px"}}),e.jsx(ht,{icon:e.jsx(He,{}),iconPosition:"start",label:o("snapshots.tabs.assetSnapshots"),sx:{minWidth:140,fontWeight:600,letterSpacing:"0.3px"}})]}),e.jsx(l,{sx:{p:1},children:e.jsx(he,{variant:"outlined",size:"small",icon:e.jsx(Mt,{}),mobileText:o("snapshots.refreshData"),desktopText:o("snapshots.refreshData"),onClick:Ve,disabled:Le||J||I,sx:{fontWeight:600,letterSpacing:"0.3px"},children:o("snapshots.refreshData")})})]}),e.jsxs(l,{sx:{p:2},children:[w===0&&e.jsx(PP,{portfolioSnapshots:Z,portfolioSnapshotsLoading:J,portfolioSnapshotsError:ae,portfolioSnapshotsPagination:ue,baseCurrency:oe,onPageChange:te=>{g(te-1),r&&le()},onLimitChange:te=>{y(te),g(0),r&&le()}}),w===1&&e.jsx(DP,{portfolioPerformanceData:k,performanceLoading:I,baseCurrency:oe,onPageChange:te=>{N.setPage(te)},onLimitChange:te=>{N.setLimit(te)}}),w===2&&e.jsx(AP,{assetGroupPerformanceData:L,performanceLoading:I,onPageChange:te=>{E.setPage(te)},onLimitChange:te=>{E.setLimit(te)}}),w===3&&e.jsx(IP,{assetPerformanceData:M,performanceLoading:I,onPageChange:te=>{R.setPage(te)},onLimitChange:te=>{R.setLimit(te)}}),w===4&&e.jsx(RP,{transformedSnapshots:Re,expandedAssetTypes:j,allExpanded:v,toggleAssetType:$,toggleAll:Y,getAssetTypeIcon:_,baseCurrency:oe,showActions:a,onSnapshotSelect:t,onSnapshotEdit:n,onSnapshotDelete:s,loading:Le,pagination:de,page:d,rowsPerPage:h,handleChangePage:ie,handleChangeRowsPerPage:Se,snapshots:Me,portfolios:X})]})]})})},NP=({selectedPortfolioId:r,onPortfolioChange:t,disabled:n=!1})=>{const{t:s}=Ne(),{accountId:a}=Ge(),i=Je(),{portfolios:o,isLoading:d,error:u}=Un(a),[h,m]=p.useState([]),[x,g]=p.useState(!1);p.useEffect(()=>{o.length>0&&a&&f()},[o,a]);const f=async()=>{g(!0);try{const b=await Promise.all(o.map(async v=>{try{const P=await yn.getSnapshots({portfolioId:v.portfolioId},a),w=P.length,C=w>0?P[0].snapshotDate:void 0,k=w>0?P[P.length-1].snapshotDate:void 0;return{...v,snapshotCount:w,latestSnapshotDate:C,oldestSnapshotDate:k}}catch{return{...v,snapshotCount:0,latestSnapshotDate:void 0,oldestSnapshotDate:void 0}}}));m(b)}catch(b){console.error("Failed to fetch snapshot stats:",b);const v=o.map(P=>({...P,snapshotCount:0,latestSnapshotDate:void 0,oldestSnapshotDate:void 0}));m(v)}finally{g(!1)}},y=b=>new Date(b).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),j=h.find(b=>b.portfolioId===r);return e.jsxs(Te,{elevation:0,sx:{p:3,borderRadius:2},children:[e.jsxs(nt,{fullWidth:!0,size:"medium",disabled:n||d||x,children:[e.jsxs(st,{children:[s("snapshots.selectPortfolio")," ",x?s("snapshots.loadingSnapshots"):""]}),e.jsx(Ze,{value:r||"",onChange:b=>t(b.target.value),label:s("snapshots.selectPortfolio"),children:(h.length>0?h:o).map(b=>e.jsx(re,{value:b.portfolioId,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,width:"100%"},children:[e.jsx(Vt,{sx:{bgcolor:U(i.palette.primary.main,.1),color:i.palette.primary.main,width:32,height:32},children:e.jsx(Ue,{fontSize:"small"})}),e.jsxs(l,{sx:{flexGrow:1},children:[e.jsx(D,{variant:"body2",sx:{fontWeight:"bold"},children:b.name}),e.jsxs(D,{variant:"caption",color:"text.secondary",sx:{wordBreak:"break-all"},children:[b.portfolioId,"  ",b.snapshotCount||0," ",s("snapshots.snapshots")]})]}),e.jsxs(l,{sx:{display:"flex",gap:1},children:[e.jsx(ce,{label:b.baseCurrency,size:"small",color:"primary",variant:"outlined"}),b.latestSnapshotDate&&e.jsx(ce,{label:`${s("snapshots.latest")}: ${y(b.latestSnapshotDate)}`,size:"small",color:"success",variant:"outlined"}),!b.latestSnapshotDate&&b.snapshotCount===0&&e.jsx(ce,{label:s("snapshots.noSnapshots"),size:"small",color:"default",variant:"outlined"})]})]})},b.portfolioId))})]}),!!u&&e.jsx(D,{variant:"body2",color:"error",sx:{mt:2},children:s("snapshots.failedToLoadPortfolios")}),j&&e.jsxs(l,{sx:{mt:3},children:[e.jsx(D,{variant:"h6",sx:{mb:2,fontWeight:"bold"},children:s("snapshots.portfolioDetails")}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%"},children:e.jsx(me,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{children:[e.jsx(D,{color:"text.secondary",gutterBottom:!0,variant:"body2",children:s("snapshots.totalSnapshots")}),e.jsx(D,{variant:"h4",component:"div",sx:{fontWeight:"bold"},children:j.snapshotCount||0})]}),e.jsx(l,{sx:{p:1,borderRadius:1,bgcolor:U(i.palette.primary.main,.1),color:i.palette.primary.main},children:e.jsx(Zt,{})})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%"},children:e.jsx(me,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{children:[e.jsx(D,{color:"text.secondary",gutterBottom:!0,variant:"body2",children:s("snapshots.latestSnapshot")}),e.jsx(D,{variant:"h6",component:"div",sx:{fontWeight:"bold"},children:j.latestSnapshotDate?y(j.latestSnapshotDate):s("snapshots.noSnapshots")})]}),e.jsx(l,{sx:{p:1,borderRadius:1,bgcolor:U(i.palette.success.main,.1),color:i.palette.success.main},children:e.jsx(Rr,{})})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%"},children:e.jsx(me,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{children:[e.jsx(D,{color:"text.secondary",gutterBottom:!0,variant:"body2",children:s("snapshots.oldestSnapshot")}),e.jsx(D,{variant:"h6",component:"div",sx:{fontWeight:"bold"},children:j.oldestSnapshotDate?y(j.oldestSnapshotDate):s("snapshots.noSnapshots")})]}),e.jsx(l,{sx:{p:1,borderRadius:1,bgcolor:U(i.palette.info.main,.1),color:i.palette.info.main},children:e.jsx(He,{})})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%"},children:e.jsx(me,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(l,{children:[e.jsx(D,{color:"text.secondary",gutterBottom:!0,variant:"body2",children:s("snapshots.portfolioInfo")}),e.jsx(D,{variant:"body2",component:"div",sx:{fontWeight:"bold"},children:j.name})]}),e.jsx(l,{sx:{p:1,borderRadius:1,bgcolor:U(i.palette.warning.main,.1),color:i.palette.warning.main},children:e.jsx(Ue,{})})]})})})})]})]})]})},LP=({open:r,onClose:t,onSuccess:n,onError:s,onPortfolioRefresh:a,selectedPortfolioId:i})=>{const{t:o}=Ne(),{accountId:d}=Ge(),u=Je(),h=Kt(),[m,x]=p.useState([]),[g,f]=p.useState(""),[y,j]=p.useState(lr.DAILY),[b,v]=p.useState(!1),[P,w]=p.useState(!1),[C,k]=p.useState({type:null,message:""}),[A,L]=p.useState(!1),[T,M]=p.useState(new Date().toISOString().split("T")[0]),[O,I]=p.useState(new Date().toISOString().split("T")[0]),z=m.find(Y=>Y.portfolioId===g),N=async Y=>{try{const _=[h.invalidateQueries(["portfolio",Y]),h.invalidateQueries(["portfolio-analytics",Y]),h.invalidateQueries(["portfolio-snapshots",Y]),h.invalidateQueries(["snapshots",Y]),h.invalidateQueries(["portfolio-performance",Y]),h.invalidateQueries(["portfolio-allocation",Y]),h.invalidateQueries(["portfolio-positions",Y])];await Promise.all(_),a&&a(Y)}catch(_){console.error(" Error refreshing portfolio data:",_)}};p.useEffect(()=>{r&&(E(),i&&f(i))},[r,i]);const E=async()=>{w(!0);try{const Y=await q.api.get("/api/v1/portfolios",{params:{accountId:d}});x(Y.data||[])}catch(Y){console.error("Failed to load portfolios:",Y),k({type:"error",message:o("snapshots.modals.createSnapshot.failedToLoadPortfolios")})}finally{w(!1)}},R=async()=>{var Y,_,K,X,ne,oe,ee,H,Q,Z,J;if(!g||!y){k({type:"error",message:o("snapshots.modals.createSnapshot.selectPortfolioAndGranularity")});return}if(!T){k({type:"error",message:o("snapshots.modals.createSnapshot.selectStartDate")});return}if(A&&!O){k({type:"error",message:o("snapshots.modals.createSnapshot.selectEndDate")});return}if(A&&new Date(T)>new Date(O)){k({type:"error",message:o("snapshots.modals.createSnapshot.startDateBeforeEndDate")});return}if(new Date(T)>new Date){k({type:"error",message:o("snapshots.modals.createSnapshot.startDateNotFuture")});return}v(!0),k({type:null,message:""});try{const ae=new Date(T),ue=new Date(O),le=Math.ceil((ue.getTime()-ae.getTime())/(1e3*60*60*24))+1,pe=Math.max(6e4,le*3e3);le>7&&k({type:"info",message:o("snapshots.modals.createSnapshot.processingDays",{days:le})});const Me=await q.api.post("/api/v1/snapshots/portfolio/bulk",{portfolioIds:[g],...A?{startDate:T,endDate:O,granularity:y,createdBy:d}:{startDate:T,granularity:y,createdBy:d}},{timeout:pe});if(Me&&Me.status>=200&&Me.status<300){const Le=Me.data;Le.totalSnapshots>0?(k({type:"success",message:Le.message||o("snapshots.modals.createSnapshot.successCreated",{count:Le.totalSnapshots,portfolioName:(z==null?void 0:z.name)||"portfolio"})}),n==null||n(g,T),await N(g),setTimeout(()=>{V(),t()},400)):(k({type:"info",message:Le.message||o("snapshots.modals.createSnapshot.noSnapshotsCreated",{portfolioName:(z==null?void 0:z.name)||"portfolio"})}),setTimeout(()=>{V(),t()},500))}else throw new Error("Invalid response from server")}catch(ae){console.error("Failed to create bulk snapshot:",ae),console.error("Error details:",{message:ae.message,status:(Y=ae.response)==null?void 0:Y.status,statusText:(_=ae.response)==null?void 0:_.statusText,data:(K=ae.response)==null?void 0:K.data,config:{url:(X=ae.config)==null?void 0:X.url,method:(ne=ae.config)==null?void 0:ne.method,params:(oe=ae.config)==null?void 0:oe.params}});const ue=((H=(ee=ae.response)==null?void 0:ee.data)==null?void 0:H.message)||ae.message||o("snapshots.modals.createSnapshot.errorCreating",{status:((Q=ae.response)==null?void 0:Q.status)||"Unknown",message:((J=(Z=ae.response)==null?void 0:Z.data)==null?void 0:J.message)||ae.message||"Unknown error"});k({type:"error",message:ue}),s==null||s(ue)}finally{v(!1)}},V=()=>{f(""),j(lr.DAILY),L(!1),M(new Date().toISOString().split("T")[0]),I(new Date().toISOString().split("T")[0]),k({type:null,message:""})},F=()=>{b||(V(),t())},B=e.jsx(l,{sx:{p:1.5,borderRadius:"50%",bgcolor:U(u.palette.primary.main,.1),color:u.palette.primary.main},children:e.jsx(fa,{fontSize:"medium"})}),$=e.jsxs(e.Fragment,{children:[e.jsx(he,{variant:"text",onClick:F,disabled:b,sx:{textTransform:"none"},children:o("snapshots.modals.createSnapshot.cancel")}),e.jsx(We,{variant:"contained",icon:b?e.jsx(Ce,{size:20}):e.jsx(xt,{}),mobileText:o("snapshots.modals.createSnapshot.create"),desktopText:o("snapshots.modals.createSnapshot.createSnapshot"),onClick:R,disabled:!g||!T||!y||b||P,forceTextOnly:!0,sx:{textTransform:"none",minWidth:140},children:o(b?"snapshots.modals.createSnapshot.creating":"snapshots.modals.createSnapshot.createSnapshot")})]});return e.jsx(Rt,{open:r,onClose:F,title:o("snapshots.modals.createSnapshot.title"),icon:B,actions:$,loading:b,maxWidth:"sm",titleColor:"primary",children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:3,mt:2},children:[e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:o("snapshots.modals.createSnapshot.selectPortfolio")}),e.jsx(Ze,{value:g,onChange:Y=>f(Y.target.value),label:o("snapshots.modals.createSnapshot.selectPortfolio"),disabled:b||P,children:m.map(Y=>e.jsx(re,{value:Y.portfolioId,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,width:"100%"},children:[e.jsxs(l,{sx:{flexGrow:1},children:[e.jsx(D,{variant:"body2",sx:{fontWeight:"bold"},children:Y.name}),e.jsx(D,{variant:"caption",color:"text.secondary",sx:{wordBreak:"break-all"},children:Y.portfolioId})]}),e.jsx(ce,{label:`${o("snapshots.modals.createSnapshot.created")}: ${new Date(Y.createdAt).toLocaleDateString()}`,size:"small",color:"primary",variant:"outlined"})]})},Y.portfolioId))})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(he,{variant:A?"contained":"outlined",onClick:()=>L(!A),disabled:b,icon:e.jsx(xt,{}),size:"small",children:o(A?"snapshots.modals.createSnapshot.singleDateMode":"snapshots.modals.createSnapshot.dateRangeMode")}),e.jsx(D,{variant:"body2",color:"text.secondary",children:o(A?"snapshots.modals.createSnapshot.singleDateModeDescription":"snapshots.modals.createSnapshot.dateRangeModeDescription")})]}),A?e.jsxs(l,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(Ae,{type:"date",label:o("snapshots.modals.createSnapshot.startDate"),value:T,onChange:Y=>M(Y.target.value),InputLabelProps:{shrink:!0},disabled:b,sx:{flex:1,minWidth:200}}),e.jsx(Ae,{type:"date",label:o("snapshots.modals.createSnapshot.endDate"),value:O,onChange:Y=>I(Y.target.value),InputLabelProps:{shrink:!0},disabled:b,sx:{flex:1,minWidth:200}})]}):e.jsx(Ae,{fullWidth:!0,type:"date",label:o("snapshots.modals.createSnapshot.snapshotDate"),value:T,onChange:Y=>M(Y.target.value),InputLabelProps:{shrink:!0},disabled:b}),C.type&&e.jsx(je,{severity:C.type,icon:C.type==="success"?e.jsx(Xe,{}):C.type==="info"?e.jsx(on,{}):e.jsx(qn,{}),onClose:()=>k({type:null,message:""}),children:C.message})]})})},EP=({open:r,onClose:t,portfolioId:n,portfolioName:s,onSuccess:a,onError:i})=>{const{t:o}=Ne(),[d,u]=p.useState("date"),[h,m]=p.useState(""),[x,g]=p.useState(""),[f,y]=p.useState(""),[j,b]=p.useState(lr.DAILY),[v,P]=p.useState(!1),[w,C]=p.useState({type:null,message:""}),k=()=>{v||(C({type:null,message:""}),m(""),g(""),y(""),b(lr.DAILY),u("date"),t())},A=async()=>{var O,I;if(!n){C({type:"error",message:o("snapshots.modals.deleteSnapshots.portfolioIdRequired")});return}P(!0),C({type:null,message:""});try{let z;switch(d){case"date":if(!h){C({type:"error",message:o("snapshots.modals.deleteSnapshots.selectSnapshotDate")}),P(!1);return}z=await yn.deleteSnapshotsByDate(n,h,j);break;case"dateRange":if(!x||!f){C({type:"error",message:o("snapshots.modals.deleteSnapshots.selectBothDates")}),P(!1);return}if(new Date(x)>new Date(f)){C({type:"error",message:o("snapshots.modals.deleteSnapshots.startDateBeforeEndDate")}),P(!1);return}z=await yn.deleteSnapshotsByDateRange(n,x,f,j);break;case"granularity":z=await yn.deleteSnapshotsByGranularity(n,j);break;default:throw new Error(o("snapshots.modals.deleteSnapshots.invalidDeleteMode"))}C({type:"success",message:z.message}),a==null||a(z.deletedCount,z.message),setTimeout(()=>{k()},500)}catch(z){console.error("Failed to delete snapshots:",z);const N=((I=(O=z.response)==null?void 0:O.data)==null?void 0:I.message)||z.message||o("snapshots.modals.deleteSnapshots.failedToDelete");C({type:"error",message:N}),i==null||i(N)}finally{P(!1)}},L=()=>{switch(d){case"date":return o("snapshots.modals.deleteSnapshots.specificDateDescription");case"dateRange":return o("snapshots.modals.deleteSnapshots.dateRangeDescription");case"granularity":return o("snapshots.modals.deleteSnapshots.granularityDescription");default:return""}},T=e.jsx(l,{sx:{p:1.5,borderRadius:"50%",bgcolor:"error.light",color:"error.contrastText"},children:e.jsx(pt,{fontSize:"medium"})}),M=e.jsxs(e.Fragment,{children:[e.jsx(he,{variant:"text",onClick:k,disabled:v,sx:{textTransform:"none"},children:o("snapshots.modals.deleteSnapshots.cancel")}),e.jsx(We,{variant:"contained",color:"error",icon:v?void 0:e.jsx(pt,{}),mobileText:o("snapshots.modals.deleteSnapshots.delete"),desktopText:o("snapshots.modals.deleteSnapshots.deleteSnapshots"),onClick:A,disabled:v,forceTextOnly:!0,sx:{textTransform:"none",minWidth:140},children:o(v?"snapshots.modals.deleteSnapshots.deleting":"snapshots.modals.deleteSnapshots.deleteSnapshots")})]});return e.jsx(Rt,{open:r,onClose:k,title:`${o("snapshots.modals.deleteSnapshots.title")}${s?` - ${s}`:""}`,icon:T,actions:M,loading:v,maxWidth:"sm",titleColor:"error",size:"medium",children:e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:3,mt:2},children:[v&&e.jsx(ds,{sx:{mb:2}}),w.type&&e.jsx(je,{severity:w.type,icon:w.type==="error"?e.jsx(on,{}):void 0,onClose:()=>C({type:null,message:""}),children:w.message}),e.jsxs(l,{children:[e.jsx(c,{variant:"formLabel",sx:{mb:2,fontWeight:600},children:o("snapshots.modals.deleteSnapshots.deleteMode")}),e.jsxs(ft,{direction:"row",spacing:1,sx:{mb:2,flexWrap:"wrap"},children:[e.jsx(ce,{label:o("snapshots.modals.deleteSnapshots.specificDate"),onClick:()=>u("date"),color:d==="date"?"primary":"default",icon:e.jsx(Rr,{}),clickable:!0,size:"medium",sx:{mb:1}}),e.jsx(ce,{label:o("snapshots.modals.deleteSnapshots.dateRange"),onClick:()=>u("dateRange"),color:d==="dateRange"?"primary":"default",icon:e.jsx(Wp,{}),clickable:!0,size:"medium",sx:{mb:1}}),e.jsx(ce,{label:o("snapshots.modals.deleteSnapshots.byGranularity"),onClick:()=>u("granularity"),color:d==="granularity"?"primary":"default",icon:e.jsx(Zn,{}),clickable:!0,size:"medium",sx:{mb:1}})]}),e.jsx(c,{variant:"formHelper",color:"text.secondary",children:L()})]}),d==="granularity"&&e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:o("snapshots.modals.deleteSnapshots.granularity")}),e.jsxs(Ze,{value:j,onChange:O=>b(O.target.value),label:o("snapshots.modals.deleteSnapshots.granularity"),disabled:v,size:"medium",sx:{"& .MuiInputBase-input":{fontSize:{xs:"0.875rem",sm:"1rem"}},"& .MuiFormLabel-root":{fontSize:{xs:"0.875rem",sm:"1rem"}}},children:[e.jsx(re,{value:lr.DAILY,sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:o("snapshots.modals.deleteSnapshots.daily")}),e.jsx(re,{value:lr.WEEKLY,sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:o("snapshots.modals.deleteSnapshots.weekly")}),e.jsx(re,{value:lr.MONTHLY,sx:{fontSize:{xs:"0.875rem",sm:"1rem"}},children:o("snapshots.modals.deleteSnapshots.monthly")})]})]}),d==="date"&&e.jsx(Ae,{fullWidth:!0,type:"date",label:o("snapshots.modals.deleteSnapshots.snapshotDate"),value:h,onChange:O=>m(O.target.value),disabled:v,InputLabelProps:{shrink:!0},required:!0,helperText:o("snapshots.modals.deleteSnapshots.selectDate"),size:"medium",sx:{"& .MuiInputBase-input":{fontSize:{xs:"0.875rem",sm:"1rem"}},"& .MuiFormLabel-root":{fontSize:{xs:"0.875rem",sm:"1rem"}},"& .MuiFormHelperText-root":{fontSize:{xs:"0.75rem",sm:"0.875rem"}}}}),d==="dateRange"&&e.jsxs(l,{sx:{display:"flex",gap:2,flexWrap:"wrap"},children:[e.jsx(Ae,{type:"date",label:o("snapshots.modals.deleteSnapshots.startDate"),value:x,onChange:O=>g(O.target.value),disabled:v,InputLabelProps:{shrink:!0},required:!0,helperText:o("snapshots.modals.deleteSnapshots.startDateHelper"),size:"medium",sx:{flex:1,minWidth:200,"& .MuiInputBase-input":{fontSize:{xs:"0.875rem",sm:"1rem"}},"& .MuiFormLabel-root":{fontSize:{xs:"0.875rem",sm:"1rem"}},"& .MuiFormHelperText-root":{fontSize:{xs:"0.75rem",sm:"0.875rem"}}}}),e.jsx(Ae,{type:"date",label:o("snapshots.modals.deleteSnapshots.endDate"),value:f,onChange:O=>y(O.target.value),disabled:v,InputLabelProps:{shrink:!0},required:!0,helperText:o("snapshots.modals.deleteSnapshots.endDateHelper"),size:"medium",sx:{flex:1,minWidth:200,"& .MuiInputBase-input":{fontSize:{xs:"0.875rem",sm:"1rem"}},"& .MuiFormLabel-root":{fontSize:{xs:"0.875rem",sm:"1rem"}},"& .MuiFormHelperText-root":{fontSize:{xs:"0.75rem",sm:"0.875rem"}}}})]}),e.jsxs(je,{severity:"warning",icon:e.jsx(on,{}),sx:{"& .MuiAlert-message":{fontSize:{xs:"0.875rem",sm:"1rem"}}},children:[e.jsx(c,{variant:"formLabel",sx:{fontWeight:600},children:o("snapshots.modals.deleteSnapshots.warning")}),e.jsx(c,{variant:"formHelper",children:o("snapshots.modals.deleteSnapshots.warningDescription")})]})]})})},WP=({bulkCreateModalOpen:r,onBulkCreateModalClose:t,selectedPortfolioId:n,onBulkCreateSuccess:s,onBulkCreateError:a,onPortfolioRefresh:i,deleteModalOpen:o,onDeleteModalClose:d,onDeleteSuccess:u,onDeleteError:h,recalculateConfirmOpen:m,onRecalculateConfirmClose:x,onRecalculateConfirm:g,isRecalculating:f})=>e.jsxs(e.Fragment,{children:[e.jsx(LP,{open:r,onClose:t,selectedPortfolioId:n,onSuccess:s,onError:a,onPortfolioRefresh:i}),e.jsx(EP,{open:o,onClose:d,portfolioId:n||"",onSuccess:u,onError:h}),e.jsx(Cx,{open:m,onClose:x,onConfirm:g,isRecalculating:f})]}),FP=({open:r,onClose:t,onSuccess:n,onError:s,onPortfolioRefresh:a,selectedPortfolioId:i})=>{const{t:o}=Ne(),{accountId:d}=Ge(),u=Je(),h=Kt(),[m,x]=p.useState(""),[g,f]=p.useState([]),[y,j]=p.useState(!0),[b,v]=p.useState(lr.DAILY),[P,w]=p.useState(!1),[C,k]=p.useState({type:null,message:""}),[A,L]=p.useState({}),[T,M]=p.useState(!1),[O,I]=p.useState(new Date().toISOString().split("T")[0]),[z,N]=p.useState(new Date().toISOString().split("T")[0]),{portfolios:E=[],isLoading:R,error:V}=Un(d),F=E.find(Q=>Q.portfolioId===m),B=async Q=>{try{const Z=[h.invalidateQueries(["portfolio",Q]),h.invalidateQueries(["portfolio-analytics",Q]),h.invalidateQueries(["portfolio-snapshots",Q]),h.invalidateQueries(["snapshots",Q]),h.invalidateQueries(["portfolio-performance",Q]),h.invalidateQueries(["portfolio-allocation",Q]),h.invalidateQueries(["portfolio-positions",Q])];await Promise.all(Z),a&&a(Q)}catch(Z){console.error(" Error refreshing portfolio data:",Z)}};p.useEffect(()=>{r&&i&&x(i)},[r,i]),p.useEffect(()=>{E.length>0&&y&&f(E.map(Q=>Q.portfolioId))},[E,y]),p.useEffect(()=>{y&&E.length>0&&f(E.map(Q=>Q.portfolioId))},[y,E]),p.useEffect(()=>{r&&E.length>0&&d&&$()},[r,E,d]);const $=async()=>{try{const Q=await q.api.get("/api/v1/snapshots",{params:{accountId:d}}),Z=(Q==null?void 0:Q.data)||[],J={};E.forEach(ae=>{var pe;const ue=Z.filter(Me=>Me.portfolioId===ae.portfolioId),le=ue.sort((Me,Le)=>new Date(Le.snapshotDate).getTime()-new Date(Me.snapshotDate).getTime());J[ae.portfolioId]={lastSnapshotDate:(pe=le[0])==null?void 0:pe.snapshotDate,snapshotCount:ue.length}}),L(J)}catch(Q){console.warn("Failed to load snapshot info:",Q)}},Y=async()=>{var Q,Z,J,ae,ue,le,pe,Me,Le,qe,de,fe;if(y){if(g.length===0){k({type:"error",message:o("snapshots.modals.createSnapshot.selectAtLeastOnePortfolio")});return}}else if(!m){k({type:"error",message:o("snapshots.modals.createSnapshot.selectPortfolio")});return}if(!b){k({type:"error",message:o("snapshots.modals.createSnapshot.selectGranularity")});return}if(!O){k({type:"error",message:o("snapshots.modals.createSnapshot.selectStartDate")});return}if(T&&!z){k({type:"error",message:o("snapshots.modals.createSnapshot.selectEndDate")});return}if(T&&new Date(O)>new Date(z)){k({type:"error",message:o("snapshots.modals.createSnapshot.startDateBeforeEndDate")});return}if(new Date(O)>new Date){k({type:"error",message:o("snapshots.modals.createSnapshot.startDateNotFuture")});return}w(!0),k({type:null,message:""});try{const ie=new Date(O),Se=new Date(z),Ve=Math.ceil((Se.getTime()-ie.getTime())/(1e3*60*60*24))+1,Re=y?g.length:1,xe=Math.max(6e4,Ve*Re*3e3);(Ve>7||Re>5)&&k({type:"info",message:o("snapshots.modals.createSnapshot.processing",{days:Ve,portfolios:Re})});let te;if(y?te=await q.api.post("/api/v1/snapshots/portfolio/bulk",{portfolioIds:g,startDate:T?O:void 0,endDate:T?z:void 0,granularity:b,createdBy:d},{timeout:xe}):te=await q.api.post("/api/v1/snapshots/portfolio/bulk",{portfolioIds:[m],...T?{startDate:O,endDate:z,granularity:b,createdBy:d}:{startDate:O,granularity:b,createdBy:d}},{timeout:xe}),te&&te.status>=200&&te.status<300){const Ee=te.data;Ee.totalSnapshots>0?(k({type:"success",message:Ee.message||o("snapshots.modals.createSnapshot.successCreated",{count:Ee.totalSnapshots,portfolioName:y?`${Ee.totalPortfolios} portfolios`:(F==null?void 0:F.name)||"portfolio"})}),y?(Q=Ee.results)==null||Q.forEach(Ke=>{Ke.success&&(n==null||n(Ke.portfolioId,O),B(Ke.portfolioId))}):(n==null||n(m,O),await B(m)),setTimeout(()=>{_(),t()},2e3)):k({type:"info",message:o("snapshots.modals.createSnapshot.noSnapshotsCreated")})}else throw new Error("Invalid response from server")}catch(ie){console.error("Failed to create bulk snapshot:",ie),console.error("Error details:",{message:ie.message,status:(Z=ie.response)==null?void 0:Z.status,statusText:(J=ie.response)==null?void 0:J.statusText,data:(ae=ie.response)==null?void 0:ae.data,config:{url:(ue=ie.config)==null?void 0:ue.url,method:(le=ie.config)==null?void 0:le.method,params:(pe=ie.config)==null?void 0:pe.params}});const Se=((Le=(Me=ie.response)==null?void 0:Me.data)==null?void 0:Le.message)||ie.message||o("snapshots.modals.createSnapshot.errorCreating",{status:((qe=ie.response)==null?void 0:qe.status)||"Unknown",message:((fe=(de=ie.response)==null?void 0:de.data)==null?void 0:fe.message)||ie.message||"Unknown error"});k({type:"error",message:Se}),s==null||s(Se)}finally{w(!1)}},_=()=>{x(""),f([]),j(!0),v(lr.DAILY),M(!1),I(new Date().toISOString().split("T")[0]),N(new Date().toISOString().split("T")[0]),k({type:null,message:""})},K=()=>{P||(_(),t())},X=()=>{f(E.map(Q=>Q.portfolioId))},ne=()=>{f([])},oe=Q=>{f(Z=>Z.includes(Q)?Z.filter(J=>J!==Q):[...Z,Q])},ee=e.jsx(l,{sx:{p:1.5,borderRadius:"50%",bgcolor:U(u.palette.primary.main,.1),color:u.palette.primary.main,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(fa,{fontSize:"medium"})}),H=e.jsxs(e.Fragment,{children:[e.jsx(he,{variant:"text",onClick:K,disabled:P,mobileText:o("common.cancel"),desktopText:o("common.cancel"),sx:{textTransform:"none",minWidth:100},children:o("common.cancel")}),e.jsx(We,{variant:"contained",color:"primary",icon:P?e.jsx(Ce,{size:20}):e.jsx(xt,{}),mobileText:o("snapshots.modals.createSnapshot.create"),desktopText:o("snapshots.modals.createSnapshot.createSnapshot"),onClick:Y,disabled:(y?g.length===0:!m)||!O||!b||P||R,forceTextOnly:!0,sx:{textTransform:"none",minWidth:140},children:o(P?"snapshots.modals.createSnapshot.creating":"snapshots.modals.createSnapshot.createSnapshot")})]});return e.jsx(Rt,{open:r,onClose:K,title:o("snapshots.modals.createSnapshot.title"),icon:ee,actions:H,loading:P,maxWidth:"md",titleColor:"primary",size:"medium",children:e.jsxs(l,{sx:{px:2,mt:1},children:[e.jsx(an,{control:e.jsx(jn,{checked:y,onChange:Q=>j(Q.target.checked),disabled:P}),label:o("snapshots.modals.createSnapshot.createForMultiplePortfolios"),sx:{mb:3}}),y?e.jsxs(l,{sx:{mb:3},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(D,{variant:"h6",component:"div",sx:{mb:1},children:o("snapshots.modals.createSnapshot.selectPortfolios")}),e.jsxs(l,{sx:{display:"flex",gap:.5},children:[e.jsx(he,{variant:"text",size:"small",icon:e.jsx(Fp,{fontSize:"small"}),onClick:X,disabled:R,sx:{textTransform:"none",minWidth:"auto",px:1,py:.5,fontSize:"0.75rem","& .MuiButton-startIcon":{marginRight:.5}},children:o("common.selectAll")}),e.jsx(he,{variant:"text",size:"small",icon:e.jsx(zp,{fontSize:"small"}),onClick:ne,disabled:R,sx:{textTransform:"none",minWidth:"auto",px:1,py:.5,fontSize:"0.75rem","& .MuiButton-startIcon":{marginRight:.5}},children:o("common.deselectAll")})]})]}),R?e.jsx(l,{sx:{display:"flex",justifyContent:"center",p:3},children:e.jsx(Ce,{})}):V?e.jsxs(je,{severity:"error",sx:{m:2},children:[o("snapshots.modals.createSnapshot.failedToLoadPortfolios"),": ",String(V)]}):e.jsx(lt,{sx:{maxHeight:300,overflow:"auto",border:1,borderColor:"divider",borderRadius:1},children:E.map(Q=>{const Z=A[Q.portfolioId],J=g.includes(Q.portfolioId);return e.jsxs(Pe,{dense:!0,sx:{borderLeft:J?"4px solid":"4px solid transparent",borderLeftColor:J?"primary.main":"transparent",backgroundColor:J?"action.selected":"inherit","&:hover":{backgroundColor:"action.hover"},transition:"all 0.2s ease-in-out"},children:[e.jsx(tt,{sx:{minWidth:40},children:e.jsx(rn,{checked:J,onChange:()=>oe(Q.portfolioId),disabled:P,size:"small"})}),e.jsxs(l,{sx:{flex:1,ml:1},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:e.jsx(D,{variant:"subtitle2",component:"div",fontWeight:600,children:Q.name})}),e.jsx(l,{sx:{display:"flex",flexDirection:"column",gap:.5},children:Z!=null&&Z.lastSnapshotDate?e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(D,{variant:"caption",component:"span",color:"success.main",fontWeight:500,children:""}),e.jsxs(D,{variant:"caption",component:"span",color:"text.secondary",children:[o("snapshots.modals.createSnapshot.lastSnapshot"),": ",new Date(Z.lastSnapshotDate).toLocaleDateString()]})]}):e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(D,{variant:"caption",component:"span",color:"warning.main",fontWeight:500,children:""}),e.jsx(D,{variant:"caption",component:"span",color:"warning.main",children:o("snapshots.modals.createSnapshot.noSnapshots")})]})})]})]},Q.portfolioId)})}),g.length>0&&e.jsx(l,{sx:{mt:2},children:e.jsx(ce,{label:`${g.length} ${o("snapshots.modals.createSnapshot.portfoliosSelected")}`,color:"primary",variant:"outlined"})})]}):e.jsxs(nt,{fullWidth:!0,sx:{mb:2},children:[e.jsx(st,{shrink:!0,sx:{backgroundColor:"background.paper",px:1,"&.Mui-focused":{color:"primary.main"}},children:o("snapshots.modals.createSnapshot.selectPortfolio")}),e.jsx(Ze,{value:m,onChange:Q=>x(Q.target.value),disabled:P||R,label:o("snapshots.modals.createSnapshot.selectPortfolio"),children:R?e.jsxs(re,{disabled:!0,children:[e.jsx(Ce,{size:20,sx:{mr:1}}),o("snapshots.modals.createSnapshot.loadingPortfolios")]}):E.map(Q=>e.jsx(re,{value:Q.portfolioId,children:Q.name},Q.portfolioId))})]}),e.jsx(an,{control:e.jsx(jn,{checked:T,onChange:Q=>M(Q.target.checked),disabled:P}),label:o("snapshots.modals.createSnapshot.useDateRange"),sx:{mb:2}}),e.jsxs(l,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(Ae,{fullWidth:!0,label:o("snapshots.modals.createSnapshot.startDate"),type:"date",value:O,onChange:Q=>I(Q.target.value),disabled:P,InputLabelProps:{shrink:!0}}),T&&e.jsx(Ae,{fullWidth:!0,label:o("snapshots.modals.createSnapshot.endDate"),type:"date",value:z,onChange:Q=>N(Q.target.value),disabled:P,InputLabelProps:{shrink:!0}})]}),C.type&&e.jsx(je,{severity:C.type,sx:{mb:1},icon:C.type==="success"?e.jsx(Xe,{}):C.type==="error"?e.jsx(qn,{}):C.type==="info"?e.jsx(on,{}):void 0,children:C.message})]})})},zP=({portfolioId:r})=>{const{t}=Ne(),{accountId:n}=Ge(),[s,a]=p.useState(r),[i,o]=p.useState(!1),[d,u]=p.useState(!1),[h,m]=p.useState(!1),[x,g]=p.useState({open:!1,message:"",severity:"info"}),[f,y]=p.useState(0),[j,b]=p.useState(!1),[v,P]=p.useState(!1),w=p.useMemo(()=>s?{portfolioId:s}:{},[s]),{deleteSnapshot:C,bulkRecalculateSnapshots:k,refreshSnapshots:A}=Px(w),{refreshPortfolioSnapshots:L}=Dx({portfolioId:s,autoFetch:!0}),T=(R,V)=>{g({open:!0,message:R,severity:V})},M=async R=>{try{await C(R.id),A(),T(t("snapshots.snapshotDeletedSuccess"),"success")}catch(V){console.error("Failed to delete snapshot:",V),T(t("snapshots.snapshotDeleteFailed"),"error")}},O=()=>{P(!0)},I=async()=>{P(!1),b(!0),T(t("snapshots.recalculating"),"info");try{const R=await k(s,n);if(R.status==="PROCESSING"){T(`Bulk recalculate started. Processing ${R.dateRange?`${R.dateRange.startDate} to ${R.dateRange.endDate}`:"snapshots"} in background. Estimated duration: ${R.estimatedDuration}`,"info");const V=async()=>{try{const F=await yn.getBulkRecalculateStatus(s,R.trackingId);F.status==="completed"?(T(`Bulk recalculate completed: ${F.summary.totalSnapshots} snapshots across ${F.summary.successfulDates} dates`,"success"),await A(),await L(),y(B=>B+1),b(!1)):F.status==="failed"?(T("Bulk recalculate failed. Please try again.","error"),b(!1)):F.status==="in_progress"||F.status==="started"?setTimeout(V,5e3):(T("Bulk recalculate status unknown. Please check manually.","warning"),b(!1))}catch(F){console.error("Failed to get bulk recalculate status:",F),T("Failed to get recalculate status. Please check manually.","error"),b(!1)}};setTimeout(V,2e3)}}catch(R){console.error("Failed to bulk recalculate snapshots:",R),T(t("snapshots.recalculateFailed"),"error"),b(!1)}},z=()=>{P(!1)},N=(R,V)=>{T(V,"success"),A()},E=R=>{T(`${t("snapshots.deleteFailed")}: ${R}`,"error")};return e.jsxs(l,{sx:{minHeight:"100vh",display:"flex",flexDirection:"column",bgcolor:"grey.50"},children:[e.jsxs(Te,{elevation:1,sx:{p:3,borderRadius:0,borderBottom:1,borderColor:"divider",bgcolor:"white"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"pageTitle",sx:{color:"text.primary",mb:.5},children:t("snapshots.title")}),e.jsx(c,{variant:"pageSubtitle",sx:{color:"text.secondary"},children:t("snapshots.subtitle")})]}),e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:2},children:e.jsx(We,{variant:"contained",color:"secondary",icon:e.jsx(fa,{}),mobileText:t("snapshots.createForAllPortfolios"),desktopText:t("snapshots.createForAllPortfolios"),onClick:()=>u(!0),size:"medium",sx:{textTransform:"none",fontWeight:600},children:t("snapshots.createForAllPortfolios")})})]}),e.jsx(NP,{selectedPortfolioId:s,onPortfolioChange:a})]}),s&&e.jsxs(l,{sx:{p:2,bgcolor:"white",borderBottom:1,borderColor:"divider",display:"flex",gap:2,flexWrap:"wrap",alignItems:"center"},children:[e.jsx(We,{variant:"contained",icon:e.jsx(fa,{}),mobileText:t("snapshots.createSnapshots"),desktopText:t("snapshots.createSnapshots"),onClick:()=>o(!0),size:"medium",sx:{textTransform:"none",fontWeight:600},children:t("snapshots.createSnapshots")}),e.jsx(We,{variant:"outlined",color:"warning",icon:j?e.jsx(Ce,{size:20}):e.jsx(Mt,{}),mobileText:t(j?"snapshots.recalculating":"snapshots.recalculateAll"),desktopText:t(j?"snapshots.recalculating":"snapshots.recalculateAll"),onClick:O,disabled:j,size:"medium",sx:{textTransform:"none"},children:t(j?"snapshots.recalculating":"snapshots.recalculateAll")}),e.jsx(We,{variant:"outlined",color:"error",icon:e.jsx(pt,{}),mobileText:t("snapshots.deleteSnapshots"),desktopText:t("snapshots.deleteSnapshots"),onClick:()=>m(!0),size:"medium",sx:{textTransform:"none"},children:t("snapshots.deleteSnapshots")})]}),j&&e.jsx(ds,{sx:{position:"fixed",top:0,left:0,right:0,zIndex:9999,height:4}}),e.jsx(l,{sx:{flexGrow:1},children:s?e.jsx(l,{sx:{p:2},children:e.jsx(MP,{portfolioId:s,onSnapshotSelect:()=>{},onSnapshotDelete:M,showActions:!0,pageSize:10,refreshTrigger:f,onPortfolioRefresh:()=>{y(R=>R+1),A(),L()}},s)}):e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"grey.50",width:"100%"},children:e.jsx(l,{sx:{p:6,textAlign:"center",width:"100%"},children:e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:t("snapshots.selectPortfolioPlaceholder")})})})}),e.jsx(di,{open:x.open,autoHideDuration:6e3,onClose:()=>g(R=>({...R,open:!1})),anchorOrigin:{vertical:"top",horizontal:"right"},sx:{mt:6,"& .MuiSnackbarContent-root":{minWidth:"300px",maxWidth:"500px"}},children:e.jsx(je,{onClose:()=>g(R=>({...R,open:!1})),severity:x.severity,sx:{width:"100%",fontSize:"0.875rem",fontWeight:500},children:x.message})}),e.jsx(WP,{bulkCreateModalOpen:i,onBulkCreateModalClose:()=>o(!1),selectedPortfolioId:s,onBulkCreateSuccess:(R,V)=>{T(`${t("snapshots.snapshotCreatedSuccess")} ${V}`,"success"),A(),L(),y(F=>F+1)},onBulkCreateError:R=>{T(`${t("snapshots.snapshotCreateFailed")}: ${R}`,"error")},onPortfolioRefresh:()=>{y(R=>R+1)},deleteModalOpen:h,onDeleteModalClose:()=>m(!1),onDeleteSuccess:N,onDeleteError:E,recalculateConfirmOpen:v,onRecalculateConfirmClose:z,onRecalculateConfirm:I,isRecalculating:j}),e.jsx(FP,{open:d,onClose:()=>u(!1),onSuccess:(R,V)=>{T(`${t("snapshots.snapshotCreatedSuccess")} ${V}`,"success"),A(),L(),y(F=>F+1)},onError:R=>{T(`${t("snapshots.snapshotCreateFailed")}: ${R}`,"error")},onPortfolioRefresh:()=>{y(R=>R+1)},selectedPortfolioId:s})]})},OP=()=>e.jsx(Go,{permission:"financial.snapshots.manage",children:e.jsx(VP,{})}),VP=()=>{const{t:r}=Ne(),t=Je();return e.jsxs(l,{children:[e.jsx(l,{sx:{mb:4},children:e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:2},children:e.jsxs(l,{children:[e.jsx(c,{variant:"pageHeader",component:"h1",sx:{background:`linear-gradient(135deg, ${t.palette.primary.main} 0%, ${t.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1,filter:"none"},children:r("snapshots.pageTitle")}),e.jsx(c,{variant:"pageSubtitle",sx:{mb:1},children:r("snapshots.pageSubtitle")})]})})})}),e.jsx(Te,{sx:{p:0,borderRadius:2,boxShadow:1},children:e.jsx(zP,{})})]})},$P=({open:r,onClose:t,transaction:n,onTransactionUpdated:s})=>{const{t:a}=Ne(),[i,o]=p.useState({units:0,amount:0,description:"",transactionDate:""}),[d,u]=p.useState(!1),[h,m]=p.useState(null),[x,g]=p.useState({});p.useEffect(()=>{var w,C;n&&(o({units:n.transaction.units||0,amount:n.transaction.amount||0,description:((w=n.cashFlow)==null?void 0:w.description)||"",transactionDate:(C=n.cashFlow)!=null&&C.flowDate?new Date(n.cashFlow.flowDate).toISOString().split("T")[0]:new Date(n.transaction.createdAt).toISOString().split("T")[0]}),m(null),g({}))},[n]);const f=()=>{const w={};return(!i.units||i.units<=0)&&(w.units=a("holdings.edit.validation.unitsRequired")),(!i.amount||i.amount<=0)&&(w.amount=a("holdings.edit.validation.amountRequired")),i.transactionDate||(w.transactionDate=a("holdings.edit.validation.dateRequired")),g(w),Object.keys(w).length===0},y=async()=>{var w,C;if(!(!n||!f())){u(!0),m(null);try{await q.updateHoldingTransaction(n.transaction.transactionId,{units:i.units,amount:i.amount,description:i.description,transactionDate:new Date(i.transactionDate).toISOString()}),s(),t()}catch(k){console.error("Error updating transaction:",k),m(((C=(w=k.response)==null?void 0:w.data)==null?void 0:C.message)||a("holdings.edit.error.updateFailed"))}finally{u(!1)}}},j=()=>{d||(m(null),g({}),t())};if(!n)return null;const b=n.transaction.holdingType==="SUBSCRIBE",v=n.transaction.navPerUnit,P=e.jsxs(e.Fragment,{children:[e.jsx(he,{onClick:j,disabled:d,size:"large",children:a("common.cancel")}),e.jsx(We,{onClick:y,variant:"contained",disabled:d,size:"large",icon:d?e.jsx(Ce,{size:20}):e.jsx(Tt,{}),mobileText:a("common.update"),desktopText:a("holdings.edit.updateTransaction"),forceTextOnly:!0,children:a(d?"holdings.edit.updating":"holdings.edit.updateTransaction")})]});return e.jsx(Rt,{open:r,onClose:j,title:a("holdings.edit.title",{type:""}),icon:e.jsx(Tt,{color:"primary"}),actions:P,loading:d,maxWidth:"md",fullWidth:!0,titleColor:"primary",size:"medium",children:e.jsxs(l,{sx:{pt:1},children:[e.jsx(l,{sx:{mb:3,backgroundColor:"grey.50",borderRadius:2,p:2},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:6,children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:a("holdings.edit.transactionType")}),e.jsx(ce,{label:n.transaction.holdingType,color:b?"success":"warning",size:"small",sx:{mt:.5}})]}),e.jsxs(W,{item:!0,xs:6,children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:a("holdings.edit.navPerUnit")}),e.jsx(c,{variant:"cardValue",color:"primary",children:G(v,"VND")})]})]})}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(gi,{value:i.units,onChange:w=>{o(C=>({...C,units:w})),x.units&&g(C=>({...C,units:void 0}))},label:a("holdings.edit.units"),placeholder:a("holdings.edit.unitsPlaceholder"),helperText:x.units,error:!!x.units,disabled:d,decimalPlaces:3,min:.001,step:.001,showThousandsSeparator:!0,align:"right",required:!0})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(vr,{value:i.amount,onChange:w=>{o(C=>({...C,amount:w})),x.amount&&g(C=>({...C,amount:void 0}))},label:a("holdings.edit.amount"),placeholder:a("holdings.edit.amountPlaceholder"),helperText:x.amount,error:!!x.amount,disabled:d,currency:"VND",showCurrency:!0,align:"right",required:!0})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(Ae,{fullWidth:!0,label:a("holdings.edit.transactionDate"),type:"date",value:i.transactionDate,onChange:w=>{o(C=>({...C,transactionDate:w.target.value})),x.transactionDate&&g(C=>({...C,transactionDate:void 0}))},error:!!x.transactionDate,helperText:x.transactionDate,disabled:d,InputLabelProps:{shrink:!0},inputProps:{max:new Date().toISOString().split("T")[0]}})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(Ae,{fullWidth:!0,label:a("holdings.edit.description"),value:i.description,onChange:w=>{o(C=>({...C,description:w.target.value})),x.description&&g(C=>({...C,description:void 0}))},disabled:d,placeholder:a("holdings.edit.descriptionPlaceholder"),helperText:x.description,error:!!x.description})})]}),e.jsxs(l,{sx:{mt:3,p:2,backgroundColor:"info.50",borderRadius:2,border:"1px solid",borderColor:"info.200"},children:[e.jsx(c,{variant:"pageSubtitle",color:"info.main",gutterBottom:!0,children:a("holdings.edit.calculationSummary")}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:4,children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:a("holdings.edit.units")}),e.jsx(c,{variant:"cardValue",color:"primary",children:Vn(i.units,3)})]}),e.jsxs(W,{item:!0,xs:4,children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:a("holdings.edit.navPerUnit")}),e.jsx(c,{variant:"cardValue",color:"primary",children:G(v,"VND")})]}),e.jsxs(W,{item:!0,xs:4,children:[e.jsx(c,{variant:"labelSmall",color:"text.secondary",children:a("holdings.edit.calculatedAmount")}),e.jsx(c,{variant:"cardValue",color:"primary",children:G((i.units||0)*v,"VND")})]})]}),Math.abs((i.units||0)*v-(i.amount||0))>.01&&e.jsx(je,{severity:"warning",sx:{mt:2},children:e.jsx(c,{variant:"labelSmall",ellipsis:!1,children:a("holdings.edit.amountDifferenceNote",{calculated:G((i.units||0)*v,"VND"),entered:G(i.amount||0,"VND")})})})]}),h&&e.jsx(je,{severity:"error",sx:{mt:2},children:e.jsx(c,{variant:"tableCell",children:h})}),e.jsxs(je,{severity:"info",sx:{mt:2},children:[e.jsx(c,{variant:"labelSmall",sx:{mt:1},ellipsis:!1,children:a("holdings.edit.recalculationMessage")}),e.jsxs(l,{component:"ul",sx:{mt:1,pl:2,mb:0},children:[e.jsx(c,{component:"li",variant:"labelSmall",ellipsis:!1,children:a("holdings.edit.recalculationItem1")}),e.jsx(c,{component:"li",variant:"labelSmall",ellipsis:!1,children:a("holdings.edit.recalculationItem2")}),e.jsx(c,{component:"li",variant:"labelSmall",ellipsis:!1,children:a("holdings.edit.recalculationItem3")})]}),e.jsx(c,{variant:"labelSmall",sx:{mt:1,fontStyle:"italic"},ellipsis:!1,children:a("holdings.edit.recalculationDate",{date:i.transactionDate||a("common.currentDate")})})]})]})})},HP=()=>{var ne,oe,ee,H,Q;const{t:r}=Ne(),{holdingId:t}=So(),n=An(),s=Pa(),[a,i]=p.useState(null),[o,d]=p.useState(!0),[u,h]=p.useState(null),[m,x]=p.useState(!1),[g,f]=p.useState(null),[y,j]=p.useState(!1),[b,v]=p.useState(null),[P,w]=p.useState(!1),[C,k]=p.useState(!1),[A,L]=p.useState(!1),[T,M]=p.useState(!1);p.useEffect(()=>{t&&O()},[t]);const O=async()=>{try{d(!0),h(null);const Z=await q.getHoldingDetail(t);Z.summary.returnPercentage=(Z.holding.currentValue-Z.holding.totalInvestment)/Z.holding.totalInvestment*100,i(Z)}catch(Z){console.error("Error fetching holding detail:",Z),h(r("holdings.error.loadDetailsFailed"))}finally{d(!1)}},I=()=>{var J;new URLSearchParams(s.search).get("from")==="nav"&&((J=a==null?void 0:a.holding)!=null&&J.portfolioId)?n(`/portfolios/${a.holding.portfolioId}?tab=5`):n(-1)},z=Z=>{f(Z),x(!0)},N=()=>{O()},E=Z=>{v(Z),j(!0)},R=async()=>{if(b)try{w(!0),await q.deleteHoldingTransaction(b.transaction.transactionId),j(!1),v(null),await O()}catch(Z){console.error("Error deleting transaction:",Z),h(r("holdings.error.deleteTransactionFailed"))}finally{w(!1)}},V=()=>{j(!1),v(null)},F=async()=>{var Z;if((Z=a==null?void 0:a.holding)!=null&&Z.portfolioId)try{k(!0),await q.refreshNavPerUnit(a.holding.portfolioId),await q.recalculateAllHoldings(a.holding.portfolioId),await O()}catch(J){console.error("Error recalculating NAV:",J),h(r("holdings.error.recalculateNavFailed"))}finally{k(!1)}},B=()=>{L(!1),O()},$=()=>{M(!1),O()},Y=Z=>{if(Z==null)return null;const J=typeof Z=="string"?parseFloat(Z):Z;return isNaN(J)?null:J>=0?e.jsx(He,{}):e.jsx(Bt,{})};if(o)return e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsx(Ce,{})});if(u)return e.jsxs(xn,{maxWidth:"lg",sx:{mt:4},children:[e.jsx(je,{severity:"error",sx:{mb:2},children:e.jsx(c,{variant:"tableCell",children:u})}),e.jsx(he,{variant:"outlined",icon:e.jsx(Kr,{}),onClick:()=>n(-1),mobileText:"Back",desktopText:"Go Back",children:"Go Back"})]});if(!a)return e.jsx(xn,{maxWidth:"lg",sx:{mt:4},children:e.jsx(je,{severity:"info",children:e.jsx(c,{variant:"tableCell",children:r("holdings.error.noDetailsFound")})})});const{holding:_,transactions:K,summary:X}=a;return e.jsxs(xn,{maxWidth:"xl",sx:{mt:.5,mb:1},children:[e.jsxs(l,{sx:{mb:2,position:"sticky",top:0,zIndex:100,backgroundColor:"#ffffff",pt:1,pb:1,backdropFilter:"blur(8px)",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[e.jsx(he,{variant:"text",icon:e.jsx(Kr,{}),onClick:I,mobileText:r("common.back"),desktopText:r("holdings.actions.backToPortfolio"),sx:{mb:1.5,textTransform:"none"},children:r("holdings.actions.backToPortfolio")}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mx:{xs:1,sm:2},p:{xs:1.5,sm:2},borderRadius:2,backgroundColor:"#f8f9fa",border:"1px solid #e9ecef",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(Vt,{sx:{bgcolor:"primary.main",width:48,height:48,boxShadow:"0 4px 8px rgba(0,0,0,0.1)",display:{xs:"none",sm:"flex"}},children:e.jsx(Ue,{})}),e.jsxs(l,{children:[e.jsx(c,{variant:"pageTitle",sx:{fontWeight:700,color:"primary.main"},children:(ne=_.account)==null?void 0:ne.name}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",sx:{display:{xs:"none",sm:"block"}},children:r("holdings.detail.investmentIn",{portfolioName:(oe=_.portfolio)==null?void 0:oe.name})})]})]}),e.jsxs(l,{sx:{display:"flex",gap:1.5,flexWrap:"wrap"},children:[e.jsx(We,{size:"small",variant:"contained",color:"success",icon:e.jsx(xt,{}),onClick:()=>L(!0),mobileText:r("nav.holdings.newSubscription"),desktopText:r("nav.holdings.newSubscription"),sx:{minWidth:"120px",textTransform:"none",boxShadow:"0 2px 8px rgba(34, 197, 94, 0.3)","&:hover":{boxShadow:"0 4px 12px rgba(34, 197, 94, 0.4)"}},children:r("nav.holdings.newSubscription")}),e.jsx(We,{size:"small",variant:"contained",color:"warning",icon:e.jsx(ja,{}),onClick:()=>M(!0),mobileText:r("nav.holdings.processRedemption"),desktopText:r("nav.holdings.processRedemption"),sx:{minWidth:"120px",textTransform:"none",boxShadow:"0 2px 8px rgba(245, 158, 11, 0.3)","&:hover":{boxShadow:"0 4px 12px rgba(245, 158, 11, 0.4)"}},children:r("nav.holdings.processRedemption")}),e.jsx(We,{size:"small",variant:"contained",color:"primary",icon:C?e.jsx(Ce,{size:20}):e.jsx(ar,{}),onClick:F,disabled:C,mobileText:r(C?"holdings.actions.recalculating":"holdings.actions.recalculate"),desktopText:r(C?"holdings.actions.recalculating":"holdings.actions.recalculateNav"),sx:{minWidth:"160px",textTransform:"none",boxShadow:"0 2px 8px rgba(25, 118, 210, 0.3)","&:hover":{boxShadow:"0 4px 12px rgba(25, 118, 210, 0.4)"}},children:r(C?"holdings.actions.recalculating":"holdings.actions.recalculateNav")})]})]})]}),e.jsxs(W,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(W,{item:!0,xs:12,md:8,children:e.jsxs(ft,{spacing:2,children:[e.jsx(se,{sx:{background:"white",border:"1px solid #e9ecef",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:e.jsxs(me,{sx:{p:2},children:[e.jsx(c,{variant:"cardTitle",sx:{mb:2,fontWeight:600,color:"text.primary"},children:r("holdings.detail.portfolioPerformance")}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center",p:1.5,borderRadius:2},children:[e.jsx(c,{variant:"cardValue",sx:{fontWeight:700,color:"primary.main",mb:.5},children:G(_.currentValue,"VND")}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary",fontWeight:500},children:r("holdings.detail.currentValue")})]})}),e.jsx(W,{item:!0,xs:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center",p:1.5,borderRadius:2},children:[e.jsx(c,{variant:"cardValue",sx:{fontWeight:700,color:"text.primary",mb:.5},children:G(_.totalInvestment,"VND")}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary",fontWeight:500},children:r("holdings.detail.totalInvestment")})]})}),e.jsx(W,{item:!0,xs:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center",p:1.5,borderRadius:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:.5},children:[Y(_.unrealizedPnL),e.jsx(c,{variant:"cardValue",sx:{fontWeight:700,color:_.unrealizedPnL>=0?"success.main":"error.main",ml:.5},children:G(_.unrealizedPnL,"VND")})]}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary",fontWeight:500},children:r("holdings.detail.unrealizedPnL")})]})}),e.jsx(W,{item:!0,xs:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center",p:1.5,borderRadius:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:.5},children:[Y(X.returnPercentage),e.jsx(c,{variant:"cardValue",sx:{fontWeight:700,color:X.returnPercentage>=0?"success.main":"error.main",ml:.5},children:ye(X.returnPercentage,2)})]}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary",fontWeight:500},children:r("holdings.detail.returnPercent")})]})})]})]})}),e.jsx(se,{sx:{background:"white",border:"1px solid #e9ecef",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:e.jsxs(me,{sx:{p:2},children:[e.jsx(c,{variant:"cardTitle",sx:{mb:2,fontWeight:600,color:"text.primary"},children:r("holdings.detail.transactionSummary")}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center",p:1.5,borderRadius:2},children:[e.jsx(c,{variant:"cardValue",sx:{fontWeight:700,color:"primary.main"},children:X.totalTransactions}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary",fontWeight:500},children:r("holdings.detail.totalTransactions")})]})}),e.jsx(W,{item:!0,xs:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center",p:1.5,borderRadius:2},children:[e.jsx(c,{variant:"cardValue",sx:{fontWeight:700,color:"success.main"},children:X.totalSubscriptions}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary",fontWeight:500},children:r("holdings.detail.subscriptions")})]})}),e.jsx(W,{item:!0,xs:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center",p:1.5,borderRadius:2},children:[e.jsx(c,{variant:"cardValue",sx:{fontWeight:700,color:"warning.main"},children:X.totalRedemptions}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary",fontWeight:500},children:r("holdings.detail.redemptions")})]})}),e.jsx(W,{item:!0,xs:6,md:3,children:e.jsxs(l,{sx:{textAlign:"center",p:1.5,borderRadius:2},children:[e.jsx(c,{variant:"cardValue",sx:{fontWeight:700,color:"info.main"},children:Vn(X.totalUnitsSubscribed,3)}),e.jsx(c,{variant:"cardLabel",sx:{color:"text.secondary",fontWeight:500},children:r("holdings.detail.unitsSubscribed")})]})})]})]})})]})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsx(se,{sx:{height:"100%",background:"white",border:"1px solid #e9ecef",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:e.jsxs(me,{sx:{p:2},children:[e.jsx(c,{variant:"cardTitle",sx:{mb:2,fontWeight:600,color:"text.primary"},children:r("holdings.detail.holdingDetails")}),e.jsxs(lt,{dense:!0,children:[e.jsxs(Pe,{sx:{px:0,py:1,mb:1},children:[e.jsx(tt,{children:e.jsx(ar,{color:"primary"})}),e.jsx(ve,{primary:r("holdings.detail.totalUnits"),secondary:Vn(_.totalUnits,3),primaryTypographyProps:{sx:{color:"text.primary",fontWeight:600}},secondaryTypographyProps:{sx:{color:"text.secondary"}}})]}),e.jsxs(Pe,{sx:{px:0,py:1,mb:1},children:[e.jsx(tt,{children:e.jsx(mr,{color:"primary"})}),e.jsx(ve,{primary:r("holdings.detail.avgCostPerUnit"),secondary:G(_.avgCostPerUnit,"VND"),primaryTypographyProps:{sx:{color:"text.primary",fontWeight:600}},secondaryTypographyProps:{sx:{color:"text.secondary"}}})]}),e.jsx(Pe,{sx:{px:0,py:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",flex:1},children:[e.jsx(tt,{children:e.jsx(Zt,{color:"primary"})}),e.jsx(ve,{primary:r("holdings.detail.currentNav"),secondary:(ee=_.portfolio)!=null&&ee.navPerUnit?G(_.portfolio.navPerUnit,"VND"):_.totalUnits>0?G(_.currentValue/_.totalUnits,"VND"):"N/A",primaryTypographyProps:{sx:{color:"text.primary",fontWeight:600}},secondaryTypographyProps:{sx:{color:"text.secondary"}}})]})})]})]})})})]}),e.jsx(se,{sx:{background:"white",border:"1px solid #e9ecef",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:e.jsxs(me,{sx:{p:0},children:[e.jsx(l,{sx:{p:2,pb:0},children:e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,color:"text.primary"},children:r("holdings.detail.transactionHistory")})}),e.jsx(at,{children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{sx:{background:"#f8f9fa"},children:[e.jsx(S,{sx:{fontWeight:600,color:"text.primary"},children:e.jsx(c,{variant:"tableHeaderSmall",children:r("holdings.table.date")})}),e.jsx(S,{sx:{fontWeight:600,color:"text.primary"},children:e.jsx(c,{variant:"tableHeaderSmall",children:r("holdings.table.type")})}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary"},children:e.jsx(c,{variant:"tableHeaderSmall",children:r("holdings.table.units")})}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary"},children:e.jsx(c,{variant:"tableHeaderSmall",children:r("holdings.table.navPerUnit")})}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary"},children:e.jsx(c,{variant:"tableHeaderSmall",children:r("holdings.table.amount")})}),e.jsx(S,{sx:{fontWeight:600,color:"text.primary"},children:e.jsx(c,{variant:"tableHeaderSmall",children:r("holdings.table.description")})}),e.jsx(S,{align:"center",sx:{fontWeight:600,color:"text.primary"},children:e.jsx(c,{variant:"tableHeaderSmall",children:r("common.actions")})})]})}),e.jsx(ot,{children:K.map(({transaction:Z,cashFlow:J},ae)=>e.jsxs(De,{sx:{"&:hover":{background:"#f8f9fa"},background:ae%2===0?"white":"#fafbfc"},children:[e.jsx(S,{sx:{fontWeight:500,color:"text.primary"},children:e.jsx(c,{variant:"tableCellSmall",children:fn(new Date(Z.createdAt),"dd/MM/yyyy")})}),e.jsx(S,{children:e.jsx(ce,{label:Z.holdingType,color:Z.holdingType==="SUBSCRIBE"?"success":"warning",size:"small",sx:{fontWeight:500}})}),e.jsx(S,{align:"right",sx:{fontWeight:500,color:"text.primary"},children:e.jsx(c,{variant:"tableCellSmall",children:Vn(Z.units,3)})}),e.jsx(S,{align:"right",sx:{fontWeight:500,color:"text.primary"},children:e.jsx(c,{variant:"tableCellSmall",children:G(Z.navPerUnit,"VND")})}),e.jsx(S,{align:"right",sx:{fontWeight:600,color:"text.primary"},children:e.jsx(c,{variant:"tableCellSmall",children:G(Z.amount,"VND")})}),e.jsx(S,{sx:{color:"text.secondary"},children:e.jsx(c,{variant:"tableCellSmall",children:(J==null?void 0:J.description)||"N/A"})}),e.jsx(S,{align:"center",children:e.jsxs(ft,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(tr,{size:"small",onClick:()=>z({transaction:Z,cashFlow:J}),tooltip:"Edit Transaction",sx:{width:50,height:50,border:"1px solid",borderColor:"primary.main",color:"primary.main","&:hover":{backgroundColor:"primary.light",color:"white"}},children:e.jsx(Tt,{})}),e.jsx(tr,{size:"small",onClick:()=>E({transaction:Z,cashFlow:J}),tooltip:"Delete Transaction",sx:{width:50,height:50,border:"1px solid",borderColor:"error.main",color:"error.main","&:hover":{backgroundColor:"error.light",color:"white"}},children:e.jsx(pt,{})})]})})]},Z.transactionId))})]})})]})}),e.jsx($P,{open:m,onClose:()=>{x(!1),f(null)},transaction:g,onTransactionUpdated:N}),e.jsx(wx,{open:A,onClose:()=>L(!1),portfolio:(_==null?void 0:_.portfolio)||null,onSubscriptionSuccess:B,preselectedAccountId:(H=_==null?void 0:_.account)==null?void 0:H.accountId}),e.jsx(Sx,{open:T,onClose:()=>M(!1),portfolio:(_==null?void 0:_.portfolio)||null,onRedemptionSuccess:$,preselectedAccountId:(Q=_==null?void 0:_.account)==null?void 0:Q.accountId}),e.jsxs(kt,{open:y,onClose:V,maxWidth:"sm",fullWidth:!0,children:[e.jsxs(Et,{sx:{display:"flex",alignItems:"center",gap:1,color:"error.main",fontWeight:600},children:[e.jsx(pt,{color:"error"}),r("holdings.delete.title")]}),e.jsxs(Pt,{children:[e.jsx(c,{variant:"tableCell",sx:{mb:2},children:r("holdings.delete.message")}),b&&e.jsxs(se,{variant:"outlined",sx:{p:2,bgcolor:"grey.50"},children:[e.jsxs(c,{variant:"cardLabel",sx:{fontWeight:600,mb:1},children:[r("holdings.delete.transactionDetails"),":"]}),e.jsxs(c,{variant:"labelSmall",color:"text.secondary",children:[e.jsxs("strong",{children:[r("holdings.table.type"),":"]})," ",b.transaction.holdingType]}),e.jsxs(c,{variant:"labelSmall",color:"text.secondary",children:[e.jsxs("strong",{children:[r("holdings.table.units"),":"]})," ",Vn(b.transaction.units,3)]}),e.jsxs(c,{variant:"labelSmall",color:"text.secondary",children:[e.jsxs("strong",{children:[r("holdings.table.amount"),":"]})," ",G(b.transaction.amount,"VND")]}),e.jsxs(c,{variant:"labelSmall",color:"text.secondary",children:[e.jsxs("strong",{children:[r("holdings.table.date"),":"]})," ",fn(new Date(b.transaction.createdAt),"dd/MM/yyyy")]})]}),e.jsxs(je,{severity:"warning",sx:{mt:2},children:[e.jsx(c,{variant:"cardLabel",sx:{fontWeight:500},children:r("holdings.delete.recalculationImpact")}),e.jsx(c,{variant:"labelSmall",sx:{mt:1},children:r("holdings.delete.recalculationMessage")}),e.jsxs(l,{component:"ul",sx:{mt:1,pl:2,mb:0},children:[e.jsx(c,{component:"li",variant:"labelSmall",children:r("holdings.delete.recalculationItem1")}),e.jsx(c,{component:"li",variant:"labelSmall",children:r("holdings.delete.recalculationItem2")}),e.jsx(c,{component:"li",variant:"labelSmall",children:r("holdings.delete.recalculationItem3")})]}),e.jsx(c,{variant:"labelSmall",sx:{mt:1,fontStyle:"italic"},children:r("holdings.delete.recalculationDate",{date:b?fn(new Date(b.transaction.createdAt),"dd/MM/yyyy"):"N/A"})})]})]}),e.jsxs(Dt,{sx:{p:2},children:[e.jsx(he,{onClick:V,disabled:P,size:"large",mobileText:r("common.cancel"),desktopText:r("common.cancel"),children:r("common.cancel")}),e.jsx(We,{onClick:R,variant:"contained",color:"error",disabled:P,size:"large",icon:P?e.jsx(Ce,{size:20}):e.jsx(pt,{}),forceTextOnly:!0,mobileText:r(P?"holdings.delete.deleting":"common.delete"),desktopText:r(P?"holdings.delete.deleting":"holdings.delete.deleteTransaction"),children:r(P?"holdings.delete.deleting":"holdings.delete.deleteTransaction")})]})]})]})},BP=r=>{const[t,n]=p.useState([]),[s,a]=p.useState(!1),[i,o]=p.useState(null),d=async()=>{if(!r){n([]);return}a(!0),o(null);try{const u=await q.getInvestorHoldings(r);n(u)}catch(u){o(u instanceof Error?u.message:"Failed to fetch investor holdings"),n([])}finally{a(!1)}};return p.useEffect(()=>{d()},[r]),{holdings:t,isLoading:s,error:i,refetch:d}},UP=({open:r,onClose:t,holdingId:n,holdingName:s="Holding Details"})=>{const{t:a}=Ne(),i=Je(),o=Nt(i.breakpoints.down("md")),[d,u]=p.useState(null),[h,m]=p.useState(!1),[x,g]=p.useState(null),f=async()=>{if(n){m(!0),g(null);try{const w=await q.getHoldingDetail(n);u(w)}catch(w){g(w instanceof Error?w.message:a("holdings.error.fetchDetailsFailed"))}finally{m(!1)}}};p.useEffect(()=>{r&&n&&f()},[r,n]);const y=w=>w.holdingType==="SUBSCRIBE"?e.jsx(He,{}):e.jsx(Bt,{}),j=w=>w.holdingType==="SUBSCRIBE"?"success":"error",b=w=>w.holdingType==="SUBSCRIBE"?a("holdings.transaction.subscription"):a("holdings.transaction.redemption"),P=(d?[{title:a("holdings.modal.totalSubscriptions"),value:d.summary.totalSubscriptions,subtitle:a("holdings.modal.subscriptionCount"),icon:e.jsx(He,{}),color:"success",hideOnMobile:!0},{title:a("holdings.modal.totalRedemptions"),value:d.summary.totalRedemptions,subtitle:a("holdings.modal.redemptionCount"),icon:e.jsx(Bt,{}),color:"error",hideOnMobile:!0},{title:a("holdings.modal.totalFundUnits"),value:Vn((d.summary.totalUnitsSubscribed||0)-(d.summary.totalUnitsRedeemed||0),2),subtitle:a("holdings.modal.totalUnitsHeld"),icon:e.jsx(Zt,{}),color:"primary",hideOnMobile:!1},{title:a("holdings.modal.totalInvested"),value:G((d.summary.totalAmountInvested||0)-(d.summary.totalAmountReceived||0),"VND"),subtitle:a("holdings.modal.amountInvested"),icon:e.jsx(mr,{}),color:"info",hideOnMobile:!1}]:[]).filter(w=>!o||!w.hideOnMobile);return e.jsx(Rt,{open:r,onClose:t,title:e.jsxs(l,{children:[e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,color:"text.primary",fontSize:"1.25rem"},children:s}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:a("holdings.modal.subtitle")})]}),loading:h,maxWidth:"xl",size:"small",titleColor:"primary",actions:e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:1},children:e.jsx(he,{onClick:t,variant:"outlined",sx:{borderRadius:2},children:a("common.close")})}),children:x?e.jsxs(je,{severity:"error",sx:{m:3,borderRadius:2},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,children:a("holdings.error.loadDetailsFailed")}),e.jsx(c,{variant:"tableCell",children:x}),e.jsx(he,{onClick:f,sx:{mt:1},children:a("common.tryAgain")})]}):d?e.jsxs(l,{children:[e.jsxs(l,{sx:{px:{xs:0,sm:1,md:2},py:2},children:[e.jsx(c,{variant:"cardTitle",sx:{mb:2,fontWeight:600},children:a("holdings.modal.summary")}),e.jsx(W,{container:!0,spacing:2,children:P.map((w,C)=>e.jsx(W,{item:!0,xs:6,sm:6,md:3,children:e.jsx(se,{sx:{height:"100%",background:`linear-gradient(135deg, ${U(i.palette[w.color].main,.06)} 0%, ${U(i.palette[w.color].main,.03)} 100%)`,border:`0.5px solid ${U(i.palette[w.color].main,.15)}`,borderRadius:2},children:e.jsx(me,{sx:{p:2},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(l,{sx:{borderRadius:"50%",background:U(i.palette[w.color].main,.08),color:`${w.color}.main`,width:40,height:40,display:{xs:"none",sm:"flex"},alignItems:"center",justifyContent:"center",flexShrink:0},children:rt.cloneElement(w.icon,{sx:{fontSize:20}})}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"cardLabel",sx:{color:"text.primary",mb:.5},children:w.title}),e.jsx(c,{variant:"cardValue",sx:{fontWeight:600,color:"text.primary",mb:.5},children:w.value})]})]})})})},C))})]}),e.jsx(bt,{}),e.jsxs(l,{sx:{px:{xs:0,sm:1,md:2},py:2},children:[e.jsx(c,{variant:"cardTitle",sx:{mb:2,fontWeight:600},children:a("holdings.detail.transactionHistory")}),d.transactions.length===0?e.jsxs(l,{sx:{textAlign:"center",py:6,background:`linear-gradient(135deg, ${U(i.palette.background.paper,.5)} 0%, ${U(i.palette.background.paper,.3)} 100%)`,borderRadius:2,border:`1px solid ${U(i.palette.divider,.1)}`},children:[e.jsx(qt,{sx:{fontSize:60,color:"text.secondary",mb:2}}),e.jsx(c,{variant:"cardTitle",color:"text.secondary",children:a("holdings.modal.noTransactions")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:a("holdings.modal.noTransactionsMessage")})]}):e.jsx(at,{component:Te,variant:"outlined",sx:{borderRadius:2},children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:U(i.palette.primary.main,.02)},children:[e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:a("holdings.table.type")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:a("holdings.table.units")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:a("holdings.table.navPerUnit")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:a("holdings.table.amount")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:a("holdings.table.date")})})]})}),e.jsx(ot,{children:d.transactions.map(w=>e.jsxs(De,{sx:{"&:hover":{backgroundColor:U(i.palette.primary.main,.02)}},children:[e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(l,{sx:{borderRadius:"50%",background:U(i.palette[j(w.transaction)].main,.1),color:`${j(w.transaction)}.main`,width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center"},children:rt.cloneElement(y(w.transaction),{sx:{fontSize:16}})}),e.jsx(l,{children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:600},children:b(w.transaction)})})]})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:Vn(Number(w.transaction.units),2)})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCell",children:G(Number(w.transaction.navPerUnit),"VND")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:600,color:w.transaction.holdingType==="SUBSCRIBE"?"success.main":"error.main"},children:G(Number(w.transaction.amount),"VND")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:fn(_r(w.transaction.createdAt),"MMM dd, yyyy")})})]},w.transaction.transactionId))})]})})]})]}):null})},_P=()=>{var I,z;const{t:r}=Ne(),t=An(),n=Je(),{accountId:s}=Ge(),{holdings:a,isLoading:i,error:o,refetch:d}=BP(s),[u,h]=p.useState(null),[m,x]=p.useState(""),[g,f]=p.useState(!1),y=a.length,j=a.reduce((N,E)=>N+Number(E.totalInvestment),0),b=a.reduce((N,E)=>N+Number(E.currentValue),0),v=a.reduce((N,E)=>N+Number(E.unrealizedPnL),0),P=a.reduce((N,E)=>N+Number(E.realizedPnL),0),w=v+P,C=j>0?w/j*100:0,k=((z=(I=a.find(N=>{var E;return(E=N.portfolio)==null?void 0:E.baseCurrency}))==null?void 0:I.portfolio)==null?void 0:z.baseCurrency)||"VND",A=N=>{t(`/portfolios/${N}`)},L=()=>{d()},T=(N,E)=>{h(N),x(E),f(!0)},M=()=>{f(!1),h(null),x("")};if(i)return e.jsxs(l,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"400px",sx:{background:`linear-gradient(135deg, ${U(n.palette.primary.main,.05)} 0%, ${U(n.palette.primary.main,.02)} 100%)`,borderRadius:3,p:4},children:[e.jsx(Ce,{size:60,thickness:4}),e.jsx(c,{variant:"pageSubtitle",sx:{mt:2},children:r("holdings.loading")})]});if(o)return e.jsxs(je,{severity:"error",sx:{mb:2,borderRadius:2,"& .MuiAlert-message":{fontSize:"1rem"}},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,children:r("holdings.error.loadFailed")}),e.jsx(c,{variant:"formHelper",children:o}),e.jsx(he,{onClick:L,mobileText:r("common.tryAgain"),desktopText:r("common.tryAgain"),sx:{mt:1},children:r("common.tryAgain")})]});const O=[{title:r("holdings.summary.totalInvestment"),value:G(j,k),subtitle:r("holdings.summary.holdingsCount",{count:y}),icon:e.jsx(qt,{}),color:"primary",gradient:`linear-gradient(135deg, ${U(n.palette.primary.main,.06)} 0%, ${U(n.palette.primary.main,.03)} 100%)`},{title:r("holdings.summary.currentValue"),value:G(b,k),subtitle:r("holdings.summary.marketValue"),icon:e.jsx(Zt,{}),color:"warning",gradient:`linear-gradient(135deg, ${U(n.palette.warning.main,.06)} 0%, ${U(n.palette.warning.main,.03)} 100%)`},{title:r("holdings.summary.totalPnL"),value:G(w,k),subtitle:w>=0?r("holdings.summary.profitable"):r("holdings.summary.loss"),icon:w>=0?e.jsx(He,{}):e.jsx(Bt,{}),color:w>=0?"success":"error",gradient:w>=0?`linear-gradient(135deg, ${U(n.palette.success.main,.06)} 0%, ${U(n.palette.success.main,.03)} 100%)`:`linear-gradient(135deg, ${U(n.palette.error.main,.06)} 0%, ${U(n.palette.error.main,.03)} 100%)`},{title:r("holdings.summary.totalReturn"),value:ye(C),subtitle:r("holdings.summary.performance"),icon:e.jsx(mr,{}),color:"secondary",gradient:`linear-gradient(135deg, ${U(n.palette.secondary.main,.06)} 0%, ${U(n.palette.secondary.main,.03)} 100%)`}];return e.jsxs(l,{children:[e.jsx(l,{sx:{mb:4},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"pageHeader",sx:{background:`linear-gradient(135deg, ${n.palette.primary.main} 0%, ${n.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1},children:r("holdings.title")}),e.jsx(c,{variant:"pageSubtitle",children:r("holdings.subtitle")})]}),e.jsx(l,{sx:{display:"flex",gap:1},children:e.jsx(he,{variant:"outlined",icon:e.jsx(Mt,{}),onClick:L,mobileText:r("common.refresh"),desktopText:r("common.refresh"),sx:{borderRadius:2},children:r("common.refresh")})})]})}),e.jsxs(l,{sx:{px:{xs:0,sm:1,md:2}},children:[e.jsxs(l,{sx:{mb:4},children:[e.jsx(l,{sx:{display:{xs:"none",md:"block"}},children:e.jsx(W,{container:!0,spacing:2,children:O.map((N,E)=>e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{sx:{mb:1},children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(l,{sx:{mr:2,display:"flex",alignItems:"center"},children:rt.cloneElement(N.icon,{color:N.color,sx:{fontSize:32}})}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",sx:{mb:.5},children:N.title}),e.jsx(c,{variant:"cardValue",color:`${N.color}.main`,sx:{mb:.5},children:N.value}),e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",children:N.subtitle})]})]})})})},E))})}),e.jsx(l,{sx:{display:{xs:"block",md:"none"}},children:e.jsx(se,{sx:{borderRadius:3,background:`linear-gradient(135deg, ${U(n.palette.background.paper,.8)} 0%, ${U(n.palette.background.paper,.6)} 100%)`,border:`0.5px solid ${U(n.palette.divider,.08)}`,backdropFilter:"blur(10px)"},children:e.jsx(me,{sx:{p:2},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:6,children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2,pb:2,borderBottom:`1px solid ${n.palette.divider}`},children:[e.jsx(qt,{color:"primary",sx:{fontSize:20,mr:1}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",color:"text.secondary",sx:{fontSize:"0.75rem"},children:r("holdings.summary.totalInvestment")}),e.jsx(c,{variant:"cardValue",color:"primary",fontWeight:"600",sx:{fontSize:"0.9rem"},children:G(j,k)})]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[w>=0?e.jsx(He,{color:"success",sx:{fontSize:20,mr:1}}):e.jsx(Bt,{color:"error",sx:{fontSize:20,mr:1}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",color:"text.secondary",sx:{fontSize:"0.75rem"},children:r("holdings.summary.totalPnL")}),e.jsx(c,{variant:"cardValue",color:w>=0?"success.main":"error.main",fontWeight:"600",sx:{fontSize:"0.9rem"},children:G(w,k)})]})]})]}),e.jsxs(W,{item:!0,xs:6,children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2,pb:2,borderBottom:`1px solid ${n.palette.divider}`},children:[e.jsx(Zt,{color:"warning",sx:{fontSize:20,mr:1}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",color:"text.secondary",sx:{fontSize:"0.75rem"},children:r("holdings.summary.currentValue")}),e.jsx(c,{variant:"cardValue",color:"warning.main",fontWeight:"600",sx:{fontSize:"0.9rem"},children:G(b,k)})]})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(mr,{color:"secondary",sx:{fontSize:20,mr:1}}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",color:"text.secondary",sx:{fontSize:"0.75rem"},children:r("holdings.summary.totalReturn")}),e.jsx(c,{variant:"cardValue",color:"secondary.main",fontWeight:"600",sx:{fontSize:"0.9rem"},children:ye(C)})]})]})]})]})})})})]}),e.jsxs(l,{children:[e.jsx(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:e.jsxs(l,{children:[e.jsx(c,{variant:"pageTitle",component:"h2",sx:{mb:1},children:r("holdings.table.title")}),e.jsx(c,{variant:"pageSubtitle",sx:{display:{xs:"none",md:"block"}},children:r("holdings.table.subtitle")})]})}),a.length===0?e.jsxs(se,{sx:{p:6,textAlign:"center",background:`linear-gradient(135deg, ${U(n.palette.background.paper,.8)} 0%, ${U(n.palette.background.paper,.6)} 100%)`,border:`1px solid ${U(n.palette.divider,.1)}`,borderRadius:3},children:[e.jsx(l,{sx:{p:3,borderRadius:"50%",background:`linear-gradient(135deg, ${U(n.palette.primary.main,.1)} 0%, ${U(n.palette.primary.main,.05)} 100%)`,display:"inline-flex",mb:3},children:e.jsx(Ue,{sx:{fontSize:80,color:"primary.main"}})}),e.jsx(c,{variant:"pageTitle",sx:{mb:2,color:"text.primary"},children:r("holdings.empty.title")}),e.jsx(c,{variant:"pageSubtitle",sx:{mb:3,maxWidth:500,mx:"auto"},children:r("holdings.empty.message")})]}):e.jsx(se,{sx:{borderRadius:3,background:`linear-gradient(135deg, ${U(n.palette.background.paper,.8)} 0%, ${U(n.palette.background.paper,.6)} 100%)`,border:`0.5px solid ${U(n.palette.divider,.08)}`,backdropFilter:"blur(10px)"},children:e.jsx(me,{sx:{p:0},children:e.jsx(at,{component:Te,variant:"outlined",sx:{borderRadius:0},children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:U(n.palette.primary.main,.02)},children:[e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:r("holdings.table.portfolio")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:r("holdings.table.units")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:r("holdings.table.avgCostPerUnit")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:r("holdings.table.totalInvestment")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:r("holdings.table.currentValue")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:r("holdings.table.totalPnL")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:r("holdings.table.returnPercent")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",children:r("common.actions")})})]})}),e.jsx(ot,{children:a.map(N=>{var R,V;const E=Number(N.totalInvestment)>0?(Number(N.currentValue)-Number(N.totalInvestment))/Number(N.totalInvestment)*100:0;return e.jsxs(De,{sx:{cursor:"pointer","&:hover":{backgroundColor:U(n.palette.primary.main,.02)}},onClick:()=>{var F;return T(N.holdingId,((F=N.portfolio)==null?void 0:F.name)||"Unknown Portfolio")},children:[e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(l,{sx:{borderRadius:"8px",background:U(n.palette.primary.main,.1),color:"primary.main",width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(Ue,{sx:{fontSize:16}})}),e.jsxs(l,{children:[e.jsx(c,{variant:"tableCell",sx:{fontWeight:600},children:((R=N.portfolio)==null?void 0:R.name)||"Unknown Portfolio"}),e.jsx(c,{variant:"formHelper",children:((V=N.portfolio)==null?void 0:V.baseCurrency)||"VND"})]})]})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:Vn(Number(N.totalUnits),1)})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCell",children:G(Number(N.avgCostPerUnit),k)})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:G(Number(N.totalInvestment),k)})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:G(Number(N.currentValue),k)})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:500,color:Number(N.unrealizedPnL)>=0?"success.main":"error.main"},children:G(Number(N.unrealizedPnL)+Number(N.realizedPnL),k)})}),e.jsx(S,{children:e.jsx(ce,{label:ye(E),color:E>=0?"success":"error",size:"small",sx:{fontWeight:600}})}),e.jsx(S,{children:e.jsx(Fe,{title:r("holdings.actions.viewPortfolio"),children:e.jsx(Ie,{onClick:()=>A(N.portfolioId),size:"small",sx:{color:"primary.main"},children:e.jsx(Xt,{})})})})]},N.holdingId)})})]})})})})]}),e.jsx(UP,{open:g,onClose:M,holdingId:u,holdingName:m})]})]})},YP=()=>{const[r,t]=p.useState([]),[n,s]=p.useState(!1),[a,i]=p.useState(null),{accountId:o}=Ge(),{portfolios:d}=Un(),u=async()=>{if(!o||!d.length){t([]);return}s(!0),i(null);try{const h=[];for(const m of d){try{const g=(await q.getTrades(m.portfolioId,o)).map(f=>({id:f.tradeId,type:"TRADE",portfolioId:m.portfolioId,portfolioName:m.name,date:f.tradeDate,amount:f.totalValue,currency:m.baseCurrency,description:`${f.side} ${f.quantity} ${f.assetSymbol||"Asset"}`,side:f.side,assetSymbol:f.assetSymbol,assetName:f.assetName,quantity:f.quantity,price:f.price,createdAt:f.createdAt}));h.push(...g)}catch(x){console.warn(`Failed to fetch trades for portfolio ${m.portfolioId}:`,x)}try{const g=(await q.getCashFlowHistory(m.portfolioId,o,{limit:100})).data.map(f=>({id:f.cashflowId,type:"CASH_FLOW",portfolioId:m.portfolioId,portfolioName:m.name,date:f.flowDate,amount:f.amount,currency:f.currency,description:f.description||`${f.type} transaction`,cashFlowType:f.type,fundingSource:f.fundingSource,createdAt:f.createdAt}));h.push(...g)}catch(x){console.warn(`Failed to fetch cash flows for portfolio ${m.portfolioId}:`,x)}}h.sort((m,x)=>new Date(x.date).getTime()-new Date(m.date).getTime()),t(h)}catch(h){i(h instanceof Error?h.message:"Failed to fetch transactions"),t([])}finally{s(!1)}};return p.useEffect(()=>{u()},[o,d]),{transactions:r,isLoading:n,error:a,refetch:u}},qP=()=>{const{t:r}=Ne(),t=An(),n=Je(),{transactions:s,isLoading:a,error:i,refetch:o}=YP(),[d,u]=p.useState(""),[h,m]=p.useState("ALL"),[x,g]=p.useState("ALL"),[f,y]=p.useState("ALL"),j=p.useMemo(()=>s.map(M=>({id:M.portfolioId,name:M.portfolioName})).filter((M,O,I)=>O===I.findIndex(z=>z.id===M.id)),[s]),b=p.useMemo(()=>s.filter(T=>{var N,E;const M=T.description.toLowerCase().includes(d.toLowerCase())||((N=T.assetSymbol)==null?void 0:N.toLowerCase().includes(d.toLowerCase()))||((E=T.assetName)==null?void 0:E.toLowerCase().includes(d.toLowerCase()))||T.portfolioName.toLowerCase().includes(d.toLowerCase()),O=h==="ALL"||T.type===h,I=x==="ALL"||T.portfolioId===x;let z=!0;if(f!=="ALL"){const R=new Date(T.date),F=Math.floor((new Date().getTime()-R.getTime())/(1e3*60*60*24));switch(f){case"7D":z=F<=7;break;case"30D":z=F<=30;break;case"90D":z=F<=90;break;case"1Y":z=F<=365;break}}return M&&O&&I&&z}),[s,d,h,x,f]),v=p.useMemo(()=>{const T=b.length,M=b.reduce((N,E)=>N+Math.abs(E.amount),0),O=b.filter(N=>N.type==="TRADE").length,I=b.filter(N=>N.type==="CASH_FLOW").length,z=b.filter(N=>N.type==="FUND_UNIT").length;return{totalTransactions:T,totalAmount:M,tradeCount:O,cashFlowCount:I,fundUnitCount:z}},[b]),P=T=>{t(`/portfolios/${T}`)},w=()=>{o()},C=T=>{switch(T.type){case"TRADE":return T.side==="BUY"?e.jsx(He,{}):e.jsx(Bt,{});case"CASH_FLOW":return e.jsx(Ue,{});case"FUND_UNIT":return e.jsx(qt,{});default:return e.jsx(Zt,{})}},k=T=>{switch(T.type){case"TRADE":return T.side==="BUY"?"success":"error";case"CASH_FLOW":return T.amount>0?"success":"error";case"FUND_UNIT":return"info";default:return"primary"}},A=T=>{switch(T.type){case"TRADE":return`${T.side} ${T.assetSymbol||"Asset"}`;case"CASH_FLOW":return T.cashFlowType||"Cash Flow";case"FUND_UNIT":return"Fund Unit Transaction";default:return"Transaction"}};if(a)return e.jsxs(l,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"400px",sx:{background:`linear-gradient(135deg, ${U(n.palette.primary.main,.05)} 0%, ${U(n.palette.primary.main,.02)} 100%)`,borderRadius:3,p:4},children:[e.jsx(Ce,{size:60,thickness:4}),e.jsx(D,{variant:"h6",sx:{mt:2,color:"text.secondary"},children:"Loading your transactions..."})]});if(i)return e.jsxs(je,{severity:"error",sx:{mb:2,borderRadius:2,"& .MuiAlert-message":{fontSize:"1rem"}},children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Failed to load transactions"}),e.jsx(D,{variant:"body2",children:i}),e.jsx(he,{onClick:w,mobileText:"Try Again",desktopText:"Try Again",sx:{mt:1},children:"Try Again"})]});const L=[{title:"Total Transactions",value:v.totalTransactions.toLocaleString(),subtitle:"All transaction types",icon:e.jsx(Zt,{}),color:"primary",gradient:`linear-gradient(135deg, ${U(n.palette.primary.main,.06)} 0%, ${U(n.palette.primary.main,.03)} 100%)`},{title:"Total Amount",value:G(v.totalAmount,"VND"),subtitle:"Absolute transaction value",icon:e.jsx(mr,{}),color:"info",gradient:`linear-gradient(135deg, ${U(n.palette.info.main,.06)} 0%, ${U(n.palette.info.main,.03)} 100%)`},{title:"Trading Transactions",value:v.tradeCount.toLocaleString(),subtitle:"Buy/Sell trades",icon:e.jsx(He,{}),color:"success",gradient:`linear-gradient(135deg, ${U(n.palette.success.main,.06)} 0%, ${U(n.palette.success.main,.03)} 100%)`},{title:"Cash Flows",value:v.cashFlowCount.toLocaleString(),subtitle:"Cash transactions",icon:e.jsx(Ue,{}),color:"secondary",gradient:`linear-gradient(135deg, ${U(n.palette.secondary.main,.06)} 0%, ${U(n.palette.secondary.main,.03)} 100%)`}];return e.jsx(Xr,{in:!0,timeout:800,children:e.jsxs(l,{children:[e.jsx(l,{sx:{mb:4},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(l,{children:[e.jsx(D,{variant:"h3",component:"h1",sx:{fontWeight:300,background:`linear-gradient(135deg, ${n.palette.primary.main} 0%, ${n.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1},children:"Transaction History"}),e.jsx(D,{variant:"h6",color:"text.secondary",sx:{fontWeight:300},children:"Complete transaction history across all your portfolios"})]}),e.jsx(l,{sx:{display:"flex",gap:1},children:e.jsx(he,{variant:"outlined",icon:e.jsx(Mt,{}),onClick:w,mobileText:"Refresh",desktopText:"Refresh",sx:{borderRadius:2},children:"Refresh"})})]})}),e.jsx(W,{container:!0,spacing:3,sx:{mb:4},children:L.map((T,M)=>e.jsx(W,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(as,{direction:"up",in:!0,timeout:600+M*100,children:e.jsx(se,{sx:{height:"100%",background:T.gradient,border:`0.5px solid ${U(n.palette[T.color].main,.15)}`,borderRadius:2,transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:`0 4px 12px ${U(n.palette[T.color].main,.1)}`,border:`0.5px solid ${U(n.palette[T.color].main,.2)}`}},children:e.jsxs(me,{sx:{p:2},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1.5},children:e.jsx(l,{sx:{borderRadius:"50%",background:U(n.palette[T.color].main,.08),color:`${T.color}.main`,width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0 2px 4px ${U(n.palette[T.color].main,.15)}`},children:rt.cloneElement(T.icon,{sx:{fontSize:20}})})}),e.jsx(D,{variant:"h4",sx:{fontWeight:600,color:"text.primary",mb:.5,lineHeight:1.2},children:T.value}),e.jsx(D,{variant:"h6",sx:{color:"text.secondary",fontWeight:500,mb:.5},children:T.title}),e.jsx(D,{variant:"body2",sx:{color:"text.secondary",opacity:.8,fontWeight:400},children:T.subtitle})]})})})},M))}),e.jsx(se,{sx:{mb:3,borderRadius:3},children:e.jsxs(me,{sx:{p:3},children:[e.jsx(D,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Filters & Search"}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Ae,{fullWidth:!0,placeholder:"Search transactions...",value:d,onChange:T=>u(T.target.value),InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx($n,{})})},sx:{borderRadius:2}})}),e.jsx(W,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Type"}),e.jsxs(Ze,{value:h,onChange:T=>m(T.target.value),label:"Type",children:[e.jsx(re,{value:"ALL",children:"All Types"}),e.jsx(re,{value:"TRADE",children:"Trades"}),e.jsx(re,{value:"CASH_FLOW",children:"Cash Flows"}),e.jsx(re,{value:"FUND_UNIT",children:"Fund Units"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Portfolio"}),e.jsxs(Ze,{value:x,onChange:T=>g(T.target.value),label:"Portfolio",children:[e.jsx(re,{value:"ALL",children:"All Portfolios"}),j.map(T=>e.jsx(re,{value:T.id,children:T.name},T.id))]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Date Range"}),e.jsxs(Ze,{value:f,onChange:T=>y(T.target.value),label:"Date Range",children:[e.jsx(re,{value:"ALL",children:"All Time"}),e.jsx(re,{value:"7D",children:"Last 7 Days"}),e.jsx(re,{value:"30D",children:"Last 30 Days"}),e.jsx(re,{value:"90D",children:"Last 90 Days"}),e.jsx(re,{value:"1Y",children:"Last Year"})]})]})})]})]})}),e.jsxs(l,{children:[e.jsx(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:e.jsxs(l,{children:[e.jsx(D,{variant:"h4",component:"h2",sx:{fontWeight:300,mb:1},children:"Transaction History"}),e.jsxs(D,{variant:"body1",color:"text.secondary",children:[b.length," transaction",b.length!==1?"s":""," found"]})]})}),b.length===0?e.jsxs(se,{sx:{p:6,textAlign:"center",background:`linear-gradient(135deg, ${U(n.palette.background.paper,.8)} 0%, ${U(n.palette.background.paper,.6)} 100%)`,border:`1px solid ${U(n.palette.divider,.1)}`,borderRadius:3},children:[e.jsx(l,{sx:{p:3,borderRadius:"50%",background:`linear-gradient(135deg, ${U(n.palette.primary.main,.1)} 0%, ${U(n.palette.primary.main,.05)} 100%)`,display:"inline-flex",mb:3},children:e.jsx(Zt,{sx:{fontSize:80,color:"primary.main"}})}),e.jsx(D,{variant:"h4",sx:{fontWeight:300,mb:2,color:"text.primary"},children:"No Transactions Found"}),e.jsx(D,{variant:"h6",color:"text.secondary",sx:{mb:3,maxWidth:500,mx:"auto"},children:s.length===0?"You don't have any transactions yet. Start by creating trades or adding cash flows to your portfolios.":"No transactions match your current filters. Try adjusting your search criteria."})]}):e.jsx(se,{sx:{borderRadius:3,background:`linear-gradient(135deg, ${U(n.palette.background.paper,.8)} 0%, ${U(n.palette.background.paper,.6)} 100%)`,border:`0.5px solid ${U(n.palette.divider,.08)}`,backdropFilter:"blur(10px)"},children:e.jsx(me,{sx:{p:0},children:e.jsx(at,{component:Te,variant:"outlined",sx:{borderRadius:0},children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:U(n.palette.primary.main,.02)},children:[e.jsx(S,{sx:{fontWeight:600,color:"text.primary"},children:"Type"}),e.jsx(S,{sx:{fontWeight:600,color:"text.primary"},children:"Portfolio"}),e.jsx(S,{sx:{fontWeight:600,color:"text.primary"},children:"Description"}),e.jsx(S,{sx:{fontWeight:600,color:"text.primary"},children:"Amount"}),e.jsx(S,{sx:{fontWeight:600,color:"text.primary"},children:"Date"}),e.jsx(S,{sx:{fontWeight:600,color:"text.primary"},children:r("tables.actions")})]})}),e.jsx(ot,{children:b.map((T,M)=>e.jsx(as,{direction:"up",in:!0,timeout:800+M*50,children:e.jsxs(De,{sx:{"&:hover":{backgroundColor:U(n.palette.primary.main,.02)}},children:[e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(l,{sx:{borderRadius:"50%",background:U(n.palette[k(T)].main,.1),color:`${k(T)}.main`,width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center"},children:rt.cloneElement(C(T),{sx:{fontSize:16}})}),e.jsxs(l,{children:[e.jsx(D,{variant:"body2",sx:{fontWeight:600},children:A(T)}),e.jsx(ce,{label:T.type,size:"small",color:k(T),sx:{fontSize:"0.7rem",height:20}})]})]})}),e.jsx(S,{children:e.jsxs(l,{children:[e.jsx(D,{variant:"body1",sx:{fontWeight:600},children:T.portfolioName}),e.jsx(D,{variant:"body2",color:"text.secondary",children:T.currency})]})}),e.jsxs(S,{children:[e.jsx(D,{variant:"body1",sx:{fontWeight:500},children:T.description}),T.assetSymbol&&e.jsxs(D,{variant:"body2",color:"text.secondary",children:[T.assetSymbol," ",T.quantity&&`(${Vn(T.quantity)})`]})]}),e.jsxs(S,{children:[e.jsx(D,{variant:"body1",sx:{fontWeight:600,color:T.amount>=0?"success.main":"error.main"},children:G(Math.abs(T.amount),T.currency)}),T.price&&e.jsxs(D,{variant:"body2",color:"text.secondary",children:["@ ",G(T.price,T.currency)]})]}),e.jsxs(S,{children:[e.jsx(D,{variant:"body1",sx:{fontWeight:500},children:fn(_r(T.date),"MMM dd, yyyy")}),e.jsx(D,{variant:"body2",color:"text.secondary",children:fn(_r(T.date),"HH:mm")})]}),e.jsx(S,{children:e.jsx(Fe,{title:"View Portfolio",children:e.jsx(Ie,{onClick:()=>P(T.portfolioId),size:"small",sx:{color:"primary.main"},children:e.jsx(Xt,{})})})})]})},T.id))})]})})})})]})]})})},GP=()=>{const{t:r}=Ne(),t=Je(),n=Nt(t.breakpoints.down("md")),{accountId:s,baseCurrency:a}=Ge(),[i,o]=p.useState(null),[d,u]=p.useState(!0),[h,m]=p.useState(null),[x,g]=p.useState([]),[f,y]=p.useState(["all"]);p.useEffect(()=>{s&&(async()=>{try{const v=await q.getPortfolios(s);g(v)}catch(v){console.error("Failed to load portfolios:",v)}})()},[s]),p.useEffect(()=>{s&&(async()=>{try{u(!0),m(null);const v=f.includes("all")||f.length===0?void 0:f.join(","),P=await q.getReportData(s,v);o(P)}catch(v){m(r("report.error.loadFailed")),console.error("Error fetching report data:",v)}finally{u(!1)}})()},[s,f]);const j=({title:b,value:v,subtitle:P,icon:w,color:C="primary",trend:k="neutral",change:A})=>{const L={primary:t.palette.primary.main,success:t.palette.success.main,error:t.palette.error.main,info:t.palette.info.main,warning:t.palette.warning.main},T=`linear-gradient(135deg, ${U(L[C],.06)} 0%, ${U(L[C],.03)} 100%)`;return e.jsx(se,{sx:{height:"100%",background:T,border:`1px solid ${U(L[C],.1)}`,"&:hover":{transform:"translateY(-2px)",boxShadow:`0 8px 25px ${U(L[C],.15)}`},transition:"all 0.3s ease"},children:e.jsxs(me,{sx:{p:3},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(l,{sx:{p:1.5,backgroundColor:L[C],borderRadius:2,mr:2,display:"flex",alignItems:"center",justifyContent:"center"},children:w}),e.jsx(c,{variant:"cardTitle",sx:{color:"#1a1a1a"},children:b})]}),e.jsx(c,{variant:"cardValue",sx:{mb:1,color:"#212529"},children:v}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(c,{variant:"cardLabel",sx:{color:"#6c757d"},children:P}),A&&e.jsx(ce,{label:A,size:"small",color:k==="positive"?"success":k==="negative"?"error":"default",variant:k==="neutral"?"outlined":"filled",sx:{fontSize:"0.75rem"}})]})]})})};return d?e.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:e.jsx(Ce,{})}):h?e.jsx(l,{children:e.jsx(je,{severity:"error",children:h})}):i?e.jsxs(l,{children:[e.jsxs(l,{sx:{mb:4},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2,m:0},children:[e.jsx(l,{sx:{flex:1},children:e.jsx(c,{variant:"pageHeader",sx:{background:`linear-gradient(135deg, ${t.palette.primary.main} 0%, ${t.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1,filter:"none"},ellipsis:!1,children:r("report.title")})}),e.jsx(l,{sx:{ml:2},children:e.jsxs(nt,{sx:{minWidth:160,"& .MuiOutlinedInput-root":{height:"40px"}},children:[e.jsx(st,{sx:{fontSize:"0.875rem!important"},children:r("report.portfolioFilter")}),e.jsxs(Ze,{multiple:!0,value:f,size:"small",sx:{fontSize:"0.875rem!important"},onChange:b=>{const v=b.target.value;v.includes("all")?v.length===1?y(["all"]):y(v.filter(P=>P!=="all")):y(v.length>0?v:["all"])},label:r("report.portfolioFilter"),renderValue:b=>{if(b.includes("all")||b.length===0)return r("report.allPortfolios");if(b.length===1){const v=x.find(P=>P.portfolioId===b[0]);return v?v.name:b[0]}return r("report.portfoliosSelected",{count:b.length})},MenuProps:{PaperProps:{style:{maxHeight:250,width:250}}},children:[e.jsxs(re,{value:"all",sx:{display:"flex",alignItems:"center",py:.5,minHeight:"32px"},children:[e.jsx(rn,{checked:f.includes("all"),color:"primary",size:"small"}),e.jsx(ve,{primary:r("report.allPortfolios"),sx:{ml:1,"& .MuiListItemText-primary":{fontSize:"0.875rem"}}})]},"all"),x.map((b,v)=>b.portfolioId?e.jsxs(re,{value:b.portfolioId,sx:{display:"flex",alignItems:"center",py:.5,minHeight:"32px"},children:[e.jsx(rn,{checked:f.includes(b.portfolioId),color:"primary",size:"small"}),e.jsx(ve,{primary:b.name,sx:{ml:1,"& .MuiListItemText-primary":{fontSize:"0.875rem"}}})]},`portfolio-${v}-${b.portfolioId}`):(console.warn(`Portfolio ${v} has invalid portfolioId:`,b),null))]})]})})]}),!n&&e.jsx(c,{variant:"pageSubtitle",children:r("report.subtitle")})]}),e.jsxs(W,{container:!0,spacing:3,sx:{alignItems:"stretch"},children:[e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(l,{sx:{p:.2,height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(l,{sx:{mb:3,height:"180px",display:"flex",alignItems:"stretch"},children:e.jsx(l,{sx:{width:"100%"},children:e.jsx(j,{title:r("report.cashBalance.title"),value:G(i.cashBalance.total,a),subtitle:r("report.cashBalance.subtitle"),icon:e.jsx(Ue,{sx:{fontSize:24,color:"white"}}),color:"info",change:r("report.cashBalance.change")})})}),e.jsx(l,{sx:{flex:1},children:e.jsxs(l,{sx:{background:"white",borderRadius:2},children:[e.jsx(l,{sx:{p:2},children:e.jsx(c,{variant:"chartTitle",children:r("report.cashBalance.byFundingSource")})}),e.jsx(gs,{data:i.cashBalance.byFundingSource,columns:[{key:"source",header:r("report.columns.fundingSource")},{key:"total",header:r("report.columns.totalAmount"),align:"right",render:b=>e.jsx(c,{variant:"tableCell",sx:{color:Number(b.total)>=0?"success.main":"error.main","@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:G(b.total,a)})},{key:"percentage",header:r("report.columns.share"),align:"right",render:b=>e.jsx(ce,{label:In(b.percentage,1),size:"small",color:"primary",variant:"outlined",sx:{fontSize:"0.65rem"}})}]})]})})]})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(l,{sx:{p:.2,height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(l,{sx:{mb:3,height:"180px",display:"flex",alignItems:"stretch"},children:e.jsx(l,{sx:{width:"100%"},children:e.jsx(j,{title:r("report.deposits.title"),value:G(i.deposits.totalValue,a),subtitle:r("report.deposits.subtitle",{count:i.deposits.total}),icon:e.jsx(Xu,{sx:{fontSize:24,color:"white"}}),color:"success",change:r("report.deposits.change")})})}),e.jsxs(l,{sx:{flex:1},children:[e.jsxs(l,{sx:{background:"white",borderRadius:2},children:[e.jsx(l,{sx:{p:2},children:e.jsx(c,{variant:"chartTitle",children:r("report.deposits.byBank")})}),e.jsx(gs,{data:i.deposits.byExchange,columns:[{key:"exchange",header:r("report.columns.bank")},{key:"count",header:r("report.columns.count"),align:"right",render:b=>e.jsx(c,{variant:"tableCell",sx:{"@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:dn(b.count,0)})},{key:"total",header:r("report.columns.value"),align:"right",render:b=>e.jsx(c,{variant:"tableCell",sx:{color:Number(b.total)>=0?"success.main":"error.main","@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:G(b.total,a)})},{key:"percentage",header:r("report.columns.share"),align:"right",render:b=>e.jsx(ce,{label:In(b.percentage,1),size:"small",color:"primary",variant:"outlined",sx:{fontSize:"0.7rem"}})}]})]}),e.jsxs(l,{sx:{background:"white",borderRadius:2,mt:3},children:[e.jsx(l,{sx:{p:2},children:e.jsx(c,{variant:"chartTitle",children:r("report.deposits.byTerm")})}),e.jsx(gs,{data:i.deposits.byFundingSource,columns:[{key:"source",header:r("report.columns.term")},{key:"count",header:r("report.columns.count"),align:"right",render:b=>e.jsx(c,{variant:"tableCell",sx:{"@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:dn(b.count,0)})},{key:"total",header:r("report.columns.value"),align:"right",render:b=>e.jsx(c,{variant:"tableCell",sx:{color:Number(b.total)>=0?"success.main":"error.main","@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:G(b.total,a)})},{key:"percentage",header:r("report.columns.share"),align:"right",render:b=>e.jsx(ce,{label:In(b.percentage,1),size:"small",color:"primary",variant:"outlined",sx:{fontSize:"0.7rem"}})}]})]})]})]})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(l,{sx:{p:.2,height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(l,{sx:{mb:3,height:"180px",display:"flex",alignItems:"stretch"},children:e.jsx(l,{sx:{width:"100%"},children:e.jsx(j,{title:r("report.assets.title"),value:G(i.assets.totalValue,a),subtitle:r("report.assets.subtitle",{count:i.assets.total}),icon:e.jsx(qt,{sx:{fontSize:24,color:"white"}}),color:"primary",change:r("report.assets.change")})})}),e.jsxs(l,{sx:{flex:1},children:[e.jsxs(l,{sx:{background:"white",borderRadius:2},children:[e.jsx(l,{sx:{p:2},children:e.jsx(c,{variant:"chartTitle",children:r("report.assets.byExchange")})}),e.jsx(gs,{data:i.assets.byExchange,columns:[{key:"exchange",header:r("report.columns.exchange")},{key:"count",header:r("report.columns.capitalValue"),align:"right",render:b=>e.jsxs(l,{children:[e.jsx(c,{variant:"tableCell",sx:{color:Number(b.capitalValue)>=0?"success.main":"error.main","@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:G(b.capitalValue,a)}),e.jsxs(c,{variant:"tableCellSmall",sx:{color:"text.secondary","@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:[r("report.columns.count"),": ",dn(b.count,0)]})]})},{key:"total",header:r("report.columns.currentValue"),align:"right",render:b=>e.jsxs(l,{children:[e.jsx(c,{variant:"tableCell",sx:{color:Number(b.total)>=0?"success.main":"error.main","@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:G(b.total,a)}),e.jsxs(c,{variant:"tableCellSmall",sx:{color:Number(b.total-b.capitalValue)>=0?"success.main":"error.main","@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:[r("report.columns.pnl"),": ",G(b.total-b.capitalValue,a)]})]})},{key:"percentage",header:r("report.columns.share"),align:"right",render:b=>e.jsx(ce,{label:In(b.percentage,1),size:"small",color:"primary",variant:"outlined",sx:{fontSize:"0.7rem"}})}]})]}),e.jsxs(l,{sx:{background:"white",borderRadius:2,mt:3},children:[e.jsx(l,{sx:{p:2},children:e.jsx(c,{variant:"chartTitle",children:r("report.assets.byGroup")})}),e.jsx(gs,{data:i.assets.byAssetGroup,columns:[{key:"group",header:r("report.columns.assetGroup")},{key:"count",header:r("report.columns.capitalValue"),align:"right",render:b=>e.jsxs(l,{children:[e.jsx(c,{variant:"tableCell",sx:{color:Number(b.capitalValue)>=0?"success.main":"error.main","@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:G(b.capitalValue,a)}),e.jsxs(c,{variant:"tableCellSmall",sx:{color:"text.secondary","@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:[r("report.columns.count"),": ",dn(b.count,0)]})]})},{key:"total",header:r("report.columns.currentValue"),align:"right",render:b=>e.jsxs(l,{children:[e.jsx(c,{variant:"tableCell",sx:{color:Number(b.total)>=0?"success.main":"error.main","@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:G(b.total,a)}),e.jsxs(c,{variant:"tableCellSmall",sx:{color:Number(b.total-b.capitalValue)>=0?"success.main":"error.main","@media (max-width: 600px)":{lineHeight:"1.1 !important"}},children:[r("report.columns.pnl"),": ",G(b.total-b.capitalValue,a)]})]})},{key:"percentage",header:r("report.columns.share"),align:"right",render:b=>e.jsx(ce,{label:In(b.percentage,1),size:"small",color:"primary",variant:"outlined",sx:{fontSize:"0.7rem"}})}]})]})]})]})})]})]}):e.jsx(l,{children:e.jsx(je,{severity:"info",children:r("report.noReportData")})})},KP=()=>{var P;const{t:r}=Ne(),t=Je(),n=An(),{currentAccount:s}=Ge(),[a,i]=p.useState([]),[o,d]=p.useState(!0),[u,h]=p.useState(null),[m,x]=p.useState(null),g=p.useRef(null);p.useEffect(()=>{s!=null&&s.accountId?f():d(!1)},[s]),p.useEffect(()=>{if(m&&g.current){const w=g.current,C=w.querySelector(`[data-portfolio-id="${m}"]`);if(C){const k=w.getBoundingClientRect(),A=C.getBoundingClientRect(),L=C.offsetLeft-k.width/2+A.width/2;w.scrollTo({left:L,behavior:"smooth"})}}},[m]);const f=async()=>{try{if(d(!0),h(null),!(s!=null&&s.accountId)){h(r("investorView.error.loadFailed","Khng th ti danh sch portfolio. Vui lng th li sau."));return}const C=(await q.getInvestorPortfolios(s.accountId)).map(k=>({id:k.portfolio.id,name:k.portfolio.name,totalValue:k.portfolio.totalValue,cashBalance:k.portfolio.cashBalance,assetValue:k.portfolio.assetValue,depositsValue:k.portfolio.depositsValue,performance:k.performance,lastUpdated:k.portfolio.lastUpdated,owner:k.portfolio.owner,userPermission:k.userPermission}));i(C),C.length===1&&x(C[0].id)}catch(w){console.error("Error fetching portfolios:",w),h(r("investorView.error.loadFailed","Khng th ti danh sch portfolio. Vui lng th li sau."))}finally{d(!1)}},y=w=>{x(w)},j=()=>{x(null)},b=(w,C)=>{C.stopPropagation();const k=a.find(A=>A.id===w);if(!(k!=null&&k.userPermission)){console.warn("No permission data available for portfolio:",w);return}k.userPermission.isOwner||k.userPermission.canUpdate?n(`/portfolios/${w}`,{state:{from:"investor",fromInvestor:!0}}):console.warn("Insufficient permissions to access portfolio detail:",w)},v=w=>w>0?t.palette.success.main:w<0?t.palette.error.main:t.palette.text.secondary;return o?e.jsx(xn,{maxWidth:"lg",sx:{py:4},children:e.jsxs(l,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"400px",gap:2,children:[e.jsx(Ce,{size:60,thickness:4}),e.jsx(c,{variant:"body1",color:"text.secondary",children:r("investorView.loading","ang ti danh sch portfolio...")})]})}):u?e.jsx(xn,{maxWidth:"lg",sx:{py:4},children:e.jsx(je,{severity:"error",children:u})}):s!=null&&s.accountId?e.jsxs(l,{children:[e.jsx(l,{children:e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs(l,{children:[e.jsx(c,{variant:"pageHeader",sx:{background:`linear-gradient(135deg, ${t.palette.primary.main} 0%, ${t.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1},children:r("investorView.title","Gc nhn nh u t")}),e.jsx(c,{variant:"pageSubtitle",sx:{display:{xs:"none",sm:"block"}},children:r("investorView.subtitle","Tng quan tt c danh mc u t ca bn")})]})})}),a.length===0?e.jsx(l,{sx:{textAlign:"center",py:8},children:e.jsxs(l,{sx:{p:6,borderRadius:3,background:`linear-gradient(135deg, ${U(t.palette.background.paper,.8)} 0%, ${U(t.palette.background.paper,.6)} 100%)`,border:`1px solid ${U(t.palette.divider,.1)}`,backdropFilter:"blur(10px)",maxWidth:500,mx:"auto"},children:[e.jsx(l,{sx:{p:3,borderRadius:"50%",background:`linear-gradient(135deg, ${U(t.palette.primary.main,.1)} 0%, ${U(t.palette.primary.main,.05)} 100%)`,display:"inline-flex",mb:3},children:e.jsx(Ue,{sx:{fontSize:80,color:"primary.main"}})}),e.jsx(c,{variant:"pageTitle",sx:{mb:2,color:"text.primary"},children:r("investorView.noPortfolios","Cha c danh mc u t no")}),e.jsx(c,{variant:"pageSubtitle",sx:{mb:4,maxWidth:400,mx:"auto"},ellipsis:!1,paragraph:!0,children:r("investorView.noPortfoliosDesc","Bn cha c quyn truy cp vo bt k danh mc u t no. Hy xem c phn ca bn hoc lin h vi qun tr vin  c cp quyn.")}),e.jsxs(l,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap"},children:[e.jsx(ut,{variant:"contained",color:"primary",size:"large",startIcon:e.jsx(qt,{}),onClick:()=>n("/holdings"),sx:{borderRadius:2,px:4,py:1.5,fontWeight:600,textTransform:"none",boxShadow:`0 4px 12px ${U(t.palette.primary.main,.3)}`,"&:hover":{boxShadow:`0 6px 16px ${U(t.palette.primary.main,.4)}`,transform:"translateY(-1px)"}},children:r("investorView.viewHoldings","Xem c phn")}),e.jsx(ut,{variant:"outlined",color:"primary",size:"large",onClick:()=>n("/portfolios"),sx:{borderRadius:2,px:4,py:1.5,fontWeight:600,textTransform:"none",borderWidth:2,"&:hover":{borderWidth:2,backgroundColor:U(t.palette.primary.main,.05)}},children:r("investorView.managePortfolios","Qun l danh mc")})]})]})}):e.jsxs(e.Fragment,{children:[(!m||a.length>1)&&e.jsx(l,{sx:{mb:m?3:0,p:1},children:m&&a.length>1?e.jsx(l,{ref:g,sx:{display:"flex",gap:1,overflowX:"auto",p:1,"&::-webkit-scrollbar":{height:4},"&::-webkit-scrollbar-track":{backgroundColor:U(t.palette.grey[300],.3)},"&::-webkit-scrollbar-thumb":{backgroundColor:U(t.palette.grey[500],.5),borderRadius:2}},children:a.map(w=>{var C,k,A,L;return e.jsx(se,{"data-portfolio-id":w.id,sx:{minWidth:200,cursor:"pointer",transition:"all 0.2s ease-in-out",border:m===w.id?`2px solid ${t.palette.primary.main}`:"1px solid",borderColor:m===w.id?t.palette.primary.main:t.palette.grey[300],backgroundColor:m===w.id?U(t.palette.primary.main,.05):"inherit",m:.5,"&:hover":{transform:"translateY(-1px)",boxShadow:`0 2px 8px rgba(0,0,0,0.15), 0 0 0 1px ${t.palette.primary.main}`,borderColor:t.palette.primary.main}},onClick:()=>y(w.id),children:e.jsxs(me,{sx:{p:1.5,"&:last-child":{pb:1.5}},children:[e.jsx(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",flex:1},children:[e.jsx(c,{variant:"body2",onClick:T=>b(w.id,T),sx:{fontSize:"0.85rem",fontWeight:500,color:m===w.id?"primary.main":"text.primary",cursor:(C=w.userPermission)!=null&&C.isOwner||(k=w.userPermission)!=null&&k.canUpdate?"pointer":"default","&:hover":{textDecoration:(A=w.userPermission)!=null&&A.isOwner||(L=w.userPermission)!=null&&L.canUpdate?"underline":"none"}},children:w.name}),w.userPermission&&!(s!=null&&s.isInvestor)&&e.jsx(Jl,{permission:w.userPermission,size:"small",showIcon:!0,showLabel:!1,variant:"outlined"})]})}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:r("investorView.totalValue","Tng")}),e.jsx(c,{variant:"body2",color:"primary.main",sx:{fontSize:"0.8rem",fontWeight:600},children:G(w.totalValue)})]}),w.performance&&e.jsxs(l,{sx:{textAlign:"right"},children:[e.jsx(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:r("investorView.ytd","YTD")}),e.jsx(c,{variant:"body2",color:v(w.performance.ytdGrowth),sx:{fontSize:"0.8rem",fontWeight:600},children:In(w.performance.ytdGrowth,2)})]})]})]})},w.id)})}):e.jsx(W,{container:!0,spacing:2,sx:{p:1},children:a.map(w=>{var C,k,A,L,T,M;return e.jsx(W,{item:!0,xs:12,sm:6,md:4,lg:4,xl:3,children:e.jsx(se,{sx:{cursor:"pointer",transition:"all 0.2s ease-in-out",border:"1px solid",borderColor:t.palette.grey[300],backgroundColor:t.palette.background.paper,background:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,250,252,0.9) 100%)",backdropFilter:"blur(10px)",boxShadow:"0 2px 8px rgba(0,0,0,0.08), 0 1px 3px rgba(0,0,0,0.1)",m:.5,"&:hover":{transform:"translateY(-2px)",boxShadow:"0 8px 25px rgba(0,0,0,0.15), 0 0 0 1px rgba(59, 130, 246, 0.3)",borderColor:t.palette.primary.main,background:"linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(248,250,252,0.95) 100%)"}},onClick:()=>y(w.id),children:e.jsxs(me,{sx:{p:2,"&:last-child":{pb:2}},children:[e.jsxs(l,{sx:{mb:1.5},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,children:[e.jsx(c,{variant:"subtitle1",gutterBottom:!1,onClick:O=>b(w.id,O),sx:{fontSize:"1rem",fontWeight:600,cursor:(C=w.userPermission)!=null&&C.isOwner||(k=w.userPermission)!=null&&k.canUpdate?"pointer":"default","&:hover":{textDecoration:(A=w.userPermission)!=null&&A.isOwner||(L=w.userPermission)!=null&&L.canUpdate?"underline":"none",color:(T=w.userPermission)!=null&&T.isOwner||(M=w.userPermission)!=null&&M.canUpdate?"primary.main":"inherit"}},children:w.name}),w.userPermission&&!(s!=null&&s.isInvestor)&&e.jsx(Jl,{permission:w.userPermission,size:"small",showIcon:!0})]}),w.owner&&e.jsxs(l,{sx:{mb:1,display:"flex",alignItems:"center",gap:.5},children:[e.jsxs(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem"},children:[r("investorView.owner","Ch s hu"),":"]}),e.jsx(c,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem",fontWeight:500},children:w.owner.name})]}),e.jsx(ce,{label:r("investorView.clickToView","Nhn  xem chi tit"),size:"small",color:"primary",variant:"outlined",sx:{fontSize:"0.7rem",height:20}})]}),e.jsx(bt,{sx:{my:1.5}}),e.jsxs(W,{container:!0,spacing:1.5,sx:{mb:1},children:[e.jsx(W,{item:!0,xs:6,children:e.jsxs(Te,{sx:{p:1,textAlign:"center",background:"linear-gradient(135deg, rgba(59, 130, 246, 0.03) 0%, rgba(59, 130, 246, 0.06) 100%)",border:"1px solid rgba(59, 130, 246, 0.1)",borderRadius:2,boxShadow:"0 2px 4px rgba(59, 130, 246, 0.1)",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(59, 130, 246, 0.15)"}},children:[e.jsx(c,{variant:"cardValue",color:"primary.main",sx:{fontSize:"0.9rem",fontWeight:700,mb:.5},children:G(w.totalValue)}),e.jsx(c,{variant:"labelXSmall",sx:{fontWeight:500,color:"text.primary"},children:r("investorView.totalValue","Tng gi tr")})]})}),e.jsx(W,{item:!0,xs:6,children:e.jsxs(Te,{sx:{p:1,textAlign:"center",background:"linear-gradient(135deg, rgba(34, 197, 94, 0.03) 0%, rgba(34, 197, 94, 0.06) 100%)",border:"1px solid rgba(34, 197, 94, 0.1)",borderRadius:2,boxShadow:"0 2px 4px rgba(34, 197, 94, 0.1)",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(34, 197, 94, 0.15)"}},children:[e.jsx(c,{variant:"cardValue",color:"success.main",sx:{fontSize:"0.9rem",fontWeight:700,mb:.5},children:G(w.cashBalance)}),e.jsx(c,{variant:"labelXSmall",sx:{fontWeight:500,color:"text.primary"},children:r("investorView.cash","Tin mt")})]})}),e.jsx(W,{item:!0,xs:6,sx:{mt:1},children:e.jsxs(Te,{sx:{p:1,textAlign:"center",background:"linear-gradient(135deg, rgba(6, 182, 212, 0.03) 0%, rgba(6, 182, 212, 0.06) 100%)",border:"1px solid rgba(6, 182, 212, 0.1)",borderRadius:2,boxShadow:"0 2px 4px rgba(6, 182, 212, 0.1)",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(6, 182, 212, 0.15)"}},children:[e.jsx(c,{variant:"cardValue",color:"info.main",sx:{fontSize:"0.9rem",fontWeight:700,mb:.5},children:G(w.assetValue)}),e.jsx(c,{variant:"labelXSmall",sx:{fontWeight:500,color:"text.primary"},children:r("investorView.investments","Tin u t")})]})}),e.jsx(W,{item:!0,xs:6,sx:{mt:1},children:e.jsxs(Te,{sx:{p:1,textAlign:"center",background:"linear-gradient(135deg, rgba(245, 158, 11, 0.03) 0%, rgba(245, 158, 11, 0.06) 100%)",border:"1px solid rgba(245, 158, 11, 0.1)",borderRadius:2,boxShadow:"0 2px 4px rgba(245, 158, 11, 0.1)",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(245, 158, 11, 0.15)"}},children:[e.jsx(c,{variant:"cardValue",color:"warning.main",sx:{fontSize:"0.9rem",fontWeight:700,mb:.5},children:G(w.depositsValue)}),e.jsx(c,{variant:"labelXSmall",sx:{fontWeight:500,color:"text.primary"},children:r("investorView.deposits","Tin gi")})]})})]}),w.performance&&e.jsxs(l,{sx:{mt:1.5},children:[e.jsx(c,{variant:"caption",gutterBottom:!0,sx:{fontSize:"0.75rem",fontWeight:600},children:r("investorView.performance","Hiu sut")}),e.jsxs(W,{container:!0,spacing:.5,children:[e.jsx(W,{item:!0,xs:4,children:e.jsxs(l,{textAlign:"center",children:[e.jsx(c,{variant:"caption",color:v(w.performance.dailyGrowth),fontWeight:"bold",sx:{fontSize:"0.8rem"},children:In(w.performance.dailyGrowth,2)}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem!important",display:"block"},children:w.lastUpdated&&Gt(w.lastUpdated)!==Gt(new Date)?Gt(w.lastUpdated,"dd/MM/yyyy"):r("investorView.daily","Hm nay")})]})}),e.jsx(W,{item:!0,xs:4,children:e.jsxs(l,{textAlign:"center",children:[e.jsx(c,{variant:"caption",color:v(w.performance.monthlyGrowth),fontWeight:"bold",sx:{fontSize:"0.8rem"},children:In(w.performance.monthlyGrowth,2)}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem!important",display:"block"},children:r("investorView.monthly","Thng ny")})]})}),e.jsx(W,{item:!0,xs:4,children:e.jsxs(l,{textAlign:"center",children:[e.jsx(c,{variant:"caption",color:v(w.performance.ytdGrowth),fontWeight:"bold",sx:{fontSize:"0.8rem"},children:In(w.performance.ytdGrowth,2)}),e.jsx(c,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.75rem!important",display:"block"},ellipsis:!1,children:r("investorView.ytd","T u nm (TWR)")})]})})]})]})]})})},w.id)})})}),m&&e.jsxs(l,{sx:{mt:0},children:[e.jsxs(l,{sx:{mb:3,display:"flex",alignItems:"center",justifyContent:"space-between",flexDirection:{xs:"column",sm:"row"},gap:{xs:2,sm:0},p:2,backgroundColor:U(t.palette.primary.main,.05),borderRadius:2,border:`1px solid ${U(t.palette.primary.main,.2)}`},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(l,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:t.palette.primary.main,animation:"pulse 2s infinite"}}),e.jsx(c,{variant:"body1",fontWeight:"600",color:"primary.main",onClick:w=>b(m,w),sx:{cursor:(()=>{var C,k;const w=a.find(A=>A.id===m);return(C=w==null?void 0:w.userPermission)!=null&&C.isOwner||(k=w==null?void 0:w.userPermission)!=null&&k.canUpdate?"pointer":"default"})(),"&:hover":{textDecoration:(()=>{var C,k;const w=a.find(A=>A.id===m);return(C=w==null?void 0:w.userPermission)!=null&&C.isOwner||(k=w==null?void 0:w.userPermission)!=null&&k.canUpdate?"underline":"none"})()}},children:(P=a.find(w=>w.id===m))==null?void 0:P.name})]}),e.jsxs(l,{sx:{display:"flex",gap:1,alignItems:"center"},children:[a.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(ce,{label:` ${r("investorView.previous","Trc")}`,onClick:()=>{const w=a.findIndex(k=>k.id===m),C=w>0?w-1:a.length-1;x(a[C].id)},variant:"outlined",size:"small",sx:{cursor:"pointer","&:hover":{backgroundColor:U(t.palette.primary.main,.1)}}}),e.jsx(ce,{label:`${r("investorView.next","Tip")} `,onClick:()=>{const w=a.findIndex(k=>k.id===m),C=w<a.length-1?w+1:0;x(a[C].id)},variant:"outlined",size:"small",sx:{cursor:"pointer","&:hover":{backgroundColor:U(t.palette.primary.main,.1)}}})]}),e.jsx(ce,{label:r("investorView.close","ng"),onClick:j,color:"primary",size:"small",sx:{cursor:"pointer",fontWeight:600}})]})]}),e.jsx(Tx,{portfolioId:m,accountId:(s==null?void 0:s.accountId)||""})]})]})]}):e.jsx(xn,{maxWidth:"lg",sx:{py:4},children:e.jsx(je,{severity:"warning",children:r("investorView.error.loadFailed","Khng th ti danh sch portfolio. Vui lng th li sau.")})})};var bn=(r=>(r.ACTIVE="ACTIVE",r.ACHIEVED="ACHIEVED",r.PAUSED="PAUSED",r.CANCELLED="CANCELLED",r))(bn||{});const QP=r=>{switch(r){case bn.ACTIVE:return"primary";case bn.ACHIEVED:return"success";case bn.PAUSED:return"warning";case bn.CANCELLED:return"error";default:return"default"}},Cl=r=>{const{achievementPercentage:t,isOverdue:n,createdAt:s,targetDate:a}=r;if(n)return"#f44336";if(t>=100)return"#4caf50";if(!a)return t>=80?"#4caf50":t>=50?"#2196f3":"#03a9f4";const i=new Date,o=new Date(s),d=new Date(a),u=d.getTime()-o.getTime(),h=d.getTime()-i.getTime(),m=Math.max(h/u,0),x=100-t;return m*100<x?x>50?"#f44336":x>30?"#ff5722":"#ff9800":t>=80?"#4caf50":t>=50?"#2196f3":"#03a9f4"},XP=(r,t)=>{const{achievementPercentage:n,isOverdue:s,createdAt:a,targetDate:i}=r;if(s)return t("goals.card.status.overdue");if(n>=100)return t("goals.card.status.completed");if(!i)return n>=80?t("goals.card.status.excellent"):n>=50?t("goals.card.status.okay"):t("goals.card.status.good");const o=new Date,d=new Date(a),u=new Date(i),h=u.getTime()-d.getTime(),m=u.getTime()-o.getTime(),x=Math.max(m/h,0),g=100-n;return x*100<g?g>50?t("goals.card.status.dangerous"):g>30?t("goals.card.status.urgent"):t("goals.card.status.attention"):n>=80?t("goals.card.status.excellent"):n>=50?t("goals.card.status.okay"):t("goals.card.status.good")},Ru=(r,t)=>{const{achievementPercentage:n,isOverdue:s,createdAt:a,targetDate:i}=r;if(s)return t("goals.card.tooltip.overdue");if(n>=100)return t("goals.card.tooltip.completed");if(!i){const b=100-n;return t("goals.card.tooltip.noTargetDate",{progress:Math.round(n),remaining:Math.round(b)})}const o=new Date,d=new Date(a),u=new Date(i),h=u.getTime()-d.getTime(),m=u.getTime()-o.getTime(),x=Math.max(m/h,0),g=100-n,f=x*100<g,y=Math.round(x*100),j=Math.ceil(m/(1e3*60*60*24));return f?t("goals.card.tooltip.warning",{timePercent:y,days:j.toLocaleString(),progressPercent:Math.round(g)}):t("goals.card.tooltip.safe",{timePercent:y,days:j.toLocaleString(),progressPercent:Math.round(g)})},JP=({goal:r,onEdit:t,onDelete:n,onSetPrimary:s,onViewDetails:a})=>{const{t:i}=Ne(),[o,d]=rt.useState(null),[u,h]=rt.useState(!1),[m,x]=rt.useState(!1),g=!!o,f=k=>{d(k.currentTarget)},y=()=>{d(null)},j=k=>{k(),y()},b=()=>{h(!0),y()},v=async()=>{if(n){x(!0);try{await n(r),h(!1)}catch(k){console.error("Error deleting goal:",k)}finally{x(!1)}}},P=()=>{h(!1)},w=()=>r.isAchieved?e.jsx(Xe,{color:"success"}):r.isOverdue?e.jsx(on,{color:"error"}):r.achievementPercentage>=80?e.jsx(He,{color:"primary"}):r.achievementPercentage>=50?e.jsx(Zn,{color:"warning"}):e.jsx(Bt,{color:"error"}),C=()=>r.daysRemaining?r.daysRemaining>0?`${r.daysRemaining.toLocaleString()} ${i("goals.card.daysRemaining")}`:`${i("goals.card.overdue")} ${Math.abs(r.daysRemaining).toLocaleString()} ${i("goals.card.daysRemaining")}`:null;return e.jsxs(se,{sx:{height:"100%",display:"flex",flexDirection:"column",borderRadius:2,boxShadow:1,"&:hover":{boxShadow:3,transform:"translateY(-2px)",transition:"all 0.2s ease-in-out"}},children:[e.jsx(pa,{title:e.jsxs(ft,{direction:"row",alignItems:"center",gap:1,spacing:1,sx:{minWidth:0,flex:1},children:[w(),e.jsx(Fe,{title:r.name,placement:"top",arrow:!0,children:e.jsx(c,{variant:"cardTitle",component:"div",fontWeight:600,children:r.name})}),r.isPrimary&&e.jsx(ce,{icon:e.jsx(ci,{}),label:i("goals.card.primary"),size:"small",color:"primary",variant:"filled",sx:{fontWeight:500,flexShrink:0}})]}),subheader:e.jsx(ft,{direction:"row",gap:1,flexWrap:"wrap",mt:1,minHeight:32,children:C()?e.jsx(ce,{label:C(),size:"small",color:r.isOverdue?"error":"default",variant:r.isOverdue?"filled":"outlined",sx:{fontWeight:500}}):e.jsx(l,{sx:{height:24}})}),action:e.jsxs(l,{sx:{flexShrink:0},children:[e.jsx(Fe,{title:i("goals.options"),children:e.jsx(Ie,{onClick:f,sx:{"&:hover":{backgroundColor:"action.hover"}},children:e.jsx(wr,{})})}),e.jsxs(Gn,{anchorEl:o,open:g,onClose:y,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[a&&e.jsx(re,{onClick:()=>j(()=>a(r)),children:i("goals.viewDetails")}),t&&e.jsx(re,{onClick:()=>j(()=>t(r)),children:i("goals.edit")}),!r.isPrimary&&s&&e.jsx(re,{onClick:()=>j(()=>s(r)),children:i("goals.setPrimary")}),n&&e.jsxs(re,{onClick:b,sx:{color:"error.main"},children:[e.jsx(pt,{sx:{mr:1,fontSize:"1rem"}}),i("goals.delete")]})]})]}),sx:{pb:1,"& .MuiCardHeader-content":{minWidth:0,overflow:"hidden"},"& .MuiCardHeader-action":{flexShrink:0,alignSelf:"flex-start"}}}),e.jsxs(me,{sx:{flexGrow:1,pt:0},children:[e.jsxs(Te,{elevation:0,sx:{p:{xs:1.5,sm:2},mb:{xs:1.5,sm:2},backgroundColor:"grey.50",borderRadius:1.5,border:"1px solid",borderColor:"divider"},children:[e.jsxs(ft,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:1.5,children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",fontWeight:500,children:i("goals.card.progress")}),e.jsxs(ft,{direction:"row",alignItems:"center",gap:1,children:[e.jsx(c,{variant:"cardValue",fontWeight:700,sx:{color:Cl(r),transition:"color 0.3s ease"},children:ye(r.achievementPercentage,1)}),e.jsx(Fe,{title:Ru(r,i),placement:"top",arrow:!0,children:e.jsx(ce,{label:XP(r,i),size:"small",sx:{backgroundColor:Cl(r),color:"white",fontWeight:500,fontSize:"0.75rem",height:20,cursor:"help"}})})]})]}),e.jsx(Fe,{title:Ru(r,i),placement:"top",arrow:!0,children:e.jsx(ds,{variant:"determinate",value:Math.min(r.achievementPercentage,100),sx:{height:8,borderRadius:4,backgroundColor:"grey.200",cursor:"help","& .MuiLinearProgress-bar":{backgroundColor:Cl(r),borderRadius:4,transition:"background-color 0.3s ease"}}})}),e.jsx(ft,{direction:"row",justifyContent:"space-between",alignItems:"center",mt:1,children:e.jsx(c,{variant:"caption",color:"text.secondary",children:G((r.currentValue||0)-(r.targetValue||0))})})]}),e.jsxs(ft,{spacing:{xs:1,sm:1.5},children:[e.jsxs(ft,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",fontWeight:500,children:i("goals.card.currentValue")}),e.jsx(c,{variant:"cardValue",children:G(r.currentValue)})]}),r.targetValue&&e.jsxs(ft,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",fontWeight:500,children:i("goals.card.target")}),e.jsx(c,{variant:"cardValue",children:G(r.targetValue)})]}),e.jsx(bt,{sx:{my:1}}),e.jsxs(ft,{direction:"row",alignItems:"center",spacing:2,sx:{width:"100%"},children:[e.jsx(l,{sx:{flex:1,display:"flex",justifyContent:"left"},children:e.jsx(ce,{label:r.status,size:"small",color:QP(r.status),sx:{fontWeight:500,fontSize:"0.75rem"}})}),e.jsx(l,{sx:{flex:1,px:1},children:e.jsx(Fe,{title:`${i("goals.form.priority")}: ${r.priority===5?i("goals.priority.highest"):r.priority===4?i("goals.priority.high"):r.priority===3?i("goals.priority.medium"):r.priority===2?i("goals.priority.low"):i("goals.priority.lowest")} (${r.priority}/5)`,placement:"top",arrow:!0,children:e.jsxs(l,{children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",fontWeight:500,children:i("goals.form.priority")}),e.jsx(jc,{value:r.priority,min:1,max:5,step:1,marks:[{value:1},{value:2},{value:3},{value:4},{value:5}],disabled:!0,size:"small",sx:{"& .MuiSlider-track":{background:"linear-gradient(to right, #e3f2fd 0%, #bbdefb 25%, #90caf9 50%, #64b5f6 75%, #1976d2 100%)",height:4},"& .MuiSlider-thumb":{backgroundColor:r.priority===1?"#e3f2fd":r.priority===2?"#bbdefb":r.priority===3?"#90caf9":r.priority===4?"#64b5f6":"#1976d2",width:16,height:16,border:"1px solid grey.400"},"& .MuiSlider-mark":{backgroundColor:"transparent"},"& .MuiSlider-rail":{backgroundColor:"#e0e0e0",height:4}}})]})})})]})]})]}),e.jsxs(Rt,{open:u,onClose:P,title:i("goals.deleteConfirm.title","Xc nhn xa mc tiu"),icon:e.jsx(pt,{color:"error"}),titleColor:"error",maxWidth:"sm",loading:m,disableCloseOnBackdrop:m,disableCloseOnEscape:m,children:[e.jsxs(l,{sx:{py:2},children:[e.jsx(c,{variant:"body1",sx:{mb:2},children:i("goals.deleteConfirm.message","Bn c chc chn mun xa mc tiu ny khng?")}),e.jsxs(Te,{elevation:0,sx:{p:2,backgroundColor:"error.50",border:"1px solid",borderColor:"error.200",borderRadius:1},children:[e.jsxs(ft,{direction:"row",alignItems:"center",spacing:1,sx:{mb:1},children:[e.jsx(on,{color:"error",sx:{fontSize:"1.2rem"}}),e.jsx(c,{variant:"subtitle2",fontWeight:600,color:"error.main",children:i("goals.deleteConfirm.warning","Cnh bo")})]}),e.jsx(c,{variant:"body2",color:"error.main",ellipsis:!1,children:i("goals.deleteConfirm.warningMessage","Hnh ng ny khng th hon tc. Tt c d liu lin quan n mc tiu ny s b xa vnh vin.")})]}),e.jsxs(l,{sx:{mt:2,p:2,backgroundColor:"grey.50",borderRadius:1},children:[e.jsx(c,{variant:"subtitle2",fontWeight:600,sx:{mb:1},children:i("goals.deleteConfirm.goalDetails","Chi tit mc tiu s b xa:")}),e.jsxs(ft,{spacing:.5,children:[e.jsxs(c,{variant:"body2",color:"text.secondary",children:[e.jsxs("strong",{children:[i("goals.card.name","Tn"),":"]})," ",r.name]}),e.jsxs(c,{variant:"body2",color:"text.secondary",children:[e.jsxs("strong",{children:[i("goals.card.currentValue","Gi tr hin ti"),":"]})," ",G(r.currentValue)]}),r.targetValue&&e.jsxs(c,{variant:"body2",color:"text.secondary",children:[e.jsxs("strong",{children:[i("goals.card.target","Mc tiu"),":"]})," ",G(r.targetValue)]}),e.jsxs(c,{variant:"body2",color:"text.secondary",children:[e.jsxs("strong",{children:[i("goals.card.progress","Tin "),":"]})," ",ye(r.achievementPercentage,1)]})]})]})]}),e.jsxs(ft,{direction:"row",spacing:2,justifyContent:"flex-end",children:[e.jsx(he,{variant:"outlined",onClick:P,disabled:m,forceTextOnly:!0,mobileText:i("common.cancel","Hy"),desktopText:i("common.cancel","Hy"),sx:{minWidth:100},children:i("common.cancel","Hy")}),e.jsx(We,{variant:"contained",color:"error",onClick:v,disabled:m,icon:m?void 0:e.jsx(pt,{}),forceTextOnly:!0,mobileText:m?i("common.deleting","ang xa..."):i("goals.delete","Xa"),desktopText:m?i("common.deleting","ang xa..."):i("goals.delete","Xa"),sx:{minWidth:120},children:m?i("common.deleting","ang xa..."):i("goals.delete","Xa")})]})]})]})},Ra={createGoal:(r,t)=>q.post("/api/v1/goals",r,{params:{accountId:t}}),getAllGoals:(r,t)=>q.get("/api/v1/goals",{params:{accountId:r,portfolioId:t}}),getGoalById:(r,t)=>q.get(`/api/v1/goals/${r}`,{params:{accountId:t}}),updateGoal:(r,t,n)=>q.put(`/api/v1/goals/${r}`,t,{params:{accountId:n}}),deleteGoal:(r,t)=>q.delete(`/api/v1/goals/${r}`,{params:{accountId:t}}),updateGoalProgress:(r,t)=>q.post(`/api/v1/goals/${r}/update-progress`,{},{params:{accountId:t}}),getGoalProgress:(r,t)=>q.get(`/api/v1/goals/${r}/progress`,{params:{accountId:t}}),getGoalsByStatus:(r,t)=>q.get(`/api/v1/goals/status/${r}`,{params:{accountId:t}}),getPrimaryGoals:r=>q.get("/api/v1/goals/primary/list",{params:{accountId:r}}),setPrimaryGoal:(r,t)=>q.post(`/api/v1/goals/${r}/set-primary`,{},{params:{accountId:t}}),createAssetAllocation:(r,t,n)=>q.post(`/api/v1/goals/${r}/allocations`,t,{params:{accountId:n}}),getAssetAllocations:(r,t)=>q.get(`/api/v1/goals/${r}/allocations`,{params:{accountId:t}}),getAssetAllocationSummary:(r,t)=>q.get(`/api/v1/goals/${r}/allocations/summary`,{params:{accountId:t}}),getAssetRebalancingCandidates:r=>q.get("/api/v1/goals/allocations/rebalancing-candidates",{params:{accountId:r}}),updateAssetAllocation:(r,t,n,s)=>q.put(`/api/v1/goals/${r}/allocations/${t}`,n,{params:{accountId:s}}),deleteAssetAllocation:(r,t,n)=>q.delete(`/api/v1/goals/${r}/allocations/${t}`,{params:{accountId:n}}),rebalanceAssetAllocation:(r,t,n,s)=>q.post(`/api/v1/goals/${r}/allocations/${t}/rebalance`,n,{params:{accountId:s}}),createAlert:(r,t,n)=>q.post(`/api/v1/goals/${r}/alerts`,t,{params:{accountId:n}}),getAlertsByGoal:(r,t)=>q.get(`/api/v1/goals/${r}/alerts`,{params:{accountId:t}}),getPendingAlerts:r=>q.get("/api/v1/goals/alerts/pending",{params:{accountId:r}}),getAlertStats:r=>q.get("/api/v1/goals/alerts/stats",{params:{accountId:r}}),getAlertsByType:(r,t)=>q.get(`/api/v1/goals/alerts/type/${r}`,{params:{accountId:t}}),getCriticalAlerts:r=>q.get("/api/v1/goals/alerts/critical",{params:{accountId:r}}),getWarningAlerts:r=>q.get("/api/v1/goals/alerts/warnings",{params:{accountId:r}}),getAchievementAlerts:r=>q.get("/api/v1/goals/alerts/achievements",{params:{accountId:r}}),getRebalanceAlerts:r=>q.get("/api/v1/goals/alerts/rebalance",{params:{accountId:r}}),getDeadlineAlerts:r=>q.get("/api/v1/goals/alerts/deadlines",{params:{accountId:r}}),acknowledgeAlert:(r,t)=>q.put(`/api/v1/goals/alerts/${r}/acknowledge`,{},{params:{accountId:t}}),dismissAlert:(r,t)=>q.put(`/api/v1/goals/alerts/${r}/dismiss`,{},{params:{accountId:t}}),cleanupOldAlerts:(r,t)=>q.delete("/api/v1/goals/alerts/cleanup",{params:{accountId:r,daysOld:t}}),getRebalancingHistory:(r,t)=>q.get(`/api/v1/goals/${r}/rebalancing/history`,{params:{accountId:t}}),getRebalancingStats:(r,t)=>q.get(`/api/v1/goals/${r}/rebalancing/stats`,{params:{accountId:t}}),getRebalancingPerformance:(r,t,n)=>q.get(`/api/v1/goals/${r}/rebalancing/performance`,{params:{accountId:t,days:n}}),getRebalancingCandidates:r=>q.get("/api/v1/goals/rebalancing/candidates",{params:{accountId:r}}),executeRebalancing:(r,t,n)=>q.post(`/api/v1/goals/${r}/rebalancing/execute`,t,{params:{accountId:n}}),createRebalancingHistory:(r,t,n)=>q.post(`/api/v1/goals/${r}/rebalancing/history`,t,{params:{accountId:n}}),getAvailablePortfolios:r=>q.get("/api/v1/goals/portfolios/available",{params:{accountId:r}})},ZP=r=>[{value:5,label:r("goals.priority.highest")},{value:4,label:r("goals.priority.high")},{value:3,label:r("goals.priority.medium")},{value:2,label:r("goals.priority.low")},{value:1,label:r("goals.priority.lowest")}],eD=({open:r,onClose:t,onSubmit:n,goal:s,loading:a=!1,accountId:i})=>{const{t:o}=Ne(),{portfolios:d=[]}=Un(i),[u,h]=p.useState([]),[m,x]=p.useState({portfolioIds:[],name:"",description:"",targetValue:0,targetDate:void 0,priority:3,status:bn.ACTIVE,isPrimary:!1,autoTrack:!0}),[g,f]=p.useState({});p.useEffect(()=>{i&&Ra.getAvailablePortfolios(i).then(w=>{h(w.portfolios)}).catch(w=>{console.error("Error loading available portfolios:",w)})},[i]),p.useEffect(()=>{u.length>0&&m.portfolioIds.length===0&&(s||x(w=>({...w,portfolioIds:[u[0].portfolioId]})))},[u,s]),p.useEffect(()=>{x(s?{portfolioIds:s.portfolioId||[],name:s.name||"",description:s.description||"",targetValue:s.targetValue||0,targetDate:s.targetDate||void 0,priority:s.priority||3,status:s.status||bn.ACTIVE,isPrimary:s.isPrimary||!1,autoTrack:s.autoTrack!==void 0?s.autoTrack:!0}:{portfolioIds:[],name:"",description:"",targetValue:0,targetDate:void 0,priority:3,status:bn.ACTIVE,isPrimary:!1,autoTrack:!0}),f({})},[s,r]),p.useEffect(()=>{s&&d.length>0&&m.portfolioIds.length===0&&x(w=>({...w,portfolioIds:s.portfolioId||[]}))},[s,d,m.portfolioIds.length]);const y=(w,C)=>{x(k=>({...k,[w]:C})),g[w]&&f(k=>({...k,[w]:""}))},j=()=>{const w={};return(!m.portfolioIds||m.portfolioIds.length===0)&&(u.length===0&&!s?w.portfolioIds=o("goals.form.noPortfolios"):w.portfolioIds=o("goals.form.selectPortfolio")),m.name.trim()||(w.name=o("goals.form.nameRequired")),(!m.targetValue||m.targetValue<=0)&&(w.targetValue=o("goals.form.valueRequired")),f(w),Object.keys(w).length===0},b=()=>{j()&&n(m)},v=()=>{x({portfolioIds:[],name:"",description:"",targetValue:0,targetDate:void 0,priority:3,status:bn.ACTIVE,isPrimary:!1,autoTrack:!0}),f({}),t()},P=e.jsxs(ft,{direction:"row",gap:2,children:[e.jsx(he,{onClick:v,disabled:a,variant:"outlined",forceTextOnly:!0,mobileText:o("common.cancel"),desktopText:o("common.cancel"),sx:{px:3},children:o("common.cancel")}),e.jsx(We,{onClick:b,variant:"contained",disabled:a,forceTextOnly:!0,mobileText:o(a?"goals.form.saving":s?"goals.form.update":"goals.form.create"),desktopText:o(a?"goals.form.saving":s?"goals.form.update":"goals.form.create"),sx:{px:3,borderRadius:2},children:o(a?"goals.form.saving":s?"goals.form.update":"goals.form.create")})]});return e.jsxs(Rt,{open:r,onClose:v,title:o(s?"goals.edit":"goals.create"),actions:P,loading:a,maxWidth:"md",size:"medium",children:[e.jsx(c,{variant:"pageTitle",color:"text.secondary",mb:3,children:o(s?"goals.form.editTitle":"goals.form.title")}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,children:e.jsx(jo,{multiple:!0,options:u,getOptionLabel:w=>w.name||"",value:!m.portfolioIds||m.portfolioIds.length===0?[]:u.filter(w=>m.portfolioIds.includes(w.portfolioId)),onChange:(w,C)=>{const k=C.map(A=>A.portfolioId);y("portfolioIds",k)},renderTags:(w,C)=>w.map((k,A)=>p.createElement(ce,{...C({index:A}),key:k.portfolioId,label:k.name,size:"small",sx:{fontWeight:500}})),renderInput:w=>e.jsx(Ae,{...w,label:o("goals.form.linkedPortfolios"),error:!!g.portfolioIds,helperText:g.portfolioIds,InputLabelProps:{children:e.jsx(c,{variant:"body2",fontWeight:500,children:o("goals.form.linkedPortfolios")})}}),renderOption:(w,C)=>{const{key:k,...A}=w;return e.jsx(l,{component:"li",...A,children:e.jsx(ft,{direction:"row",alignItems:"center",gap:1,children:e.jsx(c,{variant:"body2",children:C.name})})},k)},isOptionEqualToValue:(w,C)=>w.portfolioId===C.portfolioId,noOptionsText:o(s?"goals.form.noPortfoliosEdit":"goals.form.noPortfolios"),loadingText:o("common.loading"),size:"medium"},(s==null?void 0:s.id)||"new")}),e.jsx(W,{item:!0,xs:12,children:e.jsx(Ae,{fullWidth:!0,label:o("goals.form.name"),value:m.name,onChange:w=>y("name",w.target.value),error:!!g.name,helperText:g.name,required:!0,placeholder:o("goals.form.namePlaceholder"),InputLabelProps:{children:e.jsx(c,{variant:"body2",fontWeight:500,children:o("goals.form.name")})}})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(Ae,{fullWidth:!0,label:o("goals.form.description"),value:m.description,onChange:w=>y("description",w.target.value),multiline:!0,rows:2,placeholder:o("goals.form.descriptionPlaceholder"),InputLabelProps:{children:e.jsx(c,{variant:"body2",fontWeight:500,children:o("goals.form.description")})}})}),e.jsx(W,{item:!0,xs:12,sm:5,children:e.jsx(vr,{value:m.targetValue||0,onChange:w=>y("targetValue",w),label:o("goals.form.targetValue"),placeholder:o("goals.form.targetValuePlaceholder"),error:!!g.targetValue,helperText:g.targetValue,currency:"VND",showCurrency:!0})}),e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsx(Ae,{label:o("goals.form.targetDate"),type:"date",fullWidth:!0,value:m.targetDate||"",onChange:w=>y("targetDate",w.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(W,{item:!0,xs:12,sm:3,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:e.jsx(c,{variant:"body2",fontWeight:500,children:o("goals.form.priority")})}),e.jsx(Ze,{value:m.priority,onChange:w=>y("priority",Number(w.target.value)),label:o("goals.form.priority"),children:ZP(o).map(w=>e.jsx(re,{value:w.value,children:e.jsx(c,{variant:"body2",children:w.label})},w.value))})]})}),e.jsx(W,{item:!0,xs:12,children:e.jsxs(ft,{direction:"row",gap:3,flexWrap:"wrap",alignItems:"center",children:[e.jsx(an,{control:e.jsx(jn,{checked:m.status===bn.ACTIVE,onChange:w=>y("status",w.target.checked?bn.ACTIVE:bn.PAUSED),color:"primary"}),label:e.jsx(c,{variant:"body2",fontWeight:500,children:m.status===bn.ACTIVE?o("goals.status.active"):o("goals.status.paused")})}),e.jsx(an,{control:e.jsx(jn,{checked:m.isPrimary,onChange:w=>y("isPrimary",w.target.checked),color:"primary"}),label:e.jsx(c,{variant:"body2",fontWeight:500,children:o("goals.form.isPrimary")})}),e.jsx(an,{control:e.jsx(jn,{checked:m.autoTrack,onChange:w=>y("autoTrack",w.target.checked),color:"primary"}),label:e.jsx(c,{variant:"body2",fontWeight:500,children:o("goals.form.autoTrack")})})]})})]})]})},tD=(r,t)=>yt({queryKey:["goals",r,t],queryFn:()=>Ra.getAllGoals(r,t),enabled:!!r}),nD=r=>{const t=Kt();return jt({mutationFn:n=>Ra.createGoal(n,r),onSuccess:()=>{t.invalidateQueries({queryKey:["goals",r]}),t.invalidateQueries({queryKey:["goals"]}),t.invalidateQueries({queryKey:["goals","status"]}),t.invalidateQueries({queryKey:["goals","primary",r]}),t.refetchQueries({queryKey:["goals",r]})}})},rD=r=>{const t=Kt();return jt({mutationFn:({id:n,data:s})=>Ra.updateGoal(n,s,r),onSuccess:(n,{id:s})=>{t.invalidateQueries({queryKey:["goal",s,r]}),t.invalidateQueries({queryKey:["goals",r]}),t.invalidateQueries({queryKey:["goals"]}),t.invalidateQueries({queryKey:["goals","status"]}),t.invalidateQueries({queryKey:["goals","primary",r]}),t.invalidateQueries({queryKey:["goal-progress",s,r]}),t.refetchQueries({queryKey:["goals",r]})}})},sD=r=>{const t=Kt();return jt({mutationFn:n=>Ra.deleteGoal(n,r),onSuccess:()=>{t.invalidateQueries({queryKey:["goals",r]}),t.invalidateQueries({queryKey:["goals"]}),t.invalidateQueries({queryKey:["goals","status"]}),t.invalidateQueries({queryKey:["goals","primary",r]}),t.refetchQueries({queryKey:["goals",r]})}})},aD=r=>{const t=Kt();return jt({mutationFn:n=>Ra.setPrimaryGoal(n,r),onSuccess:()=>{t.invalidateQueries({queryKey:["goals",r]}),t.invalidateQueries({queryKey:["goals"]}),t.invalidateQueries({queryKey:["goals","primary",r]}),t.refetchQueries({queryKey:["goals",r]})}})},iD=r=>{switch(r){case bn.ACTIVE:return"primary";case bn.ACHIEVED:return"success";case bn.PAUSED:return"warning";case bn.CANCELLED:return"error";default:return"default"}},oD=r=>{const{achievementPercentage:t,isOverdue:n,createdAt:s,targetDate:a}=r;if(n)return"#f44336";if(t>=100)return"#4caf50";if(!a)return t>=80?"#4caf50":t>=50?"#2196f3":"#03a9f4";const i=new Date,o=new Date(s),d=new Date(a),u=d.getTime()-o.getTime(),h=d.getTime()-i.getTime(),m=Math.max(h/u,0),x=100-t;return m*100<x?x>50?"#f44336":x>30?"#ff5722":"#ff9800":t>=80?"#4caf50":t>=50?"#2196f3":"#03a9f4"},lD=({accountId:r,portfolioId:t})=>{const{t:n}=Ne(),s=Je(),[a,i]=p.useState(!1),[o,d]=p.useState(null),[u,h]=p.useState("ALL"),[m,x]=p.useState(""),[g,f]=p.useState(!1),[y,j]=p.useState("grid"),[b,v]=p.useState(0),[P,w]=p.useState(10),[C,k]=p.useState({}),{data:A,isLoading:L,error:T}=tD(r,t),M=nD(r),O=rD(r),I=sD(r),z=aD(r),N=(A==null?void 0:A.filter(H=>{var J;const Q=u==="ALL"||H.status===u,Z=H.name.toLowerCase().includes(m.toLowerCase())||((J=H.description)==null?void 0:J.toLowerCase().includes(m.toLowerCase()));return Q&&Z}).sort((H,Q)=>H.priority!==Q.priority?Q.priority-H.priority:new Date(Q.createdAt).getTime()-new Date(H.createdAt).getTime()))||[],E=y==="table"?N.slice(b*P,b*P+P):N,R=H=>{M.mutate(H,{onSuccess:()=>{i(!1)}})},V=H=>{o&&O.mutate({id:o.id,data:H},{onSuccess:()=>{d(null),i(!1)}})},F=H=>{I.mutate(H.id)},B=H=>{z.mutate(H.id)},$=H=>{d(H),i(!0)},Y=()=>{i(!1),d(null)},_=(H,Q)=>{v(Q)},K=H=>{w(parseInt(H.target.value,10)),v(0)},X=(H,Q)=>{k(Z=>({...Z,[Q]:H.currentTarget}))},ne=H=>{k(Q=>({...Q,[H]:null}))},oe=(H,Q)=>{H(),ne(Q)},ee=(A==null?void 0:A.reduce((H,Q)=>{const Z=Q.status;return H[Z]=(H[Z]||0)+1,H},{}))||{};return L?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsx(Ce,{})}):T?e.jsx(je,{severity:"error",sx:{mb:3},children:n("goals.list.error")}):e.jsxs(l,{children:[e.jsx(l,{sx:{mb:2},children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(l,{children:[e.jsx(c,{variant:"pageHeader",sx:{background:`linear-gradient(135deg, ${s.palette.primary.main} 0%, ${s.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1},children:n("goals.list.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",sx:{display:{xs:"none",md:"block"}},children:n("goals.list.subtitle")})]}),e.jsx(l,{sx:{display:"flex",gap:1,alignItems:"center"},children:e.jsx(he,{variant:"contained",icon:e.jsx(xt,{}),onClick:()=>i(!0),mobileText:n("goals.create"),desktopText:n("goals.create"),breakpoint:"sm",sx:{borderRadius:2},children:n("goals.create")})})]})}),e.jsxs(l,{sx:{px:{xs:0,sm:4}},children:[e.jsxs(ft,{direction:"row",alignItems:"center",gap:2,mb:2,children:[e.jsx(he,{variant:"outlined",icon:e.jsx(Ir,{}),onClick:()=>f(!g),mobileText:n("goals.list.filters"),desktopText:n("goals.list.filters"),breakpoint:"sm",sx:{borderColor:"divider",borderRadius:2,"&:hover":{borderColor:"primary.main",backgroundColor:"primary.50"}},children:n("goals.list.filters")}),(m||u!=="ALL")&&e.jsx(he,{variant:"text",size:"small",onClick:()=>{x(""),h("ALL")},mobileText:n("goals.list.clearFilters"),desktopText:n("goals.list.clearFilters"),breakpoint:"sm",sx:{color:"text.secondary"},children:n("goals.list.clearFilters")})]}),g&&e.jsx(Te,{elevation:0,sx:{p:3,border:"1px solid",borderColor:"divider",borderRadius:2,mb:3,background:`linear-gradient(135deg, ${U(s.palette.background.paper,.8)} 0%, ${U(s.palette.background.paper,.6)} 100%)`},children:e.jsxs(ft,{direction:"row",gap:2,flexWrap:"wrap",alignItems:"center",children:[e.jsx(Ae,{label:n("goals.list.search"),value:m,onChange:H=>x(H.target.value),size:"small",sx:{minWidth:250},placeholder:n("goals.list.searchPlaceholder")}),e.jsxs(nt,{size:"small",sx:{minWidth:160},children:[e.jsx(st,{children:n("goals.list.status")}),e.jsxs(Ze,{value:u,onChange:H=>h(H.target.value),label:n("goals.list.status"),children:[e.jsx(re,{value:"ALL",children:n("goals.list.allStatuses")}),e.jsx(re,{value:bn.ACTIVE,children:n("goals.status.active")}),e.jsx(re,{value:bn.ACHIEVED,children:n("goals.status.achieved")}),e.jsx(re,{value:bn.PAUSED,children:n("goals.status.paused")}),e.jsx(re,{value:bn.CANCELLED,children:n("goals.status.cancelled")})]})]})]})}),e.jsx(bt,{sx:{my:2}}),e.jsxs(ft,{direction:"row",gap:2,flexWrap:"wrap",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(ft,{direction:"row",gap:1,flexWrap:"wrap",alignItems:"center",children:[e.jsxs(c,{variant:"body2",color:"text.secondary",mr:1,children:[n("goals.list.overview"),":"]}),Object.keys(ee).length>0&&Object.entries(ee).map(([H,Q])=>e.jsx(ce,{label:`${n(`goals.status.${H.toLowerCase()}`,H)}: ${Q}`,variant:u===H?"filled":"outlined",onClick:()=>h(H),clickable:!0,size:"small",sx:{"&:hover":{backgroundColor:u===H?"primary.main":"action.hover"}}},H))]}),e.jsxs(Te,{elevation:0,sx:{display:"flex",border:"1px solid",borderColor:"divider",borderRadius:2,overflow:"hidden"},children:[e.jsx(Fe,{title:n("goals.list.gridView","Xem dng li"),children:e.jsx(Ie,{onClick:()=>j("grid"),sx:{backgroundColor:y==="grid"?"primary.main":"transparent",color:y==="grid"?"primary.contrastText":"text.secondary",borderRadius:0,"&:hover":{backgroundColor:y==="grid"?"primary.dark":"action.hover"}},size:"small",children:e.jsx(vo,{})})}),e.jsx(Fe,{title:n("goals.list.tableView","Xem dng bng"),children:e.jsx(Ie,{onClick:()=>j("table"),sx:{backgroundColor:y==="table"?"primary.main":"transparent",color:y==="table"?"primary.contrastText":"text.secondary",borderRadius:0,"&:hover":{backgroundColor:y==="table"?"primary.dark":"action.hover"}},size:"small",children:e.jsx(wo,{})})})]})]}),e.jsx(l,{sx:{mt:2},children:N.length===0?e.jsxs(Te,{elevation:0,sx:{p:6,textAlign:"center",border:`1px solid ${U(s.palette.divider,.1)}`,borderRadius:3,background:`linear-gradient(135deg, ${U(s.palette.background.paper,.8)} 0%, ${U(s.palette.background.paper,.6)} 100%)`},children:[e.jsx(c,{variant:"h5",color:"text.secondary",mb:1,fontWeight:500,children:n(m||u!=="ALL"?"goals.list.noGoalsFiltered":"goals.list.noGoals")}),e.jsx(c,{variant:"body1",color:"text.secondary",mb:3,children:n(m||u!=="ALL"?"goals.list.noGoalsFilteredMessage":"goals.list.noGoalsMessage")}),e.jsx(he,{variant:"contained",icon:e.jsx(xt,{}),onClick:()=>i(!0),mobileText:n(m||u!=="ALL"?"goals.list.clearFiltersAction":"goals.list.createFirstAction"),desktopText:n(m||u!=="ALL"?"goals.list.clearFiltersAction":"goals.list.createFirstAction"),breakpoint:"sm",sx:{borderRadius:2},children:n(m||u!=="ALL"?"goals.list.clearFiltersAction":"goals.list.createFirstAction")})]}):y==="grid"?e.jsx(W,{container:!0,spacing:3,children:N.map(H=>e.jsx(W,{item:!0,xs:12,sm:6,md:6,lg:4,xl:3,children:e.jsx(JP,{goal:H,onEdit:$,onDelete:F,onSetPrimary:B})},H.id))}):e.jsxs(at,{component:Te,elevation:0,sx:{border:"1px solid",borderColor:"divider",borderRadius:2,background:`linear-gradient(135deg, ${U(s.palette.background.paper,.8)} 0%, ${U(s.palette.background.paper,.6)} 100%)`},children:[e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:"grey.50"},children:[e.jsx(S,{sx:{fontWeight:600},children:n("goals.card.name","Tn mc tiu")||"Tn mc tiu"}),e.jsx(S,{sx:{fontWeight:600},children:n("goals.form.status","Trng thi")||"Trng thi"}),e.jsx(S,{sx:{fontWeight:600},children:n("goals.card.progress","Tin ")||"Tin "}),e.jsx(S,{sx:{fontWeight:600},children:n("goals.card.currentValue","Gi tr hin ti")||"Gi tr hin ti"}),e.jsx(S,{sx:{fontWeight:600},children:n("goals.card.target","Mc tiu")||"Mc tiu"}),e.jsx(S,{sx:{fontWeight:600},children:n("goals.form.priority"," u tin")||" u tin"}),e.jsx(S,{sx:{fontWeight:600},children:n("goals.card.date","Thi gian")||"Thi gian"}),e.jsx(S,{align:"center",sx:{fontWeight:600},children:n("common.actions","Thao tc")||"Thao tc"})]})}),e.jsx(ot,{children:E.map(H=>e.jsxs(De,{hover:!0,sx:{"&:last-child td, &:last-child th":{border:0},"&:hover":{backgroundColor:"action.hover"}},children:[e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[H.isPrimary&&e.jsx(ce,{icon:e.jsx(ci,{}),label:n("goals.card.primary"),size:"small",color:"primary",variant:"filled",sx:{fontSize:"0.7rem",height:20}}),e.jsx(c,{variant:"body2",fontWeight:500,children:H.name})]})}),e.jsx(S,{children:e.jsx(ce,{label:n(`goals.status.${H.status.toLowerCase()}`,H.status),size:"small",color:iD(H.status),sx:{fontWeight:500,fontSize:"0.75rem"}})}),e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(l,{sx:{width:60},children:e.jsx(ds,{variant:"determinate",value:Math.min(H.achievementPercentage,100),sx:{height:6,borderRadius:3,backgroundColor:"grey.200","& .MuiLinearProgress-bar":{backgroundColor:oD(H),borderRadius:3}}})}),e.jsx(c,{variant:"body2",fontWeight:600,children:ye(H.achievementPercentage,1)||"0%"})]})}),e.jsx(S,{children:e.jsx(c,{variant:"body2",fontWeight:500,children:G(H.currentValue)||"0 VND"})}),e.jsx(S,{children:e.jsx(c,{variant:"body2",fontWeight:500,children:H.targetValue?G(H.targetValue)||"0 VND":"-"})}),e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(l,{sx:{width:40},children:e.jsx(jc,{value:H.priority,min:1,max:5,step:1,disabled:!0,size:"small",sx:{"& .MuiSlider-track":{background:"linear-gradient(to right, #e3f2fd 0%, #bbdefb 25%, #90caf9 50%, #64b5f6 75%, #1976d2 100%)",height:3},"& .MuiSlider-thumb":{backgroundColor:H.priority===1?"#e3f2fd":H.priority===2?"#bbdefb":H.priority===3?"#90caf9":H.priority===4?"#64b5f6":"#1976d2",width:12,height:12},"& .MuiSlider-rail":{backgroundColor:"#e0e0e0",height:3}}})}),e.jsxs(c,{variant:"body2",fontWeight:500,children:[H.priority,"/5"]})]})}),e.jsx(S,{children:H.daysRemaining?e.jsx(ce,{label:H.daysRemaining>0?`${H.daysRemaining.toLocaleString()} ${n("goals.card.daysRemaining")}`:`${n("goals.card.overdue")} ${Math.abs(H.daysRemaining).toLocaleString()} ${n("goals.card.daysRemaining")}`,size:"small",color:H.isOverdue?"error":"default",variant:H.isOverdue?"filled":"outlined",sx:{fontWeight:500,fontSize:"0.75rem"}}):e.jsx(c,{variant:"body2",color:"text.secondary",children:"-"})}),e.jsx(S,{align:"center",children:e.jsxs(l,{sx:{display:"flex",gap:.5,justifyContent:"center"},children:[e.jsx(Fe,{title:n("goals.options"),children:e.jsx(Ie,{onClick:Q=>X(Q,H.id),size:"small",sx:{color:"text.secondary"},children:e.jsx(wr,{})})}),e.jsxs(Gn,{anchorEl:C[H.id],open:!!C[H.id],onClose:()=>ne(H.id),anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsx(re,{onClick:()=>oe(()=>$(H),H.id),children:n("goals.edit")}),!H.isPrimary&&e.jsx(re,{onClick:()=>oe(()=>B(H),H.id),children:n("goals.setPrimary")}),e.jsxs(re,{onClick:()=>oe(()=>F(H),H.id),sx:{color:"error.main"},children:[e.jsx(pt,{sx:{mr:1,fontSize:"1rem"}}),n("goals.delete")]})]})]})})]},H.id))})]}),e.jsx(hi,{rowsPerPageOptions:[5,10,25,50],component:"div",count:N.length,rowsPerPage:P,page:b,onPageChange:_,onRowsPerPageChange:K,labelRowsPerPage:n("goals.list.rowsPerPage","S dng"),labelDisplayedRows:({from:H,to:Q,count:Z})=>`${H}-${Q} ${n("goals.list.of","ca")||"ca"} ${Z}`,size:"small"})]})})]}),e.jsx(eD,{open:a,onClose:Y,onSubmit:H=>{o?V(H):R(H)},goal:o||void 0,loading:M.isLoading||O.isLoading,accountId:r})]})},cD=()=>{const{portfolioId:r}=So(),{accountId:t}=Ge();return t?e.jsx(l,{children:e.jsx(lD,{accountId:t,portfolioId:r})}):e.jsx(xn,{maxWidth:"lg",children:e.jsx(l,{sx:{p:3,textAlign:"center"},children:e.jsx("div",{children:"Please login to access goals"})})})};class dD{generateDeviceFingerprint(){if(this.detectIncognitoMode())return this.hashFingerprint(`incognito_${Date.now()}_${Math.random()}`);const n=this.getCanvasFingerprint(),s=this.getWebGLFingerprint(),a=this.getAudioFingerprint(),i=this.getScreenFingerprint(),o=Intl.DateTimeFormat().resolvedOptions().timeZone,d=navigator.language,u=navigator.platform,h=navigator.userAgent,m=navigator.hardwareConcurrency||0,x=navigator.maxTouchPoints||0,g={canvas:n,webgl:s,audio:a,screen:i,timezone:o,language:d,platform:u,userAgent:h,hardwareConcurrency:m,maxTouchPoints:x};return this.hashFingerprint(JSON.stringify(g))}detectIncognitoMode(){try{if(!window.localStorage)return!0;const t="incognito_test";try{localStorage.setItem(t,"test"),localStorage.removeItem(t)}catch{return!0}return!!(!window.indexedDB||navigator.webkitTemporaryStorage&&!navigator.webkitTemporaryStorage.queryUsageAndQuota||navigator.connection&&navigator.connection.effectiveType==="slow-2g")}catch{return!0}}getCanvasFingerprint(){try{const t=document.createElement("canvas"),n=t.getContext("2d");return n?(n.textBaseline="top",n.font="14px Arial",n.fillStyle="#f60",n.fillRect(125,1,62,20),n.fillStyle="#069",n.fillText("Device fingerprint",2,15),n.fillStyle="rgba(102, 204, 0, 0.7)",n.fillText("Device fingerprint",4,17),t.toDataURL()):""}catch{return""}}getWebGLFingerprint(){try{const t=document.createElement("canvas"),n=t.getContext("webgl")||t.getContext("experimental-webgl");if(!n)return"";const s=n,a=s.getParameter(s.VENDOR)||"",i=s.getParameter(s.RENDERER)||"",o=s.getParameter(s.VERSION)||"",d=s.getParameter(s.SHADING_LANGUAGE_VERSION)||"";return`${a}|${i}|${o}|${d}`}catch{return""}}getAudioFingerprint(){try{const t=new(window.AudioContext||window.webkitAudioContext),n=t.createOscillator(),s=t.createAnalyser(),a=t.createGain();n.connect(s),s.connect(a),a.connect(t.destination),n.frequency.value=1e3,n.start();const i=new Uint8Array(s.frequencyBinCount);return s.getByteFrequencyData(i),n.stop(),Array.from(i).join("")}catch{return""}}getScreenFingerprint(){return`${screen.width}x${screen.height}x${screen.colorDepth}x${screen.pixelDepth}`}hashFingerprint(t){let n=0;for(let s=0;s<t.length;s++){const a=t.charCodeAt(s);n=(n<<5)-n+a,n=n&n}return Math.abs(n).toString(36)}}const uD=new dD;class hD{async getDeviceInfo(){const t=uD.generateDeviceFingerprint(),n=this.getDeviceName(),s=navigator.userAgent,a=await this.getIPAddress(),i=await this.getLocation();return{deviceFingerprint:t,deviceName:n,browserInfo:s,ipAddress:a,location:i}}async checkDeviceTrust(t){return console.warn("DEPRECATED: checkDeviceTrust method is deprecated. Device trust is now handled in login API."),!1}async getTrustedDevices(){try{return(await q.api.get("/api/v1/device-trust/devices")).data}catch(t){return console.error("Error getting trusted devices:",t),[]}}async addTrustedDevice(){try{const t=await this.getDeviceInfo();await q.api.post("/api/v1/device-trust/devices",t)}catch(t){throw console.error("Error adding trusted device:",t),t}}async revokeDevice(t){try{await q.api.delete(`/api/v1/device-trust/devices/${t}`)}catch(n){throw console.error("Error revoking device:",n),n}}async revokeDeviceByFingerprintAndUsername(t,n){try{await q.api.delete(`/api/v1/device-trust/devices/fingerprint/${t}/username/${n}`)}catch(s){throw console.error("Error revoking device by fingerprint and username:",s),s}}async revokeAllDevices(){try{await q.api.delete("/api/v1/device-trust/devices")}catch(t){throw console.error("Error revoking all devices:",t),t}}async getDeviceStats(){try{return(await q.api.get("/api/v1/device-trust/stats")).data}catch(t){return console.error("Error getting device stats:",t),{totalDevices:0,activeDevices:0,expiredDevices:0,highTrustDevices:0}}}getDeviceName(){const t=navigator.userAgent,n=/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t),s=/iPad|Android(?!.*Mobile)/i.test(t),a=!n&&!s;let i="Unknown Browser";t.includes("Edg/")?i="Microsoft Edge":t.includes("Chrome/")?i="Google Chrome":t.includes("Firefox/")?i="Mozilla Firefox":t.includes("Safari/")&&!t.includes("Chrome")?i="Safari":(t.includes("Opera/")||t.includes("OPR/"))&&(i="Opera");let o="Unknown OS";t.includes("Windows NT 10.0")?o="Windows 10/11":t.includes("Windows NT 6.3")?o="Windows 8.1":t.includes("Windows NT 6.1")?o="Windows 7":t.includes("Mac OS X")?o="macOS":t.includes("Linux")?o="Linux":t.includes("Android")?o="Android":(t.includes("iPhone")||t.includes("iPad"))&&(o="iOS");let d="";return n?d="mobile":s?d="tablet":a?d="desktop":d="device",`${d}  ${i}  ${o}`}async getIPAddress(){return"unknown"}async getLocation(){var n;try{const s=Intl.DateTimeFormat().resolvedOptions().timeZone;if(s)return s.includes("Ho_Chi_Minh")||s.includes("Bangkok")?"Vit Nam":s.includes("Tokyo")?"Nht Bn":s.includes("Seoul")?"Hn Quc":s.includes("Singapore")?"Singapore":s.includes("New_York")?"Hoa K":s.includes("London")?"Anh":s.includes("Paris")?"Php":s.includes("Berlin")?"c":s.includes("Sydney")?"c":s.replace(/_/g," ")}catch{console.log("Could not detect location from timezone")}const t=navigator.language||((n=navigator.languages)==null?void 0:n[0]);return t!=null&&t.startsWith("vi")?"Vit Nam":t!=null&&t.startsWith("en")?"English":t!=null&&t.startsWith("ja")?"Japan":t!=null&&t.startsWith("ko")?"Korea":t!=null&&t.startsWith("zh")?"China":"Khng xc nh"}getTrustLevelColor(t){switch(t){case"HIGH":return"#4caf50";case"MEDIUM":return"#ff9800";case"LOW":return"#f44336";default:return"#9e9e9e"}}getTrustLevelLabel(t){switch(t){case"HIGH":return"High Trust";case"MEDIUM":return"Medium Trust";case"LOW":return"Low Trust";default:return"Unknown"}}}const zr=new hD,mD=()=>{const{t:r}=Ne(),t=An(),[n]=vc(),{updateAuthState:s}=Ge(),[a,i]=p.useState(""),[o,d]=p.useState(""),[u,h]=p.useState(!1),[m,x]=p.useState(!1),[g,f]=p.useState(null),[y,j]=p.useState("UNKNOWN"),[b,v]=p.useState([]),[P,w]=p.useState(!0),[C,k]=p.useState("username"),A=()=>n.get("redirect")||"/";p.useEffect(()=>{const R=js.getUserHistory();v(R)},[]),p.useEffect(()=>{a.length>=3&&(k("username"),j("UNKNOWN"))},[a]);const L=async()=>{var F,B,$;if(!a.trim()){f(r("login.errors.usernameRequired"));return}const R=a.toLowerCase().trim().replace(/\s+/g,"");if(!/^[a-zA-Z0-9_-]+$/.test(R)){f(r("login.errors.usernameFormat"));return}x(!0),f(null);try{const Y=await zr.getDeviceInfo(),_=await Nn.loginOrRegister(R,C==="password"?o:void 0,Y);Nn.saveUserSession(_),await s(),t(A())}catch(Y){const _=((B=(F=Y.response)==null?void 0:F.data)==null?void 0:B.message)||Y.message||r("login.errors.loginFailed");(($=Y.response)==null?void 0:$.status)===400&&(_.toLowerCase().includes("password")||_.toLowerCase().includes("required"))?(k("password"),f(null)):f(_)}finally{x(!1)}},T=R=>{R.key==="Enter"&&!m&&(R.preventDefault(),L())},M=()=>{k("username"),d(""),f(null)},O=async R=>{var F,B,$;i(R.username),d(""),w(!1),f(null),x(!0);const V=R.username.toLowerCase().trim().replace(/\s+/g,"");try{const Y=await zr.getDeviceInfo(),_=await Nn.loginOrRegister(V,"",Y);Nn.saveUserSession(_),await s(),t(A())}catch(Y){const _=((B=(F=Y.response)==null?void 0:F.data)==null?void 0:B.message)||Y.message||r("login.errors.loginFailed");(($=Y.response)==null?void 0:$.status)===400&&(_.toLowerCase().includes("password")||_.toLowerCase().includes("required"))?(k("password"),f(null)):f(_)}finally{x(!1)}},I=async R=>{try{js.removeUserFromHistory(R);const F=(await zr.getDeviceInfo()).deviceFingerprint;await zr.revokeDeviceByFingerprintAndUsername(F,R);const B=js.getUserHistory();v(B)}catch(V){console.error("Error removing user and device trust:",V);const F=js.getUserHistory();v(F)}},z=()=>{w(!P)},N=()=>{switch(y){case"COMPLETE":return r("login.buttons.signIn");case"PARTIAL":return r("login.buttons.welcomeBack");case"DEMO":return r("login.buttons.continue");default:return r("login.buttons.enterUsername")}},E=()=>{switch(y){case"COMPLETE":return r("login.subtitle.signIn");case"PARTIAL":return r("login.subtitle.welcomeBack");case"DEMO":return r("login.subtitle.continue");default:return r("login.subtitle.enterUsername")}};return e.jsx(l,{sx:{minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",display:"flex",alignItems:"center",justifyContent:"center",py:4},children:e.jsx(xn,{maxWidth:"sm",children:e.jsx(se,{sx:{borderRadius:3,boxShadow:"0 20px 40px rgba(0,0,0,0.08)",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.2)",overflow:"hidden"},children:e.jsxs(me,{sx:{p:4},children:[e.jsxs(l,{sx:{textAlign:"center",mb:4},children:[e.jsx(Vt,{sx:{width:64,height:64,mx:"auto",mb:2,background:"linear-gradient(135deg, #1e40af 0%, #3b82f6 100%)"},children:e.jsx(Ue,{sx:{fontSize:32,color:"white"}})}),e.jsx(c,{variant:"pageTitle",gutterBottom:!0,children:r("login.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",ellipsis:!1,children:E()})]}),C==="username"&&e.jsx(l,{sx:{mb:3},children:e.jsx(Ae,{fullWidth:!0,label:r("login.form.username"),value:a,onChange:R=>i(R.target.value),onKeyPress:T,margin:"normal",InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx(Sn,{})})}})}),C==="password"&&e.jsxs(l,{sx:{mb:3},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(Ie,{onClick:M,sx:{mr:1},children:e.jsx(Kr,{})}),e.jsx(c,{variant:"tableCell",color:"text.secondary",component:"div",children:r("login.messages.welcomeBack",{username:a})})]}),e.jsx(Ae,{fullWidth:!0,label:r("login.form.password"),type:u?"text":"password",value:o,onChange:R=>d(R.target.value),onKeyPress:T,margin:"normal",error:!!g,InputProps:{endAdornment:e.jsx(un,{position:"end",children:e.jsx(Ie,{onClick:()=>h(!u),edge:"end",children:u?e.jsx(oa,{}):e.jsx(Xt,{})})})},helperText:r(g?"login.form.passwordHelperError":"login.form.passwordHelper")})]}),e.jsx(he,{type:"button",fullWidth:!0,variant:"contained",size:"large",onClick:L,disabled:!a.trim()||m||C==="password"&&!o.trim(),icon:m?e.jsx(Ce,{size:20}):e.jsx(Fl,{}),mobileText:m?r("login.buttons.signingIn"):C==="password"?r("login.buttons.signIn"):N(),desktopText:m?r("login.buttons.signingIn"):C==="password"?r("login.buttons.signIn"):N(),forceTextOnly:!0,sx:{py:1.5,fontSize:"1.1rem",fontWeight:"bold",borderRadius:2,background:"linear-gradient(135deg, #1e40af 0%, #3b82f6 100%)",color:"white","&:hover":{background:"linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%)",boxShadow:"0 4px 12px rgba(30, 64, 175, 0.3)"},"&:disabled":{background:"linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%)",color:"#94a3b8",cursor:"not-allowed",boxShadow:"none"}},children:m?r("login.buttons.signingIn"):C==="password"?r("login.buttons.signIn"):N()}),e.jsxs(l,{sx:{mt:3,textAlign:"center"},children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",ellipsis:!1,children:r(C==="password"?"login.messages.enterPassword":y==="COMPLETE"?"login.messages.userHasPassword":y==="PARTIAL"?"login.messages.userIncomplete":"login.messages.easyStart")}),C==="password"&&e.jsx(l,{sx:{mt:2},children:e.jsx(he,{variant:"text",size:"small",onClick:()=>t("/forget-password"),sx:{textTransform:"none",color:"primary.main","&:hover":{backgroundColor:"primary.light",color:"primary.dark"}},children:r("login.buttons.forgetPassword")})})]}),b.length>0&&C==="username"&&e.jsxs(l,{sx:{mt:4},children:[e.jsx(bt,{sx:{mb:2}}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(va,{fontSize:"small"}),e.jsx(c,{variant:"cardTitle",children:r("login.history.title")})]}),e.jsxs(he,{size:"small",onClick:z,mobileText:r(P?"login.buttons.hide":"login.buttons.show"),desktopText:`${r(P?"login.buttons.hide":"login.buttons.show")} (${b.length})`,sx:{textTransform:"none"},children:[r(P?"login.buttons.hide":"login.buttons.show")," (",b.length,")"]})]}),P&&e.jsx(Te,{sx:{maxHeight:200,overflow:"auto"},children:e.jsx(lt,{dense:!0,children:b.map(R=>e.jsx(Pe,{disablePadding:!0,children:e.jsxs(ss,{onClick:()=>O(R),sx:{borderRadius:1,mb:.5,borderColor:"divider",backgroundColor:"background.paper","&:hover":{backgroundColor:"action.hover",borderColor:"primary.main",boxShadow:1}},children:[e.jsx(Op,{children:e.jsx(Vt,{sx:{width:32,height:32,fontSize:"0.875rem"},children:R.avatarText||R.username.charAt(0).toUpperCase()})}),e.jsx(ve,{primary:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:R.fullName||R.username}),e.jsxs(c,{variant:"formHelper",color:"text.secondary",children:["@",R.username]}),R.isProfileComplete&&e.jsx(ce,{label:r("login.history.secure"),size:"small",color:"success",sx:{height:16,fontSize:"0.7rem"}})]})}),e.jsx(Ie,{size:"small",onClick:V=>{V.stopPropagation(),I(R.username)},sx:{opacity:.6,"&:hover":{opacity:1,color:"error.main"}},children:e.jsx(pt,{fontSize:"small"})})]})},R.username))})})]})]})})})})},xD=({open:r,onClose:t})=>{const{t:n}=Ne(),[s,a]=p.useState(!1),[i,o]=p.useState(""),[d,u]=p.useState(!1),h=async()=>{if(i.trim()){a(!0);try{await new Promise(x=>setTimeout(x,1e3)),u(!0),setTimeout(()=>{m()},2e3)}catch{}finally{a(!1)}}},m=()=>{o(""),u(!1),t()};return e.jsxs(kt,{open:r,onClose:m,maxWidth:"sm",fullWidth:!0,children:[e.jsx(Et,{children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(c,{variant:"cardTitle",children:n("forgetPassword.contactAdmin.modal.title")}),e.jsx(Ie,{onClick:m,size:"small",children:e.jsx(sr,{})})]})}),e.jsx(Pt,{children:d?e.jsx(je,{severity:"success",sx:{mb:2},children:n("forgetPassword.contactAdmin.modal.success")}):e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"cardTitle",color:"warning.main",ellipsis:!1,children:n("forgetPassword.contactAdmin.modal.description")}),e.jsxs(l,{my:3,children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,children:n("forgetPassword.contactAdmin.modal.contactInfo")}),e.jsxs(l,{sx:{mt:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(ni,{sx:{mr:1,color:"primary.main",fontSize:20}}),e.jsx(D,{variant:"body2",children:"mmotionsystem@gmail.com"})]}),e.jsxs(l,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(Zu,{sx:{mr:1,color:"primary.main",fontSize:20}}),e.jsx(D,{variant:"body2",children:"+84 xxx xxx xxx"})]})]})]}),e.jsx(bt,{sx:{my:2}})]})}),!d&&e.jsxs(Dt,{sx:{p:3,pt:0},children:[e.jsx(he,{onClick:m,children:n("forgetPassword.contactAdmin.modal.cancel")}),e.jsx(We,{variant:"contained",onClick:h,disabled:s||!i.trim(),icon:s?e.jsx(Ce,{size:20}):e.jsx(ni,{}),forceTextOnly:!0,mobileText:n(s?"forgetPassword.contactAdmin.modal.sending":"forgetPassword.contactAdmin.modal.send"),desktopText:n(s?"forgetPassword.contactAdmin.modal.sending":"forgetPassword.contactAdmin.modal.send"),children:n(s?"forgetPassword.contactAdmin.modal.sending":"forgetPassword.contactAdmin.modal.send")})]})]})},pD=()=>{const{t:r}=Ne(),t=An(),[n,s]=p.useState(""),[a,i]=p.useState(!1),[o,d]=p.useState(null),[u,h]=p.useState(!1),m=async f=>{if(f.preventDefault(),!n.trim()){d(r("forgetPassword.errors.emailRequired"));return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)){d(r("forgetPassword.errors.invalidEmail"));return}i(!0),d(null);try{await new Promise(j=>setTimeout(j,1e3)),h(!0)}catch(j){d(j.message||r("forgetPassword.errors.submitFailed"))}finally{i(!1)}},x=()=>{h(!0)},g=()=>{t("/login")};return e.jsxs(xn,{maxWidth:"sm",sx:{py:4},children:[e.jsxs(l,{children:[e.jsx(l,{mb:3,children:e.jsxs(Al,{component:"button",variant:"body2",onClick:g,sx:{display:"flex",alignItems:"center",textDecoration:"none",color:"primary.main","&:hover":{textDecoration:"underline"}},children:[e.jsx(Kr,{sx:{mr:1,fontSize:20}}),r("forgetPassword.backToLogin")]})}),e.jsx(se,{children:e.jsxs(me,{sx:{p:4},children:[e.jsxs(l,{textAlign:"center",mb:4,children:[e.jsx(Jt,{sx:{fontSize:64,color:"primary.main",mb:2}}),e.jsx(c,{variant:"pageHeader",gutterBottom:!0,children:r("forgetPassword.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:r("forgetPassword.subtitle")})]}),o&&e.jsx(je,{severity:"error",sx:{mb:3},children:o}),e.jsxs(l,{component:"form",onSubmit:m,children:[e.jsx(Ae,{fullWidth:!0,label:r("forgetPassword.emailLabel"),type:"email",value:n,onChange:f=>s(f.target.value),disabled:a,sx:{mb:3},InputProps:{startAdornment:e.jsx(ni,{sx:{mr:1,color:"text.secondary"}})}}),e.jsx(he,{type:"submit",fullWidth:!0,variant:"contained",disabled:a,sx:{mb:3},children:a?e.jsx(Ce,{size:24,color:"inherit"}):r("forgetPassword.submitButton")})]}),e.jsx(bt,{sx:{my:3}}),e.jsxs(l,{textAlign:"center",children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",gutterBottom:!0,children:r("forgetPassword.contactAdmin.title")}),e.jsx(c,{variant:"body2",color:"text.secondary",sx:{mb:2},children:r("forgetPassword.contactAdmin.description")}),e.jsx(he,{variant:"outlined",onClick:x,startIcon:e.jsx(ni,{}),children:r("forgetPassword.contactAdmin.button")})]})]})})]}),e.jsx(xD,{open:u,onClose:()=>h(!1)})]})},Mn=(r,t,n="main")=>{const s=r.palette[t];return s&&typeof s=="object"&&"main"in s?n==="main"?s.main:s.dark||s.main:n==="main"?r.palette.primary.main:r.palette.primary.dark},gD=({icon:r,title:t,description:n,features:s,color:a,delay:i})=>{const o=Je();return e.jsx(as,{direction:"up",in:!0,timeout:600+i,children:e.jsx(se,{sx:{height:"100%",background:`linear-gradient(135deg, ${U(Mn(o,a),.05)} 0%, ${U(Mn(o,a),.02)} 100%)`,border:`1px solid ${U(Mn(o,a),.1)}`,borderRadius:3,transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:`0 8px 24px ${U(Mn(o,a),.15)}`}},children:e.jsxs(me,{sx:{p:3},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(Vt,{sx:{bgcolor:Mn(o,a),width:48,height:48,mr:2},children:r}),e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600},children:t})]}),e.jsx(c,{variant:"labelXSmall",color:"text.secondary",sx:{mb:2},ellipsis:!1,children:n}),e.jsx(l,{sx:{display:"flex",flexDirection:"column",gap:1},children:s.map((d,u)=>e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Xe,{sx:{fontSize:16,color:Mn(o,a)}}),e.jsx(c,{variant:"formHelper",sx:{fontSize:"0.875rem"},children:d})]},u))})]})})})},Ha=({title:r,description:t,action:n,onAction:s,icon:a,color:i,isCompleted:o=!1,isActive:d=!1})=>{const u=Je(),{t:h}=Ne();return e.jsxs(_n,{completed:o,active:d,children:[e.jsx(Yn,{StepIconComponent:({completed:m,active:x})=>e.jsx(Vt,{sx:{bgcolor:m?"success.main":x?Mn(u,i):"grey.300",width:40,height:40,transition:"all 0.3s ease",transform:x?"scale(1.1)":"scale(1)",boxShadow:x?`0 4px 12px ${U(Mn(u,i),.3)}`:"none"},children:m?e.jsx(Xe,{}):a}),children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[e.jsx(c,{variant:"cardTitle",sx:{color:d?Mn(u,i):"text.primary",fontWeight:d?600:500},children:r}),d&&e.jsx(ce,{label:h("welcome.quickStartGuide.steps.currentStep"),size:"small",color:i,variant:"filled",sx:{fontSize:"0.75rem"}})]})}),e.jsx(Jn,{children:e.jsxs(l,{sx:{p:3,borderRadius:2,bgcolor:d?U(Mn(u,i),.05):"transparent",border:d?`1px solid ${U(Mn(u,i),.2)}`:"none",transition:"all 0.3s ease"},children:[e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{mb:3},children:t}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(he,{variant:"contained",onClick:s,endIcon:e.jsx(wa,{}),sx:{borderRadius:2,background:`linear-gradient(135deg, ${Mn(u,i)} 0%, ${Mn(u,i,"dark")} 100%)`,"&:hover":{background:`linear-gradient(135deg, ${Mn(u,i,"dark")} 0%, ${Mn(u,i)} 100%)`,transform:"translateY(-2px)",boxShadow:`0 6px 16px ${U(Mn(u,i),.3)}`},transition:"all 0.3s ease"},children:n}),d&&e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Vp,{sx:{fontSize:16,color:Mn(u,i)}}),e.jsx(c,{variant:"formHelper",sx:{color:Mn(u,i)},children:h("welcome.quickStartGuide.steps.clickToContinue")})]})]})]})})]})},Mu=()=>{const{t:r}=Ne(),t=An(),{isAuthenticated:n}=Ge(),s=Je(),a=Nt(s.breakpoints.down("sm")),[i]=p.useState(!0),[o,d]=p.useState(0),[u,h]=p.useState([]),m=()=>{t(n?"/portfolios/new":"/login?redirect=/portfolios/new")},x=()=>{t(n?"/":"/login?redirect=/")},g=()=>{t(n?"/portfolios":"/login?redirect=/portfolios")},f=()=>{t(n?"/trading":"/login?redirect=/trading")},y=()=>{t(n?"/assets":"/login?redirect=/assets")},j=()=>{t(n?"/trading?tab=cash-flow":"/login?redirect=/trading?tab=cash-flow")},b=k=>{d(k)},v=k=>{u.includes(k)||h([...u,k]),k<4&&d(k+1)},P=()=>{o<4&&d(o+1)},w=()=>{o>0&&d(o-1)},C=[{icon:e.jsx(Ue,{}),title:r("welcome.features.portfolio.title"),description:r("welcome.features.portfolio.description"),features:[r("welcome.features.portfolio.feature1"),r("welcome.features.portfolio.feature2"),r("welcome.features.portfolio.feature3"),r("welcome.features.portfolio.feature4")],color:"primary",delay:0},{icon:e.jsx(Zt,{}),title:r("welcome.features.trading.title"),description:r("welcome.features.trading.description"),features:[r("welcome.features.trading.feature1"),r("welcome.features.trading.feature2"),r("welcome.features.trading.feature3"),r("welcome.features.trading.feature4")],color:"success",delay:100},{icon:e.jsx(He,{}),title:r("welcome.features.analytics.title"),description:r("welcome.features.analytics.description"),features:[r("welcome.features.analytics.feature1"),r("welcome.features.analytics.feature2"),r("welcome.features.analytics.feature3"),r("welcome.features.analytics.feature4")],color:"info",delay:200},{icon:e.jsx(qt,{}),title:r("welcome.features.assets.title"),description:r("welcome.features.assets.description"),features:[r("welcome.features.assets.feature1"),r("welcome.features.assets.feature2"),r("welcome.features.assets.feature3"),r("welcome.features.assets.feature4")],color:"warning",delay:300},{icon:e.jsx(mr,{}),title:r("welcome.features.deposits.title"),description:r("welcome.features.deposits.description"),features:[r("welcome.features.deposits.feature1"),r("welcome.features.deposits.feature2"),r("welcome.features.deposits.feature3"),r("welcome.features.deposits.feature4")],color:"secondary",delay:400},{icon:e.jsx($s,{}),title:r("welcome.features.funds.title"),description:r("welcome.features.funds.description"),features:[r("welcome.features.funds.feature1"),r("welcome.features.funds.feature2"),r("welcome.features.funds.feature3"),r("welcome.features.funds.feature4")],color:"error",delay:500}];return i?e.jsx(Xr,{in:!0,timeout:800,children:e.jsx(l,{sx:{minHeight:"100vh",background:`linear-gradient(135deg, ${U(s.palette.primary.main,.05)} 0%, ${U(s.palette.background.default,1)} 100%)`,py:4},children:e.jsxs(xn,{maxWidth:"lg",children:[n&&e.jsx(cx,{}),e.jsx(l,{sx:{textAlign:"center",mb:6,position:"relative"},children:e.jsxs(l,{sx:{mb:4},children:[e.jsx(Vt,{sx:{width:80,height:80,mx:"auto",mb:3,background:`linear-gradient(135deg, ${s.palette.primary.main} 0%, ${s.palette.secondary.main} 100%)`},children:e.jsx(Ue,{sx:{fontSize:40,color:"white"}})}),e.jsx(c,{variant:"pageTitle",sx:{background:`linear-gradient(135deg, ${s.palette.primary.main} 0%, ${s.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:2},ellipsis:!1,children:r("welcome.title")}),e.jsx(c,{variant:"pageSubtitle",sx:{mb:3,maxWidth:600,mx:"auto"},ellipsis:!1,children:r("welcome.subtitle")})]})}),e.jsxs(l,{sx:{mb:6},children:[e.jsx(l,{sx:{textAlign:"center",mb:2},children:e.jsx(c,{variant:"pageTitle",sx:{mb:2},children:r("welcome.examples.title")})}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,lg:6,children:e.jsx(se,{sx:{height:"100%",borderRadius:3,background:`linear-gradient(135deg, ${U(s.palette.primary.main,.05)} 0%, ${U(s.palette.background.paper,1)} 100%)`,border:`1px solid ${U(s.palette.primary.main,.1)}`,transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:`0 8px 24px ${U(s.palette.primary.main,.15)}`}},children:e.jsxs(me,{sx:{p:3},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(Ju,{sx:{mr:2,color:"primary.main"}}),e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600},children:r("welcome.examples.portfolioTable.title")})]}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{mb:2},children:r("welcome.examples.portfolioTable.description")}),e.jsx(at,{component:Te,sx:{borderRadius:2,overflow:"hidden"},children:e.jsxs(it,{size:"small",children:[e.jsx(ct,{children:e.jsxs(De,{sx:{bgcolor:"primary.50"},children:[e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",sx:{fontWeight:600},children:r("welcome.examples.portfolioTable.columns.name")})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableHeader",sx:{fontWeight:600},children:r("welcome.examples.portfolioTable.columns.totalValue")})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableHeader",sx:{fontWeight:600},children:r("welcome.examples.portfolioTable.columns.return")})})]})}),e.jsx(ot,{children:[{name:"Danh mc C phiu",currency:"VND",totalValue:25e8,return:15.5},{name:"Danh mc Tri phiu",currency:"VND",totalValue:15e8,return:8.2},{name:"Danh mc a dng",currency:"USD",totalValue:5e4,return:12.8}].map((k,A)=>e.jsxs(De,{hover:!0,children:[e.jsx(S,{children:e.jsxs(l,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ue,{sx:{fontSize:18,color:"primary.main",mr:1}}),e.jsx(c,{variant:"tableCell",children:k.name})]})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:G(k.totalValue,k.currency)})}),e.jsx(S,{align:"right",children:e.jsx(ce,{label:`+${k.return.toFixed(1)}%`,size:"small",color:k.return>=10?"success":"default",sx:{fontWeight:600}})})]},A))})]})})]})})}),e.jsx(W,{item:!0,xs:12,lg:6,children:e.jsx(se,{sx:{height:"100%",borderRadius:3,background:`linear-gradient(135deg, ${U(s.palette.success.main,.05)} 0%, ${U(s.palette.background.paper,1)} 100%)`,border:`1px solid ${U(s.palette.success.main,.1)}`,transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:`0 8px 24px ${U(s.palette.success.main,.15)}`}},children:e.jsxs(me,{sx:{p:3},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(Nl,{sx:{mr:2,color:"success.main"}}),e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600},children:r("welcome.examples.tradingTable.title")})]}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{mb:2},children:r("welcome.examples.tradingTable.description")}),e.jsx(at,{component:Te,sx:{borderRadius:2,overflow:"hidden"},children:e.jsxs(it,{size:"small",children:[e.jsx(ct,{children:e.jsxs(De,{sx:{bgcolor:"success.50"},children:[e.jsxs(S,{children:[e.jsx(c,{variant:"tableHeader",sx:{fontWeight:600},children:r("welcome.examples.tradingTable.columns.symbol")})," "]}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeader",sx:{fontWeight:600},children:r("welcome.examples.tradingTable.columns.side")})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableHeader",sx:{fontWeight:600},children:r("welcome.examples.tradingTable.columns.quantity")})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableHeader",sx:{fontWeight:600},children:r("welcome.examples.tradingTable.columns.price")})}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableHeader",sx:{fontWeight:600},children:r("welcome.examples.tradingTable.columns.total")})})]})}),e.jsx(ot,{children:[{symbol:"VIC",side:"BUY",quantity:1e3,price:75e3,total:75e6},{symbol:"VNM",side:"BUY",quantity:500,price:82e3,total:41e6},{symbol:"VCB",side:"SELL",quantity:200,price:95e3,total:19e6}].map((k,A)=>e.jsxs(De,{hover:!0,children:[e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:600},children:k.symbol})}),e.jsx(S,{children:e.jsx(ce,{label:k.side,size:"small",color:k.side==="BUY"?"success":"error",sx:{fontWeight:600}})}),e.jsx(S,{align:"right",children:dn(k.quantity)}),e.jsx(S,{align:"right",children:G(k.price,"VND")}),e.jsx(S,{align:"right",children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:500},children:G(k.total,"VND")})})]},A))})]})})]})})})]}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{sx:{height:"100%",borderRadius:3,background:`linear-gradient(135deg, ${U(s.palette.info.main,.05)} 0%, ${U(s.palette.background.paper,1)} 100%)`,border:`1px solid ${U(s.palette.info.main,.1)}`,transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:`0 8px 24px ${U(s.palette.info.main,.15)}`}},children:e.jsxs(me,{sx:{p:3},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(ar,{sx:{mr:2,color:"info.main"}}),e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600},children:r("welcome.examples.allocationChart.title")})]}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{mb:3},children:r("welcome.examples.allocationChart.description")}),e.jsx(l,{sx:{width:"100%",height:300},children:e.jsx(Ln,{width:"100%",height:"100%",children:e.jsxs(Co,{children:[e.jsx(ko,{data:[{name:"STOCK",value:45,marketValue:1125e6},{name:"BOND",value:30,marketValue:75e7},{name:"CASH",value:15,marketValue:375e6},{name:"OTHER",value:10,marketValue:25e7}],cx:"50%",cy:"50%",labelLine:!1,label:({name:k,percent:A})=>`${k} ${(A*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:[{name:"STOCK",value:45},{name:"BOND",value:30},{name:"CASH",value:15},{name:"OTHER",value:10}].map((k,A)=>e.jsx(Br,{fill:ur(k.name.toLowerCase())},`cell-${A}`))}),e.jsx(En,{formatter:(k,A)=>{const T={STOCK:1125e6,BOND:75e7,CASH:375e6,OTHER:25e7}[A]||0;return[`${ye(k)} (${G(T,"VND")})`,r("welcome.examples.allocationChart.allocation")]}})]})})})]})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{sx:{height:"100%",borderRadius:3,background:`linear-gradient(135deg, ${U(s.palette.warning.main,.05)} 0%, ${U(s.palette.background.paper,1)} 100%)`,border:`1px solid ${U(s.palette.warning.main,.1)}`,transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:`0 8px 24px ${U(s.palette.warning.main,.15)}`}},children:e.jsxs(me,{sx:{p:3},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:.5},children:[e.jsx(He,{sx:{mr:2,color:"warning.main"}}),e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600},children:r("welcome.examples.performanceChart.title")})]}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{mb:3},children:r("welcome.examples.performanceChart.description")}),e.jsx(l,{sx:{width:"100%",height:300},children:e.jsx(Ln,{width:"100%",height:"100%",children:e.jsxs(ys,{data:[{month:"T1",return:5.2,unrealizedPl:13e7},{month:"T2",return:8.5,unrealizedPl:2125e5},{month:"T3",return:12.1,unrealizedPl:3025e5},{month:"T4",return:15.5,unrealizedPl:3875e5},{month:"T5",return:18.2,unrealizedPl:455e6},{month:"T6",return:22.3,unrealizedPl:5575e5}],margin:{top:20,right:30,left:20,bottom:20},children:[e.jsx(cr,{strokeDasharray:"3 3",opacity:.3}),e.jsx(dr,{dataKey:"month"}),e.jsx(er,{tickFormatter:k=>`${k}%`,hide:a}),e.jsx(En,{formatter:k=>[`${k}%`,r("welcome.examples.performanceChart.return")]}),e.jsx(br,{dataKey:"return",fill:s.palette.primary.main,radius:[8,8,0,0]})]})})})]})})})]})]}),e.jsxs(l,{sx:{mb:8},children:[e.jsx(c,{variant:"pageTitle",sx:{textAlign:"center",mb:4},children:r("welcome.features.title")}),e.jsx(W,{container:!0,spacing:3,children:C.map((k,A)=>e.jsx(W,{item:!0,xs:12,sm:6,lg:4,children:e.jsx(gD,{...k})},A))})]}),e.jsxs(l,{sx:{mb:6},children:[e.jsxs(l,{sx:{textAlign:"center",mb:4},children:[e.jsx(c,{variant:"pageTitle",sx:{mb:2},children:r("welcome.quickStart.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",sx:{mb:3},children:r("welcome.quickStartGuide.subtitle")}),e.jsxs(l,{sx:{mb:3},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",children:r("welcome.quickStartGuide.progress.step",{current:o+1,total:5})}),e.jsx(c,{variant:"formHelper",color:"text.secondary",children:r("welcome.quickStartGuide.progress.complete",{percentage:Math.round((o+1)/5*100)})})]}),e.jsx(l,{sx:{width:"100%",height:8,bgcolor:"grey.200",borderRadius:4,overflow:"hidden"},children:e.jsx(l,{sx:{width:`${(o+1)/5*100}%`,height:"100%",bgcolor:"primary.main",borderRadius:4,transition:"width 0.5s ease-in-out"}})})]}),!a&&e.jsx(l,{sx:{display:"flex",justifyContent:"center",mb:4},children:e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:1},children:[0,1,2,3,4].map(k=>e.jsxs(l,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Vt,{onClick:()=>b(k),sx:{width:40,height:40,bgcolor:k===o?"primary.main":u.includes(k)?"success.main":"grey.300",fontSize:"0.875rem",fontWeight:600,cursor:"pointer",transition:"all 0.3s ease",transform:k===o?"scale(1.1)":"scale(1)",boxShadow:k===o?"0 4px 12px rgba(25, 118, 210, 0.3)":"none","&:hover":{transform:"scale(1.05)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)"}},children:u.includes(k)?e.jsx(Xe,{}):k+1}),k<4&&e.jsx(l,{sx:{width:50,height:3,bgcolor:k<o||u.includes(k)?"primary.main":"grey.300",mx:1,borderRadius:1.5,transition:"all 0.3s ease"}})]},k))})}),e.jsxs(l,{sx:{display:"flex",justifyContent:"center",gap:2,mb:3},children:[e.jsx(he,{variant:"outlined",onClick:w,disabled:o===0,icon:e.jsx(wa,{sx:{transform:"rotate(180deg)"}}),sx:{borderRadius:2},children:r("welcome.quickStartGuide.navigation.previous")}),e.jsx(he,{variant:"contained",onClick:P,disabled:o===4,endIcon:e.jsx(wa,{}),sx:{borderRadius:2},children:r("welcome.quickStartGuide.navigation.next")})]}),u.length===5&&e.jsxs(l,{sx:{textAlign:"center",p:3,bgcolor:"success.light",borderRadius:2,mb:3,border:"1px solid",borderColor:"success.main"},children:[e.jsx(Xe,{sx:{fontSize:48,color:"success.main",mb:2}}),e.jsx(c,{variant:"cardTitle",sx:{color:"success.dark",mb:1},children:r("welcome.quickStartGuide.completion.title")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("welcome.quickStartGuide.completion.message")})]})]}),e.jsx(se,{sx:{borderRadius:3,overflow:"hidden",background:`linear-gradient(135deg, ${U(s.palette.primary.main,.02)} 0%, ${U(s.palette.background.paper,1)} 100%)`,border:`1px solid ${U(s.palette.primary.main,.1)}`},children:e.jsx(me,{sx:{p:4},children:e.jsxs(Dr,{orientation:"vertical",activeStep:o,sx:{"& .MuiStepLabel-root":{alignItems:"flex-start"},"& .MuiStepConnector-root":{"& .MuiStepConnector-line":{borderColor:U(s.palette.primary.main,.3),borderWidth:2}}},children:[e.jsx(Ha,{title:r("welcome.quickStartGuide.steps.createPortfolio.title"),description:r("welcome.quickStartGuide.steps.createPortfolio.description"),action:r("welcome.quickStartGuide.steps.createPortfolio.action"),onAction:()=>{v(0),m()},icon:e.jsx(xt,{}),color:"primary",isActive:o===0,isCompleted:u.includes(0)}),e.jsx(Ha,{title:r("welcome.quickStartGuide.steps.addCashFlow.title"),description:r("welcome.quickStartGuide.steps.addCashFlow.description"),action:r("welcome.quickStartGuide.steps.addCashFlow.action"),onAction:()=>{v(1),j()},icon:e.jsx(ba,{}),color:"secondary",isActive:o===1,isCompleted:u.includes(1)}),e.jsx(Ha,{title:r("welcome.quickStartGuide.steps.addTrade.title"),description:r("welcome.quickStartGuide.steps.addTrade.description"),action:r("welcome.quickStartGuide.steps.addTrade.action"),onAction:()=>{v(2),f()},icon:e.jsx(Nl,{}),color:"success",isActive:o===2,isCompleted:u.includes(2)}),e.jsx(Ha,{title:r("welcome.quickStartGuide.steps.manageAssets.title"),description:r("welcome.quickStartGuide.steps.manageAssets.description"),action:r("welcome.quickStartGuide.steps.manageAssets.action"),onAction:()=>{v(3),y()},icon:e.jsx(qt,{}),color:"warning",isActive:o===3,isCompleted:u.includes(3)}),e.jsx(Ha,{title:r("welcome.quickStartGuide.steps.viewDashboard.title"),description:r("welcome.quickStartGuide.steps.viewDashboard.description"),action:r("welcome.quickStartGuide.steps.viewDashboard.action"),onAction:()=>{v(4),x()},icon:e.jsx(pc,{}),color:"info",isActive:o===4,isCompleted:u.includes(4)})]})})})]}),e.jsxs(l,{children:[e.jsx(bt,{sx:{mb:3}}),e.jsxs(l,{sx:{mb:6},children:[e.jsx(c,{variant:"pageTitle",sx:{textAlign:"center",mb:4},children:r("welcome.capabilities.title")}),e.jsx(W,{container:!0,spacing:2,sx:{mb:4},children:[r("welcome.capabilities.realTime"),r("welcome.capabilities.analytics"),r("welcome.capabilities.multiAccount"),r("welcome.capabilities.mobile"),r("welcome.capabilities.secure"),r("welcome.capabilities.scalable")].map((k,A)=>e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(ce,{label:k,color:"primary",variant:"outlined",sx:{width:"100%",py:2,fontSize:"0.9rem",borderRadius:2,"& .MuiChip-label":{fontWeight:500}}})},A))})]}),e.jsxs(l,{sx:{textAlign:"center",py:4},children:[e.jsx(bt,{sx:{mb:4}}),e.jsx(c,{variant:"formHelper",color:"text.secondary",sx:{mb:4},children:r("welcome.footer.message")}),e.jsxs(l,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap",mb:4},children:[e.jsx(he,{variant:"contained",size:"large",onClick:m,startIcon:e.jsx(ti,{}),sx:{borderRadius:3,px:4,py:1.5,background:`linear-gradient(135deg, ${s.palette.primary.main} 0%, ${s.palette.primary.dark} 100%)`,"&:hover":{background:`linear-gradient(135deg, ${s.palette.primary.dark} 0%, ${s.palette.primary.main} 100%)`}},forceTextOnly:!0,children:r("welcome.buttons.getStarted")}),e.jsx(he,{variant:"outlined",size:"large",onClick:x,startIcon:e.jsx(Vu,{}),sx:{borderRadius:3,px:4,py:1.5},forceTextOnly:!0,children:r("welcome.buttons.viewDashboard")})]}),e.jsxs(l,{sx:{display:"flex",gap:2,justifyContent:"center",flexWrap:"wrap"},children:[e.jsx(he,{variant:"text",onClick:x,sx:{textTransform:"none"},children:r("welcome.footer.dashboard")}),e.jsx(he,{variant:"text",onClick:g,sx:{textTransform:"none"},children:r("welcome.footer.portfolios")})]})]})]})]})})}):null};class fD{async getFunds(){try{const t=await q.api.get("/api/v1/external-market-data/funds");return t.data.success?t.data.data:[]}catch(t){return console.error("Failed to fetch funds:",t),[]}}async getStockFunds(t=10){return(await this.getFunds()).filter(s=>{var i;if(s.fundAssetType==="STOCK")return!0;const a=((i=s.name)==null?void 0:i.toUpperCase())||"";return a.includes("C PHIU")||a.includes("STOCK")||a.includes("EQUITY")}).sort((s,a)=>{const i=s.changePercent||0;return(a.changePercent||0)-i}).slice(0,t)}async getBondFunds(t=10){return(await this.getFunds()).filter(s=>{var i;if(s.fundAssetType==="BOND")return!0;const a=((i=s.name)==null?void 0:i.toUpperCase())||"";return a.includes("TRI PHIU")||a.includes("BOND")||a.includes("DEBT")}).sort((s,a)=>{const i=s.changePercent||0;return(a.changePercent||0)-i}).slice(0,t)}async getStocks(t){try{const n=await q.api.get("/api/v1/external-market-data/stocks"),s=n.data.success?n.data.data:[];return t?s.slice(0,t):s}catch(n){return console.error("Failed to fetch stocks:",n),[]}}async getTopStocks(t=5){return(await this.getStocks()).filter(i=>i.buyPrice>0&&i.symbol).sort((i,o)=>{const d=i.marketCap||0;return(o.marketCap||0)-d}).slice(0,t)}}const kl=new fD,Pl=()=>{const{t:r}=Ne(),t=Je(),n=An(),{isAuthenticated:s,loading:a}=Ge(),i=Nt(t.breakpoints.down("sm")),o=Nt(t.breakpoints.up("sm")),[d,u]=p.useState(!0),[h,m]=p.useState([]),[x,g]=p.useState([]),[f,y]=p.useState([]),[j,b]=p.useState({}),[v,P]=p.useState(null),[w,C]=p.useState(null),k=F=>{P(F.currentTarget)},A=()=>{P(null)},L=F=>{C(F.currentTarget)},T=()=>{C(null)};p.useEffect(()=>{!a&&s&&n("/",{replace:!0})},[s,a,n]),p.useEffect(()=>{localStorage.getItem("_logout_in_progress")==="true"&&localStorage.removeItem("_logout_in_progress")},[]);const M=localStorage.getItem("_logout_in_progress")==="true";if(!a&&!s&&M)return null;const O=p.useRef(null);p.useEffect(()=>(O.current=new IntersectionObserver(F=>{F.forEach(B=>{B.isIntersecting&&B.target.id&&b($=>({...$,[B.target.id]:!0}))})},{threshold:.1,rootMargin:"0px 0px -50px 0px"}),()=>{O.current&&O.current.disconnect()}),[]),p.useEffect(()=>{if(!O.current)return;const F=()=>{document.querySelectorAll("[data-animate-section]").forEach(Y=>{Y.id&&O.current&&(Y.getAttribute("data-always-visible")==="true"?b(K=>({...K,[Y.id]:!0})):O.current.observe(Y))})},B=setTimeout(()=>{requestAnimationFrame(F)},100);return()=>{clearTimeout(B),O.current&&document.querySelectorAll("[data-animate-section]").forEach(Y=>{var _;(_=O.current)==null||_.unobserve(Y)})}},[d]);const I=({id:F,children:B,delay:$=0,direction:Y="up",alwaysVisible:_=!1})=>{const K=_?!0:j[F]??!1,X=ne=>{if(ne)return"translateY(0)";switch(Y){case"up":return"translateY(30px)";case"down":return"translateY(-30px)";case"left":return"translateX(30px)";case"right":return"translateX(-30px)";default:return"translateY(30px)"}};return e.jsx(l,{id:F,"data-animate-section":!0,"data-always-visible":_?"true":"false",sx:{opacity:K?1:0,transform:X(K),transition:K?`opacity 0.6s ease-out ${$}s, transform 0.6s ease-out ${$}s`:"opacity 0.2s ease-out, transform 0.2s ease-out",visibility:K?"visible":"hidden"},children:B})},z=[{title:r("home.trust.safe.title","An ton tuyt i"),description:r("home.trust.safe.description","Tin v ti sn c qun l v gim st cht ch"),icon:e.jsx(Jt,{})},{title:r("home.trust.transparent.title","Minh bch"),description:r("home.trust.transparent.description","Theo di v qun l ti sn mt cch minh bch"),icon:e.jsx($p,{})},{title:r("home.trust.professional.title","Chuyn nghip"),description:r("home.trust.professional.description","H thng qun l danh mc u t chuyn nghip"),icon:e.jsx(Zt,{})}],N=[{step:"1",title:r("home.steps.register.title","ng nhp"),description:r("home.steps.register.description","ng nhp vo h thng  bt u s dng"),icon:e.jsx(Hp,{})},{step:"2",title:r("home.steps.invest.title","To mc tiu u t"),description:r("home.steps.invest.description","To mc tiu u t theo mc tiu u t ca bn"),icon:e.jsx(He,{})},{step:"3",title:r("home.steps.manage.title","Qun l ti sn"),description:r("home.steps.manage.description","Theo di ti sn thun tin v giao dch d dng"),icon:e.jsx(qt,{})}],E=[{type:Ns.STOCK,label:r("home.assetTypes.stock","C phiu"),icon:e.jsx(ar,{}),color:"primary",description:r("home.assetTypes.stockDesc","u t vo c phiu trn cc sn giao dch")},{type:Ns.BOND,label:r("home.assetTypes.bond","Tri phiu"),icon:e.jsx(Ue,{}),color:"success",description:r("home.assetTypes.bondDesc","u t vo tri phiu chnh ph v doanh nghip")},{type:Ns.GOLD,label:r("home.assetTypes.gold","Vng"),icon:e.jsx(He,{}),color:"warning",description:r("home.assetTypes.goldDesc","u t vo vng v kim loi qu")},{type:Ns.CRYPTO,label:r("home.assetTypes.crypto","Tin in t"),icon:e.jsx(He,{}),color:"error",description:r("home.assetTypes.cryptoDesc","u t vo tin in t v ti sn s")},{type:Ns.OTHER,label:r("home.assetTypes.other","Khc"),icon:e.jsx(Ue,{}),color:"default",description:r("home.assetTypes.otherDesc","Cc loi ti sn khc")}];p.useEffect(()=>{(async()=>{try{u(!0);const[B,$,Y]=await Promise.all([kl.getStockFunds(5),kl.getBondFunds(5),kl.getTopStocks(5)]);m(B.slice(0,10)),g($.slice(0,10)),y(Y)}catch(B){console.error("Failed to fetch market data:",B)}finally{u(!1)}})()},[]);const R=(F,B="main")=>{const $=t.palette[F];return $&&typeof $=="object"&&"main"in $?B==="main"?$.main:$.dark||$.main:B==="main"?t.palette.primary.main:t.palette.primary.dark},V=[{label:r("home.menu.home","Trang ch"),path:"/home",action:()=>n("/home")},{label:r("home.menu.features","Tnh nng"),hasSubmenu:!0,items:[{label:r("home.menu.features.portfolio","Qun l danh mc"),path:"#features-section"},{label:r("home.menu.features.tracking","Theo di hng ngy"),path:"#features-section"},{label:r("home.menu.features.security","Bo mt"),path:"#trust-section"}]},{label:r("home.menu.contact","Lin h"),path:"#contact",action:()=>{const F=document.querySelector("#contact");F&&F.scrollIntoView({behavior:"smooth"})}}];return e.jsxs(l,{sx:{minHeight:"100vh",background:`linear-gradient(135deg, ${U(t.palette.primary.main,.05)} 0%, ${U(t.palette.background.default,1)} 100%)`,pb:{xs:12,md:10}},children:[e.jsxs(hc,{position:"sticky",elevation:0,sx:{bgcolor:U(t.palette.background.paper,.95),backdropFilter:"blur(10px)",borderBottom:`1px solid ${U(t.palette.divider,.12)}`,boxShadow:`0 2px 8px ${U(t.palette.common.black,.05)}`},children:[e.jsx(xn,{maxWidth:"lg",children:e.jsxs(no,{sx:{justifyContent:"space-between",px:{xs:0,sm:2},py:{xs:1,sm:1.5},minHeight:{xs:56,sm:64}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:{xs:1,sm:3,md:4}},children:[e.jsx(D,{onClick:()=>n("/home"),sx:{fontSize:{xs:"1.1rem",sm:"1.25rem",md:"1.5rem"},fontWeight:700,background:`linear-gradient(135deg, ${t.palette.primary.main} 0%, ${t.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",cursor:"pointer","&:hover":{opacity:.8},transition:"opacity 0.2s"},children:r("home.projectName","MMO")}),!i&&e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:{sm:1,md:2}},children:V.map((F,B)=>{var $;return F.hasSubmenu?e.jsxs(l,{children:[e.jsx(ut,{onClick:L,endIcon:e.jsx(nd,{}),sx:{color:"text.primary",textTransform:"none",fontSize:{sm:"0.875rem",md:"0.95rem"},fontWeight:500,"&:hover":{color:"primary.main",bgcolor:U(t.palette.primary.main,.08)}},children:F.label}),e.jsx(Gn,{anchorEl:w,open:!!w,onClose:T,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:($=F.items)==null?void 0:$.map((Y,_)=>e.jsx(re,{onClick:()=>{if(T(),Y.path.startsWith("#")){const K=document.querySelector(Y.path);K&&K.scrollIntoView({behavior:"smooth"})}else n(Y.path)},children:Y.label},_))})]},B):e.jsx(ut,{onClick:()=>{var Y;if((Y=F.path)!=null&&Y.startsWith("#")){const _=document.querySelector(F.path);_&&_.scrollIntoView({behavior:"smooth"})}else F.action?F.action():!F.hasSubmenu&&F.path&&n(F.path)},sx:{color:"text.primary",textTransform:"none",fontSize:{sm:"0.875rem",md:"0.95rem"},fontWeight:500,"&:hover":{color:"primary.main",bgcolor:U(t.palette.primary.main,.08)}},children:F.label},B)})}),i&&e.jsx(Ie,{onClick:k,sx:{color:"text.primary",ml:1},children:e.jsx(Za,{})})]}),e.jsx(l,{sx:{display:"flex",alignItems:"center",gap:{xs:1,sm:1.5}},children:e.jsx(ut,{variant:"contained",onClick:()=>n("/login"),startIcon:e.jsx(Fl,{}),sx:{textTransform:"none",fontSize:{xs:"0.8rem",sm:"0.875rem",md:"0.9rem"},fontWeight:600,background:`linear-gradient(135deg, ${t.palette.primary.main} 0%, ${t.palette.primary.dark} 100%)`,boxShadow:`0 2px 8px ${U(t.palette.primary.main,.3)}`,"&:hover":{background:`linear-gradient(135deg, ${t.palette.primary.dark} 0%, ${t.palette.primary.main} 100%)`,boxShadow:`0 4px 12px ${U(t.palette.primary.main,.4)}`,transform:"translateY(-1px)"},transition:"all 0.3s ease-in-out"},children:i?r("home.login.short","Bt u"):r("home.login.full","Bt u ngay")})})]})}),e.jsx(Gn,{anchorEl:v,open:!!v,onClose:A,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:{mt:1,"& .MuiPaper-root":{minWidth:200,borderRadius:2,boxShadow:`0 4px 20px ${U(t.palette.common.black,.1)}`}},children:V.map((F,B)=>{var $;return F.hasSubmenu?e.jsxs(l,{children:[e.jsxs(re,{onClick:L,sx:{fontSize:"0.95rem",fontWeight:500},children:[F.label,e.jsx(nd,{sx:{ml:"auto"}})]}),e.jsx(Gn,{anchorEl:w,open:!!w,onClose:()=>{T(),A()},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},children:($=F.items)==null?void 0:$.map((Y,_)=>e.jsx(re,{onClick:()=>{if(T(),A(),Y.path.startsWith("#")){const K=document.querySelector(Y.path);K&&K.scrollIntoView({behavior:"smooth"})}else n(Y.path)},children:Y.label},_))})]},B):e.jsx(re,{onClick:()=>{var Y;if(A(),(Y=F.path)!=null&&Y.startsWith("#")){const _=document.querySelector(F.path);_&&_.scrollIntoView({behavior:"smooth"})}else F.action?F.action():!F.hasSubmenu&&F.path&&n(F.path)},sx:{fontSize:"0.95rem",fontWeight:500},children:F.label},B)})})]}),e.jsxs(xn,{maxWidth:"lg",children:[e.jsx(Xr,{in:!0,timeout:800,children:e.jsx(l,{sx:{textAlign:"center",mb:{xs:5,md:7}}})}),e.jsx(Il,{in:!0,timeout:1e3,children:e.jsx(l,{sx:{mb:{xs:4,md:6},mt:{xs:3,md:4},position:"relative",overflow:"hidden",borderRadius:{xs:2,md:3},background:`linear-gradient(135deg, ${t.palette.primary.main} 0%, ${t.palette.secondary.main} 50%, ${t.palette.primary.dark} 100%)`,boxShadow:`0 8px 32px ${U(t.palette.primary.main,.3)}`,"&::before":{content:'""',position:"absolute",top:-50,right:-50,width:200,height:200,borderRadius:"50%",background:`radial-gradient(circle, ${U(t.palette.common.white,.1)} 0%, transparent 70%)`},"&::after":{content:'""',position:"absolute",bottom:-30,left:-30,width:150,height:150,borderRadius:"50%",background:`radial-gradient(circle, ${U(t.palette.common.white,.08)} 0%, transparent 70%)`}},children:e.jsxs(l,{sx:{position:"relative",zIndex:1,p:{xs:3,md:5},textAlign:"center",color:"white"},children:[e.jsx(c,{variant:"pageTitle",sx:{fontWeight:700,mb:{xs:2,md:3},fontSize:{xs:"1.5rem",md:"2.25rem"},color:"white",textShadow:"0 2px 8px rgba(0,0,0,0.2)",background:"none",backgroundClip:"unset",WebkitBackgroundClip:"unset",WebkitTextFillColor:"white"},ellipsis:!1,children:r("home.vision.title","Bin mc tiu ca bn thnh hin thc")}),e.jsxs(l,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:{xs:.5,sm:2,md:4},mt:{xs:2,md:3},flexWrap:"nowrap",width:"100%"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:{xs:.75,sm:1.5},px:{xs:.5,sm:2,md:3},py:{xs:.75,sm:1.5,md:2},background:U(t.palette.common.white,.15),backdropFilter:"blur(10px)",borderRadius:2,border:`1px solid ${U(t.palette.common.white,.3)}`,transition:"all 0.3s ease-in-out",flex:{xs:"1 1 0",sm:"0 0 auto"},minWidth:0,maxWidth:{xs:"50%",sm:"none"},overflow:"hidden","&:hover":{background:U(t.palette.common.white,.25),transform:"translateY(-4px)",boxShadow:`0 8px 24px ${U(t.palette.common.black,.2)}`}},children:[e.jsx(l,{sx:{width:{xs:28,sm:40,md:48},height:{xs:28,sm:40,md:48},borderRadius:"50%",background:U(t.palette.common.white,.2),display:"flex",alignItems:"center",justifyContent:"center",fontSize:{xs:"0.9rem",sm:"1.2rem",md:"1.5rem"},flexShrink:0,border:`2px solid ${U(t.palette.common.white,.4)}`},children:""}),e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,fontSize:{xs:"0.65rem",sm:"1rem",md:"1.2rem"},color:"white",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:r("home.vision.easyManagement","Qun l d dng")})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:{xs:.75,sm:1.5},px:{xs:.5,sm:2,md:3},py:{xs:.75,sm:1.5,md:2},background:U(t.palette.common.white,.15),backdropFilter:"blur(10px)",borderRadius:2,border:`1px solid ${U(t.palette.common.white,.3)}`,transition:"all 0.3s ease-in-out",flex:{xs:"1 1 0",sm:"0 0 auto"},minWidth:0,maxWidth:{xs:"50%",sm:"none"},overflow:"hidden","&:hover":{background:U(t.palette.common.white,.25),transform:"translateY(-4px)",boxShadow:`0 8px 24px ${U(t.palette.common.black,.2)}`}},children:[e.jsx(l,{sx:{width:{xs:28,sm:40,md:48},height:{xs:28,sm:40,md:48},borderRadius:"50%",background:U(t.palette.common.white,.2),display:"flex",alignItems:"center",justifyContent:"center",fontSize:{xs:"0.9rem",sm:"1.2rem",md:"1.5rem"},flexShrink:0,border:`2px solid ${U(t.palette.common.white,.4)}`},children:""}),e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,fontSize:{xs:"0.65rem",sm:"1rem",md:"1.2rem"},color:"white",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:r("home.vision.free","Hon ton min ph")})]})]})]})})}),e.jsx(I,{id:"features-section",delay:.2,alwaysVisible:!0,children:e.jsxs(l,{sx:{mb:{xs:5,md:6}},children:[e.jsxs(l,{sx:{mb:{xs:2,md:3},textAlign:"center"},children:[e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,fontSize:{xs:"1.1rem",md:"1.3rem"},mb:1},children:r("home.features.title","Tnh nng ni bt")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontSize:{xs:"0.85rem",md:"0.95rem"}},children:r("home.features.subtitle","Cng c mnh m cho qun l u t hiu qu")})]}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Rs,{in:j["features-section"]||!1,timeout:500,style:{transitionDelay:"0ms"},children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"primary.main",height:"100%",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:3}},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"primary.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:""}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"subtitle2",sx:{color:"primary.main",fontWeight:600,mb:.5},children:"Qun l a ti khon"}),e.jsx(c,{variant:"caption",color:"text.primary",sx:{fontSize:"0.65rem"},ellipsis:!1,children:"To v qun l nhiu ti khon khch hng"})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Rs,{in:j["features-section"]||!1,timeout:500,style:{transitionDelay:"100ms"},children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"success.main",height:"100%",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:3}},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"success.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:""}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"subtitle2",sx:{color:"success.main",fontWeight:600,mb:.5},children:"Qun l a danh mc"}),e.jsx(c,{variant:"caption",color:"text.primary",sx:{fontSize:"0.65rem"},ellipsis:!1,children:"To a danh mc theo mc tiu u t"})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Rs,{in:j["features-section"]||!1,timeout:500,style:{transitionDelay:"200ms"},children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"warning.main",height:"100%",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:3}},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"warning.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:""}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"subtitle2",sx:{color:"warning.main",fontWeight:600,mb:.5},children:"Theo di hiu sut u t"}),e.jsx(c,{variant:"caption",color:"text.primary",sx:{fontSize:"0.65rem"},ellipsis:!1,children:"Cp nht d liu v hiu sut hng ngy"})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Rs,{in:j["features-section"]||!1,timeout:500,style:{transitionDelay:"300ms"},children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"info.main",height:"100%",transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:3}},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"info.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:""}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"subtitle2",sx:{color:"info.main",fontWeight:600,mb:.5},children:"Chia s danh mc u t"}),e.jsx(c,{variant:"caption",color:"text.primary",sx:{fontSize:"0.65rem"},ellipsis:!1,children:"Chia s d liu vi quyn truy cp linh hot"})]})]})})})})]})]})})]}),e.jsx(I,{id:"trust-section",delay:.3,alwaysVisible:!0,children:e.jsx(l,{sx:{width:"100%",mb:{xs:5,md:6},py:{xs:4,md:5},px:{xs:2,md:4},background:`linear-gradient(135deg, ${U(t.palette.primary.main,.05)} 0%, ${U(t.palette.background.paper,1)} 100%)`,borderRadius:0,border:"none",borderTop:`1px solid ${U(t.palette.primary.main,.1)}`,borderBottom:`1px solid ${U(t.palette.primary.main,.1)}`,display:{xs:"none",sm:"block"}},children:e.jsxs(xn,{maxWidth:"lg",children:[e.jsxs(l,{sx:{textAlign:"center",mb:{xs:3,sm:4}},children:[e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,mb:1,fontSize:{xs:"1.2rem",sm:"1.5rem"}},children:r("home.trust.title","u t an ton v minh bch")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{maxWidth:700,mx:"auto",fontSize:{xs:"0.9rem",sm:"1rem"}},ellipsis:!1,children:r("home.trust.subtitle","H thng qun l danh mc u t chuyn nghip vi  bo mt cao")})]}),e.jsx(l,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(3, 1fr)"},gap:{xs:2,md:3}},children:z.map((F,B)=>e.jsx(Rs,{in:j["trust-section"]||!1,timeout:600,style:{transitionDelay:`${B*100}ms`},children:e.jsxs(se,{sx:{p:{xs:2,sm:3},textAlign:"center",background:t.palette.background.paper,border:`1px solid ${U(t.palette.divider,.12)}`,borderRadius:2,transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:`0 8px 24px ${U(t.palette.primary.main,.15)}`}},children:[e.jsx(Vt,{sx:{bgcolor:U(t.palette.primary.main,.1),color:t.palette.primary.main,width:{xs:56,sm:64},height:{xs:56,md:64},mx:"auto",mb:2},children:F.icon}),e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,mb:1,fontSize:{xs:"1rem",sm:"1.1rem"}},children:F.title}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontSize:{xs:"0.85rem",sm:"0.9rem"},lineHeight:1.6},ellipsis:!1,children:F.description})]})},B))})]})})}),e.jsxs(xn,{maxWidth:"lg",children:[e.jsx(I,{id:"asset-types-section",delay:.1,alwaysVisible:!0,children:e.jsxs(l,{sx:{mb:{xs:5,md:6}},children:[e.jsxs(l,{sx:{mb:{xs:2,md:3},textAlign:"center"},children:[e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,fontSize:{xs:"1.1rem",sm:"1.3rem"},mb:.5},children:r("home.sections.assetTypes.title","a Dng Ti Sn")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontSize:{xs:"0.8rem",sm:"0.95rem"}},ellipsis:!1,children:r("home.sections.assetTypes.subtitle","a dng cc loi ti sn  a dng ha danh mc u t")})]}),e.jsx(l,{sx:{display:"flex",gap:2,overflowX:"auto",overflowY:"hidden",pb:1,scrollbarWidth:"thin",scrollbarColor:`${U(t.palette.primary.main,.3)} transparent`,"&::-webkit-scrollbar":{height:8},"&::-webkit-scrollbar-track":{background:U(t.palette.grey[300],.1),borderRadius:4},"&::-webkit-scrollbar-thumb":{background:U(t.palette.primary.main,.3),borderRadius:4,"&:hover":{background:U(t.palette.primary.main,.5)}},scrollBehavior:"smooth",[t.breakpoints.down("sm")]:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},msOverflowStyle:"none"}},children:E.map((F,B)=>{const $=j["asset-types-section"];return e.jsx(Il,{in:$,timeout:400,style:{transitionDelay:$?`${B*50}ms`:"0ms"},children:e.jsx(se,{sx:{minWidth:i?130:210,maxWidth:i?130:210,height:"100%",flexShrink:0,background:`linear-gradient(135deg, ${U(R(F.color),.05)} 0%, ${U(R(F.color),.02)} 100%)`,border:`1px solid ${U(R(F.color),.1)}`,borderRadius:2,transition:"all 0.3s ease-in-out","&:hover":{transform:"translateY(-4px)",boxShadow:`0 8px 24px ${U(R(F.color),.15)}`}},children:e.jsxs(me,{sx:{p:2,textAlign:"center"},children:[e.jsx(Vt,{sx:{bgcolor:R(F.color),width:56,height:56,mx:"auto",mb:2},children:F.icon}),e.jsx(c,{variant:"cardTitle",children:F.label})]})})},F.type)})})]})}),d?e.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400},children:e.jsx(Ce,{})}):e.jsxs(e.Fragment,{children:[e.jsx(I,{id:"stock-funds-section",delay:.1,alwaysVisible:!d,children:e.jsxs(l,{sx:{mb:{xs:5,md:6}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:{xs:2,md:3}},children:[e.jsx($s,{sx:{mr:2,color:"primary.main",fontSize:{xs:28,md:32}}}),e.jsxs(l,{children:[e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,fontSize:{xs:"1.1rem",md:"1.3rem"}},children:r("home.sections.stockFunds.title","Chng Ch Qu C Phiu")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontSize:{xs:"0.75rem",md:"0.85rem"},mt:.5},children:r("home.sections.stockFunds.subtitle","Cc qu u t vo c phiu vi hiu sut tt nht")})]})]}),h.length>0?e.jsxs(e.Fragment,{children:[e.jsx(l,{sx:{display:{xs:"flex",sm:"none"},gap:1.5,overflowX:"auto",overflowY:"hidden",pb:1,scrollbarWidth:"thin",scrollbarColor:`${U(t.palette.primary.main,.3)} transparent`,"&::-webkit-scrollbar":{height:8},"&::-webkit-scrollbar-track":{background:U(t.palette.grey[300],.1),borderRadius:4},"&::-webkit-scrollbar-thumb":{background:U(t.palette.primary.main,.3),borderRadius:4,"&:hover":{background:U(t.palette.primary.main,.5)}},scrollBehavior:"smooth",[t.breakpoints.down("sm")]:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},msOverflowStyle:"none"}},children:h.map((F,B)=>{const $=U(t.palette.primary.main,.15+B%3*.05),Y=(F.changePercent??0)>=0,_=j["stock-funds-section"]||!d;return e.jsx(as,{direction:"up",in:_,timeout:400,style:{transitionDelay:_?`${B*80}ms`:"0ms"},children:e.jsx(se,{sx:{minWidth:140,maxWidth:140,flexShrink:0,borderRadius:2,border:`1.5px solid ${$}`,boxShadow:`0 2px 8px ${U(t.palette.primary.main,.15)}`,transition:"all 0.2s ease-in-out",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"3px",background:`linear-gradient(90deg, ${t.palette.primary.main} 0%, ${t.palette.primary.light} 100%)`},"&:hover":{transform:"translateY(-4px)",boxShadow:`0 6px 20px ${U(t.palette.primary.main,.25)}`,borderColor:U(t.palette.primary.main,.4)}},children:e.jsxs(me,{sx:{p:2,"&:last-child":{pb:2}},children:[e.jsxs(l,{sx:{mb:1.5},children:[e.jsx(c,{variant:"cardTitle",sx:{fontSize:"0.85rem!important"},children:F.symbol}),F.name&&e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontSize:"0.6rem!important"},children:F.name})]}),e.jsxs(l,{children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",sx:{fontSize:"0.65rem!important",mb:.5,textTransform:"none"},children:r("home.table.price","Gi NAV")}),e.jsx(c,{variant:"cardValue",sx:{fontWeight:600,fontSize:"0.8rem!important",color:Y?t.palette.primary.main:t.palette.error.main,textTransform:"none"},children:G(F.buyPrice||F.sellPrice||0,"VND")})]}),F.changePercent!==void 0&&e.jsx(l,{sx:{display:"flex",justifyContent:"flex-start",mt:1},children:e.jsx(ce,{label:`${F.changePercent>=0?"+":""}${F.changePercent.toFixed(2)}%`,size:"small",color:F.changePercent>=0?"success":"error",sx:{fontWeight:600,height:20,fontSize:"0.7rem!important",textTransform:"none",background:F.changePercent>=0?`linear-gradient(135deg, ${t.palette.success.main} 0%, ${t.palette.success.dark} 100%)`:`linear-gradient(135deg, ${t.palette.error.main} 0%, ${t.palette.error.dark} 100%)`,color:"white","& .MuiChip-label":{padding:"0 6px",textTransform:"none"}}})})]})})},B)})}),e.jsx(at,{component:Te,sx:{display:{xs:"none",sm:"block"},borderRadius:2,border:`1px solid ${U(t.palette.primary.main,.1)}`,boxShadow:`0 2px 8px ${U(t.palette.primary.main,.08)}`},children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{sx:{background:`linear-gradient(135deg, ${U(t.palette.primary.main,.1)} 0%, ${U(t.palette.primary.main,.05)} 100%)`},children:[e.jsx(S,{sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.symbol","M")}),e.jsx(S,{sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.name","Tn")}),e.jsx(S,{align:"right",sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.price","Gi NAV")}),e.jsx(S,{align:"right",sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.change","Thay i")})]})}),e.jsx(ot,{children:h.map((F,B)=>{const $=(F.changePercent??0)>=0;return e.jsxs(De,{sx:{"&:hover":{backgroundColor:U(t.palette.primary.main,.04)},transition:"background-color 0.2s ease-in-out"},children:[e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:600},children:F.symbol})}),e.jsx(S,{sx:{maxWidth:300},children:e.jsx(c,{variant:"tableCell",children:F.name||"-"})}),e.jsx(S,{align:"right",sx:{fontSize:"0.875rem",fontWeight:600,color:$?t.palette.primary.main:t.palette.error.main},children:G(F.buyPrice||F.sellPrice||0,"VND")}),e.jsx(S,{align:"right",children:F.changePercent!==void 0?e.jsx(ce,{label:`${F.changePercent>=0?"+":""}${F.changePercent.toFixed(2)}%`,size:"small",color:F.changePercent>=0?"success":"error",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"none",background:F.changePercent>=0?`linear-gradient(135deg, ${t.palette.success.main} 0%, ${t.palette.success.dark} 100%)`:`linear-gradient(135deg, ${t.palette.error.main} 0%, ${t.palette.error.dark} 100%)`,color:"white"}}):"-"})]},B)})})]})})]}):e.jsx(l,{sx:{textAlign:"center",py:4},children:e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("home.noData","Khng c d liu")})})]})}),e.jsx(I,{id:"bond-funds-section",delay:.1,alwaysVisible:!0,children:e.jsxs(l,{sx:{mb:{xs:5,md:6}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:{xs:2,md:3}},children:[e.jsx($s,{sx:{mr:2,color:"success.main",fontSize:{xs:28,md:32}}}),e.jsxs(l,{children:[e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,fontSize:{xs:"1.1rem",md:"1.3rem"}},children:r("home.sections.bondFunds.title","Chng Ch Qu Tri Phiu")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontSize:{xs:"0.75rem",md:"0.85rem"},mt:.5},children:r("home.sections.bondFunds.subtitle","Cc qu u t vo tri phiu an ton v n nh")})]})]}),x.length>0?e.jsxs(e.Fragment,{children:[e.jsx(l,{sx:{display:{xs:"flex",sm:"none"},gap:1.5,overflowX:"auto",overflowY:"hidden",pb:1,scrollbarWidth:"thin",scrollbarColor:`${U(t.palette.success.main,.3)} transparent`,"&::-webkit-scrollbar":{height:8},"&::-webkit-scrollbar-track":{background:U(t.palette.grey[300],.1),borderRadius:4},"&::-webkit-scrollbar-thumb":{background:U(t.palette.success.main,.3),borderRadius:4,"&:hover":{background:U(t.palette.success.main,.5)}},scrollBehavior:"smooth",[t.breakpoints.down("sm")]:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},msOverflowStyle:"none"}},children:x.map((F,B)=>{const $=U(t.palette.success.main,.15+B%3*.05),Y=(F.changePercent??0)>=0,_=j["bond-funds-section"]||!d;return e.jsx(as,{direction:"up",in:_,timeout:400,style:{transitionDelay:_?`${B*80}ms`:"0ms"},children:e.jsx(se,{sx:{minWidth:140,maxWidth:140,flexShrink:0,borderRadius:2,border:`1.5px solid ${$}`,boxShadow:`0 2px 8px ${U(t.palette.success.main,.15)}`,transition:"all 0.2s ease-in-out",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"3px",background:`linear-gradient(90deg, ${t.palette.success.main} 0%, ${t.palette.success.light} 100%)`},"&:hover":{transform:"translateY(-4px)",boxShadow:`0 6px 20px ${U(t.palette.success.main,.25)}`,borderColor:U(t.palette.success.main,.4)}},children:e.jsxs(me,{sx:{p:2,"&:last-child":{pb:2}},children:[e.jsxs(l,{sx:{mb:1.5},children:[e.jsx(c,{variant:"cardTitle",sx:{fontSize:"0.85rem!important"},children:F.symbol}),F.name&&e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontSize:"0.6rem!important",textTransform:"none"},children:F.name})]}),e.jsxs(l,{children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",sx:{fontSize:"0.65rem!important",mb:.5,textTransform:"none"},children:r("home.table.price","Gi NAV")}),e.jsx(c,{variant:"cardValue",sx:{fontWeight:600,fontSize:"0.8rem!important",color:Y?t.palette.success.main:t.palette.error.main,textTransform:"none"},children:G(F.buyPrice||F.sellPrice||0,"VND")})]}),F.changePercent!==void 0&&e.jsx(l,{sx:{display:"flex",justifyContent:"flex-start",mt:1},children:e.jsx(ce,{label:`${F.changePercent>=0?"+":""}${F.changePercent.toFixed(2)}%`,size:"small",color:F.changePercent>=0?"success":"error",sx:{fontWeight:600,height:20,fontSize:"0.7rem!important",textTransform:"none",background:F.changePercent>=0?`linear-gradient(135deg, ${t.palette.success.main} 0%, ${t.palette.success.dark} 100%)`:`linear-gradient(135deg, ${t.palette.error.main} 0%, ${t.palette.error.dark} 100%)`,color:"white","& .MuiChip-label":{padding:"0 6px",textTransform:"none"}}})})]})})},B)})}),e.jsx(at,{component:Te,sx:{display:{xs:"none",sm:"block"},borderRadius:2,border:`1px solid ${U(t.palette.success.main,.1)}`,boxShadow:`0 2px 8px ${U(t.palette.success.main,.08)}`},children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{sx:{background:`linear-gradient(135deg, ${U(t.palette.success.main,.1)} 0%, ${U(t.palette.success.main,.05)} 100%)`},children:[e.jsx(S,{sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.symbol","M")}),e.jsx(S,{sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.name","Tn")}),e.jsx(S,{align:"right",sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.price","Gi NAV")}),e.jsx(S,{align:"right",sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.change","Thay i")})]})}),e.jsx(ot,{children:x.map((F,B)=>{const $=(F.changePercent??0)>=0;return e.jsxs(De,{sx:{"&:hover":{backgroundColor:U(t.palette.success.main,.04)},transition:"background-color 0.2s ease-in-out"},children:[e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{fontWeight:600},children:F.symbol})}),e.jsx(S,{sx:{maxWidth:300},children:e.jsx(c,{variant:"tableCell",children:F.name||"-"})}),e.jsx(S,{align:"right",sx:{fontSize:"0.875rem",fontWeight:600,color:$?t.palette.success.main:t.palette.error.main},children:G(F.buyPrice||F.sellPrice||0,"VND")}),e.jsx(S,{align:"right",children:F.changePercent!==void 0?e.jsx(ce,{label:`${F.changePercent>=0?"+":""}${F.changePercent.toFixed(2)}%`,size:"small",color:F.changePercent>=0?"success":"error",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"none",background:F.changePercent>=0?`linear-gradient(135deg, ${t.palette.success.main} 0%, ${t.palette.success.dark} 100%)`:`linear-gradient(135deg, ${t.palette.error.main} 0%, ${t.palette.error.dark} 100%)`,color:"white"}}):"-"})]},B)})})]})})]}):e.jsx(l,{sx:{textAlign:"center",py:4},children:e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("home.noData","Khng c d liu")})})]})}),e.jsx(I,{id:"top-stocks-section",delay:.1,alwaysVisible:!d,children:e.jsxs(l,{sx:{mb:{xs:5,md:6}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:{xs:2,md:3}},children:[e.jsx(ar,{sx:{mr:2,color:"info.main",fontSize:{xs:28,md:32}}}),e.jsxs(l,{children:[e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600,fontSize:{xs:"1.1rem",md:"1.3rem"}},children:r("home.sections.topStocks.title","Top C Phiu")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontSize:{xs:"0.75rem",md:"0.85rem"},mt:.5},ellipsis:!1,children:r("home.sections.topStocks.subtitle","Nhng c phiu c khi lng giao dch v bin ng gi cao nht")})]})]}),f.length>0?e.jsxs(e.Fragment,{children:[e.jsx(l,{sx:{display:{xs:"flex",sm:"none"},gap:1.5,overflowX:"auto",overflowY:"hidden",pb:1,scrollbarWidth:"thin",scrollbarColor:`${U(t.palette.info.main,.3)} transparent`,"&::-webkit-scrollbar":{height:8},"&::-webkit-scrollbar-track":{background:U(t.palette.grey[300],.1),borderRadius:4},"&::-webkit-scrollbar-thumb":{background:U(t.palette.info.main,.3),borderRadius:4,"&:hover":{background:U(t.palette.info.main,.5)}},scrollBehavior:"smooth",[t.breakpoints.down("sm")]:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"},msOverflowStyle:"none"}},children:f.map((F,B)=>{const $=U(t.palette.info.main,.15+B%3*.05),Y=(F.changePercent??0)>=0,_=[t.palette.warning.main,t.palette.info.main,t.palette.secondary.main],K=_[B%_.length]||t.palette.info.main,X=j["top-stocks-section"]||!d;return e.jsx(as,{direction:"up",in:X,timeout:400,style:{transitionDelay:X?`${B*100}ms`:"0ms"},children:e.jsx(se,{sx:{minWidth:i?140:200,maxWidth:i?140:200,flexShrink:0,borderRadius:2,border:`1.5px solid ${$}`,boxShadow:`0 2px 8px ${U(K,.15)}`,transition:"all 0.2s ease-in-out",position:"relative",overflow:"hidden","&::before":{content:'""',position:"absolute",top:0,left:0,right:0,height:"3px",background:`linear-gradient(90deg, ${K} 0%, ${U(K,.6)} 100%)`},"&:hover":{transform:"translateY(-4px)",boxShadow:`0 6px 20px ${U(K,.25)}`,borderColor:U(K,.4)}},children:e.jsxs(me,{sx:{p:2,"&:last-child":{pb:0}},children:[e.jsxs(l,{sx:{mb:1.5,display:"flex",alignItems:"center",justifyContent:"space-between",gap:1},children:[e.jsx(c,{variant:"cardTitle",sx:{fontSize:"0.85rem!important"},children:F.symbol}),F.exchange&&e.jsx(ce,{label:F.exchange,size:"small",variant:"outlined",sx:{fontSize:"0.65rem!important",height:16,textTransform:"none",borderColor:U(K,.5),color:K,"& .MuiChip-label":{padding:"0 5px",textTransform:"none"}}})]}),e.jsxs(l,{sx:{display:"flex",alignItems:"flex-end",justifyContent:"space-between",gap:1,flexWrap:"wrap"},children:[e.jsxs(l,{sx:{flex:"1 1 auto",minWidth:0},children:[e.jsx(c,{variant:"formHelper",color:"text.secondary",sx:{fontSize:"0.65rem!important",mb:.5,textTransform:"none"},children:r("home.table.price","Gi")}),e.jsx(c,{variant:"cardValue",sx:{fontWeight:600,fontSize:"0.8rem!important",color:Y?K:t.palette.error.main,textTransform:"none"},children:G(F.buyPrice||F.sellPrice||0,"VND")})]}),F.changePercent!==void 0&&e.jsx(l,{sx:{display:"flex",alignItems:"flex-end",flexShrink:0},children:e.jsx(ce,{label:`${F.changePercent>=0?"+":""}${F.changePercent.toFixed(2)}%`,size:"small",color:F.changePercent>=0?"success":"error",sx:{height:20,fontSize:"0.65rem!important",textTransform:"none",background:F.changePercent>=0?`linear-gradient(135deg, ${t.palette.success.main} 0%, ${t.palette.success.dark} 100%)`:`linear-gradient(135deg, ${t.palette.error.main} 0%, ${t.palette.error.dark} 100%)`,color:"white","& .MuiChip-label":{padding:"0 4px",textTransform:"none"}}})})]})]})})},B)})}),e.jsx(at,{component:Te,sx:{display:{xs:"none",sm:"block"},borderRadius:2,border:`1px solid ${U(t.palette.info.main,.1)}`,boxShadow:`0 2px 8px ${U(t.palette.info.main,.08)}`},children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.symbol","M")}),e.jsx(S,{sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.name","Tn")}),e.jsx(S,{sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.exchange","Sn")}),e.jsx(S,{sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.price","Gi")}),e.jsx(S,{sx:{fontWeight:600,fontSize:"0.875rem"},children:r("home.table.change","Thay i")})]})}),e.jsx(ot,{children:f.map((F,B)=>{const $=(F.changePercent??0)>=0,Y=[t.palette.warning.main,t.palette.info.main,t.palette.secondary.main],_=Y[B%Y.length]||t.palette.info.main;return e.jsxs(De,{sx:{"&:hover":{backgroundColor:U(t.palette.info.main,.04)},transition:"background-color 0.2s ease-in-out"},children:[e.jsx(S,{children:e.jsx(c,{variant:"cardTitle",sx:{fontWeight:600},children:F.symbol})}),e.jsx(S,{children:e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:F.name||F.symbol})}),e.jsx(S,{children:F.exchange?e.jsx(ce,{label:F.exchange,size:"small",variant:"outlined",sx:{fontSize:"0.75rem",textTransform:"none",borderColor:U(_,.3)}}):"-"}),e.jsx(S,{children:e.jsx(c,{variant:"tableCell",sx:{fontSize:"0.875rem",fontWeight:600,color:$?t.palette.success.main:t.palette.error.main},children:G(F.buyPrice||F.sellPrice||0,"VND")})}),e.jsx(S,{children:F.changePercent!==void 0?e.jsx(ce,{label:`${F.changePercent>=0?"+":""}${F.changePercent.toFixed(2)}%`,size:"small",color:F.changePercent>=0?"success":"error",sx:{textTransform:"none",background:F.changePercent>=0?`linear-gradient(135deg, ${t.palette.success.main} 0%, ${t.palette.success.dark} 100%)`:`linear-gradient(135deg, ${t.palette.error.main} 0%, ${t.palette.error.dark} 100%)`,color:"white","& .MuiChip-label":{textTransform:"none"}}}):"-"})]},B)})})]})})]}):e.jsx(l,{sx:{textAlign:"center",py:4},children:e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("home.noData","Khng c d liu")})})]})})]})]}),e.jsx(I,{id:"steps-section",delay:.1,alwaysVisible:!0,children:e.jsxs(l,{sx:{width:"100%",mb:{xs:5,md:6},position:"relative",overflow:"hidden"},children:[e.jsx(l,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,background:`linear-gradient(135deg, ${U(t.palette.primary.main,.03)} 0%, ${U(t.palette.secondary.main,.02)} 50%, ${U(t.palette.background.paper,1)} 100%)`,borderRadius:0,"&::before":{content:'""',position:"absolute",top:-100,right:-100,width:300,height:300,borderRadius:"50%",background:`radial-gradient(circle, ${U(t.palette.primary.main,.08)} 0%, transparent 70%)`,zIndex:0},"&::after":{content:'""',position:"absolute",bottom:-80,left:-80,width:250,height:250,borderRadius:"50%",background:`radial-gradient(circle, ${U(t.palette.secondary.main,.06)} 0%, transparent 70%)`,zIndex:0}}}),e.jsx(l,{sx:{position:"relative",zIndex:1,py:{xs:5,md:7},px:{xs:2,md:4}},children:e.jsxs(xn,{maxWidth:"lg",children:[e.jsxs(l,{sx:{textAlign:"center",mb:{xs:4,md:6}},children:[e.jsx(l,{sx:{display:"inline-flex",alignItems:"center",justifyContent:"center",px:2,py:.5,mb:2,borderRadius:2,background:`linear-gradient(135deg, ${U(t.palette.primary.main,.1)} 0%, ${U(t.palette.secondary.main,.08)} 100%)`,border:`1px solid ${U(t.palette.primary.main,.15)}`},children:e.jsx(c,{variant:"caption",sx:{fontSize:{xs:"0.7rem",md:"0.75rem"},fontWeight:600,color:t.palette.primary.main,textTransform:"uppercase",letterSpacing:1},children:r("home.steps.badge","Hng dn")})}),e.jsx(c,{variant:"cardTitle",sx:{fontWeight:700,mb:1.5,fontSize:{xs:"1.5rem",md:"2rem"},background:`linear-gradient(135deg, ${t.palette.primary.main} 0%, ${t.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},ellipsis:!1,children:r("home.steps.title","Bt u ngay ch vi 3 bc")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{maxWidth:650,mx:"auto",fontSize:{xs:"0.9rem",md:"1.05rem"},lineHeight:1.7},ellipsis:!1,children:r("home.steps.subtitle","u t cha bao gi d dng hn. Bt u hnh trnh u t ca bn ngay hm nay")})]}),e.jsx(l,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(3, 1fr)",md:"repeat(3, 1fr)"},gap:{xs:2.5,sm:2.5,md:3,lg:4},position:"relative",maxWidth:{xs:"100%",sm:"100%",md:1e3},mx:"auto",width:"100%",justifyContent:"center"},children:N.map((F,B)=>e.jsx(Rs,{in:j["steps-section"]||!d,timeout:700,style:{transitionDelay:`${B*200}ms`},children:e.jsxs(l,{className:"step-card-container",sx:{position:"relative",height:"100%",width:"100%",maxWidth:{xs:"100%",sm:"100%",md:"280px",lg:"320px"},mx:{sm:0,md:"auto"}},children:[B<N.length-1&&o&&e.jsxs(l,{sx:{position:"absolute",top:{sm:"68px",md:"84px"},left:"100%",width:{sm:"calc((100% - 40px) / 3)",md:"calc((100% - 48px) / 3)",lg:"calc((100% - 64px) / 3)"},height:"4px",zIndex:0,transform:"translateY(-50%)",pointerEvents:"none",[t.breakpoints.down("sm")]:{display:"none"}},children:[e.jsx(l,{sx:{width:"100%",height:"4px",background:`linear-gradient(90deg, ${t.palette.warning.main} 0%, ${U(t.palette.warning.main,.7)} 50%, ${U(t.palette.warning.main,.3)} 100%)`,borderRadius:"2px",position:"relative",boxShadow:`0 0 8px ${U(t.palette.warning.main,.3)}`}}),e.jsx(l,{sx:{position:"absolute",right:-8,top:"50%",transform:"translateY(-50%)",width:0,height:0,borderLeft:`8px solid ${t.palette.warning.main}`,borderTop:"5px solid transparent",borderBottom:"5px solid transparent"}})]}),B<N.length-1&&i&&e.jsx(l,{sx:{position:"absolute",bottom:-24,left:"50%",transform:"translateX(-50%)",width:"4px",height:40,background:`linear-gradient(180deg, ${t.palette.warning.main} 0%, ${U(t.palette.warning.main,.3)} 100%)`,zIndex:0,borderRadius:"2px",boxShadow:`0 0 8px ${U(t.palette.warning.main,.3)}`,"&::after":{content:'""',position:"absolute",bottom:-8,left:"50%",transform:"translateX(-50%)",width:0,height:0,borderTop:`8px solid ${t.palette.warning.main}`,borderLeft:"5px solid transparent",borderRight:"5px solid transparent"}}}),e.jsxs(l,{sx:{height:"100%",width:"100%",maxWidth:"100%",p:{xs:2,sm:2,lg:3},textAlign:"center",position:"relative",zIndex:1,background:"transparent",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",overflow:"visible","&:hover":{"& .step-icon":{transform:"scale(1.1)",boxShadow:`0 8px 24px ${U(t.palette.warning.main,.4)}`}}},children:[e.jsx(l,{sx:{position:"relative",mb:{xs:2,sm:2.5,md:3}},children:e.jsx(Vt,{className:"step-icon",sx:{bgcolor:U(t.palette.warning.main,.15),color:t.palette.warning.main,width:{xs:80,sm:96,md:120},height:{xs:80,sm:96,md:120},mx:"auto",border:`3px solid ${t.palette.warning.main}`,boxShadow:`0 4px 16px ${U(t.palette.warning.main,.3)}`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",zIndex:1,"& svg":{fontSize:{xs:"2rem",sm:"2.5rem",md:"3rem"}},"&::before":{content:'""',position:"absolute",inset:-4,borderRadius:"50%",background:`radial-gradient(circle, ${U(t.palette.warning.main,.2)} 0%, transparent 70%)`,zIndex:-1}},children:F.icon})}),e.jsx(c,{variant:"cardTitle",sx:{fontWeight:700,mb:{xs:1,sm:1.25,md:1.5},fontSize:{xs:"1.1rem",sm:"1.2rem",md:"1.4rem"},color:t.palette.text.primary},children:F.title}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",sx:{fontSize:{xs:"0.8rem",sm:"0.875rem",md:"0.95rem"},lineHeight:{xs:1.5,sm:1.6,md:1.7}},ellipsis:!1,children:F.description})]})]})},B))})]})})]})}),e.jsx(l,{sx:{position:"fixed",bottom:0,left:0,right:0,zIndex:1e3,px:{xs:0,md:4},py:{xs:1,md:2.5},background:`linear-gradient(180deg, transparent 0%, ${U(t.palette.background.paper,.95)} 10%, ${t.palette.background.paper} 100%)`,backdropFilter:"blur(10px)",borderTop:`1px solid ${U(t.palette.divider,.12)}`,boxShadow:`0 -4px 20px ${U(t.palette.common.black,.1)}`},children:e.jsx(xn,{maxWidth:"xs",children:e.jsx(ut,{variant:"contained",size:i?"small":"large",fullWidth:!0,startIcon:e.jsx(Fl,{}),endIcon:e.jsx(wa,{}),onClick:()=>n("/login"),sx:{py:{xs:1.5,md:1.75},fontSize:{xs:"0.95rem",md:"1rem"},fontWeight:600,borderRadius:2,background:`linear-gradient(135deg, ${t.palette.primary.main} 0%, ${t.palette.primary.dark} 100%)`,boxShadow:`0 4px 16px ${U(t.palette.primary.main,.4)}`,textTransform:"none","&:hover":{background:`linear-gradient(135deg, ${t.palette.primary.dark} 0%, ${t.palette.primary.main} 100%)`,boxShadow:`0 6px 24px ${U(t.palette.primary.main,.5)}`,transform:"translateY(-2px)"},transition:"all 0.3s ease-in-out"},children:r("home.cta.button","ng Nhp min ph")})})})]})},yD=({children:r,icon:t})=>e.jsx(l,{sx:{p:2,backgroundColor:"#e3f2fd",borderRadius:2,border:"1px solid #2196f3",mb:2},children:e.jsxs(D,{variant:"body2",sx:{display:"flex",alignItems:"center",gap:1},children:[t||""," ",r]})}),bD=()=>e.jsxs(l,{id:"overview",sx:{mb:6},children:[e.jsx(c,{variant:"pageTitle",component:"h1",gutterBottom:!0,children:"Tng quan h thng"}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",paragraph:!0,children:"Hng dn ton din v cch s dng h thng qun l danh mc u t"}),e.jsx(se,{sx:{mb:4},id:"workflow",children:e.jsxs(me,{children:[e.jsx(c,{variant:"cardTitle",component:"h2",gutterBottom:!0,children:"Quy trnh hot ng c bn"}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",paragraph:!0,children:"Cc bc c bn  s dng h thng t to ti khon n chia s d liu"}),e.jsx(yD,{children:"H thng c thit k theo m hnh phn quyn a cp, cho php nh qun l to v chia s portfolio vi khch hng mt cch an ton v linh hot."}),e.jsxs(l,{sx:{mt:3},children:[e.jsx(D,{variant:"h6",gutterBottom:!0,sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:" Quy trnh tng bc"}),e.jsxs(W,{container:!0,spacing:1.5,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"primary.main",height:"100%"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"primary.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:"1"}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(D,{variant:"subtitle2",sx:{color:"primary.main",fontWeight:600,mb:.5},children:"ng k ti khon qun l"}),e.jsx(D,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem"},children:"To ti khon ng nhp"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"success.main",height:"100%"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"success.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:"2"}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(D,{variant:"subtitle2",sx:{color:"success.main",fontWeight:600,mb:.5},children:"To ti khon khch hng"}),e.jsx(D,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem"},children:"Account 1, Account 2, Account 3..."})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"warning.main",height:"100%"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"warning.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:"3"}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(D,{variant:"subtitle2",sx:{color:"warning.main",fontWeight:600,mb:.5},children:"To Portfolio"}),e.jsx(D,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem"},children:"Portfolio 1, Portfolio 2... theo mc tiu"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"info.main",height:"100%"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"info.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:"4"}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(D,{variant:"subtitle2",sx:{color:"info.main",fontWeight:600,mb:.5},children:"Thm giao dch"}),e.jsx(D,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem"},children:"Mua/bn c phiu, tri phiu"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"secondary.main",height:"100%"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"secondary.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:"5"}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(D,{variant:"subtitle2",sx:{color:"secondary.main",fontWeight:600,mb:.5},children:"Chia s quyn truy cp"}),e.jsx(D,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem"},children:"Cp quyn VIEW/UPDATE"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"error.main",height:"100%"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"error.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:"6"}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(D,{variant:"subtitle2",sx:{color:"error.main",fontWeight:600,mb:.5},children:"Cung cp Account ID"}),e.jsx(D,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem"},children:"Gi ID cho khch hng"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"success.dark",height:"100%"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"success.dark",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:"7"}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(D,{variant:"subtitle2",sx:{color:"success.dark",fontWeight:600,mb:.5},children:"Khch hng truy cp"}),e.jsx(D,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem"},children:"ng nhp v xem d liu"})]})]})})})]}),e.jsxs(l,{sx:{p:2,backgroundColor:"linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%)",borderRadius:2,border:"2px solid #4caf50",textAlign:"center",mt:2},children:[e.jsx(D,{variant:"h6",sx:{color:"success.main",mb:1,display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:" Kt qu cui cng"}),e.jsx(D,{variant:"body2",color:"text.primary",children:"Khch hng c th xem portfolio, theo di hiu sut u t v nhn bo co t nh qun l"})]})]}),e.jsxs(l,{sx:{mt:4},children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:" c im chnh ca h thng"}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(lt,{dense:!0,children:[e.jsxs(Pe,{children:[e.jsx(tt,{children:e.jsx(D,{variant:"h6",sx:{color:"primary.main"},children:""})}),e.jsx(ve,{primary:"Bo mt a cp",secondary:"Mi ti khon c d liu ring bit"})]}),e.jsxs(Pe,{children:[e.jsx(tt,{children:e.jsx(D,{variant:"h6",sx:{color:"success.main"},children:""})}),e.jsx(ve,{primary:"Qun l a khch hng",secondary:"Mt qun l c th phc v nhiu khch hng"})]})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(lt,{dense:!0,children:[e.jsxs(Pe,{children:[e.jsx(tt,{children:e.jsx(D,{variant:"h6",sx:{color:"warning.main"},children:""})}),e.jsx(ve,{primary:"Theo di hiu sut u t",secondary:"D liu c cp nht lin tc"})]}),e.jsxs(Pe,{children:[e.jsx(tt,{children:e.jsx(D,{variant:"h6",sx:{color:"info.main"},children:""})}),e.jsx(ve,{primary:"Chia s linh hot",secondary:"C th chia s ton b hoc mt phn portfolio"})]})]})})]})]})]})})]}),jD=({children:r})=>e.jsxs(l,{sx:{p:2,backgroundColor:"#e3f2fd",borderRadius:2,border:"1px solid #2196f3",mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:""}),e.jsx(l,{children:r})]}),vD=()=>e.jsx(se,{sx:{mb:4},id:"features",children:e.jsxs(me,{children:[e.jsx(c,{variant:"cardTitle",component:"h2",gutterBottom:!0,children:"Tnh nng chnh"}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",paragraph:!0,children:"Cc tnh nng ct li ca h thng"}),e.jsx(jD,{children:e.jsx(D,{variant:"body2",color:"text.primary",children:"H thng c thit k vi 4 tnh nng ct li, mi tnh nng u c vai tr quan trng trong vic qun l danh mc u t hiu qu."})}),e.jsxs(l,{sx:{mt:3},children:[e.jsx(D,{variant:"h6",gutterBottom:!0,sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:" Tnh nng ct li"}),e.jsxs(W,{container:!0,spacing:1.5,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"primary.main",height:"100%"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"primary.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:""}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(D,{variant:"subtitle2",sx:{color:"primary.main",fontWeight:600,mb:.5},children:"Qun l a ti khon"}),e.jsx(D,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem"},children:"To v qun l nhiu ti khon khch hng"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"success.main",height:"100%"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"success.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:""}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(D,{variant:"subtitle2",sx:{color:"success.main",fontWeight:600,mb:.5},children:"Qun l Portfolio"}),e.jsx(D,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem"},children:"To portfolio theo mc tiu u t"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"warning.main",height:"100%"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"warning.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:""}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(D,{variant:"subtitle2",sx:{color:"warning.main",fontWeight:600,mb:.5},children:"Theo di hiu sut u t"}),e.jsx(D,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem"},children:"Cp nht d liu v hiu sut hng ngy"})]})]})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(Te,{elevation:1,sx:{p:1.5,borderLeft:"3px solid",borderLeftColor:"info.main",height:"100%"},children:e.jsxs(l,{sx:{display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(l,{sx:{width:28,height:28,borderRadius:"50%",bgcolor:"info.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0},children:""}),e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(D,{variant:"subtitle2",sx:{color:"info.main",fontWeight:600,mb:.5},children:"Chia s danh mc u t"}),e.jsx(D,{variant:"caption",color:"text.primary",sx:{fontSize:"0.75rem"},children:"Chia s d liu vi quyn truy cp linh hot"})]})]})})})]}),e.jsxs(l,{sx:{mt:3},children:[e.jsx(D,{variant:"h6",gutterBottom:!0,sx:{mb:2},children:" Chi tit tng tnh nng"}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Te,{elevation:1,sx:{p:2,borderLeft:"4px solid",borderLeftColor:"primary.main"},children:[e.jsx(D,{variant:"h6",sx:{color:"primary.main",mb:1,display:"flex",alignItems:"center",gap:1},children:" Qun l a ti khon"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"To ti khon ring bit",secondary:"Mi khch hng c ti khon c lp",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})}),e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"Phn quyn linh hot",secondary:"UPDATE, VIEW cho tng ti khon khch hng",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})}),e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"Bo mt d liu",secondary:"D liu khch hng c bo v ring bit",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})})]})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Te,{elevation:1,sx:{p:2,borderLeft:"4px solid",borderLeftColor:"success.main"},children:[e.jsx(D,{variant:"h6",sx:{color:"success.main",mb:1,display:"flex",alignItems:"center",gap:1},children:" Qun l Portfolio"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"To theo mc tiu",secondary:"Portfolio c thit k theo chin lc u t",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})}),e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"Qun l giao dch",secondary:"Theo di mua/bn, P&L chi tit",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})}),e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"Chia s linh hot",secondary:"C th chia s ton b hoc mt phn portfolio",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})})]})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Te,{elevation:1,sx:{p:2,borderLeft:"4px solid",borderLeftColor:"warning.main"},children:[e.jsx(D,{variant:"h6",sx:{color:"warning.main",mb:1,display:"flex",alignItems:"center",gap:1},children:" Theo di hiu sut u t"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"Cp nht gi lin tc",secondary:"Gi c phiu c cp nht hng ngy",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})}),e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"Tnh ton P&L",secondary:"Li/l c tnh ton t ng",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})}),e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"Bo co tc th",secondary:"Bo co hiu sut c to t ng",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})})]})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Te,{elevation:1,sx:{p:2,borderLeft:"4px solid",borderLeftColor:"info.main"},children:[e.jsx(D,{variant:"h6",sx:{color:"info.main",mb:1,display:"flex",alignItems:"center",gap:1},children:" Chia s danh mc u t"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"Quyn truy cp phn cp",secondary:"OWNER > UPDATE > VIEW",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})}),e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"Bo mt d liu",secondary:"M ha v xc thc ng nhp",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})}),e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:"Kim sot truy cp",secondary:"Qun l quyn truy cp chi tit",primaryTypographyProps:{fontSize:"0.875rem",fontWeight:500},secondaryTypographyProps:{fontSize:"0.75rem"}})})]})]})})]})]}),e.jsxs(l,{sx:{p:2,backgroundColor:"linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%)",borderRadius:2,border:"2px solid #2196f3",textAlign:"center",mt:3},children:[e.jsx(D,{variant:"h6",sx:{color:"primary.main",mb:1,display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:" Li ch tng th"}),e.jsx(D,{variant:"body2",color:"text.primary",children:"H thng tch hp 4 tnh nng ct li gip qun l danh mc u t hiu qu, bo mt cao v d s dng cho c nh qun l v khch hng."})]})]})]})}),wD=({children:r})=>e.jsxs(l,{sx:{p:2,backgroundColor:"#e8f5e8",borderRadius:2,border:"1px solid #4caf50",mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:""}),e.jsx(l,{children:r})]}),SD=({children:r})=>e.jsxs(l,{sx:{p:2,backgroundColor:"#fff3e0",borderRadius:2,border:"1px solid #ff9800",mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:""}),e.jsx(l,{children:r})]}),TD=()=>e.jsx(l,{id:"use-cases",sx:{mb:6},children:e.jsx(se,{sx:{mb:4},children:e.jsxs(me,{children:[e.jsx(c,{variant:"cardTitle",component:"h2",gutterBottom:!0,children:"Trng hp s dng"}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",paragraph:!0,children:"Cc tnh hung thc t v cch h thng gii quyt tng vn  c th"}),e.jsx(wD,{children:e.jsx(D,{variant:"body2",children:"H thng c thit k  phc v nhiu loi ngi dng khc nhau vi cc nhu cu a dng v qun l danh mc u t."})}),e.jsxs(Te,{elevation:2,sx:{p:3,mb:3},id:"manager-scenario",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,color:"primary.main",fontWeight:"bold"},children:[e.jsx(ks,{}),"Tnh hung 1: Nh qun l u t chuyn nghip"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Qun l nhiu khch hng vi cc chin lc u t khc nhau"}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(D,{variant:"h6",gutterBottom:!0,sx:{color:"primary.main"},children:" Mc tiu"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"Qun l 50+ khch hng c nhn"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Theo di hiu sut tng portfolio"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Chia s bo co vi khch hng"})})]})]}),e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(D,{variant:"h6",gutterBottom:!0,sx:{color:"success.main"},children:" Gii php"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"To ti khon ring cho tng khch hng"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Portfolio theo mc tiu u t"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Bo co t ng hng ngy"})})]})]})]}),e.jsxs(Dr,{orientation:"vertical",sx:{mt:2},children:[e.jsxs(_n,{active:!0,children:[e.jsx(Yn,{children:"ng nhp h thng"}),e.jsx(Jn,{children:e.jsx(D,{variant:"body2",children:"To ti khon qun l."})})]}),e.jsxs(_n,{active:!0,children:[e.jsx(Yn,{children:"Qun l khch hng"}),e.jsx(Jn,{children:e.jsx(D,{variant:"body2",children:"To Account cho tng khch hng, thit lp thng tin c nhn v mc tiu u t."})})]}),e.jsxs(_n,{active:!0,children:[e.jsx(Yn,{children:"Xy dng portfolio"}),e.jsx(Jn,{children:e.jsx(D,{variant:"body2",children:"To portfolio theo chin lc (Tng trng, Thu nhp, Cn bng) cho tng khch hng."})})]}),e.jsxs(_n,{active:!0,children:[e.jsx(Yn,{children:"Thc hin giao dch"}),e.jsx(Jn,{children:e.jsx(D,{variant:"body2",children:"Thm giao dch mua/bn, theo di P&L v cp nht Assets."})})]}),e.jsxs(_n,{active:!0,children:[e.jsx(Yn,{children:"Chia s vi khch hng"}),e.jsx(Jn,{children:e.jsx(D,{variant:"body2",children:"Cp quyn VIEW/UPDATE cho khch hng, gi Account ID v hng dn truy cp."})})]})]})]}),e.jsxs(Te,{elevation:2,sx:{p:3,mb:3},id:"investor-scenario",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,color:"success.main",fontWeight:"bold"},children:[e.jsx(Sn,{}),"Tnh hung 2: Nh u t c nhn"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Theo di danh mc u t c nhn v nhn t vn t chuyn gia"}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(D,{variant:"h6",gutterBottom:!0,sx:{color:"success.main"},children:" Mc tiu"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"Theo di hiu sut u t"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Nhn t vn t chuyn gia"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Hiu r danh mc ca mnh"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"a ra quyt nh u t"})})]})]}),e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(D,{variant:"h6",gutterBottom:!0,sx:{color:"info.main"},children:" Gii php"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"ng k ti khon c nhn"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Nhn Account ID t qun l"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Xem portfolio c chia s"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Nhn bo co nh k"})})]})]})]}),e.jsxs(l,{sx:{mt:2,p:2,backgroundColor:"#f5f5f5",borderRadius:2},children:[e.jsxs(D,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(He,{}),"Quy trnh cho nh u t"]}),e.jsxs(lt,{dense:!0,children:[e.jsxs(Pe,{children:[e.jsx(tt,{children:e.jsx(D,{variant:"h6",sx:{color:"primary.main"},children:"1"})}),e.jsx(ve,{primary:"ng k ti khon trn h thng",secondary:"To ti khon c nhn vi thng tin c bn"})]}),e.jsxs(Pe,{children:[e.jsx(tt,{children:e.jsx(D,{variant:"h6",sx:{color:"success.main"},children:"2"})}),e.jsx(ve,{primary:"Nhn Account ID t nh qun l",secondary:"Qun l s cung cp Account ID  truy cp"})]}),e.jsxs(Pe,{children:[e.jsx(tt,{children:e.jsx(D,{variant:"h6",sx:{color:"warning.main"},children:"3"})}),e.jsx(ve,{primary:"ng nhp v xem portfolio",secondary:"Truy cp danh mc u t c chia s"})]}),e.jsxs(Pe,{children:[e.jsx(tt,{children:e.jsx(D,{variant:"h6",sx:{color:"info.main"},children:"4"})}),e.jsx(ve,{primary:"Theo di hiu sut v nhn bo co",secondary:"Xem P&L, nhn bo co nh k t qun l"})]})]})]})]}),e.jsxs(Te,{elevation:2,sx:{p:3,mb:3},id:"family-office-scenario",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,color:"warning.main",fontWeight:"bold"},children:[e.jsx(Jt,{}),"Tnh hung 3: Vn phng gia nh (Family Office)"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Qun l ti sn cho gia nh vi nhiu th h v mc tiu khc nhau"}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:2},children:[e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(Te,{elevation:1,sx:{p:2,borderLeft:"4px solid",borderLeftColor:"primary.main"},children:[e.jsx(D,{variant:"h6",sx:{color:"primary.main",mb:1},children:" Th h 1: Cha m"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"Portfolio bo ton vn"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Thu nhp n nh"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Ri ro thp"})})]})]})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(Te,{elevation:1,sx:{p:2,borderLeft:"4px solid",borderLeftColor:"success.main"},children:[e.jsx(D,{variant:"h6",sx:{color:"success.main",mb:1},children:" Th h 2: Con ci"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"Portfolio tng trng"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"u t di hn"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Ri ro trung bnh"})})]})]})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(Te,{elevation:1,sx:{p:2,borderLeft:"4px solid",borderLeftColor:"warning.main"},children:[e.jsx(D,{variant:"h6",sx:{color:"warning.main",mb:1},children:" Th h 3: Chu"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"Portfolio tng trng mnh"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"u t cng ngh"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Ri ro cao"})})]})]})})]}),e.jsx(SD,{children:e.jsxs(D,{variant:"body2",children:[e.jsx("strong",{children:"Lu :"})," Mi th h c Account ring bit vi portfolio ph hp vi mc tiu v kh nng chu ri ro khc nhau."]})})]}),e.jsxs(Te,{elevation:2,sx:{p:3,mb:3},id:"investment-club-scenario",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,color:"info.main",fontWeight:"bold"},children:[e.jsx(eh,{}),"Tnh hung 4: u t chung"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Nhm bn cng u t v chia s kinh nghim vi nhau"}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(D,{variant:"h6",gutterBottom:!0,sx:{color:"info.main"},children:" c im"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"Cng mc tiu u t"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Chia s thng tin"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Hc hi ln nhau"})})]})]}),e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(D,{variant:"h6",gutterBottom:!0,sx:{color:"secondary.main"},children:" Li ch"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"Quyt nh tp th"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Chia s ri ro"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Hc hi kinh nghim"})})]})]})]}),e.jsxs(l,{sx:{mt:2,p:2,backgroundColor:"#e3f2fd",borderRadius:2},children:[e.jsxs(D,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Zt,{}),"Quy trnh hot ng"]}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",gutterBottom:!0,children:"Thit lp ban u:"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"1. Chn ngi qun l chnh"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"2. To Account cho tng thnh vin"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"3. Thit lp quy tc u t"})})]})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",gutterBottom:!0,children:"Hot ng hng ngy:"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"4. Tho lun c hi u t"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"5. Biu quyt quyt nh"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"6. Thc hin giao dch"})})]})]})]})]})]}),e.jsxs(l,{sx:{p:3,backgroundColor:"linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%)",borderRadius:2,border:"2px solid #4caf50",textAlign:"center",mt:3},children:[e.jsx(D,{variant:"h6",sx:{color:"success.main",mb:1,display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:" Tng kt"}),e.jsx(D,{variant:"body2",color:"text.primary",children:"H thng linh hot phc v nhiu loi ngi dng t c nhn n t chc, vi kh nng ty chnh theo nhu cu c th ca tng trng hp s dng."})]})]})})}),CD=({children:r})=>e.jsxs(l,{sx:{p:2,backgroundColor:"#e8f5e8",borderRadius:2,border:"1px solid #4caf50",mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:""}),e.jsx(l,{children:r})]}),kD=()=>{const r=[{level:"OWNER",color:"error",icon:e.jsx(gc,{}),description:"Ton quyn qun l",permissions:["To, sa, xa ti khon","To, sa, xa portfolio","Thc hin giao dch","Chia s quyn truy cp","Xem tt c d liu","Qun l ci t h thng"]},{level:"UPDATE",color:"warning",icon:e.jsx(Tt,{}),description:"Quyn cp nht",permissions:["Xem portfolio c chia s","Thm, sa giao dch","Cp nht cc m ti sn","Xem bo co","Khng th chia s quyn"]},{level:"VIEW",color:"info",icon:e.jsx(Xt,{}),description:"Quyn xem",permissions:["Xem portfolio c chia s","Xem bo co","Khng th chnh sa","Ch c d liu"]}];return e.jsx(l,{id:"permissions",sx:{mb:6},children:e.jsx(se,{sx:{mb:4},children:e.jsxs(me,{children:[e.jsx(c,{variant:"cardTitle",component:"h2",gutterBottom:!0,children:"H thng phn quyn"}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",paragraph:!0,children:"C ch phn quyn chi tit v cch hot ng ca h thng"}),e.jsx(CD,{children:e.jsx(D,{variant:"body2",children:"H thng s dng m hnh phn quyn 3 cp (OWNER, UPDATE, VIEW)  m bo bo mt v kim sot truy cp d liu."})}),e.jsxs(l,{sx:{mt:3},children:[e.jsxs(D,{variant:"h6",gutterBottom:!0,sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Jt,{}),"Cc cp  phn quyn"]}),e.jsx(W,{container:!0,spacing:2,children:r.map(t=>e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(Te,{elevation:2,sx:{p:3,borderLeft:"4px solid",borderLeftColor:`${t.color}.main`,height:"100%"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(l,{sx:{width:40,height:40,borderRadius:"50%",bgcolor:`${t.color}.main`,color:"white",display:"flex",alignItems:"center",justifyContent:"center",mr:2},children:t.icon}),e.jsxs(l,{children:[e.jsx(D,{variant:"h6",sx:{color:`${t.color}.main`,fontWeight:600},children:t.level}),e.jsx(D,{variant:"body2",color:"text.secondary",children:t.description})]})]}),e.jsx(lt,{dense:!0,children:t.permissions.map((n,s)=>e.jsxs(Pe,{sx:{py:.5},children:[e.jsx(tt,{children:e.jsx(Xe,{sx:{color:`${t.color}.main`,fontSize:"1rem"}})}),e.jsx(ve,{primary:n,primaryTypographyProps:{fontSize:"0.875rem"}})]},s))})]})},t.level))})]}),e.jsxs(l,{sx:{mt:4},children:[e.jsxs(D,{variant:"h6",gutterBottom:!0,sx:{mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Sn,{}),"Vai tr ngi dng"]}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Te,{elevation:2,sx:{p:3,borderLeft:"4px solid",borderLeftColor:"warning.main"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(ks,{sx:{color:"warning.main",mr:1}}),e.jsx(D,{variant:"h6",sx:{color:"warning.main"},children:"Nh qun l (Fund Manager)"})]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"C quyn OWNER trn cc ti khon c phn cng"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"Qun l portfolio khch hng"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Thc hin giao dch"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Chia s d liu vi khch hng"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"To bo co"})})]})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Te,{elevation:2,sx:{p:3,borderLeft:"4px solid",borderLeftColor:"info.main"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(Sn,{sx:{color:"info.main",mr:1}}),e.jsx(D,{variant:"h6",sx:{color:"info.main"},children:"Khch hng (Customer)"})]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"C quyn VIEW hoc UPDATE trn portfolio c chia s"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{children:e.jsx(ve,{primary:"Xem portfolio ca mnh"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Theo di hiu sut u t"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Nhn bo co t qun l"})}),e.jsx(Pe,{children:e.jsx(ve,{primary:"Cp nht thng tin c nhn"})})]})]})})]})]}),e.jsxs(l,{sx:{p:3,backgroundColor:"linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%)",borderRadius:2,border:"2px solid #2196f3",textAlign:"center",mt:3},children:[e.jsx(D,{variant:"h6",sx:{color:"primary.main",mb:1,display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:" Tng kt h thng phn quyn"}),e.jsx(D,{variant:"body2",color:"text.primary",children:"H thng phn quyn theo cp  m bo bo mt d liu, kim sot truy cp cht ch v ph hp vi nhu cu qun l ca cc t chc ti chnh chuyn nghip."})]})]})})})},Dl=({children:r})=>e.jsxs(l,{sx:{p:2,backgroundColor:"#e3f2fd",borderRadius:2,border:"1px solid #2196f3",mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:""}),e.jsx(l,{children:r})]}),PD=({children:r})=>e.jsxs(l,{sx:{p:2,backgroundColor:"#fff3e0",borderRadius:2,border:"1px solid #ff9800",mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:""}),e.jsx(l,{children:r})]}),DD=({children:r})=>e.jsxs(l,{sx:{p:2,backgroundColor:"#e8f5e8",borderRadius:2,border:"1px solid #4caf50",mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:""}),e.jsx(l,{children:r})]}),AD=()=>{const r=[{label:"ng nhp h thng",description:"S dng ti khon qun l vi quyn OWNER",details:"Truy cp https://mmotion.cloud v ng nhp vi email/username  c cp quyn qun l"},{label:"To Portfolio mi",description:"Chn menu Portfolio > To mi",details:'Nhn nt "To Portfolio"  gc trn bn phi'},{label:"Thit lp thng tin c bn",description:"Nhp tn, m t v loi portfolio",details:'V d: "Portfolio C phiu Blue-chip", "Portfolio Tri phiu Chnh ph"'},{label:"Cu hnh mc tiu u t",description:"Chn mc tiu v chin lc phn b",details:"Tng trng (80% c phiu, 20% tri phiu), Thu nhp (20% c phiu, 80% tri phiu)"},{label:"Thit lp ngn sch ban u",description:"Nhp s tin u t ban u",details:"V d: 1,000,000,000 VND cho portfolio c phiu"},{label:"Kch hot Portfolio",description:"Lu v kch hot portfolio  bt u giao dch",details:"Sau khi kch hot, bn c th thm giao dch v qun l cc loi ti sn"}],t=[{label:"Chn Portfolio",description:"Vo portfolio mun thm giao dch",details:"T danh sch portfolio, chn portfolio ph hp"},{label:"Thm giao dch mi",description:'Nhn nt "Thm giao dch"',details:"Chn loi giao dch: Mua hoc Bn"},{label:"Nhp thng tin chng khon",description:"Nhp m chng khon v s lng",details:"V d: VIC (Vingroup), VHM (Vinhomes), VRE (Vincom Retail)"},{label:"Thit lp gi v ngy",description:"Nhp gi giao dch v ngy thc hin",details:"Gi c th nhp th cng hoc ly t th trng"},{label:"Thm ph giao dch",description:"Nhp ph mi gii v cc ph khc",details:"Ph mi gii thng 0.15-0.25% gi tr giao dch"},{label:"Xc nhn v lu",description:"Kim tra thng tin v lu giao dch",details:"H thng s t ng cp nht Assets v tnh P&L"}],n=[{action:"Xem danh sch Assets",icon:e.jsx(Xt,{}),description:"Xem tt c c phiu trong portfolio"},{action:"Cp nht gi th trng",icon:e.jsx(Tt,{}),description:"ng b gi mi nht t th trng"},{action:"Thm giao dch mi",icon:e.jsx(xt,{}),description:"Thm giao dch mua/bn mi"},{action:"Chnh sa giao dch",icon:e.jsx(Tt,{}),description:"Sa thng tin giao dch  c"},{action:"Xa giao dch",icon:e.jsx(pt,{}),description:"Xa giao dch khng chnh xc"},{action:"Xut bo co",icon:e.jsx(Xt,{}),description:"Ti xung bo co chi tit"}],s=[{label:"Theo di dng tin",description:"Gim st cash flow real-time",details:"Inflows: Dividends, Interest, Capital gains. Outflows: Fees, Taxes"},{label:"D bo thanh khon",description:"D on nhu cu tin mt",details:"30-day, 90-day, 1-year liquidity forecasts"},{label:"Qun l dividend",description:"T ng ha thu nhp t c tc",details:"Dividend calendar, Reinvestment options, Tax optimization"}],a=[{date:"2024-01-15",type:"Dividend",symbol:"VIC",amount:5e5,description:"C tc Vingroup Q4/2023"},{date:"2024-01-20",type:"Interest",symbol:"BOND",amount:25e4,description:"Li tri phiu chnh ph"},{date:"2024-02-01",type:"Capital Gain",symbol:"VIC",amount:2e6,description:"Li t bn c phiu VIC"},{date:"2024-02-10",type:"Fee",symbol:"TRADING",amount:-15e4,description:"Ph giao dch v qun l"},{date:"2024-02-15",type:"Tax",symbol:"TAX",amount:-3e5,description:"Thu thu nhp t u t"},{date:"2024-02-20",type:"Dividend",symbol:"VHM",amount:75e4,description:"C tc Vinhomes Q1/2024"}],i=[{date:"2024-01-15",type:"Mua",symbol:"VIC",quantity:1e3,price:45e3,total:45e6,fees:112500},{date:"2024-01-20",type:"Mua",symbol:"VHM",quantity:500,price:32e3,total:16e6,fees:4e4},{date:"2024-02-01",type:"Bn",symbol:"VIC",quantity:200,price:47e3,total:94e5,fees:23500},{date:"2024-02-10",type:"Mua",symbol:"VRE",quantity:800,price:28e3,total:224e5,fees:56e3}];return e.jsx(l,{id:"detailed-guide",sx:{mb:6},children:e.jsx(se,{sx:{mb:4},children:e.jsxs(me,{children:[e.jsx(c,{variant:"cardTitle",component:"h2",gutterBottom:!0,children:"Hng dn chi tit"}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",paragraph:!0,children:"Cc bc c th  s dng cc tnh nng chnh ca h thng"}),e.jsx(Dl,{children:"Mi bc u c hng dn chi tit vi s th t r rng. Hy lm theo ng th t  m bo h thng hot ng tt nht."}),e.jsxs(Te,{elevation:2,sx:{p:2,mb:2},id:"portfolio-creation",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ue,{sx:{color:"primary.main"}}),"To Portfolio Chi Tit"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Hng dn tng bc  to portfolio vi y  thng tin"}),e.jsx(Dr,{orientation:"vertical",sx:{mt:1,"& .MuiStepContent-root":{pl:2}},children:r.map((o,d)=>e.jsxs(_n,{active:!0,completed:!0,children:[e.jsx(Yn,{sx:{"& .MuiStepLabel-label":{fontSize:"0.9rem"}},children:e.jsx(D,{variant:"subtitle1",sx:{color:"primary.main",fontWeight:600},children:o.label})}),e.jsxs(Jn,{sx:{pl:1,pb:1},children:[e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:o.description}),e.jsx(D,{variant:"body2",color:"text.primary",sx:{fontStyle:"italic",fontSize:"0.8rem"},children:o.details})]})]},d))}),e.jsx(PD,{children:e.jsxs(D,{variant:"body2",children:[e.jsx("strong",{children:"Quan trng:"})," m bo tn portfolio m t r mc ch  d qun l sau ny. Mi portfolio c th cha nhiu loi ti sn khc nhau."]})})]}),e.jsxs(Te,{elevation:2,sx:{p:2,mb:2},id:"transaction-creation",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(He,{sx:{color:"success.main"}}),"To Giao Dch"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Hng dn thm giao dch vo portfolio"}),e.jsx(Dr,{orientation:"vertical",sx:{mt:1,"& .MuiStepContent-root":{pl:2}},children:t.map((o,d)=>e.jsxs(_n,{active:!0,completed:!0,children:[e.jsx(Yn,{sx:{"& .MuiStepLabel-label":{fontSize:"0.9rem"}},children:e.jsx(D,{variant:"subtitle1",sx:{color:"success.main",fontWeight:600},children:o.label})}),e.jsxs(Jn,{sx:{pl:1,pb:1},children:[e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:o.description}),e.jsx(D,{variant:"body2",color:"text.primary",sx:{fontStyle:"italic",fontSize:"0.8rem"},children:o.details})]})]},d))}),e.jsx(DD,{children:e.jsx(D,{variant:"body2",children:"H thng s t ng tnh ton tng gi tr, P&L v cp nht danh mc Assets. Tt c giao dch u c lu tr v c th xem li bt k lc no."})}),e.jsxs(l,{sx:{mt:2},children:[e.jsxs(D,{variant:"subtitle1",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Ss,{}),'V d giao dch mu - Portfolio "C phiu Blue-chip"']}),e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:2,fontStyle:"italic"},children:"Di y l v d v cc giao dch thc t trong mt portfolio u t c phiu:"}),e.jsx(at,{component:Te,elevation:1,children:e.jsxs(it,{size:"small",children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:"grey.100"},children:[e.jsx(S,{sx:{fontWeight:600,fontSize:"0.8rem"},children:"Ngy"}),e.jsx(S,{sx:{fontWeight:600,fontSize:"0.8rem"},children:"Loi"}),e.jsx(S,{sx:{fontWeight:600,fontSize:"0.8rem"},children:"M CK"}),e.jsx(S,{align:"right",sx:{fontWeight:600,fontSize:"0.8rem"},children:"S lng"}),e.jsx(S,{align:"right",sx:{fontWeight:600,fontSize:"0.8rem"},children:"Gi (VND)"}),e.jsx(S,{align:"right",sx:{fontWeight:600,fontSize:"0.8rem"},children:"Tng tin"}),e.jsx(S,{align:"right",sx:{fontWeight:600,fontSize:"0.8rem"},children:"Ph"})]})}),e.jsx(ot,{children:i.map((o,d)=>e.jsxs(De,{hover:!0,sx:{"&:hover":{backgroundColor:"action.hover"}},children:[e.jsx(S,{sx:{fontSize:"0.8rem"},children:o.date}),e.jsx(S,{children:e.jsx(ce,{label:o.type,color:o.type==="Mua"?"success":"error",size:"small",sx:{fontSize:"0.7rem"}})}),e.jsx(S,{sx:{fontWeight:500,fontSize:"0.8rem"},children:o.symbol}),e.jsx(S,{align:"right",sx:{fontSize:"0.8rem"},children:o.quantity.toLocaleString()}),e.jsx(S,{align:"right",sx:{fontSize:"0.8rem"},children:o.price.toLocaleString()}),e.jsx(S,{align:"right",sx:{fontSize:"0.8rem",fontWeight:500},children:o.total.toLocaleString()}),e.jsx(S,{align:"right",sx:{fontSize:"0.8rem"},children:o.fees.toLocaleString()})]},d))})]})}),e.jsxs(l,{sx:{mt:2},children:[e.jsx(D,{variant:"subtitle2",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:" Phn tch v d:"}),e.jsxs(W,{container:!0,spacing:1.5,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{elevation:1,sx:{p:1.5,textAlign:"center",backgroundColor:"#e8f5e8"},children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Tng u t"}),e.jsxs(D,{variant:"h6",sx:{color:"success.main",fontWeight:600},children:[i.filter(o=>o.type==="Mua").reduce((o,d)=>o+d.total,0).toLocaleString()," VND"]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{elevation:1,sx:{p:1.5,textAlign:"center",backgroundColor:"#fff3e0"},children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:" bn"}),e.jsxs(D,{variant:"h6",sx:{color:"warning.main",fontWeight:600},children:[i.filter(o=>o.type==="Bn").reduce((o,d)=>o+d.total,0).toLocaleString()," VND"]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{elevation:1,sx:{p:1.5,textAlign:"center",backgroundColor:"#e3f2fd"},children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Tng ph"}),e.jsxs(D,{variant:"h6",sx:{color:"info.main",fontWeight:600},children:[i.reduce((o,d)=>o+d.fees,0).toLocaleString()," VND"]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{elevation:1,sx:{p:1.5,textAlign:"center",backgroundColor:"#f3e5f5"},children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"S giao dch"}),e.jsxs(D,{variant:"h6",sx:{color:"secondary.main",fontWeight:600},children:[i.length," ln"]})]})})]})]}),e.jsxs(l,{sx:{mt:2,p:2,backgroundColor:"#f5f5f5",borderRadius:1},children:[e.jsx(D,{variant:"subtitle2",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:" Gii thch chi tit:"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{sx:{py:.25},children:e.jsx(ve,{primary:" Mua 1,000 c phiu VIC (Vingroup) vi gi 45,000 VND/c phiu",secondary:"Tng u t: 45,000,000 VND + ph 112,500 VND",primaryTypographyProps:{fontSize:"0.8rem"},secondaryTypographyProps:{fontSize:"0.7rem"}})}),e.jsx(Pe,{sx:{py:.25},children:e.jsx(ve,{primary:" Mua 500 c phiu VHM (Vinhomes) vi gi 32,000 VND/c phiu",secondary:"Tng u t: 16,000,000 VND + ph 40,000 VND",primaryTypographyProps:{fontSize:"0.8rem"},secondaryTypographyProps:{fontSize:"0.7rem"}})}),e.jsx(Pe,{sx:{py:.25},children:e.jsx(ve,{primary:" Bn 200 c phiu VIC vi gi 47,000 VND/c phiu (li 2,000 VND/c phiu)",secondary:"Thu v: 9,400,000 VND - ph 23,500 VND = Li: 400,000 VND",primaryTypographyProps:{fontSize:"0.8rem"},secondaryTypographyProps:{fontSize:"0.7rem"}})}),e.jsx(Pe,{sx:{py:.25},children:e.jsx(ve,{primary:" Mua 800 c phiu VRE (Vincom Retail) vi gi 28,000 VND/c phiu",secondary:"Tng u t: 22,400,000 VND + ph 56,000 VND",primaryTypographyProps:{fontSize:"0.8rem"},secondaryTypographyProps:{fontSize:"0.7rem"}})})]})]})]})]}),e.jsxs(Te,{elevation:2,sx:{p:2,mb:2},id:"tradings-management",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(yc,{sx:{color:"info.main"}}),"Qun L Giao Dch"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Theo di v qun l danh mc u t hin ti"}),e.jsxs(W,{container:!0,spacing:2,sx:{mt:1},children:[e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsxs(D,{variant:"subtitle1",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Xt,{}),"Xem Giao Dch"]}),e.jsxs(lt,{dense:!0,sx:{"& .MuiListItem-root":{py:.25}},children:[e.jsxs(Pe,{children:[e.jsx(tt,{sx:{minWidth:32},children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"Vo tab 'Qun l Giao Dch' trong portfolio",secondary:"Xem danh sch tt c giao dch hin c",primaryTypographyProps:{fontSize:"0.85rem"},secondaryTypographyProps:{fontSize:"0.75rem"}})]}),e.jsxs(Pe,{children:[e.jsx(tt,{sx:{minWidth:32},children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"Kim tra s lng v gi tr hin ti",secondary:"Thng tin c cp nht hng ngy",primaryTypographyProps:{fontSize:"0.85rem"},secondaryTypographyProps:{fontSize:"0.75rem"}})]}),e.jsxs(Pe,{children:[e.jsx(tt,{sx:{minWidth:32},children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"Theo di P&L tng m",secondary:"Li/l cha thc hin v  thc hin",primaryTypographyProps:{fontSize:"0.85rem"},secondaryTypographyProps:{fontSize:"0.75rem"}})]})]})]}),e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsxs(D,{variant:"subtitle1",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Tt,{}),"Cp nht Giao Dch"]}),e.jsxs(lt,{dense:!0,sx:{"& .MuiListItem-root":{py:.25}},children:[e.jsxs(Pe,{children:[e.jsx(tt,{sx:{minWidth:32},children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"Chnh sa thng tin giao dch",secondary:"Sa gi, s lng, ngy giao dch",primaryTypographyProps:{fontSize:"0.85rem"},secondaryTypographyProps:{fontSize:"0.75rem"}})]}),e.jsxs(Pe,{children:[e.jsx(tt,{sx:{minWidth:32},children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"Thm giao dch b sung",secondary:"Mua thm hoc bn mt phn",primaryTypographyProps:{fontSize:"0.85rem"},secondaryTypographyProps:{fontSize:"0.75rem"}})]}),e.jsxs(Pe,{children:[e.jsx(tt,{sx:{minWidth:32},children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"Cp nht gi th trng",secondary:"ng b gi mi nht t sn giao dch",primaryTypographyProps:{fontSize:"0.85rem"},secondaryTypographyProps:{fontSize:"0.75rem"}})]})]})]})]}),e.jsx(bt,{sx:{my:2}}),e.jsxs(D,{variant:"subtitle1",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Ss,{}),"Cc thao tc vi Giao Dch"]}),e.jsx(W,{container:!0,spacing:1.5,sx:{mb:2},children:n.map((o,d)=>e.jsx(W,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(Te,{elevation:1,sx:{p:1.5,textAlign:"center",height:"100%"},children:[e.jsx(l,{sx:{width:32,height:32,borderRadius:"50%",bgcolor:"primary.main",color:"white",display:"flex",alignItems:"center",justifyContent:"center",mx:"auto",mb:.5},children:o.icon}),e.jsx(D,{variant:"body2",sx:{fontWeight:600,mb:.5,fontSize:"0.8rem"},children:o.action}),e.jsx(D,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:o.description})]})},d))}),e.jsx(Dl,{children:e.jsx(D,{variant:"body2",children:"Gi ti sn c cp nht hng ngy. Bn c th xem lch s giao dch, phn tch hiu sut, v xut bo co chi tit bt k lc no."})})]}),e.jsxs(Te,{elevation:2,sx:{p:2,mb:2},id:"cash-flow",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ue,{sx:{color:"info.main"}}),"Qun l dng tin"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Hng dn qun l v ti u ha dng tin u t"}),e.jsx(Dr,{orientation:"vertical",sx:{mt:1,"& .MuiStepContent-root":{pl:2}},children:s.map((o,d)=>e.jsxs(_n,{active:!0,completed:!0,children:[e.jsx(Yn,{sx:{"& .MuiStepLabel-label":{fontSize:"0.9rem"}},children:e.jsx(D,{variant:"subtitle1",sx:{color:"info.main",fontWeight:600},children:o.label})}),e.jsxs(Jn,{sx:{pl:1,pb:1},children:[e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:o.description}),e.jsx(D,{variant:"body2",color:"text.primary",sx:{fontStyle:"italic",fontSize:"0.8rem"},children:o.details})]})]},d))}),e.jsxs(l,{sx:{mt:2,mb:2},children:[e.jsxs(D,{variant:"subtitle1",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Ss,{}),'V d dng tin mu - Portfolio "C phiu Blue-chip"']}),e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:2,fontStyle:"italic"},children:"Di y l v d v cc dng tin thc t trong mt portfolio u t:"}),e.jsx(at,{component:Te,elevation:1,children:e.jsxs(it,{size:"small",children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:"grey.100"},children:[e.jsx(S,{sx:{fontWeight:600,fontSize:"0.8rem"},children:"Ngy"}),e.jsx(S,{sx:{fontWeight:600,fontSize:"0.8rem"},children:"Loi"}),e.jsx(S,{sx:{fontWeight:600,fontSize:"0.8rem"},children:"M"}),e.jsx(S,{align:"right",sx:{fontWeight:600,fontSize:"0.8rem"},children:"S tin (VND)"}),e.jsx(S,{sx:{fontWeight:600,fontSize:"0.8rem"},children:"M t"})]})}),e.jsx(ot,{children:a.map((o,d)=>e.jsxs(De,{hover:!0,sx:{"&:hover":{backgroundColor:"action.hover"}},children:[e.jsx(S,{sx:{fontSize:"0.8rem"},children:o.date}),e.jsx(S,{children:e.jsx(ce,{label:o.type,color:o.type==="Dividend"||o.type==="Interest"||o.type==="Capital Gain"?"success":"error",size:"small",sx:{fontSize:"0.7rem"}})}),e.jsx(S,{sx:{fontWeight:500,fontSize:"0.8rem"},children:o.symbol}),e.jsxs(S,{align:"right",sx:{fontSize:"0.8rem",fontWeight:500,color:o.amount>0?"success.main":"error.main"},children:[o.amount>0?"+":"",o.amount.toLocaleString()]}),e.jsx(S,{sx:{fontSize:"0.8rem"},children:o.description})]},d))})]})}),e.jsxs(l,{sx:{mt:2},children:[e.jsx(D,{variant:"subtitle2",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:" Phn tch dng tin:"}),e.jsxs(W,{container:!0,spacing:1.5,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{elevation:1,sx:{p:1.5,textAlign:"center",backgroundColor:"#e8f5e8"},children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Tng thu nhp"}),e.jsxs(D,{variant:"h6",sx:{color:"success.main",fontWeight:600},children:[a.filter(o=>o.amount>0).reduce((o,d)=>o+d.amount,0).toLocaleString()," VND"]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{elevation:1,sx:{p:1.5,textAlign:"center",backgroundColor:"#fff3e0"},children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Tng chi ph"}),e.jsxs(D,{variant:"h6",sx:{color:"error.main",fontWeight:600},children:[Math.abs(a.filter(o=>o.amount<0).reduce((o,d)=>o+d.amount,0)).toLocaleString()," VND"]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{elevation:1,sx:{p:1.5,textAlign:"center",backgroundColor:"#e3f2fd"},children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Dng tin rng"}),e.jsxs(D,{variant:"h6",sx:{color:a.reduce((o,d)=>o+d.amount,0)>0?"success.main":"error.main",fontWeight:600},children:[a.reduce((o,d)=>o+d.amount,0).toLocaleString()," VND"]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{elevation:1,sx:{p:1.5,textAlign:"center",backgroundColor:"#f3e5f5"},children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"S giao dch"}),e.jsxs(D,{variant:"h6",sx:{color:"secondary.main",fontWeight:600},children:[a.length," ln"]})]})})]})]}),e.jsxs(l,{sx:{mt:2,p:2,backgroundColor:"#f5f5f5",borderRadius:1},children:[e.jsx(D,{variant:"subtitle2",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:" Gii thch dng tin:"}),e.jsxs(lt,{dense:!0,children:[e.jsx(Pe,{sx:{py:.25},children:e.jsx(ve,{primary:" Thu nhp t c tc: 500,000 VND (VIC) + 750,000 VND (VHM) = 1,250,000 VND",secondary:"Thu nhp th ng t c phiu s hu",primaryTypographyProps:{fontSize:"0.8rem"},secondaryTypographyProps:{fontSize:"0.7rem"}})}),e.jsx(Pe,{sx:{py:.25},children:e.jsx(ve,{primary:" Li t u t: 250,000 VND (tri phiu) + 2,000,000 VND (bn c phiu) = 2,250,000 VND",secondary:"Thu nhp t li sut v li vn",primaryTypographyProps:{fontSize:"0.8rem"},secondaryTypographyProps:{fontSize:"0.7rem"}})}),e.jsx(Pe,{sx:{py:.25},children:e.jsx(ve,{primary:" Chi ph: 150,000 VND (ph) + 300,000 VND (thu) = 450,000 VND",secondary:"Chi ph vn hnh v ngha v thu",primaryTypographyProps:{fontSize:"0.8rem"},secondaryTypographyProps:{fontSize:"0.7rem"}})}),e.jsx(Pe,{sx:{py:.25},children:e.jsx(ve,{primary:" Dng tin rng: +3,050,000 VND (thu nhp rng tch cc)",secondary:"Tng dng tin sau khi tr chi ph",primaryTypographyProps:{fontSize:"0.8rem",fontWeight:600},secondaryTypographyProps:{fontSize:"0.7rem"}})})]})]})]}),e.jsx(Dl,{children:e.jsxs(D,{variant:"body2",children:[e.jsx("strong",{children:"Mo:"})," S dng tnh nng d bo thanh khon  lp k hoch u t di hn v trnh tnh trng thiu tin mt khi cn thit."]})})]}),e.jsxs(l,{sx:{p:2,backgroundColor:"linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%)",borderRadius:2,border:"2px solid #2196f3",textAlign:"center",mt:2},children:[e.jsx(D,{variant:"h6",sx:{color:"primary.main",mb:1,display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:" Tng kt hng dn chi tit"}),e.jsx(D,{variant:"body2",color:"text.primary",children:"Vi 4 bc chnh: To Portfolio  Thm Giao dch  Qun l Giao Dch  Qun l dng tin, bn c th d dng qun l danh mc u t mt cch chuyn nghip v hiu qu."})]})]})})})},ID=({children:r})=>e.jsxs(l,{sx:{p:2,backgroundColor:"#e8f5e8",borderRadius:2,border:"1px solid #4caf50",mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:""}),e.jsx(l,{children:r})]}),RD=({children:r})=>e.jsxs(l,{sx:{p:2,backgroundColor:"#fff3e0",borderRadius:2,border:"1px solid #ff9800",mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:""}),e.jsx(l,{children:r})]}),MD=()=>{const r=[{label:"Thit lp benchmark",description:"Chn ch s tham chiu ph hp",details:"V d: VN-Index, VN30, S&P 500, hoc ch s ty chnh"},{label:"Cu hnh metrics",description:"Thit lp cc ch s hiu sut",details:"ROI, Sharpe Ratio, Maximum Drawdown, Volatility"},{label:"Phn tch so snh",description:"So snh hiu sut vi benchmark",details:"Tracking Error, Alpha, Beta, Information Ratio"},{label:"Bo co chi tit",description:"Xut bo co phn tch chuyn su",details:"Monthly, Quarterly, Annual performance reports"}],t=[{label:"Thit lp gii hn ri ro",description:"nh ngha cc ngng ri ro",details:"VaR 95%, Maximum Drawdown 10%, Volatility < 20%"},{label:"Phn tch a dng ha",description:"Kim tra mc  a dng ha",details:"Sector allocation, Geographic distribution, Asset correlation"},{label:"Stress testing",description:"M phng cc kch bn ri ro",details:"Market crash, Interest rate shock, Currency fluctuation"},{label:"Cnh bo t ng",description:"Thit lp h thng cnh bo",details:"Email alerts, Dashboard notifications, Risk threshold breaches"}],n=[{label:"To bo co t ng",description:"Thit lp bo co nh k",details:"Daily, Weekly, Monthly, Quarterly automated reports"},{label:"Cu hnh email",description:"Thit lp gi email t ng",details:"Recipient lists, Report templates, Delivery schedules"},{label:"Chia s vi khch hng",description:"Cp quyn truy cp cho khch hng",details:"View-only access, Custom dashboards, Client portals"},{label:"Cp nht hng ngy",description:"ng b d liu lin tc",details:"Live data feeds, Real-time notifications, Instant updates"}],s=[{metric:"ROI (Return on Investment)",value:"12.5%",benchmark:"10.2%",status:"outperform"},{metric:"Sharpe Ratio",value:"1.8",benchmark:"1.2",status:"outperform"},{metric:"Maximum Drawdown",value:"-8.5%",benchmark:"-12.3%",status:"outperform"},{metric:"Volatility",value:"15.2%",benchmark:"18.7%",status:"outperform"},{metric:"Alpha",value:"2.3%",benchmark:"0%",status:"outperform"},{metric:"Beta",value:"0.85",benchmark:"1.0",status:"outperform"}];return e.jsx(l,{id:"advanced-features",sx:{mb:6},children:e.jsx(se,{sx:{mb:4},children:e.jsxs(me,{children:[e.jsx(c,{variant:"cardTitle",component:"h2",gutterBottom:!0,children:"Tnh nng nng cao"}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",paragraph:!0,children:"Cc tnh nng chuyn su  ti u ha qun l u t"}),e.jsx(ID,{children:e.jsx(D,{variant:"body2",children:"Cc tnh nng ny gip bn phn tch su hn v hiu sut u t, qun l ri ro hiu qu v ti u ha danh mc u t."})}),e.jsxs(Te,{elevation:2,sx:{p:2,mb:2},id:"performance-analysis",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(He,{sx:{color:"success.main"}}),"Phn tch hiu sut"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Hng dn thit lp v s dng cc cng c phn tch hiu sut chuyn nghip"}),e.jsx(Dr,{orientation:"vertical",sx:{mt:1,"& .MuiStepContent-root":{pl:2}},children:r.map((a,i)=>e.jsxs(_n,{active:!0,completed:!0,children:[e.jsx(Yn,{sx:{"& .MuiStepLabel-label":{fontSize:"0.9rem"}},children:e.jsx(D,{variant:"subtitle1",sx:{color:"success.main",fontWeight:600},children:a.label})}),e.jsxs(Jn,{sx:{pl:1,pb:1},children:[e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:a.description}),e.jsx(D,{variant:"body2",color:"text.primary",sx:{fontStyle:"italic",fontSize:"0.8rem"},children:a.details})]})]},i))}),e.jsxs(l,{sx:{mt:2},children:[e.jsxs(D,{variant:"subtitle1",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Zt,{}),"V d metrics hiu sut"]}),e.jsx(at,{component:Te,elevation:1,children:e.jsxs(it,{size:"small",children:[e.jsx(ct,{children:e.jsxs(De,{sx:{backgroundColor:"grey.100"},children:[e.jsx(S,{sx:{fontWeight:600,fontSize:"0.8rem"},children:"Ch s"}),e.jsx(S,{align:"right",sx:{fontWeight:600,fontSize:"0.8rem"},children:"Portfolio"}),e.jsx(S,{align:"right",sx:{fontWeight:600,fontSize:"0.8rem"},children:"Benchmark"}),e.jsx(S,{align:"center",sx:{fontWeight:600,fontSize:"0.8rem"},children:"Trng thi"})]})}),e.jsx(ot,{children:s.map((a,i)=>e.jsxs(De,{hover:!0,children:[e.jsx(S,{sx:{fontSize:"0.8rem"},children:a.metric}),e.jsx(S,{align:"right",sx:{fontSize:"0.8rem",fontWeight:500},children:a.value}),e.jsx(S,{align:"right",sx:{fontSize:"0.8rem"},children:a.benchmark}),e.jsx(S,{align:"center",children:e.jsx(ce,{label:"Tt hn",color:"success",size:"small",sx:{fontSize:"0.7rem"}})})]},i))})]})})]})]}),e.jsxs(Te,{elevation:2,sx:{p:2,mb:2},id:"risk-management",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(on,{sx:{color:"warning.main"}}),"Qun l ri ro"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Thng qun l ri ro ton din"}),e.jsx(Dr,{orientation:"vertical",sx:{mt:1,"& .MuiStepContent-root":{pl:2}},children:t.map((a,i)=>e.jsxs(_n,{active:!0,completed:!0,children:[e.jsx(Yn,{sx:{"& .MuiStepLabel-label":{fontSize:"0.9rem"}},children:e.jsx(D,{variant:"subtitle1",sx:{color:"warning.main",fontWeight:600},children:a.label})}),e.jsxs(Jn,{sx:{pl:1,pb:1},children:[e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:a.description}),e.jsx(D,{variant:"body2",color:"text.primary",sx:{fontStyle:"italic",fontSize:"0.8rem"},children:a.details})]})]},i))}),e.jsx(RD,{children:e.jsxs(D,{variant:"body2",children:[e.jsx("strong",{children:"Lu :"})," H thng s t ng cnh bo khi portfolio vt qu cc ngng ri ro  thit lp. Hy kim tra v iu chnh nh k."]})})]}),e.jsxs(Te,{elevation:2,sx:{p:2,mb:2},id:"sharing-reports",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(eh,{sx:{color:"primary.main"}}),"Chia s v bo co"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Hng dn to v chia s bo co chuyn nghip vi khch hng"}),e.jsx(Dr,{orientation:"vertical",sx:{mt:1,"& .MuiStepContent-root":{pl:2}},children:n.map((a,i)=>e.jsxs(_n,{active:!0,completed:!0,children:[e.jsx(Yn,{sx:{"& .MuiStepLabel-label":{fontSize:"0.9rem"}},children:e.jsx(D,{variant:"subtitle1",sx:{color:"primary.main",fontWeight:600},children:a.label})}),e.jsxs(Jn,{sx:{pl:1,pb:1},children:[e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:a.description}),e.jsx(D,{variant:"body2",color:"text.primary",sx:{fontStyle:"italic",fontSize:"0.8rem"},children:a.details})]})]},i))}),e.jsxs(je,{severity:"info",sx:{mt:2},children:[e.jsx(ui,{children:"Bo co t ng"}),"H thng c th to bo co t ng theo lch trnh v gi email cho khch hng. Bn c th ty chnh ni dung v nh dng bo co theo nhu cu."]})]}),e.jsxs(l,{sx:{p:2,backgroundColor:"linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%)",borderRadius:2,border:"2px solid #2196f3",textAlign:"center",mt:2},children:[e.jsx(D,{variant:"h6",sx:{color:"primary.main",mb:1,display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:" Tng kt tnh nng nng cao"}),e.jsx(D,{variant:"body2",color:"text.primary",children:"Vi 3 nhm tnh nng nng cao: Phn tch hiu sut, Qun l ri ro, v Chia s bo co, bn c th qun l danh mc u t mt cch chuyn nghip v hiu qu ti a."})]})]})})})},ND=({children:r})=>e.jsxs(l,{sx:{p:2,backgroundColor:"#e3f2fd",borderRadius:2,border:"1px solid #2196f3",mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:""}),e.jsx(l,{children:r})]}),Nu=({children:r})=>e.jsxs(l,{sx:{p:2,backgroundColor:"#e8f5e8",borderRadius:2,border:"1px solid #4caf50",mb:2,display:"flex",alignItems:"center",gap:1},children:[e.jsx("span",{children:""}),e.jsx(l,{children:r})]}),LD=()=>{const r=[{label:"ng k ti khon qun l",description:"To ti khon ng nhp",details:"Truy cp https://mmotion.cloud v ng k ti khon"},{label:"Xc thc ti khon",description:"Xc thc email v hon thin h s",details:"Kim tra email, xc thc ti khon v cp nht thng tin c nhn"},{label:"To ti khon khch hng",description:"Thm khch hng vo h thng",details:'Vo menu "Qun l khch hng" > "Thm mi" > Nhp thng tin khch hng'},{label:"To portfolio cho khch hng",description:"Thit lp danh mc u t",details:'Chn khch hng > "To Portfolio" > Thit lp mc tiu v chin lc u t'},{label:"Chia s quyn truy cp",description:"Cp quyn xem cho khch hng",details:'Chn portfolio > "Chia s" > Nhp Account ID khch hng > Chn quyn VIEW/UPDATE'},{label:"Theo di v bo co",description:"Gim st hiu sut v to bo co",details:"S dng dashboard  theo di hiu sut v to bo co nh k cho khch hng"}],t=[{label:"ng nhp h thng",description:"Truy cp vo ti khon",details:"ng k ti khon hoc lin h vi nh qun l  nhn thng tin ng nhp"},{label:"Chn ti khon c chia s",description:"Kt ni vi portfolio ca bn",details:'Vo menu "Ti khon" > "Kt ni ti khon" > Nhp Account ID'},{label:"Xem portfolio v bo co",description:"Theo di danh mc u t",details:'Truy cp menu "Nh u t"  xem portfolio, giao dch v bo co hiu sut'},{label:"Theo di hiu sut",description:"Gim st kt qu u t",details:"S dng dashboard  theo di P&L, hiu sut v nhn bo co t nh qun l"}];return e.jsx(l,{id:"getting-started",sx:{mb:6},children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(c,{variant:"cardTitle",component:"h2",gutterBottom:!0,children:"Bt u s dng"}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",paragraph:!0,children:"Hng dn chi tit  bt u s dng h thng"}),e.jsx(Nu,{children:e.jsx(D,{variant:"body2",children:"Chn ng vai tr ca bn (Nh qun l hoc Khch hng)  xem hng dn ph hp nht. Mi vai tr c quy trnh v quyn hn khc nhau."})}),e.jsxs(Te,{elevation:2,sx:{p:2,mb:2},id:"for-managers",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ks,{sx:{color:"primary.main"}}),"Cho nh qun l"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Hng dn chi tit  thit lp v qun l h thng cho nh qun l u t"}),e.jsx(Dr,{orientation:"vertical",sx:{mt:1,"& .MuiStepContent-root":{pl:2}},children:r.map((n,s)=>e.jsxs(_n,{active:!0,completed:!0,children:[e.jsx(Yn,{sx:{"& .MuiStepLabel-label":{fontSize:"0.9rem"}},children:e.jsx(D,{variant:"subtitle1",sx:{color:"primary.main",fontWeight:600},children:n.label})}),e.jsxs(Jn,{sx:{pl:1,pb:1},children:[e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:n.description}),e.jsx(D,{variant:"body2",color:"text.primary",sx:{fontStyle:"italic",fontSize:"0.8rem"},children:n.details})]})]},s))}),e.jsx(ND,{children:e.jsxs(D,{variant:"body2",children:[e.jsx("strong",{children:"Mo:"})," Bt u vi 1-2 khch hng  lm quen vi h thng trc khi m rng quy m."]})})]}),e.jsxs(Te,{elevation:2,sx:{p:2,mb:2},id:"for-customers",children:[e.jsxs(D,{variant:"h5",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Sn,{sx:{color:"success.main"}}),"Cho khch hng"]}),e.jsx(D,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Hng dn  khch hng bt u s dng h thng v theo di u t"}),e.jsx(Dr,{orientation:"vertical",sx:{mt:1,"& .MuiStepContent-root":{pl:2}},children:t.map((n,s)=>e.jsxs(_n,{active:!0,completed:!0,children:[e.jsx(Yn,{sx:{"& .MuiStepLabel-label":{fontSize:"0.9rem"}},children:e.jsx(D,{variant:"subtitle1",sx:{color:"success.main",fontWeight:600},children:n.label})}),e.jsxs(Jn,{sx:{pl:1,pb:1},children:[e.jsx(D,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:n.description}),e.jsx(D,{variant:"body2",color:"text.primary",sx:{fontStyle:"italic",fontSize:"0.8rem"},children:n.details})]})]},s))}),e.jsx(Nu,{children:e.jsxs(D,{variant:"body2",children:[e.jsx("strong",{children:"Lu :"})," Bn cn c Account ID t nh qun l  c th truy cp vo portfolio ca mnh."]})})]}),e.jsx(bt,{sx:{my:3}}),e.jsxs(l,{sx:{mt:3},children:[e.jsxs(D,{variant:"h6",gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[e.jsx(Xe,{}),"Checklist bt u nhanh"]}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Te,{elevation:1,sx:{p:2,borderLeft:"4px solid",borderLeftColor:"primary.main"},children:[e.jsxs(D,{variant:"subtitle2",sx:{fontWeight:600,mb:1,display:"flex",alignItems:"center",gap:1},children:[e.jsx(ks,{}),"Nh qun l"]}),e.jsxs(lt,{dense:!0,children:[e.jsxs(Pe,{sx:{py:.25},children:[e.jsx(tt,{children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"ng k ti khon qun l",primaryTypographyProps:{fontSize:"0.8rem"}})]}),e.jsxs(Pe,{sx:{py:.25},children:[e.jsx(tt,{children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"To ti khon khch hng u tin",primaryTypographyProps:{fontSize:"0.8rem"}})]}),e.jsxs(Pe,{sx:{py:.25},children:[e.jsx(tt,{children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"Thit lp portfolio mu",primaryTypographyProps:{fontSize:"0.8rem"}})]}),e.jsxs(Pe,{sx:{py:.25},children:[e.jsx(tt,{children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"Chia s quyn truy cp",primaryTypographyProps:{fontSize:"0.8rem"}})]})]})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Te,{elevation:1,sx:{p:2,borderLeft:"4px solid",borderLeftColor:"success.main"},children:[e.jsxs(D,{variant:"subtitle2",sx:{fontWeight:600,mb:1,display:"flex",alignItems:"center",gap:1},children:[e.jsx(Sn,{}),"Khch hng"]}),e.jsxs(lt,{dense:!0,children:[e.jsxs(Pe,{sx:{py:.25},children:[e.jsx(tt,{children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"ng k ti khon khch hng",primaryTypographyProps:{fontSize:"0.8rem"}})]}),e.jsxs(Pe,{sx:{py:.25},children:[e.jsx(tt,{children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"Nhn Account ID t qun l",primaryTypographyProps:{fontSize:"0.8rem"}})]}),e.jsxs(Pe,{sx:{py:.25},children:[e.jsx(tt,{children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"Kt ni ti khon c chia s",primaryTypographyProps:{fontSize:"0.8rem"}})]}),e.jsxs(Pe,{sx:{py:.25},children:[e.jsx(tt,{children:e.jsx(Xe,{sx:{color:"success.main",fontSize:"1rem"}})}),e.jsx(ve,{primary:"Bt u theo di u t",primaryTypographyProps:{fontSize:"0.8rem"}})]})]})]})})]})]}),e.jsxs(l,{sx:{p:2,backgroundColor:"linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%)",borderRadius:2,border:"2px solid #2196f3",textAlign:"center",mt:3},children:[e.jsx(D,{variant:"h6",sx:{color:"primary.main",mb:1,display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:" Sn sng bt u!"}),e.jsx(D,{variant:"body2",color:"text.primary",children:"Vi hng dn chi tit trn, bn c th bt u s dng h thng mt cch d dng v hiu qu. Nu cn h tr, hy lin h vi chng ti!"})]})]})})})},ED=()=>{const[r,t]=p.useState(!1),[n,s]=p.useState("overview"),[a,i]=p.useState(new Set(["overview"])),[o,d]=p.useState(!1),u=()=>{t(!r)},h=y=>{const j=document.getElementById(y);j&&j.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},m=y=>{d(!0),s(y),h(y),t(!1),setTimeout(()=>d(!1),1e3)},x=y=>{d(!0),s(y),i(j=>{const b=new Set(j);return b.has(y)?b.delete(y):(b.clear(),b.add(y)),b}),h(y),setTimeout(()=>d(!1),1e3)},g=[{id:"overview",title:"Tng quan",icon:e.jsx(Bp,{}),sections:[{id:"workflow",title:"Quy trnh hot ng c bn"},{id:"features",title:"Tnh nng chnh"},{id:"use-cases",title:"Trng hp s dng"},{id:"permissions",title:"H thng phn quyn"}]},{id:"detailed-guide",title:"Hng dn chi tit",icon:e.jsx(Tt,{}),sections:[{id:"portfolio-creation",title:"To Portfolio Chi Tit"},{id:"transaction-creation",title:"To Giao Dch"},{id:"tradings-management",title:"Qun L Giao Dch"},{id:"cash-flow",title:"Qun l dng tin"}]},{id:"advanced-features",title:"Tnh nng nng cao",icon:e.jsx(Ku,{}),sections:[{id:"performance-analysis",title:"Phn tch hiu sut"},{id:"risk-management",title:"Qun l ri ro"},{id:"sharing-reports",title:"Chia s v bo co"}]},{id:"getting-started",title:"Bt u s dng",icon:e.jsx(Xe,{}),sections:[{id:"for-managers",title:"Cho nh qun l"},{id:"for-customers",title:"Cho khch hng"}]}];p.useEffect(()=>{let y;const j=()=>{o||(clearTimeout(y),y=setTimeout(()=>{const b=g.flatMap(C=>[C.id,...C.sections.map(k=>k.id)]);let v="overview",P={sectionId:"overview",distance:1/0};for(const C of b){const k=document.getElementById(C);if(k){const A=k.getBoundingClientRect(),L=Math.abs(A.top);if(A.top<=window.innerHeight&&A.bottom>=0){const M=g.some(O=>O.id===C)?L*.8:L;M<P.distance&&(P={sectionId:C,distance:M})}}}v=P.sectionId,s(v);const w=g.find(C=>C.sections.some(k=>k.id===v));w&&!a.has(w.id)&&i(new Set([w.id]))},50))};return window.addEventListener("scroll",j),j(),()=>{window.removeEventListener("scroll",j),clearTimeout(y)}},[a,o]);const f=()=>e.jsxs(e.Fragment,{children:[e.jsx(bD,{}),e.jsx(vD,{}),e.jsx(TD,{}),e.jsx(kD,{}),e.jsx(AD,{}),e.jsx(MD,{}),e.jsx(LD,{})]});return e.jsxs(l,{sx:{display:"flex",minHeight:"100vh"},children:[e.jsxs(l,{sx:{width:{xs:0,md:280},flexShrink:0,display:{xs:"none",md:"block"},position:"sticky",top:0,height:"100vh",overflowY:"auto",borderRight:"1px solid",borderColor:"divider",bgcolor:"background.paper",zIndex:1},children:[e.jsx(l,{sx:{p:2,borderBottom:"1px solid",borderColor:"divider"},children:e.jsxs(D,{variant:"h6",component:"h2",sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Za,{}),"Mc lc"]})}),e.jsx(lt,{dense:!0,sx:{p:1},children:g.map(y=>{const j=n===y.id,b=y.sections.some(P=>P.id===n),v=a.has(y.id)||j||b;return e.jsxs(rt.Fragment,{children:[e.jsxs(ss,{onClick:()=>x(y.id),sx:{borderRadius:1,mb:.5,bgcolor:j?"primary.main":"transparent",color:j?"white":"inherit","&:hover":{bgcolor:j?"primary.dark":"primary.main",color:"white"}},children:[e.jsx(tt,{sx:{color:j?"white":"primary.main",minWidth:36},children:y.icon}),e.jsx(ve,{primary:y.title,primaryTypographyProps:{fontWeight:j?600:500,fontSize:"0.9rem"}})]}),e.jsx(l,{sx:{pl:4,mb:1,display:v?"block":"none"},children:y.sections.map(P=>{const w=n===P.id;return e.jsx(ss,{onClick:()=>m(P.id),sx:{py:.5,px:1,borderRadius:1,fontSize:"0.8rem",cursor:"pointer",bgcolor:w?"primary.light":"transparent",color:w?"primary.contrastText":"inherit","&:hover":{bgcolor:w?"primary.main":"action.hover"}},children:e.jsx(ve,{primary:P.title,primaryTypographyProps:{fontSize:"0.8rem",fontWeight:w?600:400}})},P.id)})})]},y.id)})})]}),e.jsx(l,{sx:{flex:1,minWidth:0},children:e.jsxs(xn,{maxWidth:"lg",sx:{py:4},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4,flexWrap:"wrap",gap:2},children:[e.jsxs(l,{sx:{flex:1,minWidth:0},children:[e.jsx(c,{variant:"pageTitle",component:"h1",gutterBottom:!0,children:"Cch hot ng ca h thng"}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",paragraph:!0,children:"Hng dn chi tit v cch s dng h thng qun l danh mc u t"})]}),e.jsx(l,{sx:{display:{xs:"block",md:"none"}},children:e.jsx(Fe,{title:"Mc lc",children:e.jsx(Ie,{onClick:u,sx:{bgcolor:"primary.main",color:"white","&:hover":{bgcolor:"primary.dark"}},children:e.jsx(Za,{})})})})]}),e.jsx(l,{"data-content-area":!0,children:f()})]})}),e.jsxs(Rl,{anchor:"right",open:r,onClose:u,sx:{display:{xs:"block",md:"none"},"& .MuiDrawer-paper":{width:"100%",p:2}},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(D,{variant:"h6",component:"h2",children:"Mc lc"}),e.jsx(Ie,{onClick:u,size:"small",children:e.jsx(wa,{})})]}),e.jsx(lt,{dense:!0,children:g.map(y=>{const j=n===y.id,b=y.sections.some(P=>P.id===n),v=a.has(y.id)||j||b;return e.jsxs(rt.Fragment,{children:[e.jsxs(ss,{onClick:()=>{x(y.id),t(!1)},sx:{borderRadius:1,mb:.5,bgcolor:j?"primary.main":"transparent",color:j?"white":"inherit","&:hover":{bgcolor:j?"primary.dark":"primary.main",color:"white"}},children:[e.jsx(tt,{sx:{color:j?"white":"primary.main"},children:y.icon}),e.jsx(ve,{primary:y.title,primaryTypographyProps:{fontWeight:j?600:500,fontSize:"0.9rem"}})]}),e.jsx(l,{sx:{pl:4,mb:1,display:v?"block":"none"},children:y.sections.map(P=>{const w=n===P.id;return e.jsx(ss,{onClick:()=>m(P.id),sx:{py:.5,px:1,borderRadius:1,fontSize:"0.8rem",cursor:"pointer",bgcolor:w?"primary.light":"transparent",color:w?"primary.contrastText":"inherit","&:hover":{bgcolor:w?"primary.main":"action.hover"}},children:e.jsx(ve,{primary:P.title,primaryTypographyProps:{fontSize:"0.8rem",fontWeight:w?600:400}})},P.id)})})]},y.id)})})]})]})},Ax=({embedded:r=!1,maxWidth:t="md"})=>{const{t:n}=Ne(),{updateAuthState:s}=Ge(),[a,i]=p.useState(null),[o,d]=p.useState(!1),[u,h]=p.useState(!1),[m,x]=p.useState(null),[g,f]=p.useState(null),[y,j]=p.useState(!1),[b,v]=p.useState(!1),[P,w]=p.useState(!1),[C,k]=p.useState(!1),[A,L]=p.useState(!1),[T,M]=p.useState(!1),[O,I]=p.useState(!1),[z,N]=p.useState({}),[E,R]=p.useState({password:""}),[V,F]=p.useState({currentPassword:"",newPassword:""});p.useEffect(()=>{B()},[]);const B=async()=>{try{d(!0),x(null);const ee=await Nn.getProfile();ee&&(i(ee),N({fullName:ee.fullName||"",email:ee.email||"",phone:ee.phone||"",dateOfBirth:ee.dateOfBirth||"",address:ee.address||""}),ee.isProfileComplete||j(!0))}catch(ee){console.error("Error loading profile:",ee),x(n("profile.failedToLoadProfile"))}finally{d(!1)}},$=()=>{j(!0),x(null),f(null)},Y=()=>{if(a&&!a.isProfileComplete){x(n("profile.pleaseCompleteProfile"));return}j(!1),N({fullName:(a==null?void 0:a.fullName)||"",email:(a==null?void 0:a.email)||"",phone:(a==null?void 0:a.phone)||"",dateOfBirth:(a==null?void 0:a.dateOfBirth)||"",address:(a==null?void 0:a.address)||""}),x(null),f(null)},_=async()=>{var ee,H,Q,Z,J,ae;if(a)try{h(!0),x(null);const ue={...z,...z.dateOfBirth&&z.dateOfBirth.trim()!==""?{dateOfBirth:z.dateOfBirth}:{},fullName:((ee=z.fullName)==null?void 0:ee.trim())||void 0,email:((H=z.email)==null?void 0:H.trim())||void 0,phone:((Q=z.phone)==null?void 0:Q.trim())||void 0,address:((Z=z.address)==null?void 0:Z.trim())||void 0},le=Object.fromEntries(Object.entries(ue).filter(([qe,de])=>de!==void 0)),pe=await Nn.updateProfile(le);i(pe),j(!1),f(n("profile.profileUpdatedSuccessfully"));const Le={...JSON.parse(localStorage.getItem("user_session")||"{}"),user:pe};localStorage.setItem("user_session",JSON.stringify(Le)),js.addUserToHistory({username:pe.username,fullName:pe.fullName,email:pe.email,avatarText:pe.avatarText,isProfileComplete:pe.isProfileComplete}),await s()}catch(ue){console.error("Error updating profile:",ue),x(((ae=(J=ue.response)==null?void 0:J.data)==null?void 0:ae.message)||n("profile.errors.failedToUpdateProfile"))}finally{h(!1)}},K=async()=>{var ee,H;if(a)try{h(!0),x(null),await Nn.setPassword(E.password),w(!1),R({password:""}),f(n("profile.passwordSetSuccessfully")),await B();const Q=await Nn.getProfile(),J={...JSON.parse(localStorage.getItem("user_session")||"{}"),user:Q};localStorage.setItem("user_session",JSON.stringify(J)),js.addUserToHistory({username:Q.username,fullName:Q.fullName,email:Q.email,avatarText:Q.avatarText,isProfileComplete:Q.isProfileComplete}),await s()}catch(Q){console.error("Error setting password:",Q),x(((H=(ee=Q.response)==null?void 0:ee.data)==null?void 0:H.message)||n("profile.errors.failedToSetPassword"))}finally{h(!1)}},X=async()=>{var ee,H,Q,Z,J,ae,ue,le,pe,Me,Le,qe,de,fe;if(a)try{h(!0),x(null),await Nn.changePassword(V.currentPassword,V.newPassword),k(!1),F({currentPassword:"",newPassword:""}),f(n("profile.passwordChangedSuccessfully"));const ie=await Nn.getProfile(),Ve={...JSON.parse(localStorage.getItem("user_session")||"{}"),user:ie};localStorage.setItem("user_session",JSON.stringify(Ve)),js.addUserToHistory({username:ie.username,fullName:ie.fullName,email:ie.email,avatarText:ie.avatarText,isProfileComplete:ie.isProfileComplete}),await s()}catch(ie){let Se=n("profile.errors.cannotChangePassword");if(((ee=ie.response)==null?void 0:ee.status)===401)(Z=(Q=(H=ie.response)==null?void 0:H.data)==null?void 0:Q.message)!=null&&Z.includes("Current password is incorrect")?Se=n("profile.errors.currentPasswordIncorrect"):(ue=(ae=(J=ie.response)==null?void 0:J.data)==null?void 0:ae.message)!=null&&ue.includes("User has no password set")?Se=n("profile.errors.userHasNoPassword"):Se=n("profile.errors.authenticationFailed");else if(((le=ie.response)==null?void 0:le.status)===400)(Le=(Me=(pe=ie.response)==null?void 0:pe.data)==null?void 0:Me.message)!=null&&Le.includes("Password must be at least 6 characters")?Se=n("profile.errors.passwordTooShort"):Se=n("profile.errors.invalidData");else if(((qe=ie.response)==null?void 0:qe.status)===404)Se=n("profile.errors.userNotFound");else if((fe=(de=ie.response)==null?void 0:de.data)!=null&&fe.message){const Ve=ie.response.data.message;Ve.includes("Current password is incorrect")?Se=n("profile.errors.currentPasswordIncorrect"):Ve.includes("User has no password set")?Se=n("profile.errors.userHasNoPassword"):Ve.includes("Password must be at least 6 characters")?Se=n("profile.errors.passwordTooShort"):Ve.includes("User not found")?Se=n("profile.errors.userNotFound"):Se=Ve}x(Se)}finally{h(!1)}},ne=ee=>ee.split(" ").map(H=>H.charAt(0)).join("").toUpperCase().slice(0,2);if(o)return e.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:400},children:e.jsx(Ce,{})});if(!a)return e.jsx(je,{severity:"error",children:n("profile.userNotFound")});const oe=e.jsx(se,{sx:r?{boxShadow:"none!important",border:"none!important"}:{"&:hover":{boxShadow:1}},children:e.jsxs(me,{sx:{p:{xs:1,sm:2}},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(Vt,{sx:{width:60,height:60,mr:3,bgcolor:"primary.main",fontSize:"2rem"},children:a.avatarText||ne(a.username)}),e.jsxs(l,{sx:{flex:1},children:[e.jsx(c,{variant:"cardTitle",gutterBottom:!0,children:a.fullName||a.username}),e.jsxs(c,{variant:"body2",color:"text.secondary",children:["@",a.username]})]}),!y&&e.jsx(he,{variant:"outlined",icon:e.jsx(Tt,{}),onClick:$,mobileText:n("profile.editProfile"),desktopText:n("profile.editProfile"),children:n("profile.editProfile")})]}),g&&e.jsx(je,{severity:"success",sx:{mb:3},onClose:()=>f(null),children:g}),m&&e.jsx(je,{severity:"error",sx:{mb:3},onClose:()=>x(null),children:m}),!a.isProfileComplete&&y&&e.jsx(je,{severity:"warning",sx:{mb:3},children:e.jsxs(c,{variant:"cardLabel",ellipsis:!1,sx:{color:"error.secondary"},children:[e.jsx("strong",{children:n("profile.completeProfileNotice")})," - ",n("profile.completeProfileDescription")]})}),e.jsx(c,{variant:"cardTitle",gutterBottom:!0,sx:{mt:3,mb:2},children:n("profile.basicInformation")}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(Ae,{fullWidth:!0,label:n("profile.username"),value:a.username,disabled:!0})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(Ae,{fullWidth:!0,label:n("profile.fullName"),value:y?z.fullName:a.fullName||"",onChange:ee=>N({...z,fullName:ee.target.value}),disabled:!y,InputProps:{startAdornment:e.jsx(Sn,{sx:{mr:1,color:"text.secondary"}})}})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(Ae,{fullWidth:!0,label:n("profile.email"),value:y?z.email:a.email||"",onChange:ee=>N({...z,email:ee.target.value}),disabled:!y,InputProps:{startAdornment:e.jsx(ni,{sx:{mr:1,color:"text.secondary"}})}})})]}),e.jsxs(l,{sx:{mt:2},children:[e.jsx(he,{onClick:()=>v(!b),icon:b?e.jsx(Dn,{}):e.jsx(ln,{}),mobileText:n("profile.advancedInformation"),desktopText:n("profile.advancedInformation"),sx:{mb:2},children:n("profile.advancedInformation")}),e.jsx(qr,{in:b,children:e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(Ae,{fullWidth:!0,label:n("profile.phone"),value:y?z.phone:a.phone||"",onChange:ee=>N({...z,phone:ee.target.value}),disabled:!y,InputProps:{startAdornment:e.jsx(Zu,{sx:{mr:1,color:"text.secondary"}})}})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(Ae,{fullWidth:!0,label:n("profile.dateOfBirth"),type:"date",value:y?z.dateOfBirth:a.dateOfBirth||"",onChange:ee=>N({...z,dateOfBirth:ee.target.value}),disabled:!y,InputProps:{startAdornment:e.jsx(Up,{sx:{mr:1,color:"text.secondary"}})},InputLabelProps:{shrink:!0}})})]})})]}),y&&e.jsxs(l,{sx:{display:"flex",gap:2,my:1},children:[e.jsx(We,{variant:"contained",onClick:_,disabled:u,icon:u?e.jsx(Ce,{size:20}):e.jsx(Ga,{}),mobileText:n(u?"profile.saving":"profile.saveChanges"),desktopText:n(u?"profile.saving":"profile.saveChanges"),forceTextOnly:!0,children:n(u?"profile.saving":"profile.saveChanges")}),e.jsx(he,{variant:"outlined",onClick:Y,disabled:u||a&&!a.isProfileComplete,icon:e.jsx(zs,{}),mobileText:n("profile.cancel"),desktopText:n("profile.cancel"),forceTextOnly:!0,children:n("profile.cancel")})]}),e.jsx(bt,{sx:{my:4}}),e.jsx(c,{variant:"h6",gutterBottom:!0,children:n("profile.security")}),a.isPasswordSet?e.jsxs(l,{children:[e.jsx(c,{variant:"body2",color:"text.secondary",sx:{mb:2},children:n("profile.changePasswordDescription")}),C?e.jsx(l,{sx:{maxWidth:400},children:e.jsxs("form",{onSubmit:ee=>{ee.preventDefault(),X()},children:[e.jsx("input",{type:"text",autoComplete:"username",value:(a==null?void 0:a.email)||(a==null?void 0:a.username)||"",style:{display:"none"},readOnly:!0}),e.jsx(Ae,{fullWidth:!0,label:n("profile.currentPassword"),type:T?"text":"password",value:V.currentPassword,onChange:ee=>F({...V,currentPassword:ee.target.value}),autoComplete:"current-password",InputProps:{endAdornment:e.jsx(un,{position:"end",children:e.jsx(Ie,{"aria-label":"toggle current password visibility",onClick:()=>M(!T),edge:"end",children:T?e.jsx(oa,{}):e.jsx(Xt,{})})})},sx:{mb:2}}),e.jsx(Ae,{fullWidth:!0,label:n("profile.newPassword"),type:O?"text":"password",value:V.newPassword,onChange:ee=>F({...V,newPassword:ee.target.value}),helperText:n("profile.passwordHelper"),autoComplete:"new-password",InputProps:{endAdornment:e.jsx(un,{position:"end",children:e.jsx(Ie,{"aria-label":"toggle new password visibility",onClick:()=>I(!O),edge:"end",children:O?e.jsx(oa,{}):e.jsx(Xt,{})})})},sx:{mb:2}}),e.jsxs(l,{sx:{display:"flex",gap:1},children:[e.jsx(We,{variant:"contained",type:"submit",disabled:u||!V.currentPassword||!V.newPassword,icon:u?e.jsx(Ce,{size:20}):e.jsx(Ga,{}),mobileText:n(u?"profile.changing":"profile.changePassword"),desktopText:n(u?"profile.changing":"profile.changePassword"),forceTextOnly:!0,children:n(u?"profile.changing":"profile.changePassword")}),e.jsx(he,{variant:"outlined",type:"button",onClick:()=>{k(!1),F({currentPassword:"",newPassword:""})},mobileText:n("profile.cancel"),desktopText:n("profile.cancel"),forceTextOnly:!0,children:n("profile.cancel")})]})]})}):e.jsx(he,{variant:"outlined",icon:e.jsx(rd,{}),onClick:()=>k(!0),mobileText:n("profile.changePassword"),desktopText:n("profile.changePassword"),forceTextOnly:!0,children:n("profile.changePassword")})]}):e.jsxs(l,{children:[e.jsx(c,{variant:"body2",color:"text.secondary",sx:{mb:2},children:n("profile.setPasswordDescription")}),P?e.jsx(l,{sx:{maxWidth:400},children:e.jsxs("form",{onSubmit:ee=>{ee.preventDefault(),K()},children:[e.jsx("input",{type:"text",autoComplete:"username",value:(a==null?void 0:a.email)||(a==null?void 0:a.username)||"",style:{display:"none"},readOnly:!0}),e.jsx(Ae,{fullWidth:!0,label:n("profile.newPassword"),type:A?"text":"password",value:E.password,onChange:ee=>R({password:ee.target.value}),helperText:n("profile.passwordHelper"),autoComplete:"new-password",InputProps:{endAdornment:e.jsx(un,{position:"end",children:e.jsx(Ie,{"aria-label":"toggle password visibility",onClick:()=>L(!A),edge:"end",children:A?e.jsx(oa,{}):e.jsx(Xt,{})})})},sx:{mb:2}}),e.jsxs(l,{sx:{display:"flex",gap:1},children:[e.jsx(We,{variant:"contained",type:"submit",disabled:u||!E.password,icon:u?e.jsx(Ce,{size:20}):e.jsx(Ga,{}),mobileText:n(u?"profile.setting":"profile.setPassword"),desktopText:n(u?"profile.setting":"profile.setPassword"),forceTextOnly:!0,children:n(u?"profile.setting":"profile.setPassword")}),e.jsx(he,{icon:e.jsx(zs,{}),variant:"outlined",type:"button",onClick:()=>{w(!1),R({password:""})},mobileText:n("profile.cancel"),desktopText:n("profile.cancel"),forceTextOnly:!0,children:n("profile.cancel")})]})]})}):e.jsx(he,{variant:"outlined",icon:e.jsx(rd,{}),onClick:()=>w(!0),mobileText:n("profile.setPassword"),desktopText:n("profile.setPassword"),forceTextOnly:!0,children:n("profile.setPassword")})]})]})});return r?oe:e.jsx(xn,{maxWidth:t,sx:{py:{xs:2,sm:3}},children:oe})},WD=()=>{const{t:r}=Ne(),{hasRole:t}=Zr(),[n,s]=p.useState([]),[a,i]=p.useState(!1),[o,d]=p.useState(!1),[u,h]=p.useState(null),[m,x]=p.useState(null),[g,f]=p.useState({title:"",message:"",targetUsers:[],targetRole:"",sendToAll:!1,actionUrl:"",priority:"normal"}),y=t("admin")||t("super_admin");p.useEffect(()=>{y&&j()},[y]);const j=async()=>{i(!0);try{const w=await q.getUsers();Array.isArray(w)?s(w):w&&typeof w=="object"&&"users"in w&&Array.isArray(w.users)?s(w.users):s([])}catch(w){console.error("Error fetching users:",w),h(r("adminMessage.error.loadUsers")+": "+(w.message||r("common.unknownError"))),s([])}finally{i(!1)}},b=(w,C)=>{f(k=>({...k,[w]:C}))},v=async()=>{if(!g.title.trim()||!g.message.trim()){h(r("adminMessage.validation.titleAndMessageRequired"));return}if(!g.sendToAll&&g.targetUsers.length===0&&!g.targetRole){h(r("adminMessage.validation.selectTarget"));return}d(!0),h(null),x(null);try{const w={title:g.title,message:g.message,type:"system",actionUrl:g.actionUrl||void 0,priority:g.priority,targetUsers:g.sendToAll?void 0:g.targetUsers,targetRole:g.sendToAll?void 0:g.targetRole,sendToAll:g.sendToAll};await q.broadcastNotification(w),x(r("adminMessage.success.sent",{target:g.sendToAll?r("adminMessage.allUsers"):r("adminMessage.usersCount",{count:g.targetUsers.length})})),f({title:"",message:"",targetUsers:[],targetRole:"",sendToAll:!1,actionUrl:"",priority:"normal"})}catch(w){h(r("adminMessage.error.sendFailed")+": "+(w.message||r("common.unknownError")))}finally{d(!1)}},P=w=>{switch(w){case"super_admin":return"error";case"admin":return"warning";case"user":return"primary";default:return"default"}};return y?a?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(Ce,{})}):e.jsxs(l,{children:[e.jsxs(l,{sx:{mb:3},children:[e.jsx(c,{variant:"pageTitle",component:"h2",gutterBottom:!0,children:r("adminMessage.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:r("adminMessage.subtitle")})]}),u&&e.jsx(je,{severity:"error",sx:{mb:2},onClose:()=>h(null),children:u}),m&&e.jsx(je,{severity:"success",sx:{mb:2},onClose:()=>x(null),children:m}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:8,children:e.jsxs(se,{children:[e.jsx(pa,{title:r("adminMessage.messageDetails.title"),avatar:e.jsx(_p,{})}),e.jsxs(me,{children:[e.jsx(l,{sx:{mb:3},children:e.jsx(Ae,{fullWidth:!0,label:r("adminMessage.messageDetails.titleLabel"),value:g.title,onChange:w=>b("title",w.target.value),placeholder:r("adminMessage.messageDetails.titlePlaceholder"),required:!0})}),e.jsx(l,{sx:{mb:3},children:e.jsx(Ae,{fullWidth:!0,multiline:!0,rows:4,label:r("adminMessage.messageDetails.contentLabel"),value:g.message,onChange:w=>b("message",w.target.value),placeholder:r("adminMessage.messageDetails.contentPlaceholder"),required:!0})}),e.jsx(l,{sx:{mb:3},children:e.jsx(Ae,{fullWidth:!0,label:r("adminMessage.messageDetails.actionUrlLabel"),value:g.actionUrl,onChange:w=>b("actionUrl",w.target.value),placeholder:r("adminMessage.messageDetails.actionUrlPlaceholder"),helperText:r("adminMessage.messageDetails.actionUrlHelper")})}),e.jsx(l,{sx:{mb:3},children:e.jsxs(nt,{fullWidth:!0,variant:"outlined",children:[e.jsx(st,{children:r("adminMessage.messageDetails.priorityLabel")}),e.jsxs(Ze,{value:g.priority,onChange:w=>b("priority",w.target.value),label:r("adminMessage.messageDetails.priorityLabel"),children:[e.jsx(re,{value:"low",children:r("adminMessage.priority.low")}),e.jsx(re,{value:"normal",children:r("adminMessage.priority.normal")}),e.jsx(re,{value:"high",children:r("adminMessage.priority.high")})]})]})})]})]})}),e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(se,{children:[e.jsx(pa,{title:r("adminMessage.targetUsers.title"),avatar:e.jsx(Yu,{})}),e.jsxs(me,{children:[e.jsx(l,{sx:{mb:2},children:e.jsx(an,{control:e.jsx(jn,{checked:g.sendToAll,onChange:w=>b("sendToAll",w.target.checked)}),label:r("adminMessage.targetUsers.sendToAll")})}),!g.sendToAll&&e.jsxs(e.Fragment,{children:[e.jsx(l,{sx:{mb:2},children:e.jsx(jo,{multiple:!0,options:Array.isArray(n)?n:[],getOptionLabel:w=>`${w.displayName||w.fullName||w.email}`,value:Array.isArray(n)?n.filter(w=>g.targetUsers.includes(w.userId)):[],onChange:(w,C)=>{b("targetUsers",C.map(k=>k.userId))},renderTags:(w,C)=>w.map((k,A)=>p.createElement(ce,{...C({index:A}),key:k.userId,label:k.displayName||k.fullName||k.email,color:P(k.role),size:"small"})),renderInput:w=>e.jsx(Ae,{...w,label:r("adminMessage.targetUsers.selectUsers"),placeholder:r("adminMessage.targetUsers.searchUsers")})})}),e.jsx(l,{sx:{mb:2},children:e.jsxs(nt,{fullWidth:!0,variant:"outlined",children:[e.jsx(st,{children:r("adminMessage.targetUsers.selectByRole")}),e.jsxs(Ze,{value:g.targetRole,onChange:w=>b("targetRole",w.target.value),label:r("adminMessage.targetUsers.selectByRole"),children:[e.jsx(re,{value:"",children:r("adminMessage.targetUsers.selectRole")}),e.jsx(re,{value:"user",children:r("adminMessage.roles.user")}),e.jsx(re,{value:"admin",children:r("adminMessage.roles.admin")}),e.jsx(re,{value:"super_admin",children:r("adminMessage.roles.superAdmin")})]})]})})]}),e.jsx(bt,{sx:{my:2}}),e.jsx(We,{fullWidth:!0,variant:"contained",icon:e.jsx(Yp,{}),onClick:v,disabled:o||!g.title.trim()||!g.message.trim(),sx:{mt:2},mobileText:r(o?"adminMessage.sending":"adminMessage.send"),desktopText:r(o?"adminMessage.sending":"adminMessage.sendMessage"),forceTextOnly:!0,children:r(o?"adminMessage.sending":"adminMessage.sendMessage")})]})]})})]})]}):e.jsx(je,{severity:"error",children:r("adminMessage.error.noPermission")})},FD=()=>{const{t:r}=Ne(),[t,n]=p.useState([]),[s,a]=p.useState({totalDevices:0,activeDevices:0,expiredDevices:0,highTrustDevices:0}),[i,o]=p.useState(!0),[d,u]=p.useState(null),[h,m]=p.useState(!1),[x,g]=p.useState(!1),[f,y]=p.useState(null),[j,b]=p.useState(null);p.useEffect(()=>{v()},[]);const v=async()=>{try{o(!0),u(null);const[A,L]=await Promise.all([zr.getTrustedDevices(),zr.getDeviceStats()]);n(A),a(L)}catch(A){u(A.message||r("deviceManagement.errors.loadFailed"))}finally{o(!1)}},P=async A=>{try{y(A),await zr.revokeDevice(A),await v(),m(!1)}catch(L){u(L.message||r("deviceManagement.errors.revokeFailed"))}finally{y(null)}},w=async()=>{try{y("all"),await zr.revokeAllDevices(),await v(),g(!1)}catch(A){u(A.message||r("deviceManagement.errors.revokeAllFailed"))}finally{y(null)}},C=A=>zr.getTrustLevelColor(A),k=A=>zr.getTrustLevelLabel(A);return i?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(Ce,{})}):e.jsxs(l,{children:[e.jsxs(se,{children:[e.jsx(pa,{avatar:e.jsx(Jt,{color:"primary"}),title:r("deviceManagement.title"),subheader:r("deviceManagement.subtitle")}),e.jsxs(me,{children:[d&&e.jsx(je,{severity:"error",sx:{mb:2},children:d}),e.jsxs(W,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{variant:"outlined",children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(nl,{color:"primary",sx:{mr:1}}),e.jsxs(l,{children:[e.jsx(c,{variant:"cardValue",children:s.totalDevices}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("deviceManagement.stats.totalDevices")})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{variant:"outlined",children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Xe,{color:"success",sx:{mr:1}}),e.jsxs(l,{children:[e.jsx(c,{variant:"cardValue",children:s.activeDevices}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("deviceManagement.stats.activeDevices")})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{variant:"outlined",children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(on,{color:"warning",sx:{mr:1}}),e.jsxs(l,{children:[e.jsx(c,{variant:"cardValue",children:s.expiredDevices}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("deviceManagement.stats.expiredDevices")})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{variant:"outlined",children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Jt,{color:"info",sx:{mr:1}}),e.jsxs(l,{children:[e.jsx(c,{variant:"cardValue",children:s.highTrustDevices}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("deviceManagement.stats.highTrust")})]})]})})})})]}),t.length===0?e.jsxs(l,{textAlign:"center",py:4,children:[e.jsx(nl,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(c,{variant:"cardTitle",color:"text.secondary",children:r("deviceManagement.noDevices.title")}),e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",children:r("deviceManagement.noDevices.subtitle")})]}):e.jsx(lt,{children:t.map((A,L)=>e.jsxs(rt.Fragment,{children:[e.jsxs(Pe,{children:[e.jsx(Vt,{sx:{bgcolor:"primary.main",mr:2},children:e.jsx(nl,{})}),e.jsx(ve,{primary:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(c,{variant:"cardTitle",children:A.deviceName}),e.jsx(ce,{label:k(A.trustLevel),size:"small",sx:{backgroundColor:C(A.trustLevel),color:"white",fontWeight:"bold"}}),!A.isActive&&e.jsx(ce,{label:r("deviceManagement.device.expired"),size:"small",color:"warning",variant:"outlined"})]}),secondary:e.jsxs(l,{children:[e.jsx(c,{variant:"cardSubtitle",color:"text.secondary",children:A.browserInfo}),e.jsxs(c,{variant:"cardSubtitle",color:"text.secondary",children:[A.location,"  ",r("deviceManagement.device.lastUsed"),": ",A.timeSinceLastUsed]})]})}),e.jsx(bo,{children:e.jsx(Fe,{title:r("deviceManagement.device.revoke"),children:e.jsx(Ie,{edge:"end",color:"error",onClick:()=>{b(A.deviceId),m(!0)},disabled:f===A.deviceId,children:f===A.deviceId?e.jsx(Ce,{size:20}):e.jsx(pt,{})})})})]}),L<t.length-1&&e.jsx(bt,{})]},A.deviceId))}),t.length>0&&e.jsxs(l,{mt:3,display:"flex",gap:2,children:[e.jsx(We,{variant:"outlined",color:"error",icon:e.jsx(qp,{}),onClick:()=>g(!0),mobileText:r("deviceManagement.device.revokeAll"),desktopText:r("deviceManagement.device.revokeAll"),children:r("deviceManagement.device.revokeAll")}),e.jsx(he,{variant:"outlined",onClick:v,children:r("deviceManagement.device.refresh")})]})]})]}),e.jsxs(kt,{open:h,onClose:()=>m(!1),children:[e.jsx(Et,{sx:{fontWeight:"bold"},children:r("deviceManagement.dialogs.revokeDevice.title")}),e.jsx(Pt,{children:e.jsx(c,{variant:"body2",ellipsis:!1,children:r("deviceManagement.dialogs.revokeDevice.message")})}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:()=>m(!1),children:r("deviceManagement.dialogs.revokeDevice.cancel")}),e.jsx(We,{variant:"contained",color:"error",onClick:()=>P(j||""),disabled:f!==null,icon:void 0,forceTextOnly:!0,mobileText:r("deviceManagement.dialogs.revokeDevice.confirm"),desktopText:r("deviceManagement.dialogs.revokeDevice.confirm"),children:r("deviceManagement.dialogs.revokeDevice.confirm")})]})]}),e.jsxs(kt,{open:x,onClose:()=>g(!1),children:[e.jsx(Et,{sx:{fontWeight:"bold"},children:r("deviceManagement.dialogs.revokeAll.title")}),e.jsxs(Pt,{children:[e.jsx(je,{severity:"warning",sx:{mb:2},children:e.jsx(c,{variant:"body2",ellipsis:!1,children:r("deviceManagement.dialogs.revokeAll.warning")})}),e.jsx(c,{variant:"body2",ellipsis:!1,children:r("deviceManagement.dialogs.revokeAll.message",{count:t.length})})]}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:()=>g(!1),children:r("deviceManagement.dialogs.revokeAll.cancel")}),e.jsx(We,{variant:"contained",color:"error",onClick:w,disabled:f!==null,icon:void 0,forceTextOnly:!0,mobileText:r(f==="all"?"deviceManagement.dialogs.revokeAll.revoking":"deviceManagement.dialogs.revokeAll.confirm"),desktopText:r(f==="all"?"deviceManagement.dialogs.revokeAll.revoking":"deviceManagement.dialogs.revokeAll.confirm"),children:r(f==="all"?"deviceManagement.dialogs.revokeAll.revoking":"deviceManagement.dialogs.revokeAll.confirm")})]})]})]})};function Ks(r){const{children:t,value:n,index:s,...a}=r;return e.jsx("div",{role:"tabpanel",hidden:n!==s,id:`settings-tabpanel-${s}`,"aria-labelledby":`settings-tab-${s}`,...a,children:n===s&&e.jsx(l,{sx:{p:3},children:t})})}function Qs(r){return{id:`settings-tab-${r}`,"aria-controls":`settings-tabpanel-${r}`}}const zD=()=>{const{t:r}=Ne(),[t,n]=p.useState(0),{hasRole:s}=Zr(),a=s("admin")||s("super_admin"),i=(o,d)=>{n(d)};return e.jsx(xn,{maxWidth:"lg",sx:{py:{xs:2,sm:3}},children:e.jsxs(l,{children:[e.jsxs(l,{sx:{mb:4},children:[e.jsx(c,{variant:"pageHeader",gutterBottom:!0,children:r("settings.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:r("settings.subtitle")})]}),e.jsxs(Te,{sx:{width:"100%"},children:[e.jsx(l,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Tr,{value:t,onChange:i,"aria-label":"settings tabs",variant:"scrollable",scrollButtons:"auto",children:[e.jsx(ht,{icon:e.jsx(Ue,{}),label:r("settings.tabs.accountManagement"),iconPosition:"start",...Qs(0)}),e.jsx(ht,{icon:e.jsx(Sn,{}),label:r("settings.tabs.profile"),iconPosition:"start",...Qs(1)}),e.jsx(ht,{icon:e.jsx(Jt,{}),label:r("settings.tabs.security"),iconPosition:"start",...Qs(2)}),e.jsx(ht,{icon:e.jsx(Vi,{}),label:r("settings.tabs.notifications"),iconPosition:"start",...Qs(3)}),e.jsx(ht,{icon:e.jsx(Gp,{}),label:r("settings.tabs.appearance"),iconPosition:"start",...Qs(4)}),a&&e.jsx(ht,{icon:e.jsx(gc,{}),label:r("settings.tabs.adminMessages"),iconPosition:"start",...Qs(5)})]})}),e.jsxs(Ks,{value:t,index:0,children:[e.jsxs(l,{sx:{m:0,p:0},children:[e.jsx(c,{variant:"pageTitle",component:"h2",gutterBottom:!0,children:r("accountManagement.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",sx:{mb:3},desktopOnly:!0,children:r("accountManagement.subtitle")})]}),e.jsx(rv,{})]}),e.jsx(Ks,{value:t,index:1,children:e.jsx(Ax,{embedded:!0,maxWidth:"md"})}),e.jsxs(Ks,{value:t,index:2,children:[e.jsxs(l,{sx:{mb:3},children:[e.jsx(c,{variant:"pageTitle",component:"h2",gutterBottom:!0,children:r("settings.security.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",sx:{mb:3},children:r("settings.security.subtitle")})]}),e.jsx(FD,{})]}),e.jsxs(Ks,{value:t,index:3,children:[e.jsxs(l,{sx:{mb:3},children:[e.jsx(c,{variant:"pageTitle",component:"h2",gutterBottom:!0,children:r("settings.notifications.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",sx:{mb:3},children:r("settings.notifications.subtitle")})]}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(se,{sx:{height:"100%",p:3},children:[e.jsx(c,{variant:"cardTitle",component:"h3",gutterBottom:!0,children:r("settings.notifications.email.title")}),e.jsx(c,{variant:"cardSubtitle",sx:{mb:3,color:"text.secondary"},children:r("settings.notifications.email.subtitle")})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(se,{sx:{height:"100%",p:3},children:[e.jsx(c,{variant:"cardTitle",component:"h3",gutterBottom:!0,children:r("settings.notifications.push.title")}),e.jsx(c,{variant:"cardSubtitle",sx:{mb:3,color:"text.secondary"},children:r("settings.notifications.push.subtitle")})]})})]})]}),e.jsxs(Ks,{value:t,index:4,children:[e.jsxs(l,{sx:{mb:3},children:[e.jsx(c,{variant:"pageTitle",component:"h2",gutterBottom:!0,children:r("settings.appearance.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",sx:{mb:3},children:r("settings.appearance.subtitle")})]}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(se,{sx:{height:"100%",p:3},children:[e.jsx(c,{variant:"cardTitle",component:"h3",gutterBottom:!0,children:r("settings.appearance.theme.title")}),e.jsx(c,{variant:"cardSubtitle",sx:{mb:3,color:"text.secondary"},children:r("settings.appearance.theme.subtitle")})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(se,{sx:{height:"100%",p:3},children:[e.jsx(c,{variant:"cardTitle",component:"h3",gutterBottom:!0,children:r("settings.appearance.language.title")}),e.jsx(c,{variant:"cardSubtitle",sx:{mb:3,color:"text.secondary"},children:r("settings.appearance.language.subtitle")}),e.jsx(c,{variant:"cardSubtitle",sx:{mb:3,color:"text.secondary"},children:r("settings.appearance.language.description")})]})})]})]}),a&&e.jsx(Ks,{value:t,index:5,children:e.jsx(WD,{})})]})]})})},OD=({onEditRole:r,onViewRole:t,onManagePermissions:n,onManageUsers:s,page:a=0,rowsPerPage:i=10,total:o=0,onPageChange:d,onRowsPerPageChange:u,roles:h=[],isLoading:m=!1,error:x=null,deleteRole:g=()=>{},isDeleting:f=!1})=>{const[y,j]=p.useState(null),[b,v]=p.useState(null),[P,w]=p.useState(!1),C=(I,z)=>{j(I.currentTarget),v(z)},k=()=>{j(null),v(null)},A=()=>{w(!0),k()},L=async()=>{if(b)try{await g(b.roleId),w(!1),v(null)}catch(I){console.error("Error deleting role:",I)}},T=()=>{w(!1),v(null)},M=I=>I>=90?"error":I>=70?"warning":I>=50?"info":"default",O=I=>I>=90?"Critical":I>=70?"High":I>=50?"Medium":"Low";return m?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(Ce,{})}):x?e.jsxs(je,{severity:"error",children:["Error loading roles: ",x instanceof Error?x.message:"Unknown error"]}):e.jsxs(l,{children:[e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(D,{variant:"h6",component:"h2",children:"Roles Management"}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:[(h==null?void 0:h.length)||0," roles"]})]}),e.jsx(at,{component:Te,children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:"Name"}),e.jsx(S,{children:"Display Name"}),e.jsx(S,{children:"Priority"}),e.jsx(S,{children:"Type"}),e.jsx(S,{children:"Permissions"}),e.jsx(S,{children:"Created"}),e.jsx(S,{align:"right",children:"Actions"})]})}),e.jsx(ot,{children:h==null?void 0:h.map(I=>{var z;return e.jsxs(De,{hover:!0,onClick:()=>t==null?void 0:t(I),sx:{cursor:"pointer"},children:[e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Jt,{color:"primary"}),e.jsx(D,{variant:"body2",fontWeight:"medium",children:I.name})]})}),e.jsxs(S,{children:[e.jsx(D,{variant:"body2",children:I.displayName}),I.description&&e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:I.description})]}),e.jsx(S,{children:e.jsx(ce,{label:O(I.priority),color:M(I.priority),size:"small"})}),e.jsx(S,{children:e.jsx(ce,{label:I.isSystemRole?"System":"Custom",color:I.isSystemRole?"primary":"default",size:"small"})}),e.jsx(S,{children:e.jsxs(D,{variant:"body2",children:[((z=I.permissions)==null?void 0:z.length)||0," permissions"]})}),e.jsx(S,{children:e.jsx(D,{variant:"body2",color:"text.secondary",children:new Date(I.createdAt).toLocaleDateString()})}),e.jsx(S,{align:"right",children:e.jsx(Ie,{size:"small",onClick:N=>{N.stopPropagation(),C(N,I)},disabled:f,children:e.jsx(wr,{})})})]},I.roleId)})})]})}),e.jsx(hi,{rowsPerPageOptions:[5,10,25,50],component:"div",count:o||(h==null?void 0:h.length)||0,rowsPerPage:i,page:a,onPageChange:d||(()=>{}),onRowsPerPageChange:u||(()=>{})})]})}),e.jsxs(Gn,{anchorEl:y,open:!!y,onClose:k,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(re,{onClick:()=>{t==null||t(b),k()},children:[e.jsx(Xt,{fontSize:"small",sx:{mr:1}}),"View Details"]}),e.jsxs(re,{onClick:()=>{r==null||r(b),k()},children:[e.jsx(Tt,{fontSize:"small",sx:{mr:1}}),"Edit Role"]}),e.jsxs(re,{onClick:()=>{n==null||n(b),k()},children:[e.jsx(Jt,{fontSize:"small",sx:{mr:1}}),"Manage Permissions"]}),e.jsxs(re,{onClick:()=>{s==null||s(b),k()},children:[e.jsx(Sn,{fontSize:"small",sx:{mr:1}}),"Manage Users"]}),b&&!b.isSystemRole&&e.jsxs(re,{onClick:A,sx:{color:"error.main"},children:[e.jsx(pt,{fontSize:"small",sx:{mr:1}}),"Delete Role"]})]}),e.jsxs(kt,{open:P,onClose:T,children:[e.jsx(Et,{children:"Delete Role"}),e.jsxs(Pt,{children:[e.jsxs(D,{children:['Are you sure you want to delete the role "',b==null?void 0:b.displayName,'"? This action cannot be undone.']}),b&&e.jsx(je,{severity:"warning",sx:{mt:2},children:"This will remove the role from all users who currently have it assigned."})]}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:T,variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{onClick:L,color:"error",variant:"contained",disabled:f,icon:f?e.jsx(Ce,{size:20}):void 0,forceTextOnly:!0,mobileText:f?"Deleting...":"Delete",desktopText:f?"Deleting...":"Delete",children:f?e.jsx(Ce,{size:20}):"Delete"})]})]})]})};class Xs{static async getRoles(){return await q.get("/api/v1/roles")}static async getRole(t){return await q.get(`/api/v1/roles/${t}`)}static async createRole(t){return await q.post("/api/v1/roles",t)}static async updateRole(t,n){return await q.put(`/api/v1/roles/${t}`,n)}static async deleteRole(t){await q.delete(`/api/v1/roles/${t}`)}static async assignPermissionsToRole(t,n){await q.post(`/api/v1/roles/${t}/permissions`,{permissionIds:n})}static async removePermissionsFromRole(t,n){await q.delete(`/api/v1/roles/${t}/permissions`,{data:{permissionIds:n}})}static async getRolePermissions(t){return await q.get(`/api/v1/roles/${t}/permissions`)}static async getUsersWithRole(t){return await q.get(`/api/v1/roles/${t}/users`)}}class qa{static async assignRoleToUser(t,n){return await q.post(`/api/v1/users/${t}/roles`,n)}static async getUserRoles(t){return await q.get(`/api/v1/users/${t}/roles`)}static async getUserPermissions(t){return await q.get(`/api/v1/users/${t}/permissions`)}static async updateUserRole(t,n){return await q.put(`/api/v1/users/roles/${t}`,n)}static async removeRoleFromUser(t,n){await q.delete(`/api/v1/users/${t}/roles/${n}`)}static async deactivateUserRole(t){return await q.put(`/api/v1/users/roles/${t}/deactivate`)}static async checkUserPermission(t,n){return await q.get(`/api/v1/users/${t}/permissions/check`,{data:{permission:n}})}static async checkUserAnyPermission(t,n){return await q.get(`/api/v1/users/${t}/permissions/check-any`,{data:{permissions:n}})}static async checkUserAllPermissions(t,n){return await q.get(`/api/v1/users/${t}/permissions/check-all`,{data:{permissions:n}})}static async getExpiredUserRoles(){return await q.get("/api/v1/users/roles/expired")}static async cleanupExpiredUserRoles(){return await q.post("/api/v1/users/roles/cleanup")}}const Qo=r=>{const t=Kt(),{data:n,isLoading:s,error:a,refetch:i}=yt({queryKey:["roles"],queryFn:Xs.getRoles,staleTime:5*60*1e3}),o=rt.useMemo(()=>{if(!n)return[];let j=[...n];if(r!=null&&r.search){const b=r.search.toLowerCase();j=j.filter(v=>{var P;return v.name.toLowerCase().includes(b)||v.displayName.toLowerCase().includes(b)||((P=v.description)==null?void 0:P.toLowerCase().includes(b))})}return r!=null&&r.sortBy&&j.sort((b,v)=>{const P=b[r.sortBy],w=v[r.sortBy];return typeof P=="string"&&typeof w=="string"?r.sortOrder==="desc"?w.localeCompare(P):P.localeCompare(w):typeof P=="number"&&typeof w=="number"?r.sortOrder==="desc"?w-P:P-w:0}),j},[n,r==null?void 0:r.search,r==null?void 0:r.sortBy,r==null?void 0:r.sortOrder,r==null?void 0:r.page,r==null?void 0:r.limit]),{total:d,totalPages:u,paginatedRoles:h}=rt.useMemo(()=>{const j=o.length,b=Math.ceil(j/((r==null?void 0:r.limit)||10)),v=(((r==null?void 0:r.page)||1)-1)*((r==null?void 0:r.limit)||10),P=v+((r==null?void 0:r.limit)||10),w=o.slice(v,P);return{total:j,totalPages:b,paginatedRoles:w}},[o,r==null?void 0:r.page,r==null?void 0:r.limit]),m=jt({mutationFn:j=>Xs.createRole(j),onSuccess:()=>{t.invalidateQueries({queryKey:["roles"]})}}),x=jt({mutationFn:({roleId:j,roleData:b})=>Xs.updateRole(j,b),onSuccess:()=>{t.invalidateQueries({queryKey:["roles"]})}}),g=jt({mutationFn:j=>Xs.deleteRole(j),onSuccess:()=>{t.invalidateQueries({queryKey:["roles"]})}}),f=jt({mutationFn:({roleId:j,permissionIds:b})=>Xs.assignPermissionsToRole(j,b),onSuccess:()=>{t.invalidateQueries({queryKey:["roles"]}),t.invalidateQueries({queryKey:["rolePermissions"]})}}),y=jt({mutationFn:({roleId:j,permissionIds:b})=>Xs.removePermissionsFromRole(j,b),onSuccess:()=>{t.invalidateQueries({queryKey:["roles"]}),t.invalidateQueries({queryKey:["rolePermissions"]})}});return{roles:h,total:d,page:(r==null?void 0:r.page)||1,limit:(r==null?void 0:r.limit)||10,totalPages:u,isLoading:s,error:a,createRole:m.mutate,updateRole:x.mutate,deleteRole:g.mutate,assignPermissions:f.mutate,removePermissions:y.mutate,refetch:i,isCreating:m.isLoading,isUpdating:x.isLoading,isDeleting:g.isLoading,isAssigningPermissions:f.isLoading,isRemovingPermissions:y.isLoading,createError:m.error,updateError:x.error,deleteError:g.error,assignPermissionsError:f.error,removePermissionsError:y.error}},VD=({open:r,onClose:t,role:n,mode:s})=>{var V;const{createRole:a,updateRole:i,isCreating:o,isUpdating:d,createError:u,updateError:h}=Qo(),[m,x]=p.useState([]),[g,f]=p.useState(!1);p.useEffect(()=>{(async()=>{if(r){f(!0);try{const $=(await Rc.getPermissionsByCategory()).flatMap(Y=>Y.permissions.map(_=>({..._,category:Y.name})));x($)}catch(B){console.error("Error fetching permissions:",B),x([])}finally{f(!1)}}})()},[r]);const[y,j]=p.useState({name:"",displayName:"",description:"",isSystemRole:!1,priority:0,permissionIds:[]}),[b,v]=p.useState({}),[P,w]=p.useState(""),[C,k]=p.useState({basic:!0,settings:!0,permissions:!0});p.useEffect(()=>{var F;j(s==="edit"&&n?{name:n.name,displayName:n.displayName,description:n.description||"",isSystemRole:n.isSystemRole,priority:n.priority,permissionIds:((F=n.permissions)==null?void 0:F.map(B=>B.permissionId))||[]}:{name:"",displayName:"",description:"",isSystemRole:!1,priority:0,permissionIds:[]}),v({})},[s,n,r]);const A=F=>B=>{const $=B.target.value;j(Y=>({...Y,[F]:$})),b[F]&&v(Y=>({...Y,[F]:""}))},L=F=>B=>{const $=B.target.checked;j(Y=>({...Y,[F]:$}))},T=F=>(B,$)=>{j(Y=>({...Y,[F]:$}))},M=(F,B)=>{j($=>({...$,permissionIds:B?[...$.permissionIds||[],F]:($.permissionIds||[]).filter(Y=>Y!==F)}))},O=()=>{const F={};return y.name.trim()?/^[a-z_]+$/.test(y.name)?y.name.length<3?F.name="Role name must be at least 3 characters long":y.name.length>50&&(F.name="Role name must be less than 50 characters"):F.name="Role name must contain only lowercase letters and underscores":F.name="Role name is required",y.displayName.trim()?y.displayName.length<3?F.displayName="Display name must be at least 3 characters long":y.displayName.length>100&&(F.displayName="Display name must be less than 100 characters"):F.displayName="Display name is required",y.description&&y.description.length>500&&(F.description="Description must be less than 500 characters"),((y.priority||0)<0||(y.priority||0)>100)&&(F.priority="Priority must be between 0 and 100"),(!y.permissionIds||y.permissionIds.length===0)&&(F.permissions="At least one permission must be selected"),v(F),Object.keys(F).length===0},I=async()=>{if(O())try{if(s==="create")await a(y);else if(n){const F={displayName:y.displayName,description:y.description,priority:y.priority};await i({roleId:n.roleId,roleData:F})}t()}catch(F){console.error("Error saving role:",F)}},z=o||d,N=u||h,E=(m==null?void 0:m.filter(F=>{var $;if(!P)return!0;const B=P.toLowerCase();return F.name.toLowerCase().includes(B)||F.displayName.toLowerCase().includes(B)||(($=F.description)==null?void 0:$.toLowerCase().includes(B))||F.category.toLowerCase().includes(B)}))||[],R=E.reduce((F,B)=>(F[B.category]||(F[B.category]=[]),F[B.category].push(B),F),{});return e.jsxs(kt,{open:r,onClose:t,maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{minHeight:"80vh"}},children:[e.jsx(Et,{children:s==="create"?"Create New Role":"Edit Role"}),e.jsxs(Pt,{sx:{p:{xs:2,sm:2.5}},children:[!!N&&e.jsx(je,{severity:"error",sx:{mb:2},children:"Error occurred"}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsxs(W,{item:!0,xs:12,md:5,children:[e.jsxs(Te,{sx:{p:{xs:1.5,sm:2},mb:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,children:[e.jsx(D,{variant:"h6",children:"Basic Information"}),e.jsx(Ie,{size:"small",onClick:()=>k(F=>({...F,basic:!F.basic})),children:C.basic?e.jsx(Dn,{}):e.jsx(ln,{})})]}),e.jsx(qr,{in:C.basic,children:e.jsxs(ft,{spacing:2,children:[e.jsx(Ae,{label:"Role Name",value:y.name,onChange:A("name"),error:!!b.name,helperText:b.name||"Use lowercase letters and underscores only",disabled:s==="edit"||z,fullWidth:!0,size:"small"}),e.jsx(Ae,{label:"Display Name",value:y.displayName,onChange:A("displayName"),error:!!b.displayName,helperText:b.displayName,disabled:z,fullWidth:!0,size:"small"}),e.jsx(Ae,{label:"Description",value:y.description,onChange:A("description"),multiline:!0,rows:2,disabled:z,error:!!b.description,helperText:b.description||`${(y.description||"").length}/500 characters`,fullWidth:!0,size:"small"})]})})]}),e.jsxs(Te,{sx:{p:2},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,children:[e.jsx(D,{variant:"h6",children:"Role Settings"}),e.jsx(Ie,{size:"small",onClick:()=>k(F=>({...F,settings:!F.settings})),children:C.settings?e.jsx(Dn,{}):e.jsx(ln,{})})]}),e.jsx(qr,{in:C.settings,children:e.jsxs(ft,{spacing:2,children:[e.jsx(an,{control:e.jsx(jn,{checked:y.isSystemRole,onChange:L("isSystemRole"),disabled:s==="edit"||z,size:"small"}),label:"System Role"}),e.jsxs(l,{children:[e.jsxs(D,{variant:"body2",gutterBottom:!0,children:["Priority: ",y.priority]}),e.jsx(jc,{value:y.priority,onChange:T("priority"),min:0,max:100,step:1,marks:[{value:0,label:"Low"},{value:50,label:"Medium"},{value:100,label:"High"}],disabled:z,size:"small"})]})]})})]})]}),e.jsx(W,{item:!0,xs:12,md:7,children:e.jsxs(Te,{sx:{p:3,height:"100%",minHeight:"60vh"},children:[e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsxs(D,{variant:"h6",children:["Permissions (",((V=y.permissionIds)==null?void 0:V.length)||0," selected)"]}),e.jsx(Ie,{size:"small",onClick:()=>k(F=>({...F,permissions:!F.permissions})),children:C.permissions?e.jsx(Dn,{}):e.jsx(ln,{})})]}),b.permissions&&e.jsx(D,{variant:"caption",color:"error",display:"block",mb:1,children:b.permissions}),e.jsxs(qr,{in:C.permissions,children:[e.jsxs(l,{display:"flex",gap:2,mb:3,children:[e.jsx(Ae,{label:"Search permissions",value:P,onChange:F=>w(F.target.value),size:"small",sx:{flexGrow:1},placeholder:"Search by name, display name, or category..."}),e.jsx(he,{size:"small",variant:"outlined",onClick:()=>{const F=E.map(B=>B.permissionId);j(B=>({...B,permissionIds:F}))},disabled:z,forceTextOnly:!0,mobileText:"Select All",desktopText:"Select All",children:"Select All"}),e.jsx(he,{size:"small",variant:"outlined",onClick:()=>j(F=>({...F,permissionIds:[]})),disabled:z,forceTextOnly:!0,mobileText:"Clear All",desktopText:"Clear All",children:"Clear All"})]}),g?e.jsx(l,{display:"flex",justifyContent:"center",p:4,children:e.jsx(Ce,{})}):e.jsx(l,{sx:{maxHeight:"50vh",overflow:"auto"},children:Object.entries(R).map(([F,B])=>e.jsxs(l,{sx:{mb:3},children:[e.jsx(D,{variant:"subtitle1",fontWeight:"medium",gutterBottom:!0,sx:{mb:2},children:F.replace(/_/g," ").toUpperCase()}),e.jsx(l,{sx:{display:"flex",flexWrap:"wrap",gap:1.5},children:B.map(($,Y)=>e.jsx(Fe,{title:e.jsxs(l,{children:[e.jsx(D,{variant:"subtitle2",fontWeight:"bold",children:$.displayName}),e.jsx(D,{variant:"body2",children:$.description||"No description available"}),e.jsxs(D,{variant:"caption",color:"text.secondary",children:["Priority: ",$.priority]})]}),arrow:!0,placement:"top",children:e.jsx(ce,{label:$.displayName,color:(y.permissionIds||[]).includes($.permissionId)?"primary":"default",variant:(y.permissionIds||[]).includes($.permissionId)?"filled":"outlined",onClick:()=>M($.permissionId,!(y.permissionIds||[]).includes($.permissionId)),disabled:z,sx:{"&:hover":{backgroundColor:(y.permissionIds||[]).includes($.permissionId)?"primary.dark":"action.hover"}}})},$.permissionId||`${F}-${Y}`))})]},F))})]})]})})]})]}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:t,disabled:z,variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{onClick:I,variant:"contained",disabled:z,icon:z?e.jsx(Ce,{size:16}):void 0,forceTextOnly:!0,mobileText:z?s==="create"?"Creating...":"Updating...":s==="create"?"Create Role":"Update Role",desktopText:z?s==="create"?"Creating...":"Updating...":s==="create"?"Create Role":"Update Role",children:z?s==="create"?"Creating...":"Updating...":s==="create"?"Create Role":"Update Role"})]})]})},$D=({open:r,onClose:t,role:n,onEdit:s,onManagePermissions:a,onManageUsers:i})=>{var g,f,y;if(!n)return null;const o=j=>j>=90?"error":j>=70?"warning":j>=50?"info":"default",d=j=>j>=90?"Critical":j>=70?"High":j>=50?"Medium":"Low",u=j=>new Date(j).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),h=j=>({user_management:"#e3f2fd",portfolio_management:"#f3e5f5",trading_operations:"#e8f5e8",asset_management:"#fff3e0",financial_data:"#fce4ec",system_administration:"#f1f8e9"})[j]||"#f5f5f5",m=j=>({user_management:"User Management",portfolio_management:"Portfolio Management",trading_operations:"Trading Operations",asset_management:"Asset Management",financial_data:"Financial Data",system_administration:"System Administration"})[j]||j.replace(/_/g," ").replace(/\b\w/g,v=>v.toUpperCase()),x=((g=n.permissions)==null?void 0:g.reduce((j,b)=>{const v=b.category;return j[v]||(j[v]=[]),j[v].push(b),j},{}))||{};return e.jsxs(kt,{open:r,onClose:t,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:"70vh"}},children:[e.jsx(Et,{children:e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Jt,{color:"primary"}),e.jsx(D,{variant:"h6",children:n.displayName})]}),e.jsx(Ie,{onClick:t,size:"small",children:e.jsx(sr,{})})]})}),e.jsx(Pt,{children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{sx:{mb:2},children:e.jsx(me,{sx:{p:{xs:1.5,sm:2}},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(D,{variant:"subtitle1",fontWeight:"medium",gutterBottom:!0,children:"Basic Information"}),e.jsxs(l,{display:"flex",flexDirection:"column",gap:1.5,children:[e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Role Name"}),e.jsx(D,{variant:"body2",fontWeight:"medium",children:n.name})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Description"}),e.jsx(D,{variant:"body2",children:n.description||"No description provided"})]}),e.jsxs(l,{display:"flex",gap:1,alignItems:"center",children:[e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Priority"}),e.jsx(ce,{label:`${d(n.priority)} (${n.priority})`,color:o(n.priority),size:"small"})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Type"}),e.jsx(ce,{label:n.isSystemRole?"System Role":"Custom Role",color:n.isSystemRole?"primary":"default",size:"small"})]})]})]})]}),e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(D,{variant:"subtitle1",fontWeight:"medium",gutterBottom:!0,children:"Metadata"}),e.jsxs(l,{display:"flex",flexDirection:"column",gap:1.5,children:[e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Created At"}),e.jsx(D,{variant:"body2",children:u(n.createdAt)})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Last Updated"}),e.jsx(D,{variant:"body2",children:u(n.updatedAt)})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:"Total Permissions"}),e.jsx(D,{variant:"h6",color:"primary",children:((f=n.permissions)==null?void 0:f.length)||0})]})]})]})]})})})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{children:e.jsxs(me,{sx:{p:2},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(D,{variant:"h6",children:["Permissions (",((y=n.permissions)==null?void 0:y.length)||0,")"]}),a&&e.jsx(ut,{variant:"outlined",size:"small",startIcon:e.jsx(Jt,{}),onClick:()=>a(n),children:"Manage Permissions"})]}),Object.keys(x).length>0?e.jsx(l,{children:Object.entries(x).map(([j,b])=>e.jsxs(l,{mb:2,children:[e.jsx(l,{sx:{backgroundColor:h(j),padding:1,borderRadius:1,mb:1},children:e.jsxs(D,{variant:"subtitle2",fontWeight:"medium",children:[m(j)," (",b.length,")"]})}),e.jsx(lt,{dense:!0,sx:{py:0},children:b.map(v=>e.jsxs(Pe,{sx:{py:.25,px:0},children:[e.jsx(tt,{sx:{minWidth:32},children:e.jsx(Jt,{fontSize:"small",color:"action"})}),e.jsx(ve,{primary:e.jsx(D,{variant:"body2",fontWeight:"medium",children:v.displayName}),secondary:e.jsx(D,{variant:"caption",color:"text.secondary",children:v.description||v.name})}),e.jsx(ce,{label:v.priority,size:"small",variant:"outlined",color:v.priority>=90?"error":v.priority>=70?"warning":"default",sx:{height:20,fontSize:"0.7rem"}})]},v.permissionId))})]},j))}):e.jsx(D,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic"},children:"No permissions assigned to this role."})]})})})]})}),e.jsxs(Dt,{children:[e.jsx(ut,{onClick:t,children:"Close"}),i&&e.jsx(ut,{variant:"outlined",startIcon:e.jsx(Sn,{}),onClick:()=>i(n),children:"Manage Users"}),s&&e.jsx(ut,{variant:"contained",startIcon:e.jsx(Tt,{}),onClick:()=>s(n),children:"Edit Role"})]})]})},HD=({open:r,onClose:t,role:n,onSave:s,isLoading:a=!1})=>{const[i,o]=p.useState([]),[d,u]=p.useState(!1),[h,m]=p.useState(""),[x,g]=p.useState([]),[f,y]=p.useState([]);p.useEffect(()=>{(async()=>{if(r){u(!0);try{const M=await Rc.getPermissionsByCategory();o(M)}catch(M){console.error("Error fetching permissions:",M),o([])}finally{u(!1)}}})()},[r]),p.useEffect(()=>{var T;n&&r&&g(((T=n.permissions)==null?void 0:T.map(M=>M.permissionId))||[])},[n,r]);const j=T=>{g(M=>M.includes(T)?M.filter(O=>O!==T):[...M,T])},b=T=>{y(M=>M.includes(T)?M.filter(O=>O!==T):[...M,T])},v=(T,M)=>{var z;const I=(((z=i==null?void 0:i.find(N=>N.name===T))==null?void 0:z.permissions)||[]).map(N=>N.permissionId);g(M?N=>[...N,...I.filter(E=>!N.includes(E))]:N=>N.filter(E=>!I.includes(E)))},P=T=>{if(T){const M=(i==null?void 0:i.flatMap(O=>O.permissions.map(I=>I.permissionId)))||[];g(M)}else g([])},w=()=>{if(x.length===0){alert("Please select at least one permission");return}s(x)},C=(i==null?void 0:i.filter(T=>h?T.permissions.some(M=>{var O;return M.name.toLowerCase().includes(h.toLowerCase())||M.displayName.toLowerCase().includes(h.toLowerCase())||((O=M.description)==null?void 0:O.toLowerCase().includes(h.toLowerCase()))}):!0))||[],k=T=>{const M=T.permissions.length,O=T.permissions.filter(I=>x.includes(I.permissionId)).length;return{total:M,selected:O}},A=(i==null?void 0:i.reduce((T,M)=>T+M.permissions.length,0))||0,L=x.length;return e.jsxs(kt,{open:r,onClose:t,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{maxHeight:"80vh"}},children:[e.jsx(Et,{sx:{pb:1},children:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Jt,{}),e.jsxs(D,{variant:"h6",children:["Manage Permissions - ",n==null?void 0:n.displayName]})]})}),e.jsx(Pt,{sx:{p:2},children:e.jsxs(l,{children:[e.jsx(l,{sx:{mb:2},children:e.jsx(Ae,{fullWidth:!0,size:"small",placeholder:"Search permissions...",value:h,onChange:T=>m(T.target.value),InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx($n,{fontSize:"small"})})}})}),e.jsx(l,{sx:{mb:2},children:e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[e.jsxs(D,{variant:"body2",color:"text.secondary",children:[L," of ",A," permissions selected"]}),e.jsxs(l,{sx:{display:"flex",gap:1},children:[e.jsx(he,{size:"small",variant:"outlined",onClick:()=>P(!0),disabled:a,forceTextOnly:!0,mobileText:"Select All",desktopText:"Select All",children:"Select All"}),e.jsx(he,{size:"small",variant:"outlined",onClick:()=>P(!1),disabled:a,forceTextOnly:!0,mobileText:"Clear All",desktopText:"Clear All",children:"Clear All"})]})]})}),d?e.jsx(l,{display:"flex",justifyContent:"center",p:2,children:e.jsx(Ce,{size:24})}):e.jsx(l,{sx:{maxHeight:"50vh",overflow:"auto"},children:C.map(T=>{const{total:M,selected:O}=k(T),I=f.includes(T.name),z=O===M,N=O>0&&O<M;return e.jsxs(Ll,{expanded:I,onChange:()=>b(T.name),sx:{mb:1,border:"1px solid",borderColor:"divider",borderRadius:2,"&:before":{display:"none"},"&.Mui-expanded":{borderColor:"primary.main",boxShadow:1},"&:hover":{borderColor:"primary.light",boxShadow:1}},children:[e.jsx(El,{expandIcon:e.jsx(ln,{}),sx:{py:.5,px:2,borderRadius:2,"&:hover":{backgroundColor:"action.hover"},"&.Mui-expanded":{backgroundColor:"primary.50"}},children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,width:"100%",children:[e.jsx(D,{variant:"subtitle2",sx:{flexGrow:1},children:T.displayName}),e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(ce,{label:`${O}/${M}`,size:"small",color:z?"primary":N?"warning":"default",sx:{height:20,fontSize:"0.7rem"}}),e.jsx(he,{size:"small",variant:"text",onClick:E=>{E.stopPropagation(),v(T.name,!z)},disabled:a,forceTextOnly:!0,mobileText:z?"Clear":"Select All",desktopText:z?"Clear":"Select All",sx:{minWidth:"auto",px:1},children:z?"Clear":"Select All"})]})]})}),e.jsx(Wl,{sx:{py:1,px:2,backgroundColor:"grey.50",borderTop:"1px solid",borderColor:"divider"},children:e.jsx(Kp,{children:T.permissions.map(E=>e.jsx(an,{control:e.jsx(rn,{size:"small",checked:x.includes(E.permissionId),onChange:()=>j(E.permissionId),disabled:a}),label:e.jsxs(l,{children:[e.jsx(D,{variant:"body2",fontWeight:"medium",children:E.displayName}),e.jsx(D,{variant:"caption",color:"text.secondary",children:E.name}),E.description&&e.jsx(D,{variant:"caption",color:"text.secondary",display:"block",children:E.description})]}),sx:{mb:.5,px:1,py:.5,borderRadius:1,"&:hover":{backgroundColor:"action.hover"},"&.Mui-checked":{backgroundColor:"primary.50"}}},E.permissionId))})})]},T.name)})}),C.length===0&&h&&e.jsxs(je,{severity:"info",children:['No permissions found matching "',h,'"']})]})}),e.jsxs(Dt,{sx:{p:2,pt:1},children:[e.jsx(he,{onClick:t,disabled:a,size:"small",variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{onClick:w,variant:"contained",size:"small",disabled:a||x.length===0,icon:a?e.jsx(Ce,{size:16}):void 0,forceTextOnly:!0,mobileText:a?"Saving...":`Save (${x.length})`,desktopText:a?"Saving...":`Save (${x.length})`,children:a?"Saving...":`Save (${x.length})`})]})]})};class ir{static async getUsers(t){return await q.get("/api/v1/users",{params:t})}static async getUser(t){return await q.get(`/api/v1/users/${t}`)}static async createUser(t){return await q.post("/api/v1/users",t)}static async updateUser(t,n){return await q.put(`/api/v1/users/${t}`,n)}static async searchUsers(t,n){return await q.get("/api/v1/users/search",{params:{query:t,...n}})}static async getUsersWithRole(t){return await q.get(`/api/v1/roles/${t}/users`)}static async assignUserToRole(t){return await q.post("/api/v1/users/roles",t)}static async removeUserFromRole(t){await q.delete(`/api/v1/users/roles/${t}`)}static async updateUserRole(t,n){return await q.put(`/api/v1/users/roles/${t}`,n)}static async getUserRoles(t){return await q.get(`/api/v1/users/${t}/roles`)}static async bulkAssignUsersToRole(t,n,s){return await q.post(`/api/v1/roles/${t}/users/bulk`,{userIds:n,expiresAt:s})}static async getAvailableUsersForRole(t,n){return await q.get(`/api/v1/roles/${t}/available-users`,{params:{search:n}})}static async getUserStats(){return await q.get("/api/v1/users/stats")}static async getRoleStats(t){return await q.get(`/api/v1/roles/${t}/stats`)}static async deleteUser(t){await q.delete(`/api/v1/users/${t}`)}}const Ix=r=>{const{data:t,isLoading:n,error:s,refetch:a}=yt({queryKey:["users",r],queryFn:()=>ir.getUsers(r),staleTime:3e5}),i=(m,x)=>ir.searchUsers(m,x),o=m=>ir.getUser(m),{data:d,isLoading:u,error:h}=yt({queryKey:["userStats"],queryFn:ir.getUserStats,staleTime:10*60*1e3});return{users:(t==null?void 0:t.users)||[],total:(t==null?void 0:t.total)||0,page:(t==null?void 0:t.page)||1,limit:(t==null?void 0:t.limit)||10,totalPages:(t==null?void 0:t.totalPages)||0,userStats:d,isLoading:n,isLoadingStats:u,error:s,statsError:h,hasError:!!(s||h),searchUsers:i,getUser:o,refetch:a}},BD=r=>{const t=Kt(),{data:n,isLoading:s,error:a,refetch:i}=yt({queryKey:["usersWithRole",r],queryFn:()=>ir.getUsersWithRole(r),enabled:!!r,staleTime:5*60*1e3}),{data:o,isLoading:d,error:u}=yt({queryKey:["roleStats",r],queryFn:()=>ir.getRoleStats(r),enabled:!!r,staleTime:5*60*1e3}),h=f=>ir.getAvailableUsersForRole(r,f),m=jt({mutationFn:({userIds:f,expiresAt:y})=>ir.bulkAssignUsersToRole(r,f,y),onSuccess:()=>{t.invalidateQueries({queryKey:["usersWithRole"]}),t.invalidateQueries({queryKey:["roleStats"]}),t.invalidateQueries({queryKey:["users"]})}}),x=jt({mutationFn:f=>ir.removeUserFromRole(f),onSuccess:()=>{t.invalidateQueries({queryKey:["usersWithRole"]}),t.invalidateQueries({queryKey:["roleStats"]})}}),g=jt({mutationFn:({userRoleId:f,updates:y})=>ir.updateUserRole(f,y),onSuccess:()=>{t.invalidateQueries({queryKey:["usersWithRole"]}),t.invalidateQueries({queryKey:["roleStats"]})}});return{usersWithRole:n||[],roleStats:o,isLoading:s,isLoadingStats:d,isBulkAssigning:m.isLoading,isRemoving:x.isLoading,isUpdating:g.isLoading,error:a,statsError:u,bulkAssignError:m.error,removeError:x.error,updateError:g.error,hasError:!!(a||u||m.error||x.error||g.error),getAvailableUsers:h,bulkAssignUsers:m.mutate,removeUserFromRole:x.mutate,updateUserRole:g.mutate,refetch:i}},UD=({open:r,onClose:t,role:n,onAssignUsers:s,isLoading:a=!1})=>{const[i,o]=p.useState(""),[d,u]=p.useState([]),[h,m]=p.useState(""),[x,g]=p.useState([]),[f,y]=p.useState(!1),{searchUsers:j}=Ix();p.useEffect(()=>{r&&n&&b()},[r,n]);const b=async()=>{y(!0);try{const T=await j(i||"",{isActive:!0});g(T.users)}catch(T){console.error("Error loading available users:",T),g([])}finally{y(!1)}};p.useEffect(()=>{if(r&&n){const T=setTimeout(()=>{b()},300);return()=>clearTimeout(T)}},[i,r,n]);const v=T=>{u(M=>M.includes(T)?M.filter(O=>O!==T):[...M,T])},P=()=>{const T=k.map(M=>M==null?void 0:M.userId);u(T)},w=()=>{u([])},C=()=>{if(d.length===0){alert("Please select at least one user");return}const T=h?new Date(h).toISOString():void 0;s(d,T),t()},k=x.filter(T=>{var O,I,z;if(!T)return!1;if(!i)return!0;const M=i.toLowerCase();return(T==null?void 0:T.email.toLowerCase().includes(M))||((O=T.displayName)==null?void 0:O.toLowerCase().includes(M))||((I=T.firstName)==null?void 0:I.toLowerCase().includes(M))||((z=T.lastName)==null?void 0:z.toLowerCase().includes(M))}),A=T=>{var M,O;if(T!=null&&T.firstName&&(T!=null&&T.lastName)&&((M=T==null?void 0:T.firstName)!=null&&M.trim())&&((O=T==null?void 0:T.lastName)!=null&&O.trim()))return`${T==null?void 0:T.firstName[0]}${T==null?void 0:T.lastName[0]}`.toUpperCase();if(T!=null&&T.displayName&&(T!=null&&T.displayName.trim())){const I=T==null?void 0:T.displayName.trim().split(" ");return I.length>=2?`${I[0][0]}${I[I.length-1][0]}`.toUpperCase():T==null?void 0:T.displayName[0].toUpperCase()}return T!=null&&T.email&&(T!=null&&T.email.trim())?T==null?void 0:T.email[0].toUpperCase():"U"},L=T=>new Date(T).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return e.jsxs(kt,{open:r,onClose:t,maxWidth:"lg",fullWidth:!0,children:[e.jsx(Et,{sx:{pb:1},children:e.jsxs(l,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Sn,{color:"primary"}),e.jsxs(D,{variant:"h6",children:["Assign Users to ",n==null?void 0:n.displayName]})]}),e.jsx(ce,{label:`${d.length} selected`,color:"primary",size:"small"})]})}),e.jsx(Pt,{sx:{p:2},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,md:4,children:e.jsxs(l,{children:[e.jsx(Ae,{label:"Search users",value:i,onChange:T=>o(T.target.value),fullWidth:!0,size:"small",sx:{mb:2},InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx($n,{fontSize:"small"})})},placeholder:"Search by name or email..."}),e.jsxs(l,{display:"flex",gap:1,mb:2,children:[e.jsx(he,{size:"small",onClick:P,variant:"outlined",children:"Select All"}),e.jsx(he,{size:"small",onClick:w,variant:"outlined",children:"Clear All"})]}),e.jsx(Ae,{label:"Expiration Date (Optional)",type:"datetime-local",value:h,onChange:T=>m(T.target.value),fullWidth:!0,size:"small",InputLabelProps:{shrink:!0},helperText:"Leave empty for no expiration"})]})}),e.jsx(W,{item:!0,xs:12,md:8,children:e.jsx(l,{sx:{height:500,border:1,borderColor:"divider",borderRadius:1},children:f?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",children:e.jsx(Ce,{})}):e.jsx(l,{sx:{height:"100%",overflow:"auto"},children:k.length===0?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",p:4,children:e.jsxs(D,{variant:"body2",color:"text.secondary",textAlign:"center",children:["No users found",e.jsx("br",{}),"Try adjusting your search criteria"]})}):e.jsxs(l,{sx:{p:1},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",p:1,borderBottom:1,borderColor:"divider",backgroundColor:"grey.50",fontWeight:600,fontSize:"0.875rem"},children:[e.jsx(l,{sx:{width:40,display:"flex",justifyContent:"center"},children:e.jsx(rn,{checked:k.length>0&&d.length===k.length,indeterminate:d.length>0&&d.length<k.length,onChange:d.length===k.length?w:P,size:"small"})}),e.jsx(l,{sx:{width:40,display:"flex",justifyContent:"center"},children:"Avatar"}),e.jsx(l,{sx:{flex:1,minWidth:0,px:1},children:"Name"}),e.jsx(l,{sx:{flex:1,minWidth:0,px:1},children:"Email"}),e.jsx(l,{sx:{width:80,px:1},children:"Status"}),e.jsx(l,{sx:{width:100,px:1},children:"Last Login"})]}),k.map(T=>e.jsxs(l,{sx:{display:"flex",alignItems:"center",p:1,borderBottom:1,borderColor:"divider",cursor:"pointer",backgroundColor:d.includes(T.userId)?"primary.50":"transparent","&:hover":{backgroundColor:d.includes(T.userId)?"primary.100":"action.hover"},transition:"all 0.2s"},onClick:()=>v(T.userId),children:[e.jsx(l,{sx:{width:40,display:"flex",justifyContent:"center"},children:e.jsx(rn,{checked:d.includes(T.userId),onChange:()=>v(T.userId),size:"small"})}),e.jsx(l,{sx:{width:40,display:"flex",justifyContent:"center"},children:e.jsx(Vt,{sx:{width:28,height:28},children:A(T)})}),e.jsx(l,{sx:{flex:1,minWidth:0,px:1},children:e.jsx(D,{variant:"body2",fontWeight:d.includes(T.userId)?600:400,noWrap:!0,children:(T==null?void 0:T.displayName)||(T==null?void 0:T.email)})}),e.jsx(l,{sx:{flex:1,minWidth:0,px:1},children:e.jsx(D,{variant:"body2",color:"text.secondary",noWrap:!0,children:T==null?void 0:T.email})}),e.jsx(l,{sx:{width:80,px:1},children:e.jsx(ce,{label:T!=null&&T.isActive?"Active":"Inactive",color:T!=null&&T.isActive?"success":"default",size:"small",sx:{height:20,fontSize:"0.7rem"}})}),e.jsx(l,{sx:{width:100,px:1},children:e.jsx(D,{variant:"caption",color:"text.secondary",children:T!=null&&T.lastLoginAt?L(T==null?void 0:T.lastLoginAt):"Never"})})]},T.userId))]})})})})]})}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:t,children:"Cancel"}),e.jsx(he,{variant:"contained",onClick:C,disabled:a||d.length===0,icon:a?e.jsx(Ce,{size:16}):void 0,mobileText:"Assign",desktopText:`Assign ${d.length} User${d.length!==1?"s":""}`,children:a?"Assigning...":`Assign ${d.length} User${d.length!==1?"s":""}`})]})]})},_D=({open:r,onClose:t,role:n})=>{const[s,a]=p.useState(""),[i,o]=p.useState("all"),[d,u]=p.useState(null),[h,m]=p.useState(null),[x,g]=p.useState(!1),{usersWithRole:f,roleStats:y,isLoading:j,isBulkAssigning:b,removeUserFromRole:v,updateUserRole:P,bulkAssignUsers:w}=BD(n==null?void 0:n.roleId),C=(V,F)=>{u(V.currentTarget),m(F)},k=()=>{u(null),m(null)},A=V=>{v(V),k()},L=(V,F)=>{P({userRoleId:V,updates:F}),k()},T=f.filter(V=>{var $,Y,_,K,X,ne;const F=!s||(($=V.email)==null?void 0:$.toLowerCase().includes(s.toLowerCase()))||((Y=V.displayName)==null?void 0:Y.toLowerCase().includes(s.toLowerCase()))||((_=V.fullName)==null?void 0:_.toLowerCase().includes(s.toLowerCase()))||((K=V.username)==null?void 0:K.toLowerCase().includes(s.toLowerCase()))||((X=V.firstName)==null?void 0:X.toLowerCase().includes(s.toLowerCase()))||((ne=V.lastName)==null?void 0:ne.toLowerCase().includes(s.toLowerCase())),B=i==="all"||i==="active"&&V.isActive&&!V.isExpired||i==="expired"&&V.isExpired||i==="inactive"&&!V.isActive;return F&&B}),M=V=>V.isActive||V.isValid?"success":V.isExpired?"warning":"error",O=V=>V.isActive||V.isValid?"Active":V.isExpired?"Expired":"Inactive",I=V=>new Date(V).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),z=V=>{if(V!=null&&V.firstName&&(V!=null&&V.lastName)&&(V!=null&&V.firstName.trim())&&(V!=null&&V.lastName.trim()))return`${V==null?void 0:V.firstName[0]}${V==null?void 0:V.lastName[0]}`.toUpperCase();const F=(V==null?void 0:V.displayName)||(V==null?void 0:V.fullName);if(F&&F.trim()){const B=F.trim().split(" ");return B.length>=2?`${B[0][0]}${B[B.length-1][0]}`.toUpperCase():F[0].toUpperCase()}return V!=null&&V.username&&(V!=null&&V.username.trim())?V.username[0].toUpperCase():V!=null&&V.email&&(V!=null&&V.email.trim())?V.email[0].toUpperCase():"U"},N=(y==null?void 0:y.activeUsers)||0,E=(y==null?void 0:y.expiredUsers)||0,R=(y==null?void 0:y.inactiveUsers)||0;return e.jsxs(kt,{open:r,onClose:t,maxWidth:"lg",fullWidth:!0,children:[e.jsx(Et,{children:e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Sn,{color:"primary"}),e.jsxs(D,{variant:"h6",children:["Manage Users - ",n==null?void 0:n.displayName]})]}),e.jsxs(l,{display:"flex",gap:1,children:[e.jsx(ut,{size:"small",startIcon:e.jsx(ia,{}),onClick:()=>g(!0),children:"Add User"}),e.jsx(Ie,{size:"small",children:e.jsx(Mt,{})})]})]})}),e.jsxs(Pt,{children:[e.jsxs(W,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Xe,{color:"success"}),e.jsx(D,{variant:"h6",children:N})]}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Active Users"})]})})}),e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(zs,{color:"warning"}),e.jsx(D,{variant:"h6",children:E})]}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Expired Users"})]})})}),e.jsx(W,{item:!0,xs:12,sm:4,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(rl,{color:"error"}),e.jsx(D,{variant:"h6",children:R})]}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Inactive Users"})]})})})]}),e.jsxs(l,{display:"flex",gap:2,mb:2,children:[e.jsx(Ae,{label:"Search users",value:s,onChange:V=>a(V.target.value),size:"small",sx:{flexGrow:1},InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx($n,{})})},placeholder:"Search by name or email..."}),e.jsxs(Ae,{select:!0,label:"Filter",value:i,onChange:V=>o(V.target.value),size:"small",sx:{minWidth:120},children:[e.jsx(re,{value:"all",children:"All Users"}),e.jsx(re,{value:"active",children:"Active"}),e.jsx(re,{value:"expired",children:"Expired"}),e.jsx(re,{value:"inactive",children:"Inactive"})]})]}),e.jsx(at,{component:Te,children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:"User"}),e.jsx(S,{children:"Status"}),e.jsx(S,{children:"Assigned Date"}),e.jsx(S,{children:"Expires"}),e.jsx(S,{children:"Last Login"}),e.jsx(S,{align:"right",children:"Actions"})]})}),e.jsx(ot,{children:j?e.jsx(De,{children:e.jsx(S,{colSpan:6,align:"center",children:e.jsx(Ce,{})})}):T.length===0?e.jsx(De,{children:e.jsx(S,{colSpan:6,align:"center",children:e.jsx(D,{variant:"body2",color:"text.secondary",children:"No users found"})})}):T.map(V=>e.jsxs(De,{children:[e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Vt,{sx:{width:32,height:32},children:z(V)}),e.jsxs(l,{children:[e.jsx(D,{variant:"body2",fontWeight:"medium",children:V.displayName||V.fullName||V.username}),e.jsx(D,{variant:"caption",color:"text.secondary",children:V.email||V.username})]})]})}),e.jsx(S,{children:e.jsx(ce,{label:O(V),color:M(V),size:"small"})}),e.jsx(S,{children:e.jsx(D,{variant:"body2",children:I(V==null?void 0:V.assignedAt)})}),e.jsx(S,{children:V.expiresAt?e.jsx(D,{variant:"body2",children:I(V.expiresAt)}):e.jsx(D,{variant:"body2",color:"text.secondary",children:"Never"})}),e.jsx(S,{children:V.lastLoginAt?e.jsx(D,{variant:"body2",children:I(V.lastLoginAt)}):e.jsx(D,{variant:"body2",color:"text.secondary",children:"Never"})}),e.jsx(S,{align:"right",children:e.jsx(Ie,{size:"small",onClick:F=>C(F,V),children:e.jsx(wr,{})})})]},V.userRoleId))})]})}),e.jsxs(Gn,{anchorEl:d,open:!!d,onClose:k,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[e.jsxs(re,{onClick:()=>L(h.userRoleId,{isActive:!h.isActive}),children:[e.jsx(tt,{children:h!=null&&h.isActive?e.jsx(rl,{}):e.jsx(ia,{})}),e.jsx(ve,{children:h!=null&&h.isActive?"Deactivate":"Activate"})]}),e.jsxs(re,{onClick:()=>L(h.userRoleId,{expiresAt:null}),children:[e.jsx(tt,{children:e.jsx(Rr,{})}),e.jsx(ve,{children:"Remove Expiration"})]}),e.jsx(bt,{}),e.jsxs(re,{onClick:()=>A(h.userRoleId),sx:{color:"error.main"},children:[e.jsx(tt,{children:e.jsx(rl,{color:"error"})}),e.jsx(ve,{children:"Remove from Role"})]})]})]}),e.jsxs(Dt,{children:[e.jsx(ut,{onClick:t,children:"Close"}),e.jsx(ut,{variant:"contained",startIcon:e.jsx(ia,{}),onClick:()=>g(!0),children:"Add Multiple Users"})]}),e.jsx(UD,{open:x,onClose:()=>g(!1),role:n,onAssignUsers:(V,F)=>{n&&(w({userIds:V,expiresAt:F}),g(!1))},isLoading:b})]})},Rx=r=>{const{currentAccount:t}=Ge(),n=r||(t==null?void 0:t.accountId),{data:s,isLoading:a,error:i,refetch:o}=yt({queryKey:["userPermissions",n],queryFn:()=>qa.getUserPermissions(n),enabled:!!n,staleTime:5*60*1e3}),{data:d,isLoading:u,error:h,refetch:m}=yt({queryKey:["userRoles",n],queryFn:()=>qa.getUserRoles(n),enabled:!!n,staleTime:5*60*1e3}),x=p.useCallback(k=>s?s.permissions.includes(k):!1,[s]),g=p.useCallback(k=>s?k.some(A=>s.permissions.includes(A)):!1,[s]),f=p.useCallback(k=>s?k.every(A=>s.permissions.includes(A)):!1,[s]),y=p.useCallback(k=>d?d.some(A=>A.roleName===k&&A.isValid):!1,[d]),j=p.useCallback(k=>d?k.some(A=>d.some(L=>L.roleName===A&&L.isValid)):!1,[d]),b=p.useCallback(k=>s?s.permissionsByCategory[k]||[]:[],[s]),v=p.useCallback(()=>s?Object.keys(s.permissionsByCategory):[],[s]),P=jt({mutationFn:({userId:k,roleId:A})=>qa.assignRoleToUser(k,{roleId:A}),onSuccess:()=>{m(),o()}}),w=jt({mutationFn:k=>{const A=d==null?void 0:d.find(L=>L.userRoleId===k);if(!A||!n)throw new Error("User role not found");return qa.removeRoleFromUser(n,A.roleId)},onSuccess:()=>{m(),o()}}),C=p.useCallback(()=>{o(),m()},[o,m]);return{userPermissions:s,userRoles:d,isLoadingPermissions:a,isLoadingRoles:u,isLoading:a||u,permissionsError:i,rolesError:h,error:i||h,hasPermission:x,hasAnyPermission:g,hasAllPermissions:f,hasRole:y,hasAnyRole:j,getPermissionsByCategory:b,getPermissionCategories:v,refresh:C,refetchPermissions:o,refetchRoles:m,assignRole:P.mutateAsync,removeRole:w.mutateAsync,isAssigning:P.isLoading,isRemoving:w.isLoading}},YD=({open:r,onClose:t,user:n})=>{var O;const{roles:s=[],isLoading:a}=Qo(),{userRoles:i=[],isLoading:o,assignRole:d,removeRole:u,isAssigning:h,isRemoving:m}=Rx(n==null?void 0:n.userId),[x,g]=p.useState(""),[f,y]=p.useState(!1),[j,b]=p.useState(""),v=async I=>{if(n)try{await d({userId:n.userId,roleId:I.roleId}),b(`Role "${I.displayName}" assigned successfully`),y(!0)}catch(z){console.error("Error assigning role:",z),b("Failed to assign role"),y(!0)}},P=async I=>{try{await u(I),b("Role removed successfully"),y(!0)}catch(z){console.error("Error removing role:",z),b("Failed to remove role"),y(!0)}},w=I=>I.displayName.split(" ").map(z=>z.charAt(0)).join("").toUpperCase().slice(0,2),C=I=>I.isActive?I.isExpired?"error":I.isValid?"success":"warning":"default",k=I=>I.isActive?I.isExpired?"Expired":I.isValid?"Active":"Pending":"Inactive",A=I=>new Date(I).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T=s.filter(I=>{var N;if(!x)return!0;const z=x.toLowerCase();return I.name.toLowerCase().includes(z)||I.displayName.toLowerCase().includes(z)||((N=I.description)==null?void 0:N.toLowerCase().includes(z))}).filter(I=>!i.some(z=>z.roleId===I.roleId)),M=i.map(I=>{const z=s.find(N=>N.roleId===I.roleId);return{...I,role:z}}).filter(I=>I.role);return n?e.jsxs(kt,{open:r,onClose:t,maxWidth:"lg",fullWidth:!0,PaperProps:{sx:{minHeight:"80vh"}},children:[e.jsx(Et,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Vt,{sx:{width:40,height:40},children:((O=n.displayName)==null?void 0:O.charAt(0))||n.email.charAt(0)}),e.jsxs(l,{children:[e.jsxs(D,{variant:"h6",children:["Manage Roles - ",n.displayName||n.email]}),e.jsx(D,{variant:"body2",color:"text.secondary",children:n.email})]})]})}),e.jsx(Pt,{children:e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:e.jsxs(D,{variant:"h6",children:["Assigned Roles (",M.length,")"]})}),o?e.jsx(l,{display:"flex",justifyContent:"center",p:3,children:e.jsx(Ce,{})}):M.length===0?e.jsx(je,{severity:"info",children:"No roles assigned to this user"}):e.jsx(at,{component:Te,variant:"outlined",children:e.jsxs(it,{size:"small",children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:"Role"}),e.jsx(S,{children:"Status"}),e.jsx(S,{children:"Assigned"}),e.jsx(S,{align:"right",children:"Actions"})]})}),e.jsx(ot,{children:M.map(I=>e.jsxs(De,{children:[e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Vt,{sx:{width:24,height:24},children:w(I.role)}),e.jsxs(l,{children:[e.jsx(D,{variant:"body2",fontWeight:"medium",children:I.role.displayName}),e.jsx(D,{variant:"caption",color:"text.secondary",children:I.role.name})]})]})}),e.jsx(S,{children:e.jsx(ce,{label:k(I),color:C(I),size:"small"})}),e.jsx(S,{children:e.jsx(D,{variant:"body2",color:"text.secondary",children:A(I.assignedAt)})}),e.jsx(S,{align:"right",children:e.jsx(Ie,{size:"small",onClick:()=>P(I.userRoleId),disabled:m,color:"error",children:e.jsx(ja,{})})})]},I.userRoleId))})]})})]})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:e.jsxs(D,{variant:"h6",children:["Available Roles (",T.length,")"]})}),e.jsx(Ae,{fullWidth:!0,placeholder:"Search roles...",value:x,onChange:I=>g(I.target.value),size:"small",InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx($n,{})})},sx:{mb:2}}),a?e.jsx(l,{display:"flex",justifyContent:"center",p:3,children:e.jsx(Ce,{})}):T.length===0?e.jsx(je,{severity:"info",children:x?"No roles found matching your search":"All roles are already assigned"}):e.jsx(at,{component:Te,variant:"outlined",children:e.jsxs(it,{size:"small",children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:"Role"}),e.jsx(S,{children:"Type"}),e.jsx(S,{align:"right",children:"Actions"})]})}),e.jsx(ot,{children:T.map(I=>e.jsxs(De,{children:[e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Vt,{sx:{width:24,height:24},children:w(I)}),e.jsxs(l,{children:[e.jsx(D,{variant:"body2",fontWeight:"medium",children:I.displayName}),e.jsx(D,{variant:"caption",color:"text.secondary",children:I.name})]})]})}),e.jsx(S,{children:e.jsx(ce,{label:I.isSystemRole?"System":"Custom",color:I.isSystemRole?"primary":"default",size:"small"})}),e.jsx(S,{align:"right",children:e.jsx(Ie,{size:"small",onClick:()=>v(I),disabled:h,color:"primary",children:e.jsx(xt,{})})})]},I.roleId))})]})})]})})})]})}),e.jsx(Dt,{children:e.jsx(ut,{onClick:t,children:"Close"})}),e.jsx(di,{open:f,autoHideDuration:6e3,onClose:()=>y(!1),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(je,{onClose:()=>y(!1),severity:"success",sx:{width:"100%"},children:j})})]}):null},qD=({open:r,onClose:t,user:n,onConfirm:s,isLoading:a=!1,error:i})=>{if(!n)return null;const o=()=>{s(n)};return e.jsxs(kt,{open:r,onClose:t,maxWidth:"sm",fullWidth:!0,children:[e.jsx(Et,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(on,{color:"error"}),e.jsx(D,{variant:"h6",children:"Delete User"})]})}),e.jsxs(Pt,{children:[!!i&&e.jsx(je,{severity:"error",sx:{mb:2},children:i}),e.jsx(D,{variant:"body1",gutterBottom:!0,children:"Are you sure you want to delete this user? This action cannot be undone."}),e.jsxs(l,{sx:{mt:2,p:2,backgroundColor:"grey.50",borderRadius:1},children:[e.jsx(D,{variant:"subtitle2",gutterBottom:!0,children:"User Information:"}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Name:"})," ",n.displayName||n.email]}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Email:"})," ",n.email]}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Status:"})," ",n.isActive?"Active":"Inactive"]})]}),e.jsxs(je,{severity:"warning",sx:{mt:2},children:[e.jsxs(D,{variant:"body2",children:[e.jsx("strong",{children:"Warning:"})," Deleting this user will:"]}),e.jsxs("ul",{style:{margin:"8px 0",paddingLeft:"20px"},children:[e.jsx("li",{children:"Remove all role assignments"}),e.jsx("li",{children:"Delete user data permanently"}),e.jsx("li",{children:"Cannot be undone"})]})]})]}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:t,disabled:a,variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{onClick:o,variant:"contained",color:"error",disabled:a,icon:a?e.jsx(Ce,{size:16}):void 0,forceTextOnly:!0,mobileText:a?"Deleting...":"Delete",desktopText:a?"Deleting...":"Delete User",children:a?"Deleting...":"Delete User"})]})]})},GD=({onEditUser:r,onViewUser:t,onDeleteUser:n,onManageRoles:s,page:a=0,rowsPerPage:i=10,total:o=0,onPageChange:d,onRowsPerPageChange:u,users:h=[],isLoading:m=!1,error:x=null,refetch:g=()=>{}})=>{const[f,y]=p.useState(""),[j,b]=p.useState(null),[v,P]=p.useState(null),[w,C]=p.useState(!1),[k,A]=p.useState(!1),[L,T]=p.useState(null),M=(X,ne)=>{b(X.currentTarget),P(ne)},O=()=>{b(null),P(null)},I=()=>{b(null),P(null),setTimeout(()=>{const X=document.activeElement;X&&X.blur&&X.blur()},100)},z=()=>{v&&r&&r(v),I()},N=()=>{v&&t&&t(v),I()},E=()=>{v&&(C(!0),b(null))},R=async X=>{A(!0),T(null);try{n&&(await n(X),Yt.success(`User "${X.displayName||X.email}" deleted successfully`),C(!1),P(null),g())}catch(ne){const oe=ne instanceof Error?ne.message:"Failed to delete user";T(oe),Yt.error(oe)}finally{A(!1)}},V=()=>{C(!1),T(null),setTimeout(()=>{P(null)},100)},F=()=>{v&&s&&s(v),I()},B=X=>X.displayName?X.displayName.split(" ").map(ne=>ne.charAt(0)).join("").toUpperCase().slice(0,2):X.firstName&&X.lastName?`${X.firstName.charAt(0)}${X.lastName.charAt(0)}`.toUpperCase():X.email?X.email.charAt(0).toUpperCase():"U",$=X=>X.isActive?X.isEmailVerified?"success":"warning":"default",Y=X=>X.isActive?X.isEmailVerified?"Active":"Unverified":"Inactive",_=X=>new Date(X).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),K=h.filter(X=>{var oe,ee,H;if(!f)return!0;const ne=f.toLowerCase();return X.email.toLowerCase().includes(ne)||((oe=X.displayName)==null?void 0:oe.toLowerCase().includes(ne))||((ee=X.firstName)==null?void 0:ee.toLowerCase().includes(ne))||((H=X.lastName)==null?void 0:H.toLowerCase().includes(ne))});return m?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",p:4,children:e.jsx(Ce,{})}):x?e.jsxs(je,{severity:"error",children:["Error loading users: ",x instanceof Error?x.message:"Unknown error"]}):e.jsxs(l,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(l,{display:"flex",gap:2,alignItems:"center",children:[e.jsx(Ae,{placeholder:"Search users...",value:f,onChange:X=>y(X.target.value),size:"small",InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx($n,{})})},sx:{minWidth:300}}),e.jsx(ut,{variant:"outlined",size:"small",startIcon:e.jsx(Ir,{}),children:"Filters"})]}),e.jsx(l,{display:"flex",gap:1,children:e.jsx(ut,{variant:"outlined",size:"small",startIcon:e.jsx(Mt,{}),onClick:()=>g(),children:"Refresh"})})]}),e.jsx(at,{component:Te,children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:"User"}),e.jsx(S,{children:"Email"}),e.jsx(S,{children:"Status"}),e.jsx(S,{children:"Last Login"}),e.jsx(S,{children:"Created"}),e.jsx(S,{align:"right",children:"Actions"})]})}),e.jsx(ot,{children:K.map(X=>e.jsxs(De,{hover:!0,onClick:()=>t==null?void 0:t(X),sx:{cursor:"pointer"},children:[e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Vt,{sx:{width:32,height:32},children:B(X)}),e.jsxs(l,{children:[e.jsx(D,{variant:"body2",fontWeight:"medium",children:X.displayName||X.email}),e.jsx(D,{variant:"caption",color:"text.secondary",children:X.firstName&&X.lastName?`${X.firstName} ${X.lastName}`:X.email})]})]})}),e.jsx(S,{children:e.jsx(D,{variant:"body2",children:X.email})}),e.jsx(S,{children:e.jsx(ce,{label:Y(X),color:$(X),size:"small"})}),e.jsx(S,{children:e.jsx(D,{variant:"body2",color:"text.secondary",children:X.lastLoginAt?_(X.lastLoginAt):"Never"})}),e.jsx(S,{children:e.jsx(D,{variant:"body2",color:"text.secondary",children:_(X.createdAt)})}),e.jsx(S,{align:"right",children:e.jsx(Ie,{size:"small",onClick:ne=>{ne.stopPropagation(),M(ne,X)},"aria-label":`Actions for ${X.displayName||X.email}`,"aria-haspopup":"menu","aria-expanded":!!j,id:`user-actions-${X.userId}`,children:e.jsx(wr,{})})})]},X.userId))})]})}),e.jsx(hi,{rowsPerPageOptions:[5,10,25,50],component:"div",count:o||(h==null?void 0:h.length)||0,rowsPerPage:i,page:a,onPageChange:d||(()=>{}),onRowsPerPageChange:u||(()=>{})}),K.length===0&&e.jsxs(l,{display:"flex",flexDirection:"column",alignItems:"center",p:4,children:[e.jsx(Sn,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(D,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No users found"}),e.jsx(D,{variant:"body2",color:"text.secondary",children:f?"Try adjusting your search criteria":"No users in the system"})]}),e.jsxs(Gn,{anchorEl:j,open:!!j,onClose:O,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},MenuListProps:{"aria-labelledby":v?`user-actions-${v.userId}`:void 0,role:"menu"},slotProps:{paper:{"aria-hidden":!1}},disableAutoFocusItem:!0,keepMounted:!1,children:[e.jsxs(re,{onClick:N,children:[e.jsx(Xt,{sx:{mr:1}}),"View Details"]}),e.jsxs(re,{onClick:z,children:[e.jsx(Tt,{sx:{mr:1}}),"Edit User"]}),e.jsxs(re,{onClick:F,children:[e.jsx(Jt,{sx:{mr:1}}),"Manage Roles"]}),e.jsxs(re,{onClick:E,sx:{color:"error.main"},children:[e.jsx(pt,{sx:{mr:1}}),"Delete User"]})]}),e.jsx(qD,{open:w,onClose:V,user:v,onConfirm:R,isLoading:k,error:L})]})},KD=({open:r,onClose:t,user:n,onEdit:s,onManageRoles:a})=>{const{userRoles:i=[],isLoading:o}=Rx(n==null?void 0:n.userId);if(!n)return null;const d=y=>y.displayName?y.displayName.split(" ").map(j=>j.charAt(0)).join("").toUpperCase().slice(0,2):y.firstName&&y.lastName?`${y.firstName.charAt(0)}${y.lastName.charAt(0)}`.toUpperCase():y.email?y.email.charAt(0).toUpperCase():"U",u=y=>y.isActive?y.isEmailVerified?"success":"warning":"default",h=y=>y.isActive?y.isEmailVerified?"Active":"Unverified":"Inactive",m=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),x=y=>y.isActive?y.isExpired?"error":y.isValid?"success":"warning":"default",g=y=>y.isActive?y.isExpired?"Expired":y.isValid?"Active":"Pending":"Inactive",f=y=>y.isActive?y.isExpired?e.jsx(Zn,{}):y.isValid?e.jsx(Xe,{}):e.jsx(Zn,{}):e.jsx(zs,{});return e.jsxs(kt,{open:r,onClose:t,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:"70vh"}},children:[e.jsx(Et,{children:e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(Vt,{sx:{width:40,height:40},children:d(n)}),e.jsxs(l,{children:[e.jsx(D,{variant:"h6",children:n.displayName||n.email}),e.jsx(D,{variant:"body2",color:"text.secondary",children:n.email})]})]}),e.jsx(Ie,{onClick:t,size:"small",children:e.jsx(sr,{})})]})}),e.jsx(Pt,{sx:{p:2},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{children:e.jsx(me,{sx:{p:2},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(D,{variant:"subtitle1",gutterBottom:!0,children:"Basic Information"}),e.jsxs(l,{display:"flex",flexDirection:"column",gap:1.5,children:[e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Display Name"}),e.jsx(D,{variant:"body2",fontWeight:"medium",children:n.displayName||"Not set"})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Email"}),e.jsx(D,{variant:"body2",children:n.email})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Name"}),e.jsx(D,{variant:"body2",children:n.firstName&&n.lastName?`${n.firstName} ${n.lastName}`:n.firstName||n.lastName||"Not set"})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Status"}),e.jsx(l,{display:"flex",gap:1,mt:.5,children:e.jsx(ce,{label:h(n),color:u(n),size:"small",sx:{height:20,fontSize:"0.7rem"}})})]})]})]}),e.jsxs(W,{item:!0,xs:12,md:6,children:[e.jsx(D,{variant:"subtitle1",gutterBottom:!0,children:"Account Information"}),e.jsxs(l,{display:"flex",flexDirection:"column",gap:1.5,children:[e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Email Verified"}),e.jsx(l,{display:"flex",gap:1,mt:.5,children:e.jsx(ce,{label:n.isEmailVerified?"Verified":"Unverified",color:n.isEmailVerified?"success":"warning",size:"small",sx:{height:20,fontSize:"0.7rem"}})})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Account Status"}),e.jsx(l,{display:"flex",gap:1,mt:.5,children:e.jsx(ce,{label:n.isActive?"Active":"Inactive",color:n.isActive?"success":"default",size:"small",sx:{height:20,fontSize:"0.7rem"}})})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Created At"}),e.jsx(D,{variant:"body2",children:m(n.createdAt)})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Last Updated"}),e.jsx(D,{variant:"body2",children:m(n.updatedAt)})]}),e.jsxs(l,{children:[e.jsx(D,{variant:"caption",color:"text.secondary",children:"Last Login"}),e.jsx(D,{variant:"body2",children:n.lastLoginAt?m(n.lastLoginAt):"Never"})]})]})]})]})})})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{children:e.jsxs(me,{sx:{p:2},children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(D,{variant:"subtitle1",children:["Assigned Roles (",i.length,")"]}),a&&e.jsx(ut,{variant:"outlined",size:"small",startIcon:e.jsx(Jt,{}),onClick:()=>a(n),children:"Manage Roles"})]}),o?e.jsx(l,{display:"flex",justifyContent:"center",p:2,children:e.jsx(Ce,{size:24})}):i.length===0?e.jsx(je,{severity:"info",sx:{py:1},children:"No roles assigned to this user"}):e.jsx(lt,{dense:!0,children:i.map(y=>e.jsxs(Pe,{sx:{py:.5,px:0},children:[e.jsx(tt,{sx:{minWidth:32},children:f(y)}),e.jsx(ve,{primary:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(D,{variant:"body2",fontWeight:"medium",children:y.roleName||y.roleDisplayName}),e.jsx(ce,{label:g(y),color:x(y),size:"small",sx:{height:20,fontSize:"0.7rem"}})]}),secondary:e.jsxs(l,{children:[e.jsxs(D,{variant:"caption",color:"text.secondary",children:["Assigned: ",m(y.assignedAt)]}),y.expiresAt&&e.jsxs(D,{variant:"caption",color:"text.secondary",display:"block",children:["Expires: ",m(y.expiresAt)]})]})})]},y.userRoleId))})]})})})]})}),e.jsxs(Dt,{children:[e.jsx(ut,{onClick:t,children:"Close"}),s&&e.jsx(ut,{variant:"contained",startIcon:e.jsx(Tt,{}),onClick:()=>s(n),children:"Edit User"})]})]})},QD=({open:r,onClose:t,user:n,mode:s,onSubmit:a,isLoading:i=!1,error:o})=>{const[d,u]=p.useState({email:"",firstName:"",lastName:"",displayName:"",isActive:!0,isEmailVerified:!1}),[h,m]=p.useState({});p.useEffect(()=>{u(n&&s==="edit"?{email:n.email||"",firstName:n.firstName||"",lastName:n.lastName||"",displayName:n.displayName||"",isActive:n.isActive,isEmailVerified:n.isEmailVerified}:{email:"",firstName:"",lastName:"",displayName:"",isActive:!0,isEmailVerified:!1})},[n,s,r]);const x=b=>v=>{const P=v.target.value;u(w=>({...w,[b]:P})),h[b]&&m(w=>({...w,[b]:""}))},g=b=>v=>{u(P=>({...P,[b]:v.target.checked}))},f=()=>{const b={};return d.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)||(b.email="Please enter a valid email address"):b.email="Email is required",d.firstName&&d.firstName.trim().length<2&&(b.firstName="First name must be at least 2 characters"),d.lastName&&d.lastName.trim().length<2&&(b.lastName="Last name must be at least 2 characters"),d.displayName&&d.displayName.trim().length<2&&(b.displayName="Display name must be at least 2 characters"),m(b),Object.keys(b).length===0},y=()=>{if(!f())return;const b={email:d.email.trim(),firstName:d.firstName.trim()||void 0,lastName:d.lastName.trim()||void 0,displayName:d.displayName.trim()||void 0,isActive:d.isActive,isEmailVerified:d.isEmailVerified};a(b)},j=()=>{i||(u({email:"",firstName:"",lastName:"",displayName:"",isActive:!0,isEmailVerified:!1}),m({}),t())};return e.jsxs(kt,{open:r,onClose:j,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{minHeight:"60vh"}},children:[e.jsx(Et,{children:s==="create"?"Create New User":"Edit User"}),e.jsxs(Pt,{sx:{p:3},children:[!!o&&e.jsx(je,{severity:"error",sx:{mb:2},children:o}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Te,{sx:{p:2},children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Basic Information"}),e.jsxs(l,{display:"flex",flexDirection:"column",gap:2,children:[e.jsx(Ae,{label:"Email",value:d.email,onChange:x("email"),error:!!h.email,helperText:h.email,disabled:i,fullWidth:!0,required:!0}),e.jsx(Ae,{label:"First Name",value:d.firstName,onChange:x("firstName"),error:!!h.firstName,helperText:h.firstName,disabled:i,fullWidth:!0}),e.jsx(Ae,{label:"Last Name",value:d.lastName,onChange:x("lastName"),error:!!h.lastName,helperText:h.lastName,disabled:i,fullWidth:!0}),e.jsx(Ae,{label:"Display Name",value:d.displayName,onChange:x("displayName"),error:!!h.displayName,helperText:h.displayName,disabled:i,fullWidth:!0})]})]})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsxs(Te,{sx:{p:2},children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Account Settings"}),e.jsxs(l,{display:"flex",flexDirection:"column",gap:2,children:[e.jsx(an,{control:e.jsx(jn,{checked:d.isActive,onChange:g("isActive"),disabled:i}),label:"Active Account"}),e.jsx(an,{control:e.jsx(jn,{checked:d.isEmailVerified,onChange:g("isEmailVerified"),disabled:i}),label:"Email Verified"})]})]})}),s==="create"&&e.jsx(W,{item:!0,xs:12,children:e.jsxs(Te,{sx:{p:2,backgroundColor:"primary.50",border:"1px solid",borderColor:"primary.200",borderRadius:2},children:[e.jsx(D,{variant:"h6",gutterBottom:!0,sx:{color:"primary.800"},children:"Auto Role Assignment"}),e.jsx(D,{variant:"body2",gutterBottom:!0,sx:{color:"text.secondary"},children:'This user will automatically be assigned the "Investor" role based on the current system configuration.'}),e.jsx(D,{variant:"caption",display:"block",sx:{color:"text.secondary"},children:"You can change the assigned role after creating the user."})]})})]})]}),e.jsxs(Dt,{sx:{p:3},children:[e.jsx(he,{onClick:j,disabled:i,variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{onClick:y,variant:"contained",disabled:i,icon:i?e.jsx(Ce,{size:16}):void 0,forceTextOnly:!0,mobileText:i?s==="create"?"Creating...":"Updating...":s==="create"?"Create User":"Update User",desktopText:i?s==="create"?"Creating...":"Updating...":s==="create"?"Create User":"Update User",children:i?s==="create"?"Creating...":"Updating...":s==="create"?"Create User":"Update User"})]})]})};class zi{static async getSettings(){return(await q.get("/api/v1/settings")).data}static async updateSettings(t){return await q.put("/api/v1/settings",t)}static async getAutoRoleAssignmentConfig(){return await q.get("/api/v1/settings/auto-role-assignment")}static async updateAutoRoleAssignmentConfig(t){return await q.put("/api/v1/settings/auto-role-assignment",t)}static async testAutoRoleAssignment(t){return await q.post("/api/v1/settings/auto-role-assignment/test",t)}static async getSystemStats(){return await q.get("/api/v1/settings/stats")}static async executeBulkAction(t){return await q.post("/api/v1/settings/bulk-actions",{action:t})}static async exportData(t){return await q.get(`/api/v1/settings/export?format=${t}`,{responseType:"blob"})}static async createBackup(){return await q.post("/api/v1/settings/backup")}static async runSecurityAudit(){return await q.post("/api/v1/settings/security-audit")}static async cleanupExpiredRoles(){return await q.post("/api/v1/settings/cleanup-expired-roles")}static async getDemoAccountStatus(){const t=await q.get("/api/v1/settings/demo-account"),n=t.data||t;return!n||typeof n.enabled!="boolean"?{enabled:!1}:n}static async toggleDemoAccount(t){const n=await q.post("/api/v1/settings/demo-account/toggle",{enabled:t}),s=n.data||n;if(!s||typeof s.enabled!="boolean")throw new Error("Invalid response format from server");return s}}const XD=()=>{const{roles:r,isLoading:t}=Qo(),{userPermissions:n,isLoading:s}=Zr(),[a,i]=p.useState(!0),[o,d]=p.useState(!0),[u,h]=p.useState(!0),[m,x]=p.useState("investor"),[g,f]=p.useState(30),[y,j]=p.useState(5),[b,v]=p.useState(90),[P,w]=p.useState(!1),[C,k]=p.useState({}),[A,L]=p.useState(!0),[T,M]=p.useState(null),[O,I]=p.useState(!1),[z,N]=p.useState(!1),[E,R]=p.useState(!1),[V,F]=p.useState(""),[B,$]=p.useState(""),[Y,_]=p.useState(""),[K,X]=p.useState(!1),[ne,oe]=p.useState(null),[ee,H]=p.useState(!1);p.useEffect(()=>{(async()=>{try{L(!0),M(null);const[le,pe]=await Promise.all([zi.getSettings(),zi.getDemoAccountStatus().catch(()=>({enabled:!1}))]);le&&(i(le.roleHierarchyEnabled??!0),d(le.permissionInheritance??!0),h(le.autoRoleAssignment??!0),x(le.defaultRoleForNewUsers??"viewer"),f(le.sessionTimeout??30),j(le.maxLoginAttempts??5),v(le.passwordExpiry??90)),pe&&(w(pe.enabled),pe.enabled&&"accountId"in pe?k({accountId:pe.accountId,accountName:pe.accountName}):k({}))}catch(le){console.error("Error loading settings:",le),M(le instanceof Error?le.message:"Failed to load settings"),Yt.error("Failed to load settings from server")}finally{L(!1)}})()},[]);const Q=async()=>{X(!0),oe(null),H(!1);try{const ue={roleHierarchyEnabled:a,permissionInheritance:o,autoRoleAssignment:u,defaultRoleForNewUsers:m,sessionTimeout:g,maxLoginAttempts:y,passwordExpiry:b},le=await zi.updateSettings(ue);le.success?(H(!0),Yt.success(`Settings saved successfully! New users will automatically be assigned the "${m}" role.`),setTimeout(()=>H(!1),3e3)):(oe(le.message||"Failed to save settings"),Yt.error(le.message||"Failed to save settings"))}catch(ue){console.error("Error saving settings:",ue);const le=ue instanceof Error?ue.message:"Failed to save settings";oe(le),Yt.error(le)}finally{X(!1)}},Z=()=>{Yt.success(`Role "${V}" created successfully!`),I(!1),F("")},J=()=>{Yt.success(`Permission "${B}" created successfully!`),N(!1),$("")},ae=()=>{Yt.info(`Bulk action "${Y}" executed successfully!`),R(!1),_("")};return A?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsxs(l,{textAlign:"center",children:[e.jsx(Ce,{size:48}),e.jsx(D,{variant:"h6",sx:{mt:2},children:"Loading Settings..."})]})}):T?e.jsxs(l,{children:[e.jsxs(je,{severity:"error",sx:{mb:2},children:["Failed to load settings: ",T]}),e.jsx(he,{variant:"contained",onClick:()=>window.location.reload(),icon:e.jsx(Mt,{}),mobileText:"Retry",desktopText:"Retry",children:"Retry"})]}):e.jsxs(l,{children:[e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(Gr,{color:"primary"}),e.jsx(D,{variant:"h6",children:"System Settings"})]}),e.jsxs(l,{display:"flex",flexDirection:"column",gap:2,children:[e.jsx(an,{control:e.jsx(jn,{checked:a,onChange:ue=>i(ue.target.checked)}),label:"Enable Role Hierarchy"}),e.jsx(an,{control:e.jsx(jn,{checked:o,onChange:ue=>d(ue.target.checked)}),label:"Permission Inheritance"}),e.jsx(an,{control:e.jsx(jn,{checked:u,onChange:ue=>h(ue.target.checked)}),label:"Auto Role Assignment"}),u&&e.jsxs(nt,{fullWidth:!0,size:"small",sx:{mt:2},children:[e.jsx(st,{children:"Default Role for New Users"}),e.jsx(Ze,{value:m,onChange:ue=>x(ue.target.value),label:"Default Role for New Users",children:r==null?void 0:r.map(ue=>e.jsxs(re,{value:ue.name,children:[ue.displayName," (",ue.name,")"]},ue.roleId))})]}),e.jsx(l,{sx:{mt:2,pt:2,borderTop:"1px solid",borderColor:"divider"},children:e.jsx(an,{control:e.jsx(jn,{checked:P,onChange:async ue=>{const le=ue.target.checked,pe=P;try{X(!0);const Me=await zi.toggleDemoAccount(le);if(Me&&typeof Me.enabled=="boolean")w(Me.enabled),Me.enabled&&Me.accountId?k({accountId:Me.accountId,accountName:Me.accountName}):k({}),Yt.success(Me.enabled?"Demo account enabled successfully":"Demo account disabled successfully");else throw new Error("Invalid response from server")}catch(Me){console.error("Error toggling demo account:",Me);const Le=Me instanceof Error?Me.message:"Failed to toggle demo account";Yt.error(Le),w(pe)}finally{X(!1)}},disabled:K}),label:e.jsxs(l,{children:[e.jsx(D,{variant:"body1",children:"Enable Demo Account"}),e.jsx(D,{variant:"caption",color:"text.secondary",children:P?`Demo account is active${C.accountName?`: ${C.accountName}`:""}`:"Demo account is disabled. All users can access demo portfolios when enabled."})]})})})]})]})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(Jt,{color:"primary"}),e.jsx(D,{variant:"h6",children:"Security Settings"})]}),e.jsxs(l,{display:"flex",flexDirection:"column",gap:2,children:[e.jsx(Ae,{label:"Session Timeout (minutes)",type:"number",value:g,onChange:ue=>f(Number(ue.target.value)),size:"small",fullWidth:!0}),e.jsx(Ae,{label:"Max Login Attempts",type:"number",value:y,onChange:ue=>j(Number(ue.target.value)),size:"small",fullWidth:!0}),e.jsx(Ae,{label:"Password Expiry (days)",type:"number",value:b,onChange:ue=>v(Number(ue.target.value)),size:"small",fullWidth:!0})]})]})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Jt,{color:"primary"}),e.jsx(D,{variant:"h6",children:"Role Management"})]}),e.jsx(he,{size:"small",icon:e.jsx(xt,{}),mobileText:"Add Role",desktopText:"Add Role",onClick:()=>I(!0),children:"Add Role"})]}),t?e.jsx(l,{display:"flex",justifyContent:"center",p:2,children:e.jsx(Ce,{size:24})}):e.jsxs(lt,{dense:!0,children:[r==null?void 0:r.slice(0,5).map(ue=>{var le;return e.jsxs(Pe,{sx:{py:.5},children:[e.jsx(ve,{primary:ue.displayName,secondary:`${((le=ue.permissions)==null?void 0:le.length)||0} permissions`}),e.jsx(bo,{children:e.jsx(ce,{label:ue.isSystemRole?"System":"Custom",color:ue.isSystemRole?"primary":"default",size:"small"})})]},ue.roleId)}),r&&r.length>5&&e.jsx(Pe,{children:e.jsx(ve,{primary:`+${r.length-5} more roles`,sx:{fontStyle:"italic"}})})]})]})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Sn,{color:"primary"}),e.jsx(D,{variant:"h6",children:"Permission Management"})]}),e.jsx(he,{size:"small",icon:e.jsx(xt,{}),mobileText:"Add Permission",desktopText:"Add Permission",onClick:()=>N(!0),children:"Add Permission"})]}),s?e.jsx(l,{display:"flex",justifyContent:"center",p:2,children:e.jsx(Ce,{size:24})}):e.jsxs(lt,{dense:!0,children:[n==null?void 0:n.slice(0,5).map(ue=>e.jsx(Pe,{sx:{py:.5},children:e.jsx(ve,{primary:e.jsxs(l,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(D,{variant:"body1",children:ue.displayName||ue.name}),e.jsxs(D,{variant:"caption",color:"text.disabled",sx:{fontFamily:"monospace"},children:["(",ue.name,")"]})]}),secondary:ue.description||ue.resource})},ue.permissionId)),n&&n.length>5&&e.jsx(Pe,{children:e.jsx(ve,{primary:`+${n.length-5} more permissions`,sx:{fontStyle:"italic"}})})]})]})})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"System Statistics"}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{sx:{p:2,textAlign:"center"},children:[e.jsx(D,{variant:"h4",color:"primary",children:(r==null?void 0:r.length)||0}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Total Roles"})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{sx:{p:2,textAlign:"center"},children:[e.jsx(D,{variant:"h4",color:"secondary",children:(n==null?void 0:n.length)||0}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Total Permissions"})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{sx:{p:2,textAlign:"center"},children:[e.jsx(D,{variant:"h4",color:"success.main",children:(r==null?void 0:r.filter(ue=>ue.isSystemRole).length)||0}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"System Roles"})]})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(Te,{sx:{p:2,textAlign:"center"},children:[e.jsx(D,{variant:"h4",color:"warning.main",children:(r==null?void 0:r.filter(ue=>!ue.isSystemRole).length)||0}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Custom Roles"})]})})]})]})})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(l,{children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"System Actions"}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Perform bulk operations and system maintenance"})]}),e.jsxs(l,{display:"flex",gap:2,children:[e.jsx(he,{variant:"outlined",icon:e.jsx(Mt,{}),mobileText:"Refresh System",desktopText:"Refresh System",onClick:()=>window.location.reload(),children:"Refresh System"}),e.jsx(he,{variant:"outlined",icon:e.jsx(on,{}),mobileText:"Bulk Actions",desktopText:"Bulk Actions",onClick:()=>R(!0),children:"Bulk Actions"}),e.jsx(We,{variant:"contained",icon:K?void 0:e.jsx(Ga,{}),mobileText:K?"Saving...":"Save Settings",desktopText:K?"Saving...":"Save Settings",onClick:Q,disabled:K,forceTextOnly:!0,children:K?"Saving...":"Save Settings"})]})]}),ee&&e.jsxs(je,{severity:"success",sx:{mt:2},children:['Settings saved successfully! New users will automatically be assigned the "',m,'" role.']}),ne&&e.jsx(je,{severity:"error",sx:{mt:2},children:ne})]})})})]}),e.jsxs(kt,{open:O,onClose:()=>I(!1),children:[e.jsx(Et,{children:"Create New Role"}),e.jsx(Pt,{children:e.jsx(Ae,{autoFocus:!0,margin:"dense",label:"Role Name",fullWidth:!0,variant:"outlined",value:V,onChange:ue=>F(ue.target.value)})}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:()=>I(!1),variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{onClick:Z,variant:"contained",forceTextOnly:!0,mobileText:"Create",desktopText:"Create",children:"Create"})]})]}),e.jsxs(kt,{open:z,onClose:()=>N(!1),children:[e.jsx(Et,{children:"Create New Permission"}),e.jsx(Pt,{children:e.jsx(Ae,{autoFocus:!0,margin:"dense",label:"Permission Name",fullWidth:!0,variant:"outlined",value:B,onChange:ue=>$(ue.target.value)})}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:()=>N(!1),variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{onClick:J,variant:"contained",forceTextOnly:!0,mobileText:"Create",desktopText:"Create",children:"Create"})]})]}),e.jsxs(kt,{open:E,onClose:()=>R(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Et,{children:"Bulk Actions"}),e.jsx(Pt,{children:e.jsxs(nt,{fullWidth:!0,margin:"dense",children:[e.jsx(st,{children:"Select Action"}),e.jsxs(Ze,{value:Y,onChange:ue=>_(ue.target.value),children:[e.jsx(re,{value:"export",children:"Export All Data"}),e.jsx(re,{value:"backup",children:"Create Backup"}),e.jsx(re,{value:"cleanup",children:"Cleanup Expired Roles"}),e.jsx(re,{value:"audit",children:"Run Security Audit"})]})]})}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:()=>R(!1),variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{onClick:ae,variant:"contained",forceTextOnly:!0,mobileText:"Execute",desktopText:"Execute",children:"Execute"})]})]})]})};class Js{static async getStatus(){return(await q.api.get("/api/v1/automated-snapshots/status")).data}static async triggerManual(){return(await q.api.post("/api/v1/automated-snapshots/trigger")).data}static async testPortfolio(t){return(await q.api.post(`/api/v1/automated-snapshots/test/${t}`)).data}static async getScheduleInfo(){return(await q.api.get("/api/v1/automated-snapshots/schedule-info")).data}static async enableService(){return(await q.api.post("/api/v1/automated-snapshots/enable")).data}static async disableService(){return(await q.api.post("/api/v1/automated-snapshots/disable")).data}}const JD=()=>{const r=Kt(),{accountId:t}=Ge(),{portfolios:n}=Un(t),[s,a]=p.useState(!1),[i,o]=p.useState(""),[d,u]=p.useState(null),{data:h,isLoading:m,error:x,refetch:g}=yt(["automated-snapshot-status"],Js.getStatus,{refetchInterval:3e4,staleTime:1e4}),{data:f}=yt(["automated-snapshot-schedule"],Js.getScheduleInfo),y=jt(Js.triggerManual,{onSuccess:I=>{Yt.success("Manual snapshot creation triggered successfully!"),r.invalidateQueries(["automated-snapshot-status"]),u({success:!0,message:I.message,snapshotsCreated:I.stats.totalSnapshots})},onError:I=>{Yt.error(`Failed to trigger manual snapshot: ${I.message}`)}}),j=jt(I=>Js.testPortfolio(I),{onSuccess:I=>{Yt.success(`Test completed: ${I.message}`),u(I)},onError:I=>{Yt.error(`Test failed: ${I.message}`)}}),b=jt(Js.enableService,{onSuccess:I=>{Yt.success(I.message),r.invalidateQueries(["automated-snapshot-status"])},onError:I=>{Yt.error(`Failed to enable service: ${I.message}`)}}),v=jt(Js.disableService,{onSuccess:I=>{Yt.success(I.message),r.invalidateQueries(["automated-snapshot-status"])},onError:I=>{Yt.error(`Failed to disable service: ${I.message}`)}}),P=()=>{if(h!=null&&h.isRunning){Yt.warning("Automated snapshot service is already running");return}y.mutate()},w=()=>{if(!i){Yt.warning("Please select a portfolio to test");return}j.mutate(i)},C=()=>{g()},k=()=>{b.mutate()},A=()=>{v.mutate()},L=(I,z)=>z?I?"warning":"success":"error",T=(I,z)=>z?I?e.jsx(Jp,{}):e.jsx(Xe,{}):e.jsx(sd,{}),M=I=>I<1e3?`${I}ms`:I<6e4?`${(I/1e3).toFixed(1)}s`:`${(I/6e4).toFixed(1)}m`,O=I=>I?new Date(I).toLocaleString():"Never";return m?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(Ce,{})}):x?e.jsxs(je,{severity:"error",children:["Error loading automated snapshot status: ",x instanceof Error?x.message:"Unknown error"]}):e.jsxs(l,{children:[e.jsxs(l,{sx:{mb:3},children:[e.jsx(c,{variant:"h4",component:"h1",gutterBottom:!0,children:"Automated Snapshot Management"}),e.jsx(D,{variant:"body1",color:"text.secondary",children:"Monitor and manage the automated portfolio snapshot system"})]}),e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(D,{variant:"h6",children:"Service Status"}),e.jsx(Ie,{onClick:C,size:"small",children:e.jsx(Mt,{})})]}),h&&e.jsxs(e.Fragment,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(ce,{icon:T(h.isRunning,h.isEnabled),label:h.isEnabled?h.isRunning?"Running":"Idle":"Disabled",color:L(h.isRunning,h.isEnabled),variant:"outlined"}),h.isRunning&&e.jsx(ds,{sx:{flexGrow:1}})]}),e.jsxs(D,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:["Last Execution: ",O(h.lastExecutionTime)]}),e.jsxs(D,{variant:"body2",color:"text.secondary",children:["Next Scheduled: ",h.nextScheduledTime]}),e.jsx(l,{display:"flex",gap:1,mt:2,children:h.isEnabled?e.jsx(We,{variant:"outlined",color:"error",icon:e.jsx(sd,{}),onClick:A,disabled:v.isLoading,size:"small",forceTextOnly:!0,mobileText:v.isLoading?"Disabling...":"Disable",desktopText:v.isLoading?"Disabling...":"Disable Service",children:v.isLoading?"Disabling...":"Disable Service"}):e.jsx(We,{variant:"outlined",color:"success",icon:e.jsx(Qp,{}),onClick:k,disabled:b.isLoading,size:"small",forceTextOnly:!0,mobileText:b.isLoading?"Enabling...":"Enable",desktopText:b.isLoading?"Enabling...":"Enable Service",children:b.isLoading?"Enabling...":"Enable Service"})})]})]})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(Zn,{}),e.jsx(D,{variant:"h6",children:"Schedule"})]}),f&&e.jsxs(e.Fragment,{children:[e.jsxs(D,{variant:"body2",gutterBottom:!0,children:[e.jsx("strong",{children:"Cron Expression:"})," ",f.cronExpression]}),e.jsxs(D,{variant:"body2",gutterBottom:!0,children:[e.jsx("strong",{children:"Timezone:"})," ",f.timezone]}),e.jsxs(D,{variant:"body2",gutterBottom:!0,children:[e.jsx("strong",{children:"Description:"})," ",f.description]}),e.jsxs(D,{variant:"body2",gutterBottom:!0,children:[e.jsx("strong",{children:"Next Execution:"})," ",f.nextExecution]})]})]})})}),h&&e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Last Execution Statistics"}),e.jsxs(W,{container:!0,spacing:2,children:[e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsxs(l,{textAlign:"center",children:[e.jsx(D,{variant:"h4",color:"primary",children:h.executionStats.totalPortfolios}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Total Portfolios"})]})}),e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsxs(l,{textAlign:"center",children:[e.jsx(D,{variant:"h4",color:"success.main",children:h.executionStats.successfulPortfolios}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Successful"})]})}),e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsxs(l,{textAlign:"center",children:[e.jsx(D,{variant:"h4",color:"error.main",children:h.executionStats.failedPortfolios}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Failed"})]})}),e.jsx(W,{item:!0,xs:6,sm:3,children:e.jsxs(l,{textAlign:"center",children:[e.jsx(D,{variant:"h4",color:"info.main",children:M(h.executionStats.executionTime)}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Execution Time"})]})})]}),e.jsx(bt,{sx:{my:2}}),e.jsxs(l,{textAlign:"center",children:[e.jsx(D,{variant:"h4",color:"secondary.main",children:h.executionStats.totalSnapshots}),e.jsx(D,{variant:"body2",color:"text.secondary",children:"Total Snapshots Created"})]})]})})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Actions"}),e.jsxs(l,{display:"flex",gap:2,flexWrap:"wrap",children:[e.jsx(We,{variant:"contained",icon:e.jsx(ti,{}),onClick:P,disabled:(h==null?void 0:h.isRunning)||y.isLoading||!(h!=null&&h.isEnabled),color:"primary",forceTextOnly:!0,mobileText:y.isLoading?"Triggering...":"Trigger",desktopText:y.isLoading?"Triggering...":"Trigger Manual Snapshot",children:y.isLoading?"Triggering...":"Trigger Manual Snapshot"}),e.jsx(he,{variant:"outlined",icon:e.jsx(Xp,{}),onClick:()=>a(!0),color:"secondary",mobileText:"Test",desktopText:"Test Portfolio",children:"Test Portfolio"}),e.jsx(he,{variant:"outlined",icon:e.jsx(Mt,{}),onClick:C,color:"info",mobileText:"Refresh",desktopText:"Refresh Status",children:"Refresh Status"})]})]})})}),d&&e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Test Results"}),e.jsxs(je,{severity:d.success?"success":"error",icon:d.success?e.jsx(Xe,{}):e.jsx(qn,{}),children:[e.jsx(D,{variant:"body1",gutterBottom:!0,children:d.message}),d.snapshotsCreated>0&&e.jsxs(D,{variant:"body2",children:["Snapshots Created: ",d.snapshotsCreated]})]})]})})})]}),e.jsxs(kt,{open:s,onClose:()=>a(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Et,{children:"Test Snapshot Creation"}),e.jsx(Pt,{children:e.jsx(l,{sx:{pt:1},children:e.jsxs(nt,{fullWidth:!0,margin:"normal",children:[e.jsx(st,{children:"Select Portfolio"}),e.jsx(Ze,{value:i,onChange:I=>o(I.target.value),label:"Select Portfolio",children:n==null?void 0:n.map(I=>e.jsx(re,{value:I.portfolioId,children:I.name},I.portfolioId))})]})})}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:()=>a(!1),variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{onClick:w,variant:"contained",disabled:!i||j.isLoading,icon:j.isLoading?e.jsx(Ce,{size:16}):void 0,forceTextOnly:!0,mobileText:j.isLoading?"Testing...":"Test",desktopText:j.isLoading?"Testing...":"Test",children:j.isLoading?"Testing...":"Test"})]})]})]})};class Ba{static async getTrackingRecords(t={}){const n=new URLSearchParams;return t.status&&n.append("status",t.status),t.type&&n.append("type",t.type),t.portfolioId&&n.append("portfolioId",t.portfolioId),t.startDate&&n.append("startDate",t.startDate),t.endDate&&n.append("endDate",t.endDate),t.limit&&n.append("limit",t.limit.toString()),t.offset&&n.append("offset",t.offset.toString()),t.page&&n.append("page",t.page.toString()),(await q.api.get(`/api/v1/snapshot-tracking?${n.toString()}`)).data}static async getTrackingByExecutionId(t){return(await q.api.get(`/api/v1/snapshot-tracking/execution/${t}`)).data}static async getExecutionSummary(t){return(await q.api.get(`/api/v1/snapshot-tracking/execution/${t}/summary`)).data}static async getTrackingStats(t,n){const s=new URLSearchParams;return t&&s.append("startDate",t),n&&s.append("endDate",n),(await q.api.get(`/api/v1/snapshot-tracking/stats?${s.toString()}`)).data}static async getRecentTracking(t=10){return(await q.api.get(`/api/v1/snapshot-tracking/recent?limit=${t}`)).data}static async getTrackingByPortfolio(t,n=20){return(await q.api.get(`/api/v1/snapshot-tracking/portfolio/${t}?limit=${n}`)).data}static async getFailedTracking(t=20){return(await q.api.get(`/api/v1/snapshot-tracking/failed?limit=${t}`)).data}static async getDashboardData(){return(await q.api.get("/api/v1/snapshot-tracking/dashboard")).data}static async cleanupOldRecords(t=30){return(await q.api.post(`/api/v1/snapshot-tracking/cleanup?daysToKeep=${t}`)).data}}function Oi(r){const{children:t,value:n,index:s,...a}=r;return e.jsx("div",{role:"tabpanel",hidden:n!==s,id:`tracking-tabpanel-${s}`,"aria-labelledby":`tracking-tab-${s}`,...a,children:n===s&&e.jsx(l,{sx:{p:3},children:t})})}const ZD=()=>{var Me,Le,qe;const[r,t]=p.useState(0),[n,s]=p.useState(!1),[a,i]=p.useState(!1),[o,d]=p.useState(!1),[u,h]=p.useState(null),[m,x]=p.useState(30),[g,f]=p.useState(!0),[y,j]=p.useState(new Set),[b,v]=p.useState({status:"",type:"",portfolioId:"",startDate:"",endDate:"",limit:50,offset:0,page:1}),[P,w]=p.useState(50),C=Kt(),{data:k,isLoading:A,error:L}=yt({queryKey:["snapshot-tracking-records",b],queryFn:()=>Ba.getTrackingRecords(b)}),T=p.useMemo(()=>{if(!g||!(k!=null&&k.data))return null;const de={},fe=[];return k.data.forEach(ie=>{var Ve;const Se=(Ve=ie.metadata)==null?void 0:Ve.parentExecutionId;if(Se){if(!de[Se]){const Re=k.data.find(xe=>xe.executionId===Se);if(Re)de[Se]={parentRecord:Re,childRecords:[]};else{fe.push(ie);return}}de[Se]&&de[Se].childRecords.push(ie)}else de[ie.executionId]||(de[ie.executionId]={parentRecord:ie,childRecords:[]})}),{groups:de,ungroupedRecords:fe}},[k==null?void 0:k.data,g,y]),{data:M,isLoading:O,error:I}=yt({queryKey:["snapshot-tracking-recent",b],queryFn:()=>Ba.getTrackingRecords({...b,limit:b.limit,offset:b.offset})}),{data:z,isLoading:N,error:E}=yt({queryKey:["snapshot-tracking-failed",b],queryFn:()=>Ba.getTrackingRecords({...b,status:"failed",limit:b.limit,offset:b.offset})}),{data:R,isLoading:V}=yt({queryKey:["snapshot-tracking-stats"],queryFn:()=>Ba.getTrackingStats()}),F=jt({mutationFn:de=>Ba.cleanupOldRecords(de),onSuccess:()=>{C.invalidateQueries({queryKey:["snapshot-tracking-records"]}),C.invalidateQueries({queryKey:["snapshot-tracking-recent"]}),C.invalidateQueries({queryKey:["snapshot-tracking-failed"]}),C.invalidateQueries({queryKey:["snapshot-tracking-stats"]})}}),B=(de,fe)=>{t(fe)},$=de=>{j(fe=>{const ie=new Set(fe);return ie.has(de)?ie.delete(de):ie.add(de),ie})},Y=()=>{f(!g),j(new Set)},_=(de,fe)=>{v(ie=>({...ie,[de]:fe}))},K=(de,fe)=>{const ie=(fe-1)*P;v(Se=>({...Se,page:fe,offset:ie,limit:P}))},X=de=>{w(de),v(fe=>({...fe,limit:de,offset:0,page:1})),C.invalidateQueries({queryKey:["snapshot-tracking-records"]}),C.invalidateQueries({queryKey:["snapshot-tracking-recent"]}),C.invalidateQueries({queryKey:["snapshot-tracking-failed"]})},ne=()=>{s(!1),v(de=>({...de,page:1,offset:0})),C.invalidateQueries({queryKey:["snapshot-tracking-records"]}),C.invalidateQueries({queryKey:["snapshot-tracking-recent"]}),C.invalidateQueries({queryKey:["snapshot-tracking-failed"]})},oe=()=>{C.invalidateQueries({queryKey:["snapshot-tracking-records"]}),C.invalidateQueries({queryKey:["snapshot-tracking-recent"]}),C.invalidateQueries({queryKey:["snapshot-tracking-failed"]}),C.invalidateQueries({queryKey:["snapshot-tracking-stats"]})},ee=de=>{h(de),i(!0)},H=()=>{i(!1),h(null)},Q=()=>{d(!0)},Z=()=>{const de=m===""?30:Number(m);if(isNaN(de)){alert("Please enter a valid number for days to keep.");return}if(de<0){alert("Days to keep cannot be negative. Please enter a valid number.");return}if(de>365){alert("Days to keep cannot be more than 365. Please enter a valid number.");return}F.mutate(de),d(!1)},J=()=>{d(!1)},ae=de=>{switch(de){case"completed":return"success";case"failed":return"error";case"in_progress":return"warning";case"started":return"info";case"cancelled":return"default";default:return"default"}},ue=de=>{switch(de){case"completed":return e.jsx(Xe,{});case"failed":return e.jsx(qn,{});case"in_progress":return e.jsx(Zn,{});case"started":return e.jsx(Zn,{});case"cancelled":return e.jsx(qn,{});default:return e.jsx(Zn,{})}},le=de=>de<1e3?`${de}ms`:de<6e4?`${(de/1e3).toFixed(1)}s`:`${(de/6e4).toFixed(1)}m`,pe=(de,fe=!1)=>e.jsxs(De,{sx:{bgcolor:fe?"grey.50":"inherit"},children:[e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",sx:{pl:fe?4:0},children:[fe&&e.jsxs(e.Fragment,{children:[e.jsx(Zp,{sx:{mr:1,fontSize:16,minWidth:16}}),e.jsx(l,{sx:{width:32,mr:1}})]}),!fe&&e.jsx(l,{sx:{width:48,mr:1}}),e.jsxs(D,{variant:"body2",fontFamily:"monospace",children:[de.executionId.substring(0,8),"..."]})]})}),e.jsx(S,{children:de.portfolioName||"All Portfolios"}),e.jsx(S,{children:e.jsx(ce,{icon:ue(de.status),label:de.status,color:ae(de.status),size:"small"})}),e.jsx(S,{children:e.jsx(ce,{label:de.type,color:de.type==="automated"?"primary":"secondary",size:"small"})}),e.jsx(S,{children:fn(new Date(de.startedAt),"MMM dd, yyyy HH:mm:ss")}),e.jsx(S,{children:le(de.executionTimeMs)}),e.jsxs(S,{children:[de.successfulSnapshots,"/",de.totalSnapshots]}),e.jsx(S,{children:de.totalPortfolios||"N/A"}),e.jsx(S,{children:e.jsx(Fe,{title:"View Details",children:e.jsx(Ie,{size:"small",onClick:()=>ee(de),children:e.jsx(Xt,{})})})})]},de.id);return A||O||N||V?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsx(Ce,{})}):L||I||E?e.jsx(je,{severity:"error",children:"Failed to load tracking data. Please try again."}):e.jsxs(l,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(D,{variant:"h4",component:"h1",children:"Snapshot Tracking Dashboard"}),e.jsxs(l,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(an,{control:e.jsx(jn,{checked:g,onChange:Y,color:"primary"}),label:"Group by Parent Execution"}),e.jsx(he,{variant:"outlined",icon:e.jsx(Ir,{}),onClick:()=>s(!0),mobileText:"Filters",desktopText:"Filters",sx:{mr:1},children:"Filters"}),e.jsx(he,{variant:"outlined",icon:e.jsx(Mt,{}),onClick:oe,mobileText:"Refresh",desktopText:"Refresh",sx:{mr:1},children:"Refresh"}),e.jsx(We,{variant:"outlined",color:"warning",onClick:Q,disabled:F.isLoading,mobileText:"Cleanup",desktopText:"Cleanup Old Records",children:"Cleanup Old Records"})]})]}),(R==null?void 0:R.data)&&e.jsxs(W,{container:!0,spacing:3,mb:3,children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Zt,{color:"primary",sx:{mr:1}}),e.jsxs(l,{children:[e.jsx(D,{color:"textSecondary",gutterBottom:!0,children:"Total Executions"}),e.jsx(D,{variant:"h4",children:R.data.totalExecutions})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Xe,{color:"success",sx:{mr:1}}),e.jsxs(l,{children:[e.jsx(D,{color:"textSecondary",gutterBottom:!0,children:"Success Rate"}),e.jsxs(D,{variant:"h4",children:[R.data.successRate.toFixed(1),"%"]})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(He,{color:"info",sx:{mr:1}}),e.jsxs(l,{children:[e.jsx(D,{color:"textSecondary",gutterBottom:!0,children:"Total Snapshots"}),e.jsx(D,{variant:"h4",children:R.data.totalSnapshots})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Zn,{color:"warning",sx:{mr:1}}),e.jsxs(l,{children:[e.jsx(D,{color:"textSecondary",gutterBottom:!0,children:"Avg Execution Time"}),e.jsx(D,{variant:"h4",children:le(R.data.averageExecutionTime)})]})]})})})})]}),e.jsx(l,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Tr,{value:r,onChange:B,children:[e.jsx(ht,{label:"Recent Executions"}),e.jsx(ht,{label:"All Records"}),e.jsx(ht,{label:"Failed Executions"}),e.jsx(ht,{label:"Statistics"})]})}),e.jsxs(Oi,{value:r,index:0,children:[e.jsx(at,{component:Te,children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:"Execution ID"}),e.jsx(S,{children:"Portfolio"}),e.jsx(S,{children:"Status"}),e.jsx(S,{children:"Type"}),e.jsx(S,{children:"Started At"}),e.jsx(S,{children:"Duration"}),e.jsx(S,{children:"Snapshots"}),e.jsx(S,{children:"Total Portfolios"}),e.jsx(S,{children:"Actions"})]})}),e.jsx(ot,{children:g&&(M!=null&&M.data)?(()=>{const de={},fe=[];return M.data.forEach(ie=>{var Ve;const Se=(Ve=ie.metadata)==null?void 0:Ve.parentExecutionId;if(Se){if(!de[Se]){const Re=M.data.find(xe=>xe.executionId===Se);if(Re)de[Se]={parentRecord:Re,childRecords:[]};else{fe.push(ie);return}}de[Se]&&de[Se].childRecords.push(ie)}else de[ie.executionId]||(de[ie.executionId]={parentRecord:ie,childRecords:[]})}),e.jsxs(e.Fragment,{children:[Object.entries(de).map(([ie,Se])=>e.jsxs(rt.Fragment,{children:[e.jsxs(De,{sx:{bgcolor:"primary.50"},children:[e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Ie,{size:"small",onClick:()=>$(ie),sx:{mr:1,minWidth:32},children:y.has(ie)?e.jsx(Dn,{}):e.jsx(ln,{})}),e.jsx(ad,{sx:{mr:1,fontSize:16,color:"primary.main",minWidth:16}}),e.jsxs(D,{variant:"body2",fontFamily:"monospace",fontWeight:"bold",children:[Se.parentRecord.executionId.substring(0,8),"..."]}),e.jsx(ce,{label:`${Se.childRecords.length} children`,size:"small",color:"primary",sx:{ml:1}})]})}),e.jsx(S,{children:Se.parentRecord.portfolioName||"All Portfolios"}),e.jsx(S,{children:e.jsx(ce,{icon:ue(Se.parentRecord.status),label:Se.parentRecord.status,color:ae(Se.parentRecord.status),size:"small"})}),e.jsx(S,{children:e.jsx(ce,{label:Se.parentRecord.type,color:Se.parentRecord.type==="automated"?"primary":"secondary",size:"small"})}),e.jsx(S,{children:fn(new Date(Se.parentRecord.startedAt),"MMM dd, yyyy HH:mm:ss")}),e.jsx(S,{children:le(Se.parentRecord.executionTimeMs)}),e.jsxs(S,{children:[Se.parentRecord.successfulSnapshots,"/",Se.parentRecord.totalSnapshots]}),e.jsx(S,{children:Se.parentRecord.totalPortfolios||"N/A"}),e.jsx(S,{children:e.jsx(Fe,{title:"View Details",children:e.jsx(Ie,{size:"small",onClick:()=>ee(Se.parentRecord),children:e.jsx(Xt,{})})})})]}),e.jsx(De,{children:e.jsx(S,{colSpan:9,sx:{p:0},children:e.jsx(qr,{in:y.has(ie),children:e.jsx(l,{sx:{bgcolor:"grey.50"},children:Se.childRecords.map(Ve=>pe(Ve,!0))})})})})]},ie)),fe.map(ie=>pe(ie,!1))]})})():(Me=M==null?void 0:M.data)==null?void 0:Me.map(de=>e.jsxs(De,{children:[e.jsx(S,{children:e.jsxs(D,{variant:"body2",fontFamily:"monospace",children:[de.executionId.substring(0,8),"..."]})}),e.jsx(S,{children:de.portfolioName||"All Portfolios"}),e.jsx(S,{children:e.jsx(ce,{icon:ue(de.status),label:de.status,color:ae(de.status),size:"small"})}),e.jsx(S,{children:e.jsx(ce,{label:de.type,color:de.type==="automated"?"primary":"secondary",size:"small"})}),e.jsx(S,{children:fn(new Date(de.startedAt),"MMM dd, yyyy HH:mm:ss")}),e.jsx(S,{children:le(de.executionTimeMs)}),e.jsxs(S,{children:[de.successfulSnapshots,"/",de.totalSnapshots]}),e.jsx(S,{children:de.totalPortfolios||"N/A"}),e.jsx(S,{children:e.jsx(Fe,{title:"View Details",children:e.jsx(Ie,{size:"small",onClick:()=>ee(de),children:e.jsx(Xt,{})})})})]},de.id))})]})}),(M==null?void 0:M.pagination)&&e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:3,mb:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(D,{variant:"body2",color:"textSecondary",children:"Rows per page:"}),e.jsxs(Ze,{value:P,onChange:de=>X(Number(de.target.value)),size:"small",sx:{minWidth:80},children:[e.jsx(re,{value:10,children:"10"}),e.jsx(re,{value:20,children:"20"}),e.jsx(re,{value:50,children:"50"}),e.jsx(re,{value:100,children:"100"})]})]}),e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:1},children:[e.jsx(la,{count:Math.ceil(M.pagination.total/M.pagination.limit),page:b.page,onChange:K,color:"primary",showFirstButton:!0,showLastButton:!0,size:"large"}),e.jsxs(D,{variant:"body2",color:"textSecondary",children:["Showing ",M.pagination.offset+1," to ",Math.min(M.pagination.offset+M.pagination.limit,M.pagination.total)," of ",M.pagination.total," records"]})]})]})]}),e.jsxs(Oi,{value:r,index:1,children:[e.jsx(at,{component:Te,children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:"Execution ID"}),e.jsx(S,{children:"Portfolio"}),e.jsx(S,{children:"Status"}),e.jsx(S,{children:"Type"}),e.jsx(S,{children:"Started At"}),e.jsx(S,{children:"Duration"}),e.jsx(S,{children:"Snapshots"}),e.jsx(S,{children:"Total Portfolios"}),e.jsx(S,{children:"Actions"})]})}),e.jsx(ot,{children:g&&T?e.jsxs(e.Fragment,{children:[Object.entries(T.groups).map(([de,fe])=>e.jsxs(rt.Fragment,{children:[e.jsxs(De,{sx:{bgcolor:"primary.50"},children:[e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Ie,{size:"small",onClick:()=>$(de),sx:{mr:1,minWidth:32},children:y.has(de)?e.jsx(Dn,{}):e.jsx(ln,{})}),e.jsx(ad,{sx:{mr:1,fontSize:16,color:"primary.main",minWidth:16}}),e.jsxs(D,{variant:"body2",fontFamily:"monospace",fontWeight:"bold",children:[fe.parentRecord.executionId.substring(0,8),"..."]}),e.jsx(ce,{label:`${fe.childRecords.length} children`,size:"small",color:"primary",sx:{ml:1}})]})}),e.jsx(S,{children:fe.parentRecord.portfolioName||"All Portfolios"}),e.jsx(S,{children:e.jsx(ce,{icon:ue(fe.parentRecord.status),label:fe.parentRecord.status,color:ae(fe.parentRecord.status),size:"small"})}),e.jsx(S,{children:e.jsx(ce,{label:fe.parentRecord.type,color:fe.parentRecord.type==="automated"?"primary":"secondary",size:"small"})}),e.jsx(S,{children:fn(new Date(fe.parentRecord.startedAt),"MMM dd, yyyy HH:mm:ss")}),e.jsx(S,{children:le(fe.parentRecord.executionTimeMs)}),e.jsxs(S,{children:[fe.parentRecord.successfulSnapshots,"/",fe.parentRecord.totalSnapshots]}),e.jsx(S,{children:fe.parentRecord.totalPortfolios||"N/A"}),e.jsx(S,{children:e.jsx(Fe,{title:"View Details",children:e.jsx(Ie,{size:"small",onClick:()=>ee(fe.parentRecord),children:e.jsx(Xt,{})})})})]}),e.jsx(De,{children:e.jsx(S,{colSpan:9,sx:{p:0},children:e.jsx(qr,{in:y.has(de),children:e.jsx(l,{sx:{bgcolor:"grey.50"},children:fe.childRecords.map(ie=>pe(ie,!0))})})})})]},de)),T.ungroupedRecords.map(de=>pe(de,!1))]}):(Le=k==null?void 0:k.data)==null?void 0:Le.map(de=>e.jsxs(De,{children:[e.jsx(S,{children:e.jsxs(D,{variant:"body2",fontFamily:"monospace",children:[de.executionId.substring(0,8),"..."]})}),e.jsx(S,{children:de.portfolioName||"All Portfolios"}),e.jsx(S,{children:e.jsx(ce,{icon:ue(de.status),label:de.status,color:ae(de.status),size:"small"})}),e.jsx(S,{children:e.jsx(ce,{label:de.type,color:de.type==="automated"?"primary":"secondary",size:"small"})}),e.jsx(S,{children:fn(new Date(de.startedAt),"MMM dd, yyyy HH:mm:ss")}),e.jsx(S,{children:le(de.executionTimeMs)}),e.jsxs(S,{children:[de.successfulSnapshots,"/",de.totalSnapshots]}),e.jsx(S,{children:de.totalPortfolios||"N/A"}),e.jsx(S,{children:e.jsx(Fe,{title:"View Details",children:e.jsx(Ie,{size:"small",onClick:()=>ee(de),children:e.jsx(Xt,{})})})})]},de.id))})]})}),(k==null?void 0:k.pagination)&&e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:3,mb:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(D,{variant:"body2",color:"textSecondary",children:"Rows per page:"}),e.jsxs(Ze,{value:P,onChange:de=>X(Number(de.target.value)),size:"small",sx:{minWidth:80},children:[e.jsx(re,{value:10,children:"10"}),e.jsx(re,{value:20,children:"20"}),e.jsx(re,{value:50,children:"50"}),e.jsx(re,{value:100,children:"100"})]})]}),e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:1},children:[e.jsx(la,{count:Math.ceil(k.pagination.total/k.pagination.limit),page:b.page,onChange:K,color:"primary",showFirstButton:!0,showLastButton:!0,size:"large"}),e.jsxs(D,{variant:"body2",color:"textSecondary",children:["Showing ",k.pagination.offset+1," to ",Math.min(k.pagination.offset+k.pagination.limit,k.pagination.total)," of ",k.pagination.total," records"]})]})]})]}),e.jsxs(Oi,{value:r,index:2,children:[e.jsx(at,{component:Te,children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:"Execution ID"}),e.jsx(S,{children:"Portfolio"}),e.jsx(S,{children:"Error Message"}),e.jsx(S,{children:"Started At"}),e.jsx(S,{children:"Duration"}),e.jsx(S,{children:"Total Portfolios"}),e.jsx(S,{children:"Actions"})]})}),e.jsx(ot,{children:(qe=z==null?void 0:z.data)==null?void 0:qe.map(de=>e.jsxs(De,{children:[e.jsx(S,{children:e.jsxs(D,{variant:"body2",fontFamily:"monospace",children:[de.executionId.substring(0,8),"..."]})}),e.jsx(S,{children:de.portfolioName||"All Portfolios"}),e.jsx(S,{children:e.jsx(D,{variant:"body2",color:"error",children:de.errorMessage||"Unknown error"})}),e.jsx(S,{children:fn(new Date(de.startedAt),"MMM dd, yyyy HH:mm:ss")}),e.jsx(S,{children:le(de.executionTimeMs)}),e.jsx(S,{children:de.totalPortfolios||"N/A"}),e.jsx(S,{children:e.jsx(Fe,{title:"View Details",children:e.jsx(Ie,{size:"small",onClick:()=>ee(de),children:e.jsx(Xt,{})})})})]},de.id))})]})}),(z==null?void 0:z.pagination)&&e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:3,mb:2},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(D,{variant:"body2",color:"textSecondary",children:"Rows per page:"}),e.jsxs(Ze,{value:P,onChange:de=>X(Number(de.target.value)),size:"small",sx:{minWidth:80},children:[e.jsx(re,{value:10,children:"10"}),e.jsx(re,{value:20,children:"20"}),e.jsx(re,{value:50,children:"50"}),e.jsx(re,{value:100,children:"100"})]})]}),e.jsxs(l,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:1},children:[e.jsx(la,{count:Math.ceil(z.pagination.total/z.pagination.limit),page:b.page,onChange:K,color:"primary",showFirstButton:!0,showLastButton:!0,size:"large"}),e.jsxs(D,{variant:"body2",color:"textSecondary",children:["Showing ",z.pagination.offset+1," to ",Math.min(z.pagination.offset+z.pagination.limit,z.pagination.total)," of ",z.pagination.total," records"]})]})]})]}),e.jsx(Oi,{value:r,index:3,children:(R==null?void 0:R.data)&&e.jsxs(W,{container:!0,spacing:3,children:[e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Execution Statistics"}),e.jsxs(l,{children:[e.jsxs(D,{variant:"body1",children:[e.jsx("strong",{children:"Total Executions:"})," ",R.data.totalExecutions]}),e.jsxs(D,{variant:"body1",children:[e.jsx("strong",{children:"Successful:"})," ",R.data.successfulExecutions]}),e.jsxs(D,{variant:"body1",children:[e.jsx("strong",{children:"Failed:"})," ",R.data.failedExecutions]}),e.jsxs(D,{variant:"body1",children:[e.jsx("strong",{children:"Success Rate:"})," ",R.data.successRate.toFixed(2),"%"]})]})]})})}),e.jsx(W,{item:!0,xs:12,md:6,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsx(D,{variant:"h6",gutterBottom:!0,children:"Performance Statistics"}),e.jsxs(l,{children:[e.jsxs(D,{variant:"body1",children:[e.jsx("strong",{children:"Total Snapshots:"})," ",R.data.totalSnapshots]}),e.jsxs(D,{variant:"body1",children:[e.jsx("strong",{children:"Average Execution Time:"})," ",le(R.data.averageExecutionTime)]})]})]})})})]})}),e.jsxs(kt,{open:n,onClose:()=>s(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Et,{children:"Filter Tracking Records"}),e.jsx(Pt,{children:e.jsxs(W,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Status"}),e.jsxs(Ze,{value:b.status,onChange:de=>_("status",de.target.value),children:[e.jsx(re,{value:"",children:"All"}),e.jsx(re,{value:"started",children:"Started"}),e.jsx(re,{value:"in_progress",children:"In Progress"}),e.jsx(re,{value:"completed",children:"Completed"}),e.jsx(re,{value:"failed",children:"Failed"}),e.jsx(re,{value:"cancelled",children:"Cancelled"})]})]})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsxs(nt,{fullWidth:!0,children:[e.jsx(st,{children:"Type"}),e.jsxs(Ze,{value:b.type,onChange:de=>_("type",de.target.value),children:[e.jsx(re,{value:"",children:"All"}),e.jsx(re,{value:"automated",children:"Automated"}),e.jsx(re,{value:"manual",children:"Manual"}),e.jsx(re,{value:"test",children:"Test"})]})]})}),e.jsx(W,{item:!0,xs:12,children:e.jsx(Ae,{fullWidth:!0,label:"Portfolio ID",value:b.portfolioId,onChange:de=>_("portfolioId",de.target.value)})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(Ae,{fullWidth:!0,label:"Start Date",type:"date",value:b.startDate,onChange:de=>_("startDate",de.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(W,{item:!0,xs:12,sm:6,children:e.jsx(Ae,{fullWidth:!0,label:"End Date",type:"date",value:b.endDate,onChange:de=>_("endDate",de.target.value),InputLabelProps:{shrink:!0}})})]})}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:()=>s(!1),variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(he,{onClick:ne,variant:"contained",forceTextOnly:!0,mobileText:"Apply",desktopText:"Apply Filters",children:"Apply Filters"})]})]}),e.jsxs(kt,{open:a,onClose:H,maxWidth:"md",fullWidth:!0,children:[e.jsx(Et,{children:"Snapshot Tracking Details"}),e.jsx(Pt,{children:u&&e.jsx(l,{sx:{mt:2},children:e.jsxs(W,{container:!0,spacing:2,children:[e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Execution ID"}),e.jsx(D,{variant:"body1",children:u.executionId})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Portfolio ID"}),e.jsx(D,{variant:"body1",children:u.portfolioId||"N/A"})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Portfolio Name"}),e.jsx(D,{variant:"body1",children:u.portfolioName||"N/A"})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Status"}),e.jsx(ce,{label:u.status,color:ae(u.status),size:"small"})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Type"}),e.jsx(D,{variant:"body1",children:u.type})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Created By"}),e.jsx(D,{variant:"body1",children:u.createdBy||"System"})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Started At"}),e.jsx(D,{variant:"body1",children:fn(new Date(u.startedAt),"yyyy-MM-dd HH:mm:ss")})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Completed At"}),e.jsx(D,{variant:"body1",children:u.completedAt?fn(new Date(u.completedAt),"yyyy-MM-dd HH:mm:ss"):"N/A"})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Total Snapshots"}),e.jsx(D,{variant:"body1",children:u.totalSnapshots})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Successful Snapshots"}),e.jsx(D,{variant:"body1",children:u.successfulSnapshots})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Failed Snapshots"}),e.jsx(D,{variant:"body1",children:u.failedSnapshots})]}),e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Execution Time"}),e.jsx(D,{variant:"body1",children:le(u.executionTimeMs)})]}),u.cronExpression&&e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Cron Expression"}),e.jsx(D,{variant:"body1",children:u.cronExpression})]}),u.timezone&&e.jsxs(W,{item:!0,xs:12,sm:6,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Timezone"}),e.jsx(D,{variant:"body1",children:u.timezone})]}),u.errorMessage&&e.jsxs(W,{item:!0,xs:12,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Error Message"}),e.jsx(D,{variant:"body1",color:"error",sx:{wordBreak:"break-word"},children:u.errorMessage})]}),u.metadata&&Object.keys(u.metadata).length>0&&e.jsxs(W,{item:!0,xs:12,children:[e.jsx(D,{variant:"subtitle2",color:"textSecondary",children:"Metadata"}),e.jsx(l,{sx:{bgcolor:"grey.100",p:2,borderRadius:1},children:e.jsx("pre",{style:{margin:0,fontSize:"0.875rem"},children:JSON.stringify(u.metadata,null,2)})})]})]})})}),e.jsx(Dt,{children:e.jsx(he,{onClick:H,variant:"outlined",forceTextOnly:!0,mobileText:"Close",desktopText:"Close",children:"Close"})})]}),e.jsxs(kt,{open:o,onClose:J,maxWidth:"sm",fullWidth:!0,children:[e.jsx(Et,{children:"Clean Up Old Records"}),e.jsx(Pt,{children:e.jsxs(l,{sx:{mt:2},children:[e.jsx(D,{variant:"body1",gutterBottom:!0,children:m===0||m==="0"?"This action will permanently delete ALL tracking records.":"This action will permanently delete tracking records older than the specified number of days."}),(m===0||m==="0")&&e.jsx(D,{variant:"body1",color:"error",gutterBottom:!0,sx:{fontWeight:"bold"},children:" WARNING: This will delete ALL tracking records!"}),e.jsx(D,{variant:"body2",color:"textSecondary",gutterBottom:!0,children:"This action cannot be undone."}),e.jsx(Ae,{fullWidth:!0,label:"Days to Keep",type:"number",value:m,onChange:de=>{const fe=de.target.value;if(fe==="")x("");else{const ie=parseInt(fe,10);x(isNaN(ie)?"":ie)}},helperText:"Records older than this number of days will be deleted (0 = delete all records)",sx:{mt:2}})]})}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:J,variant:"outlined",forceTextOnly:!0,mobileText:"Cancel",desktopText:"Cancel",children:"Cancel"}),e.jsx(We,{onClick:Z,variant:"contained",color:m===0||m==="0"?"error":"warning",disabled:F.isLoading,icon:(F.isLoading,void 0),forceTextOnly:!0,mobileText:F.isLoading?"Cleaning...":m===0||m==="0"?"Delete ALL":"Clean Up",desktopText:F.isLoading?"Cleaning...":m===0||m==="0"?"Delete ALL Records":"Clean Up",children:F.isLoading?"Cleaning...":m===0||m==="0"?"Delete ALL Records":"Clean Up"})]})]})]})},eA=()=>yt("adminPortfolios",()=>q.getAllPortfoliosAdmin(),{staleTime:5*60*1e3,cacheTime:10*60*1e3,retry:3,retryDelay:r=>Math.min(1e3*2**r,3e4)}),tA=()=>e.jsx(Go,{role:"super_admin",children:e.jsx(nA,{})}),nA=()=>{const{t:r}=Ne(),{data:t,isLoading:n,error:s,refetch:a}=eA(),[i,o]=p.useState(""),[d,u]=p.useState(!1),[h,m]=p.useState(null),[x,g]=p.useState(null),[f,y]=p.useState(null),j=(t==null?void 0:t.filter(C=>C.name.toLowerCase().includes(i.toLowerCase())||C.createdBy.name.toLowerCase().includes(i.toLowerCase())))||[],b=async()=>{if(h)try{await q.deletePortfolioAdmin(h.portfolioId),u(!1),m(null),a()}catch(C){console.error("Error deleting portfolio:",C)}},v=(C,k)=>{g(C.currentTarget),y(k)},P=()=>{g(null),y(null)},w=()=>{m(f),u(!0),P()};return n?e.jsx(xn,{maxWidth:"xl",children:e.jsxs(l,{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"400px",sx:{py:4},children:[e.jsx(Ce,{size:60,thickness:4}),e.jsx(c,{variant:"pageSubtitle",sx:{mt:2},children:r("admin.portfolioList.loading")})]})}):s?e.jsx(xn,{maxWidth:"xl",children:e.jsx(l,{sx:{py:4},children:e.jsxs(je,{severity:"error",sx:{mb:2},children:[r("admin.portfolioList.error"),": ",s.message]})})}):e.jsx(xn,{maxWidth:"xl",children:e.jsxs(l,{sx:{py:4},children:[e.jsxs(l,{sx:{mb:4},children:[e.jsx(c,{variant:"pageTitle",sx:{mb:1},children:r("admin.portfolioList.title")}),e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:r("admin.portfolioList.subtitle")})]}),e.jsxs(W,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Ue,{sx:{fontSize:40,color:"primary.main",mr:2}}),e.jsxs(l,{children:[e.jsx(c,{variant:"cardValue",color:"text.primary",children:(t==null?void 0:t.length)||0}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("admin.portfolioList.totalPortfolios")})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Sn,{sx:{fontSize:40,color:"success.main",mr:2}}),e.jsxs(l,{children:[e.jsx(c,{variant:"cardValue",color:"text.primary",children:new Set((t==null?void 0:t.map(C=>C.createdBy.accountId))||[]).size}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("admin.portfolioList.uniqueUsers")})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(He,{sx:{fontSize:40,color:"warning.main",mr:2}}),e.jsxs(l,{children:[e.jsx(c,{variant:"cardValue",color:"text.primary",children:G((t==null?void 0:t.reduce((C,k)=>C+(k.totalValue||0),0))||0,"VND")}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("admin.portfolioList.totalValue")})]})]})})})}),e.jsx(W,{item:!0,xs:12,sm:6,md:3,children:e.jsx(se,{children:e.jsx(me,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Rr,{sx:{fontSize:40,color:"info.main",mr:2}}),e.jsxs(l,{children:[e.jsx(c,{variant:"cardValue",color:"text.primary",children:new Date().toLocaleDateString()}),e.jsx(c,{variant:"cardLabel",color:"text.secondary",children:r("admin.portfolioList.lastUpdated")})]})]})})})})]}),e.jsxs(l,{sx:{mb:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(Ae,{placeholder:r("admin.portfolioList.searchPlaceholder"),value:i,onChange:C=>o(C.target.value),InputProps:{startAdornment:e.jsx(un,{position:"start",children:e.jsx($n,{})})},sx:{minWidth:300}}),e.jsx(Fe,{title:r("admin.portfolioList.refresh"),children:e.jsx(Ie,{onClick:()=>a(),color:"primary",children:e.jsx(Mt,{})})})]}),e.jsx(Te,{children:e.jsx(at,{children:e.jsxs(it,{children:[e.jsx(ct,{children:e.jsxs(De,{children:[e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",children:r("admin.portfolioList.table.portfolioName")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",children:r("admin.portfolioList.table.portfolioId")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",children:r("admin.portfolioList.table.createdBy")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",children:r("admin.portfolioList.table.user")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",children:r("admin.portfolioList.table.currency")})}),e.jsx(S,{children:e.jsx(c,{variant:"tableHeaderSmall",children:r("admin.portfolioList.table.createdAt")})}),e.jsx(S,{align:"center",children:e.jsx(c,{variant:"tableHeaderSmall",children:r("admin.portfolioList.table.actions")})})]})}),e.jsx(ot,{children:j.map(C=>e.jsxs(De,{hover:!0,children:[e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Ue,{sx:{fontSize:20,color:"primary.main",mr:1}}),e.jsx(c,{variant:"tableCell",children:C.name})]})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",color:"text.secondary",children:C.portfolioId})}),e.jsx(S,{children:e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Sn,{sx:{fontSize:16,color:"success.main",mr:1}}),e.jsx(Fe,{title:C.createdBy.email,arrow:!0,children:e.jsx(l,{sx:{cursor:"help"},children:e.jsx(c,{variant:"tableCell",children:C.createdBy.name})})})]})}),e.jsx(S,{children:C.user?e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Sn,{sx:{fontSize:16,color:"info.main",mr:1}}),e.jsx(Fe,{title:C.user.email,arrow:!0,children:e.jsx(l,{sx:{cursor:"help"},children:e.jsx(c,{variant:"tableCell",children:C.user.username})})})]}):e.jsx(ce,{label:"No User",size:"small",color:"default",variant:"outlined"})}),e.jsx(S,{children:e.jsx(ce,{label:C.baseCurrency,size:"small",color:"primary",variant:"outlined",icon:e.jsx(mr,{sx:{fontSize:16}})})}),e.jsx(S,{children:e.jsx(c,{variant:"tableCellSmall",color:"text.secondary",children:new Date(C.createdAt).toLocaleDateString()})}),e.jsx(S,{align:"right",children:!C.user&&e.jsx(e.Fragment,{children:e.jsx(Ie,{size:"small",onClick:k=>v(k,C),children:e.jsx(wr,{fontSize:"small"})})})})]},C.portfolioId))})]})})}),j.length===0&&e.jsx(l,{sx:{textAlign:"center",py:4},children:e.jsx(c,{variant:"pageSubtitle",color:"text.secondary",children:r(i?"admin.portfolioList.noResults":"admin.portfolioList.noPortfolios")})}),e.jsx(Gn,{anchorEl:x,open:!!x,onClose:P,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(re,{onClick:w,sx:{color:"error.main"},children:[e.jsx(tt,{children:e.jsx(pt,{fontSize:"small",color:"error"})}),e.jsx(ve,{children:r("admin.portfolioList.deletePortfolio")})]})}),e.jsxs(kt,{open:d,onClose:()=>u(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Et,{children:r("admin.portfolioList.deleteDialog.title")}),e.jsx(Pt,{children:e.jsx(c,{variant:"body1",ellipsis:!1,children:r("admin.portfolioList.deleteDialog.message",{portfolioName:h==null?void 0:h.name})})}),e.jsxs(Dt,{children:[e.jsx(he,{onClick:()=>u(!1),variant:"outlined",forceTextOnly:!0,mobileText:r("common.cancel"),desktopText:r("common.cancel"),children:r("common.cancel")}),e.jsx(We,{onClick:b,color:"error",variant:"contained",forceTextOnly:!0,mobileText:r("common.delete"),desktopText:r("common.delete"),children:r("common.delete")})]})]})]})})};function Zs(r){const{children:t,value:n,index:s,...a}=r;return e.jsx("div",{role:"tabpanel",hidden:n!==s,id:`role-tabpanel-${s}`,"aria-labelledby":`role-tab-${s}`,...a,children:n===s&&e.jsx(l,{sx:{p:3},children:t})})}const rA=()=>e.jsx(Go,{role:"super_admin",children:e.jsx(sA,{})}),sA=()=>{const r=Je(),[t,n]=p.useState(0),[s,a]=p.useState(10),[i,o]=p.useState(0),[d,u]=p.useState(10),{roles:h,isLoading:m,error:x,assignPermissions:g,isAssigningPermissions:f,total:y,deleteRole:j,isDeleting:b}=Qo({page:t+1,limit:s}),{users:v,total:P,isLoading:w,error:C,refetch:k}=Ix({page:i+1,limit:d}),[A,L]=p.useState(0),[T,M]=p.useState(!1),[O,I]=p.useState(!1),[z,N]=p.useState(!1),[E,R]=p.useState(!1),[V,F]=p.useState(!1),[B,$]=p.useState(!1),[Y,_]=p.useState(!1),[K,X]=p.useState(null),[ne,oe]=p.useState(null),[ee,H]=p.useState("create"),Q=(mt,_t)=>{L(_t),is()},Z=(mt,_t)=>{n(_t)},J=mt=>{a(parseInt(mt.target.value,10)),n(0)},ae=(mt,_t)=>{o(_t)},ue=mt=>{u(parseInt(mt.target.value,10)),o(0)},le=()=>{X(null),H("create"),M(!0)},pe=mt=>{X(mt),H("edit"),M(!0)},Me=mt=>{X(mt),I(!0)},Le=mt=>{},qe=mt=>{X(mt),N(!0)},de=mt=>{X(mt),R(!0)},fe=()=>{M(!1),X(null)},ie=()=>{N(!1),X(null)},Se=()=>{R(!1),X(null)},Ve=()=>{oe(null),H("create"),F(!0)},Re=mt=>{oe(mt),H("edit"),F(!0)},xe=mt=>{oe(mt),$(!0)},te=async mt=>{try{await ir.deleteUser(mt.userId)}catch(_t){throw console.error("Error deleting user:",_t),_t}},Ee=mt=>{oe(mt),_(!0)},Ke=()=>{F(!1),oe(null)},Qt=()=>{$(!1),oe(null)},cn=()=>{_(!1),oe(null)},Ut=async mt=>{try{if(ee==="create"){const _t=await ir.createUser(mt);Yt.success(`User "${mt.email}" created successfully!`);const us="viewer",ke=h==null?void 0:h.find($e=>$e.name===us);if(ke&&_t.userId)try{await qa.assignRoleToUser(_t.userId,{roleId:ke.roleId}),Yt.info(`User automatically assigned "${ke.displayName}" role`)}catch($e){console.error("Error assigning default role:",$e),Yt.warning("User created but failed to assign default role")}}else ne!=null&&ne.userId&&(await ir.updateUser(ne.userId,mt),Yt.success(`User "${mt.email}" updated successfully!`));F(!1),oe(null)}catch(_t){console.error("Error handling user submit:",_t),Yt.error("Failed to save user")}},xr=mt=>{K&&(g({roleId:K.roleId,permissionIds:mt}),N(!1),X(null))};return m?e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsx(Ce,{})}):x?e.jsx(l,{sx:{mt:2},children:e.jsxs(je,{severity:"error",children:["Error loading roles: ",x instanceof Error?x.message:"Unknown error"]})}):e.jsxs(l,{children:[e.jsxs(l,{sx:{mb:4},children:[e.jsx(c,{variant:"pageHeader",component:"h1",sx:{background:`linear-gradient(135deg, ${r.palette.primary.main} 0%, ${r.palette.secondary.main} 100%)`,backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",mb:1,filter:"none"},children:"System Administration"}),e.jsx(c,{variant:"pageSubtitle",children:"Manage system roles, users, permissions, and automated processes"})]}),e.jsx(Te,{sx:{mb:2},children:e.jsxs(Tr,{value:A,onChange:Q,variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,sx:{px:2,"& .MuiTab-root":{minWidth:"auto",padding:"12px 16px","@media (max-width: 600px)":{padding:"8px 12px",fontSize:"0.875rem"}},"& .MuiTabs-scrollButtons":{"@media (max-width: 600px)":{width:"32px"}}},children:[e.jsx(ht,{icon:e.jsx(Jt,{}),label:"Roles",id:"role-tab-0","aria-controls":"role-tabpanel-0"}),e.jsx(ht,{icon:e.jsx(Sn,{}),label:"Users",id:"role-tab-1","aria-controls":"role-tabpanel-1"}),e.jsx(ht,{icon:e.jsx(Gr,{}),label:"Settings",id:"role-tab-2","aria-controls":"role-tabpanel-2"}),e.jsx(ht,{icon:e.jsx(fa,{}),label:"Automated Snapshots",id:"role-tab-3","aria-controls":"role-tabpanel-3"}),e.jsx(ht,{icon:e.jsx(Zt,{}),label:"Snapshot Tracking",id:"role-tab-4","aria-controls":"role-tabpanel-4"}),e.jsx(ht,{icon:e.jsx(Ue,{}),label:"Portfolios",id:"role-tab-5","aria-controls":"role-tabpanel-5"})]})}),e.jsx(Zs,{value:A,index:0,children:e.jsx(W,{container:!0,spacing:3,children:e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(c,{variant:"cardTitle",children:"System Roles"}),e.jsx(We,{variant:"contained",icon:e.jsx(xt,{}),onClick:le,mobileText:"Create",desktopText:"Create Role",children:"Create Role"})]}),e.jsx(OD,{onEditRole:pe,onViewRole:Me,onDeleteRole:Le,onManagePermissions:qe,onManageUsers:de,page:t,rowsPerPage:s,total:y,onPageChange:Z,onRowsPerPageChange:J,roles:h,isLoading:m,error:x,deleteRole:j,isDeleting:b})]})})})})}),e.jsx(Zs,{value:A,index:1,children:e.jsx(W,{container:!0,spacing:3,children:e.jsx(W,{item:!0,xs:12,children:e.jsx(se,{children:e.jsxs(me,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(c,{variant:"cardTitle",children:"System Users"}),e.jsx(We,{variant:"contained",icon:e.jsx(xt,{}),onClick:Ve,mobileText:"Create",desktopText:"Create User",children:"Create User"})]}),e.jsx(GD,{onEditUser:Re,onViewUser:xe,onDeleteUser:te,onManageRoles:Ee,page:i,rowsPerPage:d,total:P,onPageChange:ae,onRowsPerPageChange:ue,users:v,isLoading:w,error:C,refetch:k})]})})})})}),e.jsx(Zs,{value:A,index:2,children:e.jsx(XD,{})}),e.jsx(Zs,{value:A,index:3,children:e.jsx(JD,{})}),e.jsx(Zs,{value:A,index:4,children:e.jsx(ZD,{})}),e.jsx(Zs,{value:A,index:5,children:e.jsx(tA,{})}),e.jsx(VD,{open:T,onClose:fe,role:K,mode:ee}),e.jsx(HD,{open:z,onClose:ie,role:K,onSave:xr,isLoading:f}),e.jsx($D,{open:O,onClose:()=>I(!1),role:K,onEdit:pe,onManagePermissions:qe,onManageUsers:de}),e.jsx(_D,{open:E,onClose:Se,role:K}),e.jsx(QD,{open:V,onClose:Ke,user:ne,mode:ee,onSubmit:Ut,isLoading:!1,error:null}),e.jsx(KD,{open:B,onClose:Qt,user:ne,onEdit:Re,onManageRoles:Ee}),e.jsx(YD,{open:Y,onClose:cn,user:ne})]})},aA=({children:r})=>{const[t,n]=p.useState(null);p.useEffect(()=>gr.subscribe(i=>{n(i)}),[]);const s=()=>{n(null)};return e.jsxs(e.Fragment,{children:[r,t&&e.jsx(di,{open:!!t,autoHideDuration:(t==null?void 0:t.duration)||3e3,onClose:s,anchorOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(je,{onClose:s,severity:t.type,sx:{width:"100%"},icon:t.type==="success"?e.jsx(Xe,{}):t.type==="warning"?e.jsx(on,{}):e.jsx(qn,{}),children:t.message})})]})},iA=({children:r})=>{const t=An(),n=Pa(),{currentAccount:s}=Ge();return p.useEffect(()=>{s&&s.isInvestor&&(n.pathname==="/"||n.pathname==="/dashboard")&&t("/investor",{replace:!0})},[s,n.pathname,t]),e.jsx(e.Fragment,{children:r})},oA=new ag({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1,staleTime:5*60*1e3}}}),lA=()=>{const{loading:r,isAuthenticated:t}=Ge();return r?e.jsx(l,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column",gap:2},children:e.jsx(D,{variant:"h6",children:"Loading account..."})}):e.jsx(rg,{children:t?e.jsxs(e.Fragment,{children:[e.jsx(en,{path:"/",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(ek,{})})})}),e.jsx(en,{path:"/welcome",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(Mu,{})})})}),e.jsx(en,{path:"/home",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(Pl,{})})})}),e.jsx(en,{path:"/portfolios",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(Tu,{})})})}),e.jsx(en,{path:"/portfolios/new",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(Tu,{})})})}),e.jsx(en,{path:"/portfolios/:portfolioId",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(v2,{})})})}),e.jsx(en,{path:"/investor",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(KP,{})})})}),e.jsx(en,{path:"/trading",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(S2,{})})})}),e.jsx(en,{path:"/portfolios/:portfolioId/trading",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(w2,{})})})}),e.jsx(en,{path:"/holdings/:holdingId",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(HP,{})})})}),e.jsx(en,{path:"/global-assets",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(CP,{})})})}),e.jsx(en,{path:"/snapshots",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(OP,{})})})}),e.jsx(en,{path:"/holdings",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(_P,{})})})}),e.jsx(en,{path:"/transactions",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(qP,{})})})}),e.jsx(en,{path:"/reports",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(GP,{})})})}),e.jsx(en,{path:"/goals",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(cD,{})})})}),e.jsx(en,{path:"/profile",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(Ax,{})})})}),e.jsx(en,{path:"/settings",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(zD,{})})})}),e.jsx(en,{path:"/admin-management",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(rA,{})})})}),e.jsx(en,{path:"/system-guide",element:e.jsx(Cn,{children:e.jsx(l,{sx:{minHeight:"100vh"},children:e.jsx(ED,{})})})}),e.jsx(en,{path:"*",element:e.jsx(sg,{to:"/",replace:!0})})]}):e.jsxs(e.Fragment,{children:[e.jsx(en,{path:"/",element:e.jsx(Pl,{})}),e.jsx(en,{path:"/welcome",element:e.jsx(Mu,{})}),e.jsx(en,{path:"/home",element:e.jsx(Pl,{})}),e.jsx(en,{path:"/forget-password",element:e.jsx(pD,{})}),e.jsx(en,{path:"*",element:e.jsx(mD,{})})]})})},cA=()=>(p.useEffect(()=>()=>{},[]),e.jsx(ig,{client:oA,children:e.jsxs(eg,{theme:Xj,children:[e.jsx(_u,{}),e.jsx(rs,{children:e.jsx(aA,{children:e.jsx(s1,{children:e.jsxs(ng,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[e.jsx(Tk,{}),e.jsx(iA,{children:e.jsx(lA,{})})]})})})}),e.jsx(mg.ReactQueryDevtools,{initialIsOpen:!1})]})})),{slice:dA,forEach:uA}=[];function hA(r){return uA.call(dA.call(arguments,1),t=>{if(t)for(const n in t)r[n]===void 0&&(r[n]=t[n])}),r}function mA(r){return typeof r!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(n=>n.test(r))}const Lu=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,xA=function(r,t){const s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},a=encodeURIComponent(t);let i=`${r}=${a}`;if(s.maxAge>0){const o=s.maxAge-0;if(Number.isNaN(o))throw new Error("maxAge should be a Number");i+=`; Max-Age=${Math.floor(o)}`}if(s.domain){if(!Lu.test(s.domain))throw new TypeError("option domain is invalid");i+=`; Domain=${s.domain}`}if(s.path){if(!Lu.test(s.path))throw new TypeError("option path is invalid");i+=`; Path=${s.path}`}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");i+=`; Expires=${s.expires.toUTCString()}`}if(s.httpOnly&&(i+="; HttpOnly"),s.secure&&(i+="; Secure"),s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case!0:i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"strict":i+="; SameSite=Strict";break;case"none":i+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return s.partitioned&&(i+="; Partitioned"),i},Eu={create(r,t,n,s){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};n&&(a.expires=new Date,a.expires.setTime(a.expires.getTime()+n*60*1e3)),s&&(a.domain=s),document.cookie=xA(r,t,a)},read(r){const t=`${r}=`,n=document.cookie.split(";");for(let s=0;s<n.length;s++){let a=n[s];for(;a.charAt(0)===" ";)a=a.substring(1,a.length);if(a.indexOf(t)===0)return a.substring(t.length,a.length)}return null},remove(r,t){this.create(r,"",-1,t)}};var pA={name:"cookie",lookup(r){let{lookupCookie:t}=r;if(t&&typeof document<"u")return Eu.read(t)||void 0},cacheUserLanguage(r,t){let{lookupCookie:n,cookieMinutes:s,cookieDomain:a,cookieOptions:i}=t;n&&typeof document<"u"&&Eu.create(n,r,s,a,i)}},gA={name:"querystring",lookup(r){var s;let{lookupQuerystring:t}=r,n;if(typeof window<"u"){let{search:a}=window.location;!window.location.search&&((s=window.location.hash)==null?void 0:s.indexOf("?"))>-1&&(a=window.location.hash.substring(window.location.hash.indexOf("?")));const o=a.substring(1).split("&");for(let d=0;d<o.length;d++){const u=o[d].indexOf("=");u>0&&o[d].substring(0,u)===t&&(n=o[d].substring(u+1))}}return n}},fA={name:"hash",lookup(r){var a;let{lookupHash:t,lookupFromHashIndex:n}=r,s;if(typeof window<"u"){const{hash:i}=window.location;if(i&&i.length>2){const o=i.substring(1);if(t){const d=o.split("&");for(let u=0;u<d.length;u++){const h=d[u].indexOf("=");h>0&&d[u].substring(0,h)===t&&(s=d[u].substring(h+1))}}if(s)return s;if(!s&&n>-1){const d=i.match(/\/([a-zA-Z-]*)/g);return Array.isArray(d)?(a=d[typeof n=="number"?n:0])==null?void 0:a.replace("/",""):void 0}}}return s}};let ea=null;const Wu=()=>{if(ea!==null)return ea;try{if(ea=typeof window<"u"&&window.localStorage!==null,!ea)return!1;const r="i18next.translate.boo";window.localStorage.setItem(r,"foo"),window.localStorage.removeItem(r)}catch{ea=!1}return ea};var yA={name:"localStorage",lookup(r){let{lookupLocalStorage:t}=r;if(t&&Wu())return window.localStorage.getItem(t)||void 0},cacheUserLanguage(r,t){let{lookupLocalStorage:n}=t;n&&Wu()&&window.localStorage.setItem(n,r)}};let ta=null;const Fu=()=>{if(ta!==null)return ta;try{if(ta=typeof window<"u"&&window.sessionStorage!==null,!ta)return!1;const r="i18next.translate.boo";window.sessionStorage.setItem(r,"foo"),window.sessionStorage.removeItem(r)}catch{ta=!1}return ta};var bA={name:"sessionStorage",lookup(r){let{lookupSessionStorage:t}=r;if(t&&Fu())return window.sessionStorage.getItem(t)||void 0},cacheUserLanguage(r,t){let{lookupSessionStorage:n}=t;n&&Fu()&&window.sessionStorage.setItem(n,r)}},jA={name:"navigator",lookup(r){const t=[];if(typeof navigator<"u"){const{languages:n,userLanguage:s,language:a}=navigator;if(n)for(let i=0;i<n.length;i++)t.push(n[i]);s&&t.push(s),a&&t.push(a)}return t.length>0?t:void 0}},vA={name:"htmlTag",lookup(r){let{htmlTag:t}=r,n;const s=t||(typeof document<"u"?document.documentElement:null);return s&&typeof s.getAttribute=="function"&&(n=s.getAttribute("lang")),n}},wA={name:"path",lookup(r){var a;let{lookupFromPathIndex:t}=r;if(typeof window>"u")return;const n=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(n)?(a=n[typeof t=="number"?t:0])==null?void 0:a.replace("/",""):void 0}},SA={name:"subdomain",lookup(r){var a,i;let{lookupFromSubdomainIndex:t}=r;const n=typeof t=="number"?t+1:1,s=typeof window<"u"&&((i=(a=window.location)==null?void 0:a.hostname)==null?void 0:i.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(s)return s[n]}};let Mx=!1;try{document.cookie,Mx=!0}catch{}const Nx=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];Mx||Nx.splice(1,1);const TA=()=>({order:Nx,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:r=>r});class Lx{constructor(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(t,n)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=t,this.options=hA(n,this.options||{},TA()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=a=>a.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=s,this.addDetector(pA),this.addDetector(gA),this.addDetector(yA),this.addDetector(bA),this.addDetector(jA),this.addDetector(vA),this.addDetector(wA),this.addDetector(SA),this.addDetector(fA)}addDetector(t){return this.detectors[t.name]=t,this}detect(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,n=[];return t.forEach(s=>{if(this.detectors[s]){let a=this.detectors[s].lookup(this.options);a&&typeof a=="string"&&(a=[a]),a&&(n=n.concat(a))}}),n=n.filter(s=>s!=null&&!mA(s)).map(s=>this.options.convertDetectedLanguage(s)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?n:n.length>0?n[0]:null}cacheUserLanguage(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;n&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(t)>-1||n.forEach(s=>{this.detectors[s]&&this.detectors[s].cacheUserLanguage(t,this.options)}))}}Lx.type="languageDetector";const CA={loading:"Loading...",error:"Error",success:"Success",save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",create:"Create",update:"Update",close:"Close",copy:"Copy",confirm:"Confirm",yes:"Yes",no:"No",search:"Search",filter:"Filter",refresh:"Refresh",export:"Export",import:"Import",back:"Back",thisAsset:"this asset",groupByDate:"Group by Date",grid:"Grid",list:"List",group:"Group",add:"Add",createFirstTrade:"Create First Trade",user:"User",name:"Name",description:"Description",email:"Email",phone:"Phone",address:"Address",date:"Date",time:"Time",amount:"Amount",quantity:"Quantity",price:"Price",total:"Total",currency:"Currency",type:"Type",status:"Status",notes:"Notes",account:"Account",new:"New",noData:"No data",actions:"Actions",readOnlyMode:"Read-only mode - Demo Account",retry:"Retry",na:"N/A",selectAll:"Select All",deselectAll:"Deselect All",year:"year",errorOccurred:"An error occurred",noDescription:"No description",currentDate:"Current date",processing:"Processing..."},kA={toggle:{title:"Toggle data display format",masked:"Data is masked - Click to show full values",full:"Showing full values - Click to mask data",compact:"Showing compact format - Click to show full values",modes:{mask:"Mask Data",full:"Show Full",compact:"Compact Format"}}},PA={title:"Investment Goals",subtitle:"Manage and track your financial goals",create:"Create New Goal",createFirst:"Create First Goal",edit:"Edit Goal",delete:"Delete Goal",setPrimary:"Set as Primary Goal",viewDetails:"View Details",options:"Options",form:{title:"Set up a new investment goal",editTitle:"Update your goal information",name:"Goal Name",namePlaceholder:"Enter goal name",description:"Description",descriptionPlaceholder:"Enter goal description",targetValue:"Target Value",targetValuePlaceholder:"Enter target value (VND)",targetDate:"Target Date",priority:"Priority",status:"Status",isPrimary:"Primary Goal",autoTrack:"Auto Track",linkedPortfolios:"Linked Portfolios",noPortfolios:"You don't have any portfolios",noPortfoliosEdit:"No portfolios available",selectPortfolio:"Please select at least one portfolio",nameRequired:"Please enter goal name",valueRequired:"Please enter target value greater than 0",saving:"Saving...",create:"Create",update:"Update"},card:{progress:"Progress",currentValue:"Current Value",target:"Target",primary:"Primary",daysRemaining:"days remaining",date:"Date",overdue:"Overdue",today:"Today",tomorrow:"Tomorrow",yesterday:"Yesterday",remaining:"remaining",days:"days",day:"day",weeks:"weeks",week:"week",months:"months",month:"month",years:"years",year:"year",status:{overdue:"Overdue",completed:"Completed",dangerous:"Dangerous",urgent:"Urgent",attention:"Attention",excellent:"Excellent",good:"Good",okay:"Okay"},tooltip:{overdue:"Goal has exceeded the target date",completed:"Goal has been completed 100%",noTargetDate:"No target date set. Progress: {{progress}}%, Remaining: {{remaining}}%",warning:"WARNING: Time remaining {{timePercent}}% ({{days}} days) is less than the percentage needed to complete {{progressPercent}}%",safe:"SAFE: Time remaining {{timePercent}}% ({{days}} days) is sufficient to complete the remaining {{progressPercent}}%"},priority:{highest:"Highest",high:"High",medium:"Medium",low:"Low",lowest:"Lowest"}},list:{title:"Investment Goals",subtitle:"Manage and track your financial goals",create:"Create New Goal",createFirst:"Create First Goal",filters:"Filters",clearFilters:"Clear Filters",search:"Search Goals",searchPlaceholder:"Enter goal name or description...",status:"Status",allStatuses:"All Statuses",overview:"Overview",noGoals:"No goals yet",noGoalsFiltered:"No goals found matching criteria",noGoalsMessage:"Start creating your first investment goal",noGoalsFilteredMessage:"Try changing filters or search keywords",clearFiltersAction:"Clear Filters",createFirstAction:"Create First Goal",loading:"Loading...",error:"Unable to load goals list. Please try again later."},status:{active:"Active",achieved:"Achieved",paused:"Paused",cancelled:"Cancelled"},priority:{highest:"Highest",high:"High",medium:"Medium",low:"Low",lowest:"Lowest"}},DA={dashboard:"Dashboard",investor:{title:"Investor",reports:"Reports",holdings:"Holdings",goals:"Goals"},fundManagement:{title:"Fund Management",portfolios:"Portfolios",assets:"Assets",deposits:"Deposits",reports:"Reports"},settings:"Settings",systemExplanation:"System Guide",priceManagement:"Price Management",dataManagement:"Data Management",systemAdmin:"System Administration",language:"Language",snapshots:"Snapshots",holdings:"Holdings",globalAssets:"Global Assets",adminManagement:"System Administration",transactions:"Transactions",logout:"Sign Out",expandMenu:"Expand menu",collapseMenu:"Collapse menu",profileIncomplete:"Profile incomplete - Click to update",profileComplete:"Profile complete",passwordSet:"Password set, profile optional",profileNeedsCompletion:"Profile needs completion",completeYourProfile:"Complete your profile",clickToGoToHome:"Click to go to Home"},AA={title:"Portfolio Management",portfolioOverview:"Portfolio Overview",create:"Create Portfolio",edit:"Edit Portfolio",delete:"Delete Portfolio",name:"Portfolio Name",description:"Description",baseCurrency:"Base Currency",value:"Total Value",currentValue:"Current Value",quantity:"Quantity",change:"Change",changePercent:"Change %",allocation:"Allocation",marketValue:"Market Value",trading:"Trading Management",deposits:"Deposit Management",cashFlow:"Cash Flow",navHoldings:"NAV Holdings",loading:"Loading data...",creating:"Creating portfolio...",updating:"Updating portfolio...",deleting:"Deleting portfolio...",failedToLoad:"Failed to load portfolios. Please try again.",startJourney:"Start Your Investment Journey",noMatch:"No portfolios match your search criteria.",createFirstDescription:"Create your first portfolio to begin tracking your investments, monitor performance, and make informed financial decisions.",trackPerformance:"Track Performance",monitorReturns:"Monitor Returns",analyzeTrends:"Analyze Trends",adjustSearch:"Try adjusting your search criteria or filters to find the portfolio you're looking for.",createFirst:"Create Your First Portfolio",learnMore:"Learn More",copyPortfolio:"Copy Portfolio",publicTooltip:"Public Portfolio - Can be copied by other users",fund:"Fund",individual:"Individual",capitalValue:"Capital Value",investmentValue:"Investment Value",unrealizedPL:"Unrealized P&L",realizedPL:"Realized P&L",cashBalance:"Cash Balance",cannotUndo:"This action cannot be undone!",confirmDelete:'Are you sure you want to delete the portfolio "{{name}}"?',willPermanentlyDelete:"This will permanently delete",deleteTrades:"All trades and trade details",deleteCashFlows:"All cash flows and deposits",deleteSnapshots:"All performance snapshots and analytics data",deleteHoldings:"All investor holdings (if this is a fund)",deleteHistorical:"All historical data and reports",managementTrading:"Portfolio Management & Trading",investorView:"Investor View",fundManagerView:"Fund Manager View",backToPortfolios:"Back to Portfolios",refreshAllData:"Refresh all portfolio data",calculatingPerformance:"Calculating performance...",refreshAll:"Refresh All",refreshing:"Refreshing...",portfolioValue:"Portfolio Value",assetValueNav:"Asset Value & NAV",currentNav:"Current NAV (+cash)",totalAnnualReturns:"Total & Annual Returns",totalReturn:"Total Return",annualized:"Annualized",tradingActivity:"Trading Activity",tradingVolume:"Trading & Volume",totalTrades:"Total Trades",totalTradedValue:"Total Value Traded",plCosts:"P&L & Costs",profitCosts:"Profit & Costs",feesTaxes:"Fees & Taxes",performance:"Performance",deposit:"Deposit",switchToNormal:"Switch to Normal View",switchToCompact:"Switch to Compact View",createNewTrade:"Create New Trade",totalInvestment:"Total Investment",assetsDepositsValue:"Assets + Deposits Value",currentUnrealizedPL:"Current Unrealized Profit/Loss",availableCash:"Available Cash",assetClasses:"Asset Classes",differentAssetTypes:"Different Asset Types",assetTypeAllocation:"Asset Type Allocation",assetAllocation:"Asset Allocation",assetAllocationPie:"Asset Allocation",failedToLoadAllocation:"Failed to load allocation data",failedToLoadPL:"Failed to load P&L data",allocationSummary:"Allocation Summary",totalAssetsValue:"Total Assets Value",totalDepositsValue:"Total Deposits Value",noAllocationData:"No allocation data available",assetDetailSummary:"Asset Detail Summary",tradeHistory:"Trade History",individualAssetHoldings:"Individual Asset Holdings",individualAssetHoldingsDescription:"Individual asset holdings with values and performance",riskPerformanceAnalysis:"Risk & Performance Analysis",riskReturnAnalysis:"Risk(X) - Return(Y) Analysis",assetPerformanceComparison:"Asset Performance Comparison",diversificationTimeline:"Diversification & Timeline",diversificationHeatmap:"Diversification Heatmap",allocationTimeline:"Allocation Timeline",twrDescription:"TWR - Pure investment management performance",twrPerformance:"TWR Performance",portfolioPerformanceTWR:"Portfolio Performance (TWR)",individualInvestorView:"Individual Investor View",mwrDescription:"MWR - Actual investor returns with cash flows",mwrPerformance:"MWR Performance",portfolioPerformanceMWR:"Portfolio Performance (MWR)",riskMetricsDashboard:"Risk Metrics Dashboard",summarySnapshots:"Portfolio Summary Snapshots",cashBalanceNote:"Cash balance c ly t bng portfolio_snapshots.cash_balance c th khc vi cch tnh trong tab Portfolio Performance.",management:"Deposit Management",createNew:"Create New",createNewDeposit:"Create New Deposit",createSuccess:"Deposit created successfully!",createError:"Error occurred while creating deposit",updateSuccess:"Deposit updated successfully!",updateError:"Error occurred while updating deposit",settleSuccess:"Deposit settled successfully!",settleError:"Error occurred while settling deposit",deleteSuccess:"Deposit deleted successfully!",deleteError:"Error occurred while deleting deposit",loadError:"Error occurred while loading deposit data",unrealizedPLByAssetType:"Unrealized P&L by Asset Type",portfolioPerformanceSummary:"Portfolio Performance Summary",totalUnrealizedPL:"Total Unrealized P&L",profitableAssets:"Profitable Assets",bestPerformer:"Best Performer",totalAssets:"Total Assets",totalAssetValue:"Total Asset Value",totalPL:"Total P&L",assetTypes:"Asset Types",qty:"Qty",marketPrice:"Market Price",profit:"Profit",loss:"Loss",riskVsReturnAnalysis:"Risk vs Return analysis of portfolio assets",performanceComparison:"Performance comparison across asset types",correlationMatrix:"Correlation matrix showing diversification between asset types",returnBubbleSize:"Return (Bubble Size)",bubbleSizeDescription:"Larger bubble = Higher return performance (better investment)",riskVolatility:"Risk (Volatility)",performanceRating:"Performance Rating",excellent:"Excellent",good:"Good",positive:"Positive",poor:"Poor",veryPoor:"Very Poor",highReturn:"HIGH RETURN",lowReturn:"LOW RETURN",noRiskReturnData:"No risk-return data available",return:"Return",performanceUnrealizedPL:"Performance (Unrealized P&L)",totalValue:"Total Value",positions:"Positions",position:"position",noPerformanceData:"No performance data available",noDiversificationData:"No diversification data available",correlationLevel:"Correlation Level",correlationHigh:"High (0.8)",correlationMediumHigh:"Medium-High (0.6-0.8)",correlationMedium:"Medium (0.4-0.6)",correlationLow:"Low (0.2-0.4)",correlationVeryLow:"Very Low (<0.2)",form:{editTitle:"Edit Portfolio",createTitle:"Create New Portfolio",saving:"Saving...",creationMode:{title:"How would you like to create this portfolio?",createNew:"Create New",copyFromTemplate:"Copy from Template"},templateSelector:{selectTemplate:"Select a public portfolio template to copy from",browseTemplates:"Browse Templates"},fields:{name:"Portfolio Name",namePlaceholder:"e.g., Growth Portfolio, Retirement Fund",fundingSource:"Funding Source (Optional)",fundingSourcePlaceholder:"VIETCOMBANK, TPBANK, etc.",baseCurrency:"Base Currency",templateName:"Template Name",templateNamePlaceholder:"Enter template name for public portfolio",templateNameHelper:"This name will be shown to other users when browsing public portfolios",description:"Description",descriptionPlaceholder:"Describe this portfolio template...",descriptionHelper:"Optional description for the public portfolio template"},visibility:{public:"Public Portfolio",private:"Private Portfolio"}},copy:{title:"Copy Portfolio",copying:"Copying...",copy:"Copy",copyPortfolio:"Copy Portfolio",copyingFrom:"Copying from",newPortfolioName:"New Portfolio Name",newPortfolioNamePlaceholder:"Enter name for the copied portfolio",whatWillBeCopied:"What will be copied",copyItems:{trades:"All trades and trade history",cashFlows:"Cash flows and transactions",deposits:"Deposits and interest settings",settings:"Portfolio settings and configuration"},note:"Note: The new portfolio will start with zero cash balance and current market values.",validation:{nameRequired:"Please enter a portfolio name"},error:{copyFailed:"Failed to copy portfolio"}},error:{deleteFailed:"Failed to delete portfolio. Please try again.",nameAlreadyExists:'Portfolio name "{{name}}" is already taken. Please choose a different name.',templateNameAlreadyExists:'Portfolio name "{{name}}" is already taken. Please try a different template.',saveFailed:"An error occurred while saving the portfolio. Please try again.",copyTemplateFailed:"Failed to copy portfolio template. Please try again."}},IA={title:"Trading",tradeSummary:"Trade Summary",manageAndTrack:"Manage and track all your trading activities",totalVolume:"Total Volume",trades:"Trades",trade:"trade",fees:"Fees",pl:"P&L",return:"Return",returnPercent:"Return %",buy:"Buy",sell:"Sell",exchange:"Exchange",noExchangeData:"No exchange data available",exchangeInfoDescription:"Exchange information will appear here when trades are recorded",tradeHistory:"Trade History",searchPlaceholder:"Search trades by symbol, name, or notes...",side:"Side",allSides:"All Sides",groupByDate:"Group by Date",expand:"Expand",collapse:"Collapse",expandAll:"Expand All",collapseAll:"Collapse All",total:"Total",fundingSource:"Funding Source",totalValue:"Total Value",totalCost:"Total Cost",loadingTrades:"Loading trades...",noTradesFound:"No trades found",noTradesMatchFilter:"No trades match your current filter criteria.",createFirstTrade:"Create First Trade",viewDetails:"View Details",editTrade:"Edit Trade",deleteTrade:"Delete Trade",modal:{editTrade:"Edit Trade",createTrade:"Create Trade"},floatingButton:{tooltip:"Quick Create Trade",ariaLabel:"Create Trade",createPortfolioFirst:"Create Portfolio First",creatingPortfolio:"Creating Portfolio..."},autoCreatePortfolio:{name:"My Portfolio"},deleteTradeConfirm:"Are you sure you want to delete this trade for {{asset}}? This action cannot be undone.",failedToLoadTrades:"Failed to load trades",asset:"Asset",type:"Type",status:"Status",taxes:"Taxes",quantity:"Quantity",price:"Price",date:"Date",symbol:"Symbol",form:{basicInformation:"Basic Information",portfolio:"Portfolio",loadingPortfolios:"Loading portfolios...",noPortfoliosFound:"No portfolios found",asset:"Asset",searchAsset:"Search and select asset...",tradeDate:"Trade Date",tradeDetails:"Trade Details",tradeSide:"Trade Side",buy:"BUY",sell:"SELL",quantity:"Quantity",pricePerUnit:"Price per Unit",refreshMarketPrice:"Refresh market price",additionalInformation:"Additional Information (Fees & Taxes)",tradingFee:"Trading Fee",tax:"Tax",tradeType:"Trade Type",marketOrder:"Market Order",limitOrder:"Limit Order",stopOrder:"Stop Order",exchangeFundingNotes:"Exchange, Funding & Notes",exchangeFunding:"Exchange & Funding",exchangePlatform:"Exchange/Platform",enterExchangePlatform:"Enter exchange or platform name",fundingSource:"Funding Source",enterFundingSource:"Enter funding source",notes:"Notes",enterNotes:"Enter any additional notes about this trade",tradeSummary:"Trade Summary",totalValue:"Total Value",feesTaxes:"Fees & Taxes",amountReceived:"Amount Received",amountPaid:"Amount Paid",processing:"Processing...",create:"Create",update:"Update",createTrade:"Create Trade",updateTrade:"Update Trade",loadingTradeForm:"Loading trade form...",noPortfoliosAvailable:"No portfolios available. Please create a portfolio first.",createPortfolioFirst:"Create Portfolio",error:"Error",noPortfoliosFoundError:"No portfolios found. Please check if the backend is running and try again."},tradeDetails:{title:"Trade Details",tradeInformation:"Trade Information",basicInformation:"Basic Information",modal:{title:"Trade Details",loadingMessage:"Loading trade details...",editTrade:"Edit Trade"},financialDetails:"Financial Details",tradeId:"Trade ID",dateTime:"Date & Time",asset:"Asset",type:"Type",source:"Source",quantity:"Quantity",pricePerUnit:"Price per Unit",totalValue:"Total Value",feesTaxes:"Fees & Taxes",totalCost:"Total Cost",realizedPL:"Realized P&L",notes:"Notes",tradeMatchingDetails:"Trade Matching Details",totalMatched:"Total Matched",remaining:"Remaining",totalRealizedPL:"Total Realized P&L",buyTradeId:"Buy Trade ID",matchedQty:"Matched Qty",buyPrice:"Buy Price",sellPrice:"Sell Price",pl:"P&L",matchedDate:"Matched Date",unmatchedTradeWarning:" This sell trade has <strong>{{quantity}} units</strong> remaining unmatched. Consider matching with available buy trades to realize P&L.",loadingTradeDetails:"Loading trade details...",tradeTypes:{MARKET:"Market Order",LIMIT:"Limit Order",STOP:"Stop Order"},tradeSources:{MANUAL:"Manual",API:"API",IMPORT:"Import"}}},RA={title:"Asset Portfolio",pageTitle:"Assets",pageSubtitle:"Manage your portfolio assets",subtitle:"Detailed view of your assets across all portfolios",name:"Asset Name",type:"Asset Type",currentPrice:"Current Price",change:"Price Change",changePercent:"Change %",quantity:"Quantity",value:"Value",profit:"Profit",profitPercent:"Profit %",table:{asset:"Asset",type:"Type",symbol:"Symbol",quantity:"Quantity",priceComparison:"Price Comparison",totalValue:"Total Value",lastUpdated:"Last Updated",priceMode:"Update Price"},metrics:{totalAssets:"Total Assets",assetsInPortfolio:"Assets in portfolio",totalValue:"Total Value",combinedAssetValue:"Combined asset value",averageValue:"Average Value",perAssetAverage:"Per asset average",assetTypes:"Asset Types",differentCategories:"Different categories"},actions:{viewDetails:"View Details",editAsset:"Edit Asset",deleteAsset:"Delete Asset",refreshData:"Refresh Data",quickCreate:"Quick Create",quickCreateTooltip:"Select multiple assets from sample list - Fast and easy",addAsset:"Add Asset",addAssetTooltip:"Create new asset with detailed information",add:"Add"},filters:{title:"Filters",active:"Active",activeFilters:"Filters",clearAll:"Clear All",search:"Search",type:"Asset Type",portfolio:"Portfolio"},noAssets:{title:"No Assets Found",description:"You don't have any assets in your portfolio yet. Start by adding assets to track your investments."},withTrades:{title:"Assets with Trades",subtitle:"Assets that have been traded (bought/sold)",noAssets:{title:"No Active Assets",description:"You don't have any assets with trading activity yet."}},withoutTrades:{title:"Assets without Trades",subtitle:"Assets that haven't been traded yet",noAssets:{title:"No Inactive Assets",description:"All your assets have trading activity."}},errors:{loadingError:"Error loading assets"}},MA={english:"English",vietnamese:"Ting Vit",selectLanguage:"Select Language"},NA={title:"Financial Dashboard",subtitle:"Comprehensive portfolio management and investment analytics",overview:"Overview",totalValue:"Total Value",totalChange:"Total Change",totalChangePercent:"Total Change %",portfolioCount:"Portfolio Count",assetCount:"Asset Count",recentActivity:"Recent Activity",performance:"Performance",allocation:"Allocation",topPerformers:"Top Performers",worstPerformers:"Worst Performers",noData:"No data available",loading:"Loading dashboard...",failedToLoad:"Failed to load dashboard data",checkConnection:"Please check your connection and try again.",totalAssets:"Total Assets Under Management",totalPL:"Total P&L",cashPosition:"Cash Position",averagePortfolioValue:"Average Portfolio Value",portfolio:"Portfolio",portfolios:"Portfolios",profitable:"Profitable",loss:"Loss",ofTotal:"of total",liquid:"Liquid",perPortfolio:"Per portfolio",balanced:"Balanced",refreshData:"Refresh Data",systemStatus:"System Status: Active",lastUpdated:"Last Updated",dataUpdateStatus:{justUpdated:"Just updated",minutesAgo:"{{minutes}} minutes ago",hoursAgo:"{{hours}} hours ago",daysAgo:"{{days}} days ago",noData:"No data available",loading:"Loading...",systemPaused:"Auto sync disabled",systemPausedMessage:"System paused due to auto sync disabled"},portfoliosActive:"Portfolios Active",portfolioPerformance:"Portfolio Performance Analytics",bestPerforming:"Best Performing Portfolio",bestPortfolioCash:"Best Portfolio Cash",quickInsights:{title:"Quick Insights",name:"Portfolio",totalValue:"Value",dailyGrowth:"Today",ytdGrowth:"YTD"},averagePortfolioValueLabel:"Average Portfolio Value:",totalReturn:"Total Return:",activePortfolios:"Active Portfolios:",systemHealth:"System Health:",excellent:"Excellent",investmentPortfolios:"Investment Portfolios",managePortfolios:"Manage and monitor your investment portfolios",createNewPortfolio:"Create New Portfolio",noPortfoliosFound:"No Portfolios Found",startInvestment:"Start your investment journey by creating your first portfolio to track and manage your assets",createFirstPortfolio:"Create Your First Portfolio",active:"Active"},LA={required:"This field is required",invalidEmail:"Invalid email address",invalidNumber:"Invalid number",invalidDate:"Invalid date",minLength:"Minimum length is {{min}} characters",maxLength:"Maximum length is {{max}} characters",minValue:"Minimum value is {{min}}",maxValue:"Maximum value is {{max}}",submit:"Submit",cancel:"Cancel",save:"Save",delete:"Delete",edit:"Edit",create:"Create",update:"Update",close:"Close",confirm:"Confirm",yes:"Yes",no:"No",loading:"Loading...",saving:"Saving...",deleting:"Deleting...",success:"Success",error:"Error",warning:"Warning",info:"Information"},EA={noData:"No data available",loading:"Loading...",search:"Search",filter:"Filter",sort:"Sort",export:"Export",import:"Import",refresh:"Refresh",rowsPerPage:"Rows per page",of:"of",date:"Date",actions:"Actions",view:"View",edit:"Edit",delete:"Delete",copy:"Copy",download:"Download"},WA={success:"Success",error:"Error",warning:"Warning",info:"Information",portfolioCreated:"Portfolio created successfully",portfolioUpdated:"Portfolio updated successfully",portfolioDeleted:"Portfolio deleted successfully",assetAdded:"Asset added successfully",assetUpdated:"Asset updated successfully",assetDeleted:"Asset deleted successfully",tradeExecuted:"Trade executed successfully",depositAdded:"Deposit added successfully",settingsSaved:"Settings saved successfully",operationFailed:"Operation failed",networkError:"Network error occurred",unauthorized:"Unauthorized access",forbidden:"Access forbidden"},FA={required:"This field is required",email:"Please enter a valid email address",url:"Please enter a valid URL",number:"Please enter a valid number",integer:"Please enter a valid integer",positive:"Please enter a positive number",negative:"Please enter a negative number",min:"Value must be at least {{min}}",max:"Value must be at most {{max}}",minLength:"Must be at least {{min}} characters",maxLength:"Must be no more than {{max}} characters",pattern:"Please match the requested format",unique:"This value must be unique",exists:"This value must exist",date:"Please enter a valid date",time:"Please enter a valid time",currency:"Please enter a valid currency amount"},zA={general:"An error occurred",network:"Network error",server:"Server error",notFound:"Not found",unauthorized:"Unauthorized",forbidden:"Forbidden",timeout:"Request timeout",validation:"Validation error",unknown:"Unknown error"},OA={title:"Investment Holdings",subtitle:"Your investment portfolio holdings and performance",loading:"Loading your investment holdings...",error:{loadFailed:"Failed to load holdings data",loadDetailsFailed:"Failed to load holding details",fetchDetailsFailed:"Failed to fetch holding details",deleteTransactionFailed:"Failed to delete transaction",recalculateNavFailed:"Failed to recalculate NAV. Please try again.",noDetailsFound:"No holding details found"},summary:{totalInvestment:"Total Investment",currentValue:"Current Value",totalPnL:"Total P&L",totalReturn:"Total Return",holdingsCount:"{{count}} Holding",holdingsCount_other:"{{count}} Holdings",marketValue:"Market value",profitable:"Profitable",loss:"Loss",performance:"Performance"},table:{title:"Investment Holdings",subtitle:"Detailed view of your investment holdings across all portfolios",portfolio:"Portfolio",units:"Units",avgCostPerUnit:"Avg Cost/Unit",totalInvestment:"Total Investment",currentValue:"Current Value",unrealizedPnL:"Unrealized P&L",realizedPnL:"Realized P&L",totalPnL:"Total P&L",returnPercent:"Return %",date:"Date",type:"Type",navPerUnit:"NAV per Unit",amount:"Amount",description:"Description",source:"Source"},empty:{title:"No Holdings Found",message:"You don't have any investment holdings yet. Start investing by subscribing to available funds."},actions:{viewPortfolio:"View Portfolio",backToPortfolio:"Back to Portfolio",recalculate:"Recalculate",recalculateNav:"Recalculate NAV",recalculating:"Recalculating..."},detail:{investmentIn:"Investment in {{portfolioName}}",portfolioPerformance:"Portfolio Performance",currentValue:"Current Value",totalInvestment:"Total Investment",unrealizedPnL:"Unrealized P&L",returnPercent:"Return %",transactionSummary:"Transaction Summary",totalTransactions:"Total Transactions",totalFundUnits:"Total Fund Units",subscriptions:"Subscriptions",redemptions:"Redemptions",unitsSubscribed:"Units Subscribed",holdingDetails:"Holding Details",totalUnits:"Total Units",avgCostPerUnit:"Avg Cost per Unit",currentNav:"Current NAV",transactionHistory:"Transaction History"},modal:{subtitle:"Subscription & Redemption History",summary:"Summary",totalFundUnits:"Total Fund Units",totalUnitsHeld:"Total units held",totalSubscriptions:"Total Subscriptions",subscriptionCount:"Subscription count",totalRedemptions:"Total Redemptions",redemptionCount:"Redemption count",totalInvested:"Total Invested",amountInvested:"Amount invested",noTransactions:"No transactions found",noTransactionsMessage:"This holding doesn't have any subscription or redemption transactions yet."},transaction:{subscription:"Subscription",redemption:"Redemption"},subscriptionModal:{title:"New Fund Subscription",redemptionTitle:"New Fund Redemption",fundInformation:"Fund Information",fundName:"Fund Name",navPerUnit:"NAV per Unit",account:"Account",accountPlaceholder:"Search for an account or enter new account ID...",investmentAmount:"Investment Amount",investmentAmountPlaceholder:"Enter investment amount (e.g., 1,000,000)",unitsAutoCalculated:"Units (Auto-calculated)",unitsPlaceholder:"Units will be calculated automatically",unitsHelperText:"Units are calculated automatically based on amount and NAV per unit",transactionDate:"Transaction Date",transactionDateHelper:"Select the date for this subscription",description:"Description",descriptionPlaceholder:"Optional description for this subscription",calculationSummary:"Calculation Summary",calculatedUnits:"Calculated Units",investmentAmountLabel:"Investment Amount",calculationNotice:"Units are automatically calculated based on the investment amount and current NAV per unit.",dataImpactNotice:" Data Impact Notice",dataImpactMessage:"Creating this subscription will automatically update:",dataImpactItem1:"Portfolio NAV per unit and total outstanding units",dataImpactItem2:"Investor holding metrics (units, investment, P&L)",dataImpactItem3:"Cash flow records and portfolio balance",dataImpactNote:"All calculations will be based on current date and current NAV per unit",createSubscription:"Create Subscription",createRedemption:"Create Redemption",creating:"Creating...",creatingRedemption:"Creating Redemption...",validation:{accountRequired:"Please select an account or enter an account ID",amountRequired:"Amount must be greater than 0",unitsRequired:"Units must be greater than 0",dateRequired:"Transaction date is required"},error:{createFailed:"Failed to create subscription. Please try again.",unauthorized:"Account is not authorized to invest in this fund. Please contact administrator.",invalidData:"Invalid subscription data. Please check your input.",notFound:"Portfolio or account not found. Please refresh and try again."}},redemptionModal:{title:"Process Fund Redemption",fundInformation:"Fund Information",fundName:"Fund Name",navPerUnit:"NAV per Unit",investorAccount:"Investor Account (With Holdings)",investorAccountPlaceholder:"Search for an investor with holdings in this fund...",investorAccountHelper:"Only accounts with holdings in this fund are shown",redemptionAmount:"Redemption Amount (Auto-calculated)",redemptionAmountPlaceholder:"Amount will be calculated automatically",redemptionAmountHelper:"Amount is calculated automatically based on units and NAV per unit",unitsToRedeem:"Units to Redeem",unitsPlaceholder:"Enter number of units to redeem",transactionDate:"Transaction Date",transactionDateHelper:"Select the date for this redemption",description:"Description",descriptionPlaceholder:"Optional description for this redemption",redemptionSummary:"Redemption Summary",unitsToRedeemLabel:"Units to Redeem",calculatedAmount:"Calculated Amount",calculationNotice:"Amount is automatically calculated based on the units you enter and current NAV per unit.",dataImpactNotice:" Data Impact Notice",dataImpactMessage:"Processing this redemption will automatically update:",dataImpactItem1:"Portfolio NAV per unit and total outstanding units",dataImpactItem2:"Investor holding metrics (units, investment, P&L)",dataImpactItem3:"Cash flow records and portfolio balance",dataImpactNote:"All calculations will be based on current date and current NAV per unit",processRedemption:"Process Redemption",processing:"Processing...",validation:{accountRequired:"Please select an account",unitsRequired:"Units must be greater than 0",dateRequired:"Transaction date is required"},error:{createFailed:"Failed to create redemption. Please try again."}},edit:{title:"Edit {{type}} Transaction",transactionInfo:"Transaction Information",transactionType:"Transaction Type",navPerUnit:"NAV per Unit",units:"Units",unitsPlaceholder:"Enter number of units",amount:"Amount",amountPlaceholder:"Enter amount (e.g., 1,000,000)",transactionDate:"Transaction Date",description:"Description",descriptionPlaceholder:"Optional description for this transaction",calculationSummary:"Calculation Summary",calculatedAmount:"Calculated Amount",amountDifferenceNote:"Note: The calculated amount ({{calculated}}) differs from the entered amount ({{entered}}). This may be due to fees or rounding differences.",recalculationNotice:" Data Recalculation Notice",recalculationMessage:"When you update this transaction, the system will automatically recalculate:",recalculationItem1:"Portfolio NAV per unit and total outstanding units",recalculationItem2:"Holding metrics (units, investment, P&L) as of the transaction date",recalculationItem3:"All related cash flow records",recalculationDate:"Recalculation will be based on the transaction date: {{date}}",updateTransaction:"Update Transaction",updating:"Updating...",error:{updateFailed:"Failed to update transaction. Please try again."},validation:{unitsRequired:"Units must be greater than 0",amountRequired:"Amount must be greater than 0",dateRequired:"Transaction date is required"}},delete:{title:"Confirm Delete Transaction",message:"Are you sure you want to delete this transaction? This action cannot be undone.",transactionDetails:"Transaction Details",recalculationImpact:" Data Recalculation Impact",recalculationMessage:"Deleting this transaction will trigger automatic recalculation of:",recalculationItem1:"Portfolio NAV per unit and total outstanding units",recalculationItem2:"All holding metrics (units, investment, P&L) will be recalculated from remaining transactions",recalculationItem3:"Associated cash flow records will be removed",recalculationDate:"Recalculation will be based on the original transaction date: {{date}}",deleting:"Deleting...",deleteTransaction:"Delete Transaction"}},VA={holdings:{notFund:"Portfolio is not a Fund",notFundMessage:"This portfolio is not configured as a fund. Convert it to a fund to enable NAV/Unit management.",convert:"Convert",convertToFund:"Convert to Fund",fundSummary:"Fund Summary",recalculateNav:"Recalculate NAV per Unit",refreshHoldings:"Refresh Holdings & Fund Summary",navPerUnit:"NAV per Unit",totalOutstandingUnits:"Total Outstanding Units",numberOfInvestors:"Number of Investors",totalPnL:"Total P&L (current value - capital)",lastNavUpdate:"Last NAV Update",new:"New",newSubscription:"New Subscription",process:"Process",processRedemption:"Process Redemption",convertToPortfolio:"Convert to Portfolio",investorHoldings:"Investor Holdings",noHoldings:"No investor holdings found",noHoldingsMessage:"Create the first subscription to start tracking investor holdings",investor:"Investor",units:"Units",avgCost:"Avg Cost",totalInvestment:"Total Investment",currentValue:"Current Value",unrealizedPnL:"Unrealized P&L",returnPercent:"Return %",viewDetails:"View Details",convertToFundModal:{title:"Convert Portfolio to Fund",portfolioInformation:"Portfolio Information",portfolioName:"Portfolio Name",baseCurrency:"Base Currency",conversionOptions:"Conversion Options",useSnapshotDate:"Use historical snapshot date for conversion",snapshotDate:"Snapshot Date",snapshotDateHelper:"Select the historical date to use for NAV calculation during conversion",conversionInformation:"Conversion Information",conversionInfoWithDate:"This will convert the portfolio to a fund using the portfolio's state as of {{date}}. The NAV per unit will be calculated based on the portfolio's value at that specific date.",conversionInfoCurrent:"This will convert the portfolio to a fund using the current portfolio state. The NAV per unit will be calculated based on the current portfolio value.",conversionInfoAfter:"After conversion, you'll be able to manage fund subscriptions, redemptions, and track investor holdings.",converting:"Converting...",convert:"Convert",convertToFund:"Convert to Fund",validation:{invalidDateFormat:"Invalid date format. Please use YYYY-MM-DD format.",dateInFuture:"Snapshot date cannot be in the future.",snapshotDateRequired:"Snapshot date is required when using historical snapshot."},error:{convertFailed:"Failed to convert portfolio to fund"}},convertToPortfolioModal:{title:"Convert Fund to Portfolio",warningTitle:"This action will permanently remove all fund-related data!",confirmationQuestion:'Are you sure you want to convert the fund "{{name}}" back to a regular portfolio?',willDelete:"This will permanently delete:",deleteItem1:"All investor holdings and their transaction history",deleteItem2:"All fund unit transactions (subscriptions and redemptions)",deleteItem3:"All cash flows related to fund unit transactions",deleteItem4:"NAV per unit and total outstanding units will be reset to 0",deleteItem5:"Number of investors will be reset to 0",willRetain:"The portfolio will retain:",retainItem1:"All trades and their history",retainItem2:"All deposits and cash flows not related to fund units",retainItem3:"All performance snapshots and analytics data",retainItem4:"Cash balance will be recalculated from remaining cash flows",confirmationLabel:"I understand that this action will permanently delete all fund-related data and cannot be undone",converting:"Converting...",convert:"Convert",convertToPortfolio:"Convert to Portfolio"}}},$A={title:"Deposit Management",management:"Deposit Management",createNew:"Create New",createNewDeposit:"Create New Deposit",createSuccess:"Deposit created successfully!",createError:"Error occurred while creating deposit",updateSuccess:"Deposit updated successfully!",updateError:"Error occurred while updating deposit",settleSuccess:"Deposit settled successfully!",settleError:"Error occurred while settling deposit",deleteSuccess:"Deposit deleted successfully!",deleteError:"Error occurred while deleting deposit",loadError:"Error occurred while loading deposit data",noDeposits:"No deposits found. Create your first deposit!",bank:"Bank",accountNumber:"Account Number",principal:"Principal Amount",interestRate:"Interest Rate",term:"Term",totalValue:"Total Value",viewDetails:"View Details",actions:"Actions",status:"Status",edit:"Edit",delete:"Delete",settle:"Settle",active:"Active",settled:"Settled",matured:"Matured",all:"All",allPortfolios:"All Portfolios",searchByBank:"Search by Bank",clearFilters:"Clear Filters",filters:"Filters",refresh:"Refresh",overview:"Overview",totalDeposits:"Total Deposits",activeDeposits:"Active Deposits",settledDeposits:"Settled Deposits",totalPrincipal:"Total Principal",averageInterestRate:"Average Interest Rate",settledInterest:"Settled Interest",accruedInterest:"Accrued Interest",actualInterest:"Actual Interest",average:"Average",confirmDelete:"Confirm Delete Deposit",cannotUndo:"This action cannot be undone",deleteWarning:"Warning:",deleteWarningText:"You are about to permanently delete this deposit. All related data will be lost and cannot be recovered.",cancel:"Cancel",deletePermanently:"Delete Permanently",principalAmount:"Principal Amount:",interestRateLabel:"Interest Rate:",termLabel:"Term:",totalValueLabel:"Total Value:",form:{editTitle:"Edit Deposit",createTitle:"Create New Deposit",bankName:"Bank Name",accountNumber:"Account Number (Optional)",principal:"Principal Amount",principalPlaceholder:"Enter principal amount",interestRate:"Interest Rate (%/year)",interestRatePlaceholder:"Enter interest rate",term:"Term",termHelper:"Select term to automatically calculate end date",startDate:"Start Date",endDate:"End Date",notes:"Notes",processing:"Processing...",update:"Update",create:"Create",cancel:"Cancel",save:"Save",termOptions:{"1M":"1 Month","3M":"3 Months","6M":"6 Months","1Y":"1 Year","2Y":"2 Years","3Y":"3 Years","5Y":"5 Years"},validation:{portfolioIdRequired:"Portfolio ID is required",bankNameRequired:"Bank name is required",bankNameMaxLength:"Bank name cannot exceed 100 characters",accountNumberMaxLength:"Account number cannot exceed 50 characters",principalRequired:"Principal amount is required",principalMin:"Principal amount must be greater than 0",interestRateRequired:"Interest rate is required",interestRateMin:"Interest rate must be greater than or equal to 0",interestRateMax:"Interest rate cannot exceed 100%",startDateRequired:"Start date is required",endDateRequired:"End date is required",notesMaxLength:"Notes cannot exceed 500 characters",endDateAfterStart:"End date must be after start date",termTooLong:"Term cannot exceed 10 years",errorOccurred:"An error occurred"}},details:{title:"Deposit Details",maturityProgress:"Maturity Progress",portfolioInfo:"Portfolio Information",portfolioName:"Portfolio Name",loadingPortfolio:"Loading portfolio...",portfolioLoadError:"Failed to load portfolio information",noPortfolioData:"No portfolio data available",financialInfo:"Financial Information",principal:"Principal Amount",interestRate:"Interest Rate",accruedInterest:"Accrued Interest",totalValue:"Total Value",actualInterest:"Actual Interest (Settled)",timelineInfo:"Timeline Information",startDate:"Start Date",endDate:"End Date",settlementDate:"Settlement Date",additionalInfo:"Additional Information",notes:"Notes",daysUntilMaturity:"{{days}} days until maturity"},settlement:{title:"Settle Deposit",subtitle:"Confirm and complete settlement",settlementInfo:"Settlement Information",settlementInfoDesc:"Deposit details and settlement information",depositInfo:"Deposit Information",settlementDetails:"Settlement Details",financialSummary:"Financial Summary",bankName:"Bank Name",term:"Term",principal:"Principal",interestRate:"Interest Rate",accruedInterest:"Accrued Interest",total:"Total",actualInterest:"Actual Interest",actualInterestPlaceholder:"Enter actual interest amount",settlementDate:"Settlement Date",settlementDateHelper:"Select settlement date",notes:"Notes",totalReceived:"Total Received",interest:"Interest",confirmSettlement:"Confirm Settlement",processing:"Processing...",validation:{actualInterestRequired:"Actual interest amount is required",actualInterestMin:"Actual interest must be greater than or equal to 0",settlementDateRequired:"Settlement date is required",notesMaxLength:"Notes cannot exceed 500 characters"}},depositActions:{edit:"Edit Deposit",settle:"Settle"},depositStatus:{active:"Active",settled:"Settled",cancelled:"Cancelled"}},HA={title:"Cash Flow",subtitle:"Track your portfolio's cash movements",refresh:"Refresh",filter:"Filter",deposit:"Deposit",withdraw:"Withdraw",dividend:"Dividend",createDeposit:"Create Deposit",createWithdrawal:"Create Withdrawal",createDividend:"Create Dividend",management:{title:"Cash Flow Management"},summary:{title:"Cash Flow Summary",totalDeposits:"Total Deposits",totalWithdrawals:"Total Withdrawals",totalDividends:"Total Dividends",netCashFlow:"Net Cash Flow",deposits:"Deposits",withdrawals:"Withdrawals",dividends:"Dividends",netFlow:"Net Flow",totalInflows:"Total Inflows",totalOutflows:"Total Outflows",transactions:"Transactions"},chart:{title:"Cash Flow Chart",subtitle:"Visualize your cash flow trends",loading:"Loading chart data...",fetchingData:"Fetching data for portfolio {{portfolioId}}",noData:{title:"No Data Available",message:"No cash flow data available for the selected period"},refresh:"Refresh Chart",chartType:"Chart Type",lineChart:"Line Chart",barChart:"Bar Chart",pieChart:"Pie Chart",timeRange:"Time Range",last7Days:"Last 7 days",last30Days:"Last 30 days",last90Days:"Last 90 days",lastYear:"Last year",dataPoints:"{{count}} data points",view:"{{range}} view",deposits:"Deposits",withdrawals:"Withdrawals",dividends:"Dividends",interest:"Interest",debugInfo:"Debug Information"},filters:{filter:"Filter",allTypes:"All Types",deposits:"Deposits",withdrawals:"Withdrawals",dividends:"Dividends",interest:"Interest",fees:"Fees",taxes:"Taxes",buyTrades:"Buy Trades",sellTrades:"Sell Trades",tradeSettlements:"Trade Settlements",adjustments:"Adjustments",depositCreations:"Deposit Creations",depositSettlements:"Deposit Settlements",transactionTypes:"Transaction Types",dateRange:"Date Range",type:"Type",apply:"Apply",applyFilters:"Apply Filters",activeFilters:"Active filters",reset:"Reset",resetAll:"Reset All",from:"From",to:"To",types:"Types"},table:{type:"Type",amount:"Amount",description:"Description",reference:"Reference",fundingSource:"Funding Source",date:"Date",status:"Status",actions:"Actions",transactionCount:"{{count}} transactions",total:"Total",items:"{{count}} items",group:"Group",groupByDate:"Group by Date",expand:"Expand",expandAll:"Expand All",collapseAll:"Collapse All"},form:{amount:"Amount",amountPlaceholder:"Enter amount",enterAmount:"Enter amount",original:"Original",new:"New",currency:"Currency",currencyHelper:"Currency for the transaction",status:"Status",completed:"Completed",pending:"Pending",cancelled:"Cancelled",originalStatus:"Original Status",fundingSource:"Funding Source",fundingSourceOptional:"Funding Source (Optional)",fundingSourcePlaceholder:"e.g., VIETCOMBANK, BANK_ACCOUNT_001",fundingSourceHelper:"Source of the funding",flowDate:"Flow Date",flowDateHelper:"Date when the cash flow occurred",reference:"Reference",referenceHelper:"Reference number or code",description:"Description",descriptionHelper:"Description of the transaction",descriptionOptional:"Description (Optional)",referenceOptional:"Reference (Optional)"},modal:{createTitle:"Create {{type}}",editTitle:"Edit Cash Flow",createDeposit:"Create Deposit",createWithdrawal:"Create Withdrawal",createDividend:"Create Dividend",transaction:"{{type}} Transaction",creating:"Creating...",updating:"Updating...",creatingCashFlow:"Creating Cash Flow...",updatingCashFlow:"Updating Cash Flow...",createCashFlow:"Create Cash Flow",updateCashFlow:"Update Cash Flow"},delete:{title:"Delete Cash Flow",message:"Are you sure you want to delete this cash flow?",warning:"This action cannot be undone.",cancelledWarning:"This cash flow has been cancelled and cannot be deleted.",cancelledHelper:"Only active cash flows can be deleted.",error:"Error deleting cash flow",errorHelper:"Please try again or contact support.",type:"Type",amount:"Amount",description:"Description",status:"Status",deleting:"Deleting...",delete:"Delete",confirm:"Are you sure you want to cancel this cash flow?"},transfer:{title:"Transfer Cash",description:"Transfer cash between funding sources",error:"Error transferring cash",errorHelper:"Please check your input and try again.",fromSource:"From Source",fromSourceHelper:"Source to transfer from",toSource:"To Source",toSourcePlaceholder:"Enter destination source",amount:"Amount",amountPlaceholder:"Enter transfer amount",amountHelper:"Transferring {{amount}}",amountHelperEmpty:"Enter the amount to transfer",date:"Date",dateHelper:"Date of the transfer",descriptionLabel:"Description",descriptionPlaceholder:"Transfer from {{from}} to {{to}}",descriptionHelper:"Description of the transfer",source:"Source",destination:"Destination",summary:"Transfer Summary",summaryText:"Transfer {{amount}} from {{from}} to {{to}}",summaryHelper:"This will create two cash flow entries: one outflow from the source and one inflow to the destination.",transferring:"Transferring...",transfer:"Transfer",transferCash:"Transfer Cash"},tooltips:{cannotEditCancelled:"Cannot edit cancelled cash flow",edit:"Edit"},pagination:{showing:"Showing {{start}} to {{end}} of {{total}} entries",perPage:"Per page"},validation:{invalidDates:"Invalid date range. Please check your dates and try again."},error:{loadFailed:"Failed to load cash flows",createFailed:"Failed to create cash flow",cancelFailed:"Failed to cancel cash flow"},typeDescription:{deposit:"Money flowing into your portfolio",withdrawal:"Money flowing out of your portfolio",dividend:"Dividend payments received",default:"Cash flow transaction"},status:{completed:"Completed",pending:"Pending",cancelled:"Cancelled"},fundingSource:{title:"Funding Source Summary",subtitle:"Track cash flows by funding source",grid:"Grid",gridView:"Grid View",list:"List",listView:"List View",fundingSource:"Funding Source",netAmount:"Net Amount",inflow:"Inflow",outflow:"Outflow",transactions:"Transactions",lastTransaction:"Last Transaction",typeToSearch:"Type to search funding sources",enterNew:"Enter new funding source",enterNewSource:"Enter new funding source",inputLabel:"Funding Source",inputPlaceholder:"Enter funding source"},tabs:{analytics:"Analytics",history:"History"},history:{title:"Cash Flow History",transactionCount:"{{count}} transactions"},withdrawal:"Withdrawal",transferCash:"Transfer Cash"},BA={title:"Create New Transaction",subtitle:"Select the type of transaction you want to perform",create:"Create",tabs:{trading:"Buy/Sell",cashflow:"Deposit/Withdraw",deposit:"Bank Deposit",transfer:"Transfer"},options:{trading:{title:"Buy/Sell Asset",description:"Buy/Sell stocks, bonds, gold..."},cashFlow:{title:"Deposit/Withdraw",description:"Deposit or withdraw money from portfolio"},bankDeposit:{title:"Bank Deposit",description:"Create bank deposit with interest rate"},bankTransfer:{title:"Transfer Money",description:"Transfer money between funding sources"}},bankDeposit:{title:"Create Bank Deposit",description:"Add bank deposit information with interest rates"},goToCashFlow:"Go to Cash Flow",goToTrading:"Go to Trading",portfolioInfo:{title:"Selected Portfolio",fundingSource:"Funding Source",selectPortfolio:"Select Portfolio"},error:{noPortfolio:"No Portfolio Found",noPortfolioDescription:"Please create a portfolio before performing transactions"}},UA={benchmarkLoadFailed:"Failed to load benchmark data",mwrBenchmarkLoadFailed:"Failed to load MWR benchmark data",riskMetricsLoadFailed:"Failed to load risk metrics data"},_A={title:"NAV Performance History",subtitle:"Net Asset Value evolution over time",tooltipDescription:"Track portfolio value changes and performance metrics",returnPercent:"Return %",navValue:"NAV Value",currentNav:"Current NAV",totalReturn:"Total Return",maxDrawdown:"Max Drawdown",dataPoints:"Data Points",loading:"Loading NAV history data...",error:{loadFailed:"Failed to load NAV history",unableToLoad:"Unable to load NAV history data"},noData:{title:"No NAV history data available",message:"Historical data will appear here once available"},tooltipContent:{navValue:"NAV Value",portfolioPnL:"Portfolio P&L",cumulativeReturn:"Cumulative Return"},legend:{navValue:"NAV Value",portfolioPnL:"Portfolio P&L"},tooltip:{navValue:"NAV Value",portfolioPnL:"Portfolio P&L",cumulativeReturn:"Cumulative Return"}},YA={noData:"No benchmark data available",subtitle:"Portfolio performance vs {{benchmarkName}}",portfolio:"Portfolio",Difference:"Difference",trackingError:"Tracking Error",tooltip:{title:"Investor Notes:",twr:"TWR",twrDescription:"reflects fund management capability, removing cash flow impact.",mwr:"MWR",mwrDescription:"reflects actual investor returns, may vary based on timing of capital contributions/withdrawals.",comparison:"Investors should compare personal MWR with fund TWR to understand differences.",difference:"Difference"}},qA={subtitle:"Portfolio performance vs {{benchmarkName}}",portfolio:"Portfolio (MWR)",difference:"Difference",noData:"No data available for MWR chart",tooltip:{title:"Investor Notes:",mwr:"MWR",mwrDescription:"reflects actual investor returns, may vary based on timing of capital contributions/withdrawals.",twr:"TWR",twrDescription:"reflects fund management capability, removing cash flow impact.",comparison:"Investors should compare personal MWR with fund TWR to understand differences.",difference:"Difference"}},GA={title:"Trading Analysis",subtitle:"Comprehensive performance insights and analytics",loading:"Loading analysis...",noData:"No trade data available for analysis",error:{loadFailed:"Failed to load trade analysis",invalidData:"Invalid analysis data format",portfolioLoadFailed:"Failed to load portfolio information",portfolioNotFound:"Portfolio not found"},totalPnL:"Total P&L",realizedPnL:"Realized P&L",unrealizedPnL:"Unrealized P&L",winRate:"Win Rate",tradingStatistics:"Trading Statistics",trades:"Trades",average:"Avg",buyTrades:"Buy Trades",sellTrades:"Sell Trades",totalVolume:"Total Volume",riskMetrics:"Risk Metrics",riskLevel:"Risk Level",riskLevels:{high:"High",medium:"Medium",low:"Low"},maxDrawdown:"Max Drawdown",var95:"VaR 95%",sharpeRatio:"Sharpe Ratio",monthlyPerformance:"Investment Performance",assetPerformance:"Asset Performance",pieChart:"Pie Chart",compactList:"Compact List",noAssetData:"No asset performance data available",topTrades:"Top Performing Trades",best:"Best",worstTrades:"Worst Performing Trades",worst:"Worst",assetPerformanceDetails:"Asset Performance Details",asset:"Asset",side:"Side",pnl:"P&L",date:"Date",tooltip:{totalPnL:"Total P&L",realizedPnL:"Realized P&L",unrealizedPnL:"Unrealized P&L",trades:"Trades",winRate:"Win Rate",volume:"Volume",symbol:"Symbol",pnl:"P&L",performance:"Performance"},timeframe:{allTime:"All Time",oneMonth:"1 Month",threeMonths:"3 Months",sixMonths:"6 Months",oneYear:"1 Year"},granularity:{daily:"Daily",weekly:"Weekly",monthly:"Monthly"},table:{asset:"Asset",side:"Side",pnl:"P&L",date:"Date",quantity:"Quantity",avgCost:"Avg Buy Price",marketValue:"Total Sell Value",trades:"Trades"},status:{win:"Win",loss:"Loss"},unknown:{asset:"Unknown",assetName:"Unknown Asset"}},KA={noData:"No risk metrics data available",loading:"Loading risk metrics...",subtitle:"Comprehensive risk analysis and portfolio health metrics",var95:"Value at Risk (95%)",sharpeRatio:"Sharpe Ratio",volatility:"Volatility",maxDrawdown:"Max Drawdown",additionalMetrics:"Additional Risk Metrics",var99:"VaR (99%)",beta:"Beta",calmarRatio:"Calmar Ratio",sortinoRatio:"Sortino Ratio",error:{loadFailed:"Failed to load risk metrics data"}},QA={title:"NAV Summary",subtitle:"Net Asset Value Overview",tooltipContent:{currentNav:"Current Net Asset Value"},navPerUnit:"NAV/Unit",navTotal:"Total NAV",growth:"Growth",decline:"Decline",investorBenefit:"Investor Benefit",navPerUnitTooltip:"NAV/Unit = Total NAV  Outstanding Units. Shows each investor's benefit.",navPerUnitGrowth:"NAV/Unit Growth",navGrowth:"NAV Growth",recent:"Recent",fromStart:"From Start",infoNote:" Total NAV = Cash + Asset Value | NAV/Unit = Total NAV  Outstanding Units"},XA={modal:{editTitle:"Edit Asset",createTitle:"Create New Asset",updateAsset:"Update Asset",createAsset:"Create Asset"},selector:{title:"Add Asset to Portfolio",subtitle:"Choose an existing asset or create a new one",tabs:{selectExisting:"Select Existing Asset",createNew:"Create New Asset"},search:{label:"Search assets",placeholder:"Search by name or code..."},noAssets:{message:"No assets found. Try creating a new asset."},createAsset:"Create Asset",add:"Add",addSelected:"Add Selected Asset",error:{createFailed:"Failed to create asset"}},autocomplete:{label:"Asset",placeholder:"Search assets...",loading:"Loading assets...",loadMore:"Load more assets...",noResults:'No assets found for "{{searchTerm}}"',noAssets:"No assets available",create:"Create",createNew:"Create new asset",currentPrice:"Current Price"},form:{fields:{name:"Asset Name",symbol:"Asset Symbol",symbolPlaceholder:"e.g., AAPL, HPG",symbolHelper:"Symbol cannot be changed after creation.",symbolFoundInSystem:" This symbol exists in the system and is ready to use",symbolDisabledHelper:"Symbol cannot be changed after creation",type:"Asset Type",currency:"Currency",currencyHelper:"Currently only VND is supported",description:"Description",descriptionPlaceholder:"Optional description of the asset"},validation:{nameRequired:"Asset name is required",symbolRequired:"Asset symbol is required",symbolInvalidFormat:"Asset symbol can only contain letters and numbers",typeRequired:"Asset type is required",priceModeRequired:"Price mode is required",manualPriceRequired:"Manual price is required when manual mode is selected"},priceMode:{automatic:"Automatic",automaticDescription:"Automatically fetch prices from market and update periodically",manual:"Manual",manualDescription:"Only manual price input, no automatic market updates",readOnlyInfo:"Only the asset creator can change the price mode"},loading:{types:"Loading asset types...",fetchingGlobalAsset:"Searching for asset information from the market..."},error:{typesLoadFailed:"Error loading asset types"},warning:{differencesWithGlobalAsset:" Asset information differs from the system",differencesExplanation:"This information may differ from the system. You can update to sync with the latest information."},actions:{syncWithGlobalAsset:"Update from System"},info:{computedFields:{title:"Computed Fields",description:"Initial value, initial quantity, current value, and current quantity are automatically calculated based on your trades and market prices. These fields will be updated when you create trades for this asset."}}},details:{title:"Asset Details",editTooltip:"Edit Asset",deleteTooltip:"Delete Asset",loading:"Loading...",demo:"Demo",demoDataWarning:"Using demo data - API may be unavailable",noPortfolios:"No portfolios linked",status:{active:"Active",inactive:"Inactive"},portfolios:{title:"Portfolios",chip:"{{count}} Portfolio"},trading:{title:"Trading Records",chip:"{{count}} Trading",demoDescription:"Demo trading activities (API unavailable)",realDescription:"Real trading activities for this asset",foundInPortfolios:"Found in {{count}} portfolio with actual trades"},metrics:{currentValue:"Current Value",unrealizedPnL:"Unrealized P&L",pnlPercentage:"P&L Percentage",quantity:"Quantity"},sections:{keyMetrics:"Key Metrics",financialOverview:"Financial Overview",priceInformation:"Price Information",positionDetails:"Position Details",performanceAnalytics:"Performance Analytics",assetInformation:"Asset Information"},price:{currentPrice:"Current Price",averageCost:"Average Cost",priceChange:"Price Change"},position:{totalQuantity:"Total Quantity",costBasis:"Cost Basis",marketValue:"Market Value"},performance:{daily:"Daily",weekly:"Weekly",monthly:"Monthly",yearly:"Yearly"},metadata:{created:"Created",lastUpdated:"Last Updated",assetId:"Asset ID"}},delete:{title:"Delete Asset",titleWithTrades:"Delete Asset with Trades",deleting:"Deleting...",delete:"Delete",deleteWithImpact:"Delete Asset & Impacted Data",affectedPortfolios:"Affected Portfolios",impactAnalysis:"Impact Analysis",impactDescription:'The asset "{{assetName}}" is actively used in your portfolio{{portfolioCount, plural, one {} other {s}}} with {{tradeCount}} trading record{{tradeCount, plural, one {} other {s}}}.',warningMessage:"Deleting this asset will affect portfolio calculations and historical data.",whatWillBeDeleted:"What will be deleted",theAsset:'The asset "{{assetName}}"',tradingRecords:"{{count}} trading record{{count, plural, one {} other {s}}}",transactionHistory:"All associated transaction history",portfolioCalculations:"Portfolio performance calculations will be affected",safeToDelete:"Safe to Delete",safeDescription:'The asset "{{assetName}}" has no associated trades or portfolio usage.',safeMessage:"This asset can be safely deleted without affecting any portfolio data.",noTradeRecords:"No trade records (safe to delete)",confirmationText:'I understand that this action cannot be undone and will permanently delete the asset "{{assetName}}" {{tradeCount}} trading records {{portfolioCount}} portfolios.'}},JA={error:{loadFailed:"Failed to load report data"},noData:"No data available",noReportData:"No report data available",title:"Financial Report",subtitle:"Comprehensive overview of cash balance, deposits, and assets by category",portfolioFilter:"Portfolio Filter",allPortfolios:"All Portfolios",portfoliosSelected:"{{count}} portfolios selected",cashBalance:{title:"Total Cash Balance",subtitle:"Available liquidity",change:"Liquid",byFundingSource:"By Funding Source"},deposits:{title:"Total Deposits",subtitle:"{{count}} deposit",change:"Active",byBank:"By Bank",byTerm:"By Deposit Term"},assets:{title:"Total Assets",subtitle:"{{count}} asset",change:"Diversified",byExchange:"By Exchange/Platform",byGroup:"By Group"},columns:{fundingSource:"Funding Source",totalAmount:"Total Amount",share:"Share",bank:"Bank",count:"Count",value:"Value",term:"Term",exchange:"Exchange",capitalValue:"Capital Value",currentValue:"Current Value",assetGroup:"Asset Group",pnl:"P&L"}},ZA={title:"Asset Report",subtitle:"Current Asset Overview",lastUpdated:"Last Updated",totalValue:"Total Portfolio Value",totalValueDesc:"Total Portfolio Assets",totalValueWithInterest:"Total Value with Interest",investmentAssets:"Investment Assets",deposits:"Deposits",cashBalance:"Cash",ofTotal:"of total assets",assetTypes:"Asset Types",performance:"Performance",diversified:"Diversified",totalAssets:"Total Assets",positions:"Investment Positions",assetAllocation:"Asset Allocation by Type",assetType:"Asset Type",value:"Value",percentage:"Percentage",count:"Count",assetDetails:"Asset Details",symbol:"Symbol",name:"Asset Name",type:"Type",quantity:"Quantity",price:"Current Price",unrealizedPl:"Unrealized P&L",depositsSummary:"Deposits Overview",totalDeposits:"Total Deposits",depositCount:"Number of Deposits",depositPercentage:"Deposit Percentage",depositsDetails:"Deposits Details",depositId:"Deposit ID",bankName:"Bank Name",accountNumber:"Account Number",principal:"Principal Amount",interestRate:"Interest Rate (%)",status:"Status",startDate:"Start Date",endDate:"End Date",growthMetrics:"Growth Metrics",dailyGrowth:"Daily Growth",monthlyGrowth:"Monthly Growth",ytdGrowth:"Year-to-Date Growth",error:{loadFailed:"Unable to load investor report. Please try again later."}},e5={title:"Investor View",subtitle:"Overview of all your investment portfolios",loading:"Loading portfolio list...",detailedReport:"Detailed Report",backToList:"Back to List",clickToView:"Click to view details",owner:"Created by",totalValue:"Total Value",cash:"Cash",investments:"Investments",deposits:"Deposits",performance:"Performance",lastestDaily:"Lastest Daily",daily:"Daily",monthly:"Monthly",ytd:"YTD",lastUpdated:"Last Updated",noPortfolios:"No portfolios available",noPortfoliosDesc:"You don't have access to any investment portfolios. View your holdings or contact an administrator to get access.",viewHoldings:"View Holdings",managePortfolios:"Manage Portfolios",previous:"Previous",next:"Next",close:"Close",error:{loadFailed:"Unable to load portfolio list. Please try again later."}},t5={title:"Account Management",subtitle:"Manage your accounts, create new accounts, and update account information.",error:{loadFailed:"Failed to load accounts",deleteFailed:"Failed to delete account"},confirmDelete:"Are you sure you want to delete this account?",copyIdTooltip:"Click to copy Account ID",create:"Create",createAccount:"Create Account",main:"Main",investor:"Investor",protectedAccount:"Protected Account",noAccounts:"No accounts found. Create your first account to get started.",moreActions:"More Actions",deleteConfirm:{title:"Delete Account",subtitle:"This action cannot be undone",message:'Are you sure you want to delete the account "{{accountName}}" ({{accountEmail}})?',warning:"This will permanently delete the account and all associated data. This action cannot be undone.",deleting:"Deleting..."}},n5={switching:"Switching...",switchAccount:"Switch Account",selectAccount:"Select Account",editCurrentAccount:"Edit Current Account",loadingAccounts:"Loading accounts...",noAccounts:"No accounts available",mainAccount:"Main Account",demoAccount:"Demo Account",demoAccountBanner:{title:"You are using a Demo Account",demoMode:"Demo Mode",message:"Demo Account allows read-only access. To get full editing and management permissions, please switch to your main account.",switchToMainAccount:"Switch to Main Account",switchToAccount:"Switch Account",noOtherAccounts:"Note: You don't have a main account yet. Please contact an administrator to create one."},demoAccountSuggestion:{title:"Explore Demo Account",newFeature:"New Feature",message:"Try out the system with the Demo Account to see features and sample data. The Demo Account provides real data and allows you to explore the system safely.",tryDemo:"Try Demo"},investor:"Investor",protectedAccount:"Protected Account",updateAccountInfo:"Update account information",manageAccounts:"Manage Accounts",manageAccountsDescription:"Create, edit, and manage all accounts",refreshAccounts:"Refresh accounts"},r5={title:"Settings",subtitle:"Manage your account settings and preferences",tabs:{accountManagement:"Account Management",security:"Security",profile:"Profile",notifications:"Notifications",appearance:"Appearance",adminMessages:"Admin Messages"},security:{title:"Security Settings",subtitle:"Manage your security preferences and authentication settings.",password:{title:"Password",subtitle:"Change your password",description:"Update your password to keep your account secure."},twoFactor:{title:"Two-Factor Authentication",subtitle:"Add an extra layer of security",description:"Enable 2FA to protect your account with an additional security layer."}},notifications:{title:"Notification Settings",subtitle:"Configure how you receive notifications and alerts.",email:{title:"Email Notifications",subtitle:"Manage email alerts",description:"Choose which email notifications you want to receive."},push:{title:"Push Notifications",subtitle:"Browser notifications",description:"Control browser push notifications for real-time updates."}},appearance:{title:"Appearance Settings",subtitle:"Customize the look and feel of your application.",theme:{title:"Theme",subtitle:"Choose your preferred theme",description:"Switch between light and dark themes."},language:{title:"Language",subtitle:"Select your language",description:"Choose your preferred language for the interface."}}},s5={error:{createFailed:"Failed to create account. Please try again."},title:"Create New Account",creating:"Creating...",create:"Create",createAccount:"Create Account",accountInfoTitle:"Account Information",fields:{name:"Account Holder Name",nameHelper:"Enter the full name of the account holder",email:"Email Address (Optional)",emailHelper:"Optional: Enter email address for account identification",baseCurrency:"Base Currency",canInvest:"Can invest in funds",canInvestHelper:"Enable this if this account can invest in fund portfolios"}},a5={title:"All Portfolios",subtitle:"View all portfolios in the system",columns:{portfolioName:"Portfolio Name",portfolioId:"Portfolio ID",createdBy:"Created By",createdById:"Created By ID",totalValue:"Total Value",createdAt:"Created At"},noPortfolios:"No portfolios found in the system",error:{loadFailed:"Failed to load portfolios"}},i5={portfolioList:{title:"All Portfolios",subtitle:"Manage portfolios in the system",loading:"Loading portfolios...",error:"Failed to load portfolios",totalPortfolios:"Total Portfolios",uniqueUsers:"Unique Users",totalValue:"Total Value",lastUpdated:"Last Updated",searchPlaceholder:"Search portfolios or users...",refresh:"Refresh",noResults:"No portfolios found matching your search",noPortfolios:"No portfolios found in the system",table:{portfolioName:"Portfolio Name",portfolioId:"Portfolio ID",createdBy:"Created By",user:"User",currency:"Currency",createdAt:"Created At",actions:"Actions"},deletePortfolio:"Delete Portfolio",deleteDialog:{title:"Delete Portfolio",message:'Are you sure you want to delete portfolio "{{portfolioName}}"? This action cannot be undone.'}}},o5={error:{loadUsers:"Failed to load users",sendFailed:"Failed to send message",noPermission:"You don't have permission to access this feature. Admin role required."},validation:{titleAndMessageRequired:"Title and message are required",selectTarget:'Please select target users, role, or enable "Send to All"'},success:{sent:"Message sent successfully to {{target}}"},allUsers:"all users",usersCount:"{{count}} users",title:"Send Message to Users",subtitle:"Send notifications to specific users, roles, or all users in the system.",messageDetails:{title:"Message Details",titleLabel:"Message Title",titlePlaceholder:"Enter message title",contentLabel:"Message Content",contentPlaceholder:"Enter your message content",actionUrlLabel:"Action URL (Optional)",actionUrlPlaceholder:"e.g., /portfolios, /settings",actionUrlHelper:"Users can click this link from the notification",priorityLabel:"Priority"},priority:{low:"Low",normal:"Normal",high:"High"},targetUsers:{title:"Target Users",sendToAll:"Send to All Users",selectUsers:"Select Users",searchUsers:"Search users...",selectByRole:"Or Select by Role",selectRole:"Select Role"},roles:{user:"Users",admin:"Admins",superAdmin:"Super Admins"},sending:"Sending...",send:"Send",sendMessage:"Send Message"},l5={title:"Portfolio Snapshots",subtitle:"Manage and view portfolio snapshots",pageTitle:"Snapshot Management",pageSubtitle:"Manage portfolio snapshots, view performance charts, and export/import data",selectPortfolio:"Select Portfolio",selectPortfolioPlaceholder:"Choose a portfolio from the dropdown above to view its snapshots",portfolioDetails:"Portfolio Details",totalSnapshots:"Total Snapshots",latestSnapshot:"Latest Snapshot",oldestSnapshot:"Oldest Snapshot",portfolioInfo:"Portfolio Info",noSnapshots:"No snapshots",snapshots:"snapshots",latest:"Latest",created:"Created",loadingSnapshots:"(Loading snapshots...)",failedToLoadPortfolios:"Failed to load portfolios",refreshData:"Refresh Data",refreshing:"Refreshing...",refreshConfirmTitle:"Confirm Data Refresh",refreshConfirm:"Are you sure you want to refresh all snapshot data?",refreshWarning:"This action will refresh all data and may take a few seconds to complete.",createSnapshots:"Create Snapshots",recalculateAll:"Recalculate All",recalculating:"Recalculating...",createForAllPortfolios:"Create Snapshots for All Portfolios",createForMultiplePortfolios:"Create Snapshots for Multiple Portfolios",selectPortfolios:"Select Portfolios",portfoliosSelected:"portfolios selected",selectAtLeastOnePortfolio:"Please select at least one portfolio",selectGranularity:"Please select granularity",processing:"Processing {days} days for {portfolios} portfolios...",deleteSnapshots:"Delete Snapshots",moreActions:"More Actions",refreshDataTooltip:"Refresh Data",moreActionsTooltip:"More Actions",snapshotDeletedSuccess:"Snapshot deleted successfully!",snapshotDeleteFailed:"Failed to delete snapshot. Please try again.",recalculateConfirmTitle:"Confirm Recalculation",recalculateConfirm:"Are you sure you want to recalculate all snapshots for this portfolio?",recalculateWarning:"This action will recalculate all existing snapshots and may take several minutes to complete.",recalculateSuccess:"All snapshots recalculated successfully!",recalculateFailed:"Failed to recalculate snapshots. Please try again.",dataRefreshedSuccess:"Data refreshed successfully!",dataRefreshError:"Error refreshing data",deleteSuccess:"Delete Success",deleteFailed:"Delete Failed",snapshotCreatedSuccess:"Snapshot created successfully for portfolio on",snapshotCreateFailed:"Failed to create snapshot",tabs:{portfolioSummary:"Portfolio Summary",portfolioPerformance:"Portfolio Performance",assetGroupPerformance:"Asset Group Performance",assetPerformance:"Asset Performance",assetSnapshots:"Asset Snapshots"},modals:{createSnapshot:{title:"Create Snapshot for All Assets",selectPortfolio:"Select Portfolio",dateRangeMode:"Date Range Mode",singleDateMode:"Single Date Mode",dateRangeModeDescription:"Create snapshots for multiple dates",singleDateModeDescription:"Create snapshot for a single date",snapshotDate:"Snapshot Date",startDate:"Start Date",endDate:"End Date",selectDate:"Select the date for the snapshot",startDateHelper:"Start date for snapshot range",endDateHelper:"End date for snapshot range",granularity:"Granularity",daily:"Daily",weekly:"Weekly",monthly:"Monthly",create:"Create",creating:"Creating...",cancel:"Cancel",createSnapshot:"Create Snapshot",created:"Created successfully",selectPortfolioAndGranularity:"Please select a portfolio and granularity",selectStartDate:"Please select a start date",selectEndDate:"Please select an end date",startDateBeforeEndDate:"Start date must be before end date",startDateNotFuture:"Start date cannot be in the future",processingDays:"Processing {{days}} days of snapshots... This may take a few minutes.",successCreated:"Successfully created {{count}} snapshots for {{portfolioName}}",noSnapshotsCreated:"No snapshots created for portfolio {{portfolioName}}.",errorCreating:"Error {{status}}: {{message}}",failedToLoadPortfolios:"Failed to load portfolios",createForMultiplePortfolios:"Create Snapshots for Multiple Portfolios",useDateRange:"Use Date Range",selectPortfolios:"Select Portfolios",portfoliosSelected:"portfolios selected",selectAtLeastOnePortfolio:"Please select at least one portfolio",selectGranularity:"Please select granularity",loadingPortfolios:"Loading portfolios...",processing:"Processing {days} days for {portfolios} portfolios...",lastSnapshot:"Last snapshot",noSnapshots:"No snapshots",totalSnapshots:"Total snapshots"},deleteSnapshots:{title:"Delete Snapshots",deleteMode:"Delete Mode",specificDate:"Specific Date",dateRange:"Date Range",byGranularity:"By Granularity",specificDateDescription:"Delete all snapshots for a specific date",dateRangeDescription:"Delete all snapshots within a date range",granularityDescription:"Delete all snapshots of a specific granularity (daily/weekly/monthly)",granularity:"Granularity",daily:"Daily",weekly:"Weekly",monthly:"Monthly",snapshotDate:"Snapshot Date",startDate:"Start Date",endDate:"End Date",selectDate:"Select the date to delete snapshots",startDateHelper:"Start date for deletion range",endDateHelper:"End date for deletion range",warning:"Warning: This action cannot be undone!",warningDescription:"All selected snapshots will be permanently deleted from the database.",delete:"Delete",deleting:"Deleting...",cancel:"Cancel",deleteSnapshots:"Delete Snapshots",portfolioIdRequired:"Portfolio ID is required",selectSnapshotDate:"Please select a snapshot date",selectBothDates:"Please select both start and end dates",startDateBeforeEndDate:"Start date must be before end date",invalidDeleteMode:"Invalid delete mode",successDeleted:"Successfully deleted {{count}} snapshots",errorDeleting:"Error {{status}}: {{message}}",failedToDelete:"Failed to delete snapshots"}}},c5={error:{updateFailed:"Failed to update account. Please try again."},title:"Edit Account Information",updating:"Updating...",update:"Update",updateAccount:"Update Account",fields:{name:"Account Holder Name",nameHelper:"Enter the full name of the account holder",email:"Email Address",emailHelper:"This will be used for account identification",baseCurrency:"Base Currency",canInvest:"Can invest in funds",canInvestHelper:"Enable this if this account can invest in fund portfolios"}},d5={title:"Select Portfolio Template",searchPlaceholder:"Search portfolio templates...",noDescription:"No description available",createdBy:"Created by: {{name}}",tradesCount:"{{count}} trades",tradesCount_other:"{{count}} trades",cashFlowsCount:"{{count}} cash flows",cashFlowsCount_other:"{{count}} cash flows",depositsCount:"{{count}} deposits",depositsCount_other:"{{count}} deposits",noSearchResults:"No portfolios match your search",noPortfolios:"No public portfolios available",error:{loadFailed:"Failed to load public portfolios"}},u5={title:"Select Assets from Template List",help:{title:" Usage Guide",description:"Select assets from the template list to quickly create them in your portfolio. The list only shows assets you don't already own. You can also search by name or symbol."},search:{label:"Search assets",placeholder:"Enter name or symbol..."},type:{label:"Asset Type",all:"All"},select:{selectAll:"Select All",deselectAll:"Deselect All"},creating:"Creating...",createCount:"Create {{count}}",createAssets:"Create {{count}} Assets",results:{found:"Found {{count}} assets not in portfolio"},noAssets:{allOwned:"You already own all available assets in the system",noSearchResults:"No assets found matching your search criteria"},success:{allCreated:" Successfully created {{count}} assets",partialCreated:" Successfully created {{created}}/{{total}} assets. {{failed}} assets failed."},error:{loadFailed:"Failed to load asset list",createFailed:" Error creating assets",allFailed:" Failed to create all {{count}} assets"}},h5={title:"Portfolio Management System",subtitle:{enterUsername:"Enter your username to get started",welcomeBack:"Enter your username to continue (no password required)",signIn:"Enter your username and password to sign in",continue:"Enter your username to continue (no password required)"},form:{username:"Username",password:"Password",usernamePlaceholder:"Enter your username",passwordPlaceholder:"Enter your password to continue",usernameHelper:"Enter your username",passwordHelper:"Enter your password to continue",passwordHelperError:"Please enter the correct password"},buttons:{enterUsername:"Enter Username",welcomeBack:"Welcome Back",signIn:"Sign In",continue:"Continue",signingIn:"Signing In...",backToWelcome:"Back to Welcome",hide:"Hide",show:"Show"},messages:{welcomeBack:"Welcome back, {{username}}",enterPassword:"Enter your password to continue",userHasPassword:"This user has a password set - please enter your password to continue",userIncomplete:"This user has incomplete profile - no password required",easyStart:"Easy start - no password required for new users",usernameRequired:"Please enter a username",passwordRequired:"Password is required for this user",incorrectPassword:"Incorrect password. Please try again.",loginFailed:"Login failed. Please try again.",usernameFormat:"Username must contain only letters, numbers, hyphens (-), and underscores (_)",newUserWelcome:" Welcome to Portfolio Management System! Click here to get started with our guided tour.",newUserWelcomeTitle:"Welcome to Portfolio Management System!",newUserWelcomeMessage:"You're all set! Let's take a quick tour to help you get started with managing your investments."},history:{title:"Recent Users - Quick Login",secure:"Secure",removeUser:"Remove user from history"},errors:{loginFailed:"Login failed. Please try again.",incorrectPassword:"Incorrect password. Please try again.",usernameFormat:"Username must contain only letters, numbers, hyphens (-), and underscores (_)",usernameRequired:"Please enter a username",passwordRequired:"Password is required for this user"}},m5={title:"Profile",subtitle:"Manage your account information and security settings",basicInfo:{title:"Basic Information",username:"Username",usernameHelper:"Username cannot be changed",fullName:"Full Name",email:"Email",emailVerified:"Email verified",emailVerificationRequired:"Email verification required"},advancedInfo:{title:"Advanced Information",phone:"Phone",dateOfBirth:"Date of Birth",address:"Address"},security:{title:"Security",setPasswordDescription:"Set a password to secure your account",passwordSetDescription:"Password is set. You can change it below.",newPassword:"New Password",currentPassword:"Current Password",passwordHelper:"Password must be at least 6 characters (letters, numbers, or special characters)"},authStates:{complete:"Secure Account",partial:"Profile Complete",demo:"Demo Account",unknown:"Unknown"},buttons:{edit:"Edit",editProfile:"Edit Profile",save:"Save",saveChanges:"Save Changes",saving:"Saving...",cancel:"Cancel",setPassword:"Set Password",set:"Set",setting:"Setting...",changePassword:"Change Password",change:"Change",changing:"Changing...",advanced:"Advanced",advancedInformation:"Advanced Information"},messages:{profileUpdated:"Profile updated successfully",passwordSet:"Password set successfully",passwordChanged:"Password changed successfully",userNotFound:"User not found",completeProfile:"Complete your profile",completeProfileDescription:"Please fill in your information to access all features. This page is in edit mode to help you get started.",cannotCancel:"Please complete your profile before canceling",failedToLoad:"Failed to load profile",failedToUpdate:"Failed to update profile",failedToSetPassword:"Failed to set password",failedToChangePassword:"Failed to change password"},errors:{currentPasswordIncorrect:"Current password is incorrect. Please check your current password.",noPasswordSet:"Account has no password. Please set a password first.",authenticationFailed:"Authentication failed. Please log in again.",invalidData:"Invalid data. Please check your information.",userNotFound:"User not found. Please log in again.",passwordTooShort:"New password is invalid. Password must be at least 6 characters.",cannotChangePassword:"Cannot change password. Please try again."}},x5={title:"Welcome to Portfolio Management System",subtitle:"Your comprehensive solution for tracking investments, managing portfolios, and analyzing performance with real-time data and advanced analytics.",buttons:{getStarted:"Get Started",viewDashboard:"View Dashboard"},features:{title:"Key Features",portfolio:{title:"Portfolio Management",description:"Comprehensive portfolio tracking and management",feature1:"Real-time portfolio valuation",feature2:"Performance analytics and reporting",feature3:"Asset allocation tracking",feature4:"Historical performance analysis"},trading:{title:"Trading Management",description:"Advanced trading and position management",feature1:"Buy/sell transaction recording",feature2:"FIFO/LIFO trade matching",feature3:"P&L calculation and tracking",feature4:"Risk management tools"},analytics:{title:"Analytics & Reporting",description:"Comprehensive analytics and insights",feature1:"Interactive performance charts",feature2:"Risk metrics and analysis",feature3:"Benchmark comparisons",feature4:"Custom reporting tools"},assets:{title:"Asset Management",description:"Multi-asset investment tracking",feature1:"Stocks, bonds, and commodities",feature2:"Real-time market data",feature3:"Price history tracking",feature4:"Asset performance analysis"},deposits:{title:"Deposit Management",description:"Bank deposit and interest tracking",feature1:"Interest rate calculations",feature2:"Early settlement support",feature3:"Deposit performance tracking",feature4:"Cash flow management"},funds:{title:"Fund Management",description:"Investment fund management",feature1:"Fund subscription/redemption",feature2:"NAV tracking and updates",feature3:"Investor management",feature4:"Fund performance analytics"}},quickStart:{title:"Quick Start Guide",step1:{title:"Create Your First Portfolio",description:"Start by creating a new portfolio to organize your investments. This will be your main workspace for tracking performance and managing assets.",action:"Create Portfolio"},step2:{title:"Add Your First Trade",description:"Record your first buy or sell transaction. The system will automatically calculate your position and track your performance.",action:"Start Trading"},step3:{title:"Manage Your Assets",description:"Add and organize your investment assets. Track stocks, bonds, gold, deposits, and other investment instruments.",action:"Manage Assets"},step4:{title:"View Your Dashboard",description:"Monitor your portfolio performance with real-time analytics, charts, and comprehensive reporting tools.",action:"View Dashboard"}},capabilities:{title:"System Capabilities",realTime:"Real-time Data",analytics:"Advanced Analytics",multiAccount:"Multi-Account Support",mobile:"Mobile Responsive",secure:"Secure & Reliable",scalable:"Scalable Architecture"},footer:{message:"Ready to start managing your investments? Choose your next step below.",dashboard:"Dashboard",portfolios:"Portfolios"},quickStartGuide:{subtitle:"Follow these simple steps to get started with your portfolio management",progress:{step:"Step {{current}} of {{total}}",complete:"{{percentage}}% Complete"},navigation:{previous:"Previous",next:"Next"},completion:{title:"Congratulations! ",message:"You've completed all the setup steps. Your portfolio management system is ready to use!"},steps:{currentStep:"Current Step",clickToContinue:"Click to continue",createPortfolio:{title:"Create Your First Portfolio",description:"Start by creating a new portfolio to organize your investments. This will be your main workspace for tracking performance and managing assets.",action:"Create Portfolio"},addCashFlow:{title:"Add Cash Flow Source",description:"Set up your initial cash flow source to fund your portfolio. This could be salary, savings, or other income streams.",action:"Add Cash Flow"},addTrade:{title:"Add Your First Trade",description:"Record your first buy or sell transaction. The system will automatically calculate your position and track your performance.",action:"Start Trading"},manageAssets:{title:"Manage Your Assets",description:"Add and organize your investment assets. Track stocks, bonds, gold, deposits, and other investment instruments.",action:"Manage Assets"},viewDashboard:{title:"View Your Dashboard",description:"Monitor your portfolio performance with real-time analytics, charts, and comprehensive reporting tools.",action:"View Dashboard"}}}},p5={title:"Manage Portfolio Permissions",addNewPermission:"Add New Permission",accountId:"Account ID",accountIdPlaceholder:"Enter account ID (UUID format)",permission:"Permission",addPermission:"Add Permission",currentPermissions:"Current Permissions",account:"Account",granted:"Granted",actions:"Actions",removePermission:"Remove Permission",transferCreator:"Transfer Portfolio Creator",transferCreatorWarning:" WARNING: This is a critical action!",transferCreatorWarningMessage:"You are transferring portfolio ownership to another person. After transfer, you will lose ownership and cannot see this portfolio anymore. This action cannot be undone!",transferCreatorSuccess:"Portfolio ownership transferred successfully!",deleteSuccess:"Permission deleted successfully!",confirmRemove:"Confirm Permission Removal",confirmRemoveDescription:"Are you sure you want to remove this permission? This action cannot be undone.",noPermissions:"No permissions set for this portfolio",noPermissionsDescription:"Add accounts to share access to this portfolio",permissionTypes:{owner:"Owner",update:"Update",view:"View",creator:"Creator"},errors:{loadFailed:"Failed to load permissions",addFailed:"Failed to add permission",deleteFailed:"Failed to delete permission",transferCreatorFailed:"Failed to transfer portfolio ownership"}},g5={title:"Trusted Devices",subtitle:"Manage devices that can access your account without password",stats:{totalDevices:"Total Devices",activeDevices:"Active Devices",expiredDevices:"Expired Devices",highTrust:"High Trust"},noDevices:{title:"No Trusted Devices",subtitle:"Devices will be automatically added when you log in"},device:{lastUsed:"Last used",expired:"Expired",revoke:"Revoke Device",revokeAll:"Revoke All Devices",refresh:"Refresh"},dialogs:{revokeDevice:{title:"Revoke Device",message:"Are you sure you want to revoke this device? You will need to enter your password the next time you log in from this device.",cancel:"Cancel",confirm:"Revoke"},revokeAll:{title:"Revoke All Devices",warning:"This will revoke all trusted devices. You will need to enter your password the next time you log in from any device.",message:"Are you sure you want to revoke all {{count}} devices?",cancel:"Cancel",confirm:"Revoke All",revoking:"Revoking..."}},errors:{loadFailed:"Failed to load device data",revokeFailed:"Failed to revoke device",revokeAllFailed:"Failed to revoke all devices"}},f5={title:"Forgot Password",subtitle:"Enter your email to contact admin for support",emailLabel:"Email",submitButton:"Send Request",backToLogin:"Back to Login",contactAdmin:{title:"Contact Admin",description:"If you forgot your password, please contact admin for support",button:"Contact Admin",modal:{title:"Contact Admin",description:"This feature is under development. Please contact admin via email below for the fastest support.",contactInfo:"Contact Information:",messageLabel:"Message",messagePlaceholder:"Describe your issue in detail...",cancel:"Cancel",send:"Send Message",sending:"Sending...",success:"Message sent successfully! Admin will contact you back as soon as possible."}},errors:{emailRequired:"Please enter email",invalidEmail:"Invalid email format",submitFailed:"Failed to send request"}},y5={title:"Portfolio Management System",subtitle:"Track and manage your investment portfolio professionally",sections:{assetTypes:{title:"Supported Asset Types",subtitle:"Diverse asset types to diversify your investment portfolio"},stockFunds:{title:"Stock Fund Certificates",subtitle:"Equity funds with the best performance"},bondFunds:{title:"Bond Fund Certificates",subtitle:"Safe and stable bond investment funds"},topStocks:{title:"Top 5 Stocks",subtitle:"Stocks with the highest trading volume and price volatility"}},assetTypes:{stock:"Stocks",stockDesc:"Invest in stocks on exchanges",bond:"Bonds",bondDesc:"Invest in government and corporate bonds",gold:"Gold",goldDesc:"Invest in gold and precious metals",crypto:"Cryptocurrency",cryptoDesc:"Invest in cryptocurrency and digital assets",commodity:"Commodities",commodityDesc:"Invest in commodities and raw materials",realEstate:"Real Estate",realEstateDesc:"Invest in real estate and REITs",other:"Other",otherDesc:"Other asset types"},table:{symbol:"Symbol",name:"Name",price:"NAV Price",change:"Change",exchange:"Exchange"},noData:"No data available",cta:{title:"Ready to start managing your investment portfolio?",description:"Login or sign up now to experience the full range of professional portfolio management features",button:"Login / Sign Up"},stats:{products:"Fund Products",users:"Users",portfolios:"Investment Portfolios"},projectName:"MMO",menu:{home:"Home",features:"Features","features.portfolio":"Portfolio Management","features.tracking":"Daily Tracking","features.security":"Security",contact:"Contact"},register:{short:"Sign Up",full:"Sign Up"},login:{short:"Start",full:"Get Started"},features:{title:"Key Features",subtitle:"Powerful tools for efficient investment management"},trust:{title:"Safe and Transparent Investment",subtitle:"Professional portfolio management system with high security",safe:{title:"Absolute Security",description:"Money and assets are managed and monitored closely"},transparent:{title:"Transparent",description:"Track and manage assets transparently"},professional:{title:"Professional",description:"Professional investment portfolio management system"}},steps:{badge:"Guide",title:"Get Started in Just 3 Steps",subtitle:"Investing has never been easier. Start your investment journey today",register:{title:"Login",description:"Login to the system to start using"},invest:{title:"Create Investment Goal",description:"Create investment goals according to your investment objectives"},manage:{title:"Manage Assets",description:"Convenient asset tracking and easy trading"}},vision:{title:"Turn Your Goals Into Reality",easyManagement:"Easy Management",free:"Completely Free"}},b5={common:CA,dataDisplay:kA,goals:PA,navigation:DA,portfolio:AA,trading:IA,assets:RA,language:MA,dashboard:NA,forms:LA,tables:EA,notifications:WA,validation:FA,errors:zA,holdings:OA,nav:VA,deposit:$A,cashflow:HA,genericForm:BA,portfolioError:UA,navHistory:_A,benchmark:YA,mwrBenchmark:qA,tradeAnalysis:GA,riskMetrics:KA,navSummary:QA,asset:XA,report:JA,investorReport:ZA,investorView:e5,accountManagement:t5,accountSwitcher:n5,settings:r5,createAccountModal:s5,adminPortfolioList:a5,admin:i5,adminMessage:o5,snapshots:l5,editAccountModal:c5,publicPortfolioSelector:d5,bulkAssetSelector:u5,login:h5,profile:m5,welcome:x5,permissions:p5,deviceManagement:g5,forgetPassword:f5,home:y5},j5={loading:"ang ti...",error:"Li",success:"Thnh cng",save:"Lu",cancel:"Hy",delete:"Xa",deleting:"ang xa...",edit:"Chnh sa",create:"To mi",update:"Cp nht",close:"ng",copy:"Sao chp",confirm:"Xc nhn",yes:"C",no:"Khng",search:"Tm kim",filter:"Lc",refresh:"Lm mi",export:"Xut",import:"Nhp",back:"Quay li",thisAsset:"ti sn ny",groupByDate:"Nhm theo ngy",grid:"Li",list:"Danh sch",group:"Nhm",add:"Thm",createFirstTrade:"To giao dch u tin",user:"Ngi dng",name:"Tn",description:"M t",email:"Email",phone:"in thoi",address:"a ch",date:"Ngy",time:"Gi",amount:"S tin",quantity:"S lng",price:"Gi",total:"Tng cng",currency:"Tin t",type:"Loi",status:"Trng thi",notes:"Ghi ch",account:"Ti khon",new:"Mi",noData:"Khng c d liu",actions:"",readOnlyMode:"Ch  ch c",moreActions:"Thm hnh ng",retry:"Th li",na:"N/A",selectAll:"Chn tt c",deselectAll:"B chn tt c",year:"nm",errorOccurred:"C li xy ra",noDescription:"Khng c m t",currentDate:"Ngy hin ti",processing:"ang x l..."},v5={toggle:{title:"Chuyn i nh dng hin th d liu",masked:"D liu b n - Nhn  hin th gi tr y ",full:"ang hin th gi tr y  - Nhn  n d liu",compact:"ang hin th nh dng rt gn - Nhn  hin th gi tr y ",modes:{mask:"n D Liu",full:"Hin Th y ",compact:"nh Dng Rt Gn"}}},w5={title:"Mc tiu u t",subtitle:"Qun l v theo di cc mc tiu ti chnh ca bn",create:"Thm mc tiu",createFirst:"To mc tiu u tin",edit:"Chnh sa mc tiu",delete:"Xa mc tiu",setPrimary:"t lm mc tiu chnh",viewDetails:"Xem chi tit",options:"Ty chn",form:{title:"Thit lp mc tiu u t mi",editTitle:"Cp nht thng tin mc tiu ca bn",name:"Tn mc tiu",namePlaceholder:"Nhp tn mc tiu",description:"M t",descriptionPlaceholder:"Nhp m t mc tiu",targetValue:"Gi tr mc tiu",targetValuePlaceholder:"Nhp gi tr mc tiu (VND)",targetDate:"Ngy t mc tiu",priority:" u tin",status:"Trng thi",isPrimary:"Mc tiu chnh",autoTrack:"T ng theo di",linkedPortfolios:"Danh mc lin kt",noPortfolios:"Bn cha c danh mc u t",noPortfoliosEdit:"Khng c danh mc no",selectPortfolio:"Vui lng chn t nht mt danh mc",nameRequired:"Vui lng nhp tn mc tiu",valueRequired:"Vui lng nhp gi tr mc tiu ln hn 0",saving:"ang lu...",create:"To",update:"Cp nht"},card:{name:"Tn mc tiu",progress:"Tin ",currentValue:"Gi tr hin ti",target:"Mc tiu",primary:"Chnh",daysRemaining:"ngy cn li",date:"Thi gian",overdue:"Qu hn",today:"Hm nay",tomorrow:"Ngy mai",yesterday:"Hm qua",remaining:"cn li",days:"ngy",day:"ngy",weeks:"tun",week:"tun",months:"thng",month:"thng",years:"nm",year:"nm",status:{overdue:"Qu hn",completed:"Hon thnh",dangerous:"Chm",urgent:"Cn gp",attention:"Ch ",excellent:"Rt tt",good:"Tt",okay:"n"},tooltip:{overdue:"Mc tiu  qu hn so vi ngy mc tiu",completed:"Mc tiu  hon thnh 100%",noTargetDate:"Khng c ngy mc tiu. Tin : {{progress}}%, Cn li: {{remaining}}%",warning:" CNH BO: Thi gian cn li {{timePercent}}% ({{days}} ngy) t hn phn trm cn hon thnh {{progressPercent}}%",safe:" An ton: Thi gian cn li {{timePercent}}% ({{days}} ngy)   hon thnh {{progressPercent}}% cn li"},priority:{highest:"Cao nht",high:"Cao",medium:"Trung bnh",low:"Thp",lowest:"Rt thp"}},list:{title:"Mc tiu u t",subtitle:"Qun l v theo di cc mc tiu ti chnh ca bn",create:"To mc tiu mi",createFirst:"To mc tiu u tin",filters:"B lc",clearFilters:"Xa b lc",search:"Tm kim mc tiu",searchPlaceholder:"Nhp tn hoc m t mc tiu...",status:"Trng thi",allStatuses:"Tt c trng thi",overview:"Tng quan",noGoals:"Cha c mc tiu no",noGoalsFiltered:"Khng tm thy mc tiu no ph hp",noGoalsMessage:"Bt u to mc tiu u t u tin ca bn",noGoalsFilteredMessage:"Th thay i b lc hoc t kha tm kim",clearFiltersAction:"Xa b lc",createFirstAction:"To mc tiu u tin",loading:"ang ti...",error:"Khng th ti danh sch mc tiu. Vui lng th li sau.",gridView:"Xem dng li",tableView:"Xem dng bng",rowsPerPage:"S dng",of:"ca"},status:{active:"Hot ng",achieved:"t mc tiu",paused:"Tm dng",cancelled:" hy"},priority:{highest:"Cao nht",high:"Cao",medium:"Trung bnh",low:"Thp",lowest:"Rt thp"},deleteConfirm:{title:"Xc nhn xa mc tiu",message:"Bn c chc chn mun xa mc tiu ny khng?",warning:"Cnh bo",warningMessage:"Hnh ng ny khng th hon tc. Tt c d liu lin quan n mc tiu ny s b xa vnh vin.",goalDetails:"Chi tit mc tiu s b xa:",name:"Tn",currentValue:"Gi tr hin ti",target:"Mc tiu",progress:"Tin "}},S5={dashboard:"Tng quan",investor:{title:"Nh u t",reports:"Bo co",holdings:"C phn",goals:"Mc tiu"},fundManagement:{title:"Qun l qu",portfolios:"Danh mc",assets:"Sn phm",deposits:"Tin gi",reports:"Bo co"},settings:"Ci t",systemExplanation:"Hng dn",priceManagement:"Qun l gi",dataManagement:"Qun l d liu",systemAdmin:"Qun tr h thng",language:"Ngn ng",snapshots:"Sao lu d liu",holdings:"C phn",globalAssets:"Qun l gi",adminManagement:"Qun tr h thng",transactions:"Giao dch",logout:"Thot",expandMenu:"M rng menu",collapseMenu:"Thu gn menu",profileIncomplete:"H s cha hon thin - Nhp  cp nht",profileComplete:"H s  hon thin",passwordSet:" t mt khu, h s ty chn",profileNeedsCompletion:"H s cn hon thin",completeYourProfile:"Cn hon thin h s",clickToGoToHome:"Nhp  i n trang ch"},T5={title:"Danh mc ca bn",portfolioOverview:"Tng quan Danh mc",create:"To Danh mc",edit:"Chnh sa Danh mc",delete:"Xa Danh mc",name:"Tn Danh mc",description:"M t",baseCurrency:"Tin t c s",value:"Tng gi tr",currentValue:"Gi tr hin ti",quantity:"S lng",change:"Thay i",changePercent:"Thay i %",allocation:"Phn b",marketValue:"Gi tr th trng",trading:"Mua/Bn",deposits:"Qun l Tin gi",cashFlow:"Dng tin",navHoldings:"NAV Holdings",loading:"ang ti d liu...",creating:"ang to danh mc...",updating:"ang cp nht danh mc...",deleting:"ang xa danh mc...",failedToLoad:"ang ti danh mc...",startJourney:"Bt u hnh trnh u t",noMatch:"Khng c danh mc no ph hp vi tiu ch tm kim.",createFirstDescription:"To danh mc u tin  bt u theo di cc khon u t, gim st hiu sut v a ra quyt nh ti chnh sng sut.",trackPerformance:"Theo di hiu sut",monitorReturns:"Gim st li nhun",analyzeTrends:"Phn tch xu hng",adjustSearch:"Th iu chnh tiu ch tm kim hoc b lc  tm danh mc bn ang tm kim.",createFirst:"To danh mc u tin",learnMore:"Tm hiu thm",copyPortfolio:"Sao chp danh mc",publicTooltip:"Danh mc cng khai - C th c sao chp bi ngi dng khc",fund:"Qu",individual:"C nhn",capitalValue:"Tng vn",investmentValue:"Gi tr u t",unrealizedPL:"Li/L cha thc hin",realizedPL:"Li/L  thc hin",cashBalance:"S d tin mt",cannotUndo:"Hnh ng ny khng th hon tc!",confirmDelete:'Bn c chc chn mun xa danh mc "{{name}}"?',willPermanentlyDelete:"iu ny s xa vnh vin",deleteTrades:"Tt c giao dch v chi tit giao dch",deleteCashFlows:"Tt c dng tin v tin gi",deleteSnapshots:"Tt c nh chp hiu sut v d liu phn tch",deleteHoldings:"Tt c c phn nh u t (nu y l qu)",deleteHistorical:"Tt c d liu lch s v bo co",managementTrading:"Qun l danh mc & Giao dch",investorView:"Gc nhn nh u t",fundManagerView:"Gc nhn qun l qu",backToPortfolios:"Quay li danh mc",refreshAllData:"Lm mi tt c d liu danh mc",calculatingPerformance:"ang tnh ton hiu sut...",managePermissions:"Qun l quyn truy cp",refreshAll:"Lm mi",refreshing:"ang lm mi...",portfolioValue:"Gi tr danh mc",assetValueNav:"Gi tr ti sn & NAV",currentNav:"Gi tr hin ti (NAV)",totalAnnualReturns:"Tng & Li nhun hng nm",totalReturn:"Ton b",annualized:"Hng nm",ytdReturn:"T u nm",tradingActivity:"Hot ng giao dch",tradingVolume:"Giao dch & Khi lng",totalTrades:"Tng giao dch",totalTradedValue:"Tng gi tr giao dch",plCosts:"Li/L & Chi ph",profitCosts:"Li nhun & Chi ph",feesTaxes:"Ph & Thu",performance:"Tng trng",deposit:"Tin gi",switchToNormal:"Chuyn sang ch  bnh thng",switchToCompact:"Chuyn sang ch  compact",createNewTrade:"To giao dch mi",totalInvestment:"Tng u t",assetsDepositsValue:"Tin u t + Tin gi",currentUnrealizedPL:"Li/L cha thc hin hin ti",availableCash:"Tin mt kh dng",assetClasses:"Loi ti sn",differentAssetTypes:"S loi ti sn khc nhau",assetTypeAllocation:"Phn b theo loi ti sn",assetAllocation:"Phn b theo ti sn",assetAllocationPie:"Phn b ti sn",failedToLoadAllocation:"Khng th ti d liu phn b",failedToLoadPL:"Khng th ti d liu P&L",allocationSummary:"Tm tt phn b",totalAssetsValue:"Tng ti sn u t",totalDepositsValue:"Tng gi tr tin gi",noAllocationData:"Khng c d liu phn b",assetDetailSummary:"Chi tit phn b ti sn",tradeHistory:"Lch s giao dch",individualAssetHoldings:"Chi tit ti sn",individualAssetHoldingsDescription:"C phn ti sn c nhn vi gi tr v hiu sut",riskPerformanceAnalysis:"Phn tch ri ro & Hiu sut",riskReturnAnalysis:"Phn tch Ri ro(X) - Li nhun(Y)",assetPerformanceComparison:"So snh hiu sut ti sn",diversificationTimeline:"a dng ha & Dng thi gian",diversificationHeatmap:"Bn  nhit a dng ha",allocationTimeline:"Dng thi gian phn b",twrDescription:"TWR - Hiu sut qun l u t thun ty",twrPerformance:"Hiu sut TWR",portfolioPerformanceTWR:"Hiu sut danh mc (TWR)",individualInvestorView:"Gc nhn nh u t c nhn",mwrDescription:"MWR - Li nhun thc t ca nh u t vi dng tin",mwrPerformance:"Hiu sut MWR",portfolioPerformanceMWR:"Hiu sut danh mc (MWR)",riskMetricsDashboard:"Ch s ri ro danh mc",summarySnapshots:"Tng quan",cashBalanceNote:"Portfolio metrics s dng  tab Portfolio Performance khng c tnh ton ti y.",management:"Qun l tin gi",createNew:"To mi",createNewDeposit:"To tin gi",createSuccess:"To tin gi thnh cng!",createError:"C li xy ra khi to tin gi",updateSuccess:"Cp nht tin gi thnh cng!",updateError:"C li xy ra khi cp nht tin gi",settleSuccess:"Tt ton tin gi thnh cng!",settleError:"C li xy ra khi tt ton tin gi",deleteSuccess:"Xa tin gi thnh cng!",deleteError:"C li xy ra khi xa tin gi",loadError:"C li xy ra khi ti d liu tin gi",unrealizedPLByAssetType:"Li/L cha thc hin",portfolioPerformanceSummary:"Tm tt hiu sut danh mc",totalUnrealizedPL:"Tng li/l cha thc hin",profitableAssets:"Ti sn c li",bestPerformer:"Ti sn tt nht",totalAssets:"Tng ti sn",totalAssetValue:"Tng gi tr ti sn",totalPL:"Tng li/l",assetTypes:"Loi ti sn",qty:"S lng",marketPrice:"Gi th trng",profit:"Li",loss:"L",riskVsReturnAnalysis:"Phn tch ri ro so vi li nhun ca ti sn danh mc",performanceComparison:"So snh hiu sut gia cc loi ti sn",correlationMatrix:"Ma trn tng quan th hin a dng ha gia cc loi ti sn",returnBubbleSize:"Li nhun",bubbleSizeDescription:"Bong bng ln hn = Hiu sut li nhun cao hn (u t tt hn)",riskVolatility:"Ri ro (Bin ng)",performanceRating:"nh gi hiu sut",excellent:"Xut sc",good:"Tt",positive:"Tch cc",poor:"Km",veryPoor:"Rt km",highReturn:"LI NHUN CAO",lowReturn:"LI NHUN THP",noRiskReturnData:"Khng c d liu ri ro-li nhun",return:"Li nhun",performanceUnrealizedPL:"Hiu sut (Li/L cha thc hin)",totalValue:"Tng gi tr",positions:"V th",position:"v th",noPerformanceData:"Khng c d liu hiu sut",noDiversificationData:"Khng c d liu a dng ha",correlationLevel:"Tng quan",correlationHigh:"Cao (0.8)",correlationMediumHigh:"Trung bnh-Cao (0.6-0.8)",correlationMedium:"Trung bnh (0.4-0.6)",correlationLow:"Thp (0.2-0.4)",correlationVeryLow:"Rt thp (<0.2)",form:{editTitle:"Chnh sa danh mc",createTitle:"To danh mc mi",saving:"ang lu...",creationMode:{title:"Bn mun to danh mc ny nh th no?",createNew:"To mi",copyFromTemplate:"Sao chp t mu"},templateSelector:{selectTemplate:"Chn mu danh mc cng khai  sao chp",browseTemplates:"Duyt mu"},fields:{name:"Tn danh mc",namePlaceholder:"VD: Danh mc tng trng, Qu hu tr",fundingSource:"Ngun tin (Ty chn)",fundingSourcePlaceholder:"VIETCOMBANK, TPBANK, v.v.",baseCurrency:"Tin t c s",templateName:"Tn mu",templateNamePlaceholder:"Nhp tn mu cho danh mc cng khai",templateNameHelper:"Tn ny s c hin th cho ngi dng khc khi duyt danh mc cng khai",description:"M t",descriptionPlaceholder:"M t mu danh mc ny...",descriptionHelper:"M t ty chn cho mu danh mc cng khai"},visibility:{public:"Danh mc cng khai",private:"Danh mc ring t"}},copy:{title:"Sao chp danh mc",copying:"ang sao chp...",copy:"Sao chp",copyPortfolio:"Sao chp danh mc",copyingFrom:"Sao chp t",newPortfolioName:"Tn danh mc mi",newPortfolioNamePlaceholder:"Nhp tn cho danh mc  sao chp",whatWillBeCopied:"Nhng g s c sao chp",copyItems:{trades:"Tt c giao dch v lch s giao dch",cashFlows:"Dng tin v giao dch",deposits:"Tin gi v ci t li sut",settings:"Ci t v cu hnh danh mc"},note:"Lu : Danh mc mi s bt u vi s d tin mt bng khng v gi tr th trng hin ti.",validation:{nameRequired:"Vui lng nhp tn danh mc"},error:{copyFailed:"Khng th sao chp danh mc"}},error:{deleteFailed:"Khng th xa danh mc. Vui lng th li.",nameAlreadyExists:'Tn danh mc "{{name}}"  c s dng. Vui lng chn tn khc.',templateNameAlreadyExists:'Tn danh mc "{{name}}"  c s dng. Vui lng th mu khc.',saveFailed:" xy ra li khi lu danh mc. Vui lng th li.",copyTemplateFailed:"Khng th sao chp mu danh mc. Vui lng th li."}},C5={title:"Giao dch",tradeSummary:"Tm tt giao dch",manageAndTrack:"Qun l v theo di tt c hot ng giao dch ca bn",totalVolume:"Tng gi tr",trades:"Giao dch",trade:"giao dch",fees:"Ph",pl:"Li/L",return:"Li nhun",returnPercent:"Li nhun %",buy:"Mua",sell:"Bn",exchange:"Sn giao dch",noExchangeData:"Khng c d liu sn giao dch",exchangeInfoDescription:"Thng tin sn giao dch s xut hin  y khi c giao dch c ghi nhn",tradeHistory:"Lch s giao dch",searchPlaceholder:"Tm kim giao dch theo m, tn hoc ghi ch...",side:"Loi",allSides:"Tt c loi",groupByDate:"Nhm theo ngy",expand:"M rng",collapse:"Thu gn",expandAll:"M rng tt c",collapseAll:"Thu gn tt c",total:"Tng",fundingSource:"Ngun tin",totalValue:"Tng gi tr",totalCost:"Tng chi ph",loadingTrades:"ang ti giao dch...",noTradesFound:"Khng tm thy giao dch",noTradesMatchFilter:"Khng c giao dch no ph hp vi b lc hin ti.",createFirstTrade:"To giao dch u tin",viewDetails:"Xem chi tit",editTrade:"Chnh sa giao dch",deleteTrade:"Xa giao dch",modal:{editTrade:"Chnh sa giao dch",createTrade:"To giao dch"},floatingButton:{tooltip:"To nhanh",ariaLabel:"To giao dch",createPortfolioFirst:"To danh mc trc",creatingPortfolio:"ang to danh mc..."},autoCreatePortfolio:{name:"Danh mc ca ti"},deleteTradeConfirm:"Bn c chc chn mun xa giao dch ny cho {{asset}}? Hnh ng ny khng th hon tc.",failedToLoadTrades:"Khng th ti giao dch",asset:"Ti sn",type:"Loi",status:"Trng thi",taxes:"Thu",quantity:"S lng",price:"Gi",date:"Ngy",symbol:"M",form:{basicInformation:"Thng tin c bn",portfolio:"Danh mc",selectPortfolio:"Chn danh mc",loadingPortfolios:"ang ti danh mc...",noPortfoliosFound:"Khng tm thy danh mc",asset:"Ti sn",searchAsset:"Tm kim v chn ti sn...",tradeDate:"Ngy giao dch",tradeDetails:"Chi tit giao dch",tradeSide:"Loi giao dch",buy:"MUA",sell:"BN",quantity:"S lng",pricePerUnit:"Gi mi n v",refreshMarketPrice:"Lm mi gi th trng",additionalInformation:"Thng tin b sung (Ph & Thu)",tradingFee:"Ph giao dch",tax:"Thu",tradeType:"Loi giao dch",marketOrder:"Lnh th trng",limitOrder:"Lnh gii hn",stopOrder:"Lnh dng",exchangeFundingNotes:"Sn giao dch & Ngun tin",exchangeFunding:"Sn giao dch & Ngun tin",exchangePlatform:"Sn giao dch/Nn tng",enterExchangePlatform:"Nhp tn sn giao dch hoc nn tng",fundingSource:"Ngun tin",enterFundingSource:"Nhp ngun tin",notes:"Ghi ch",enterNotes:"Nhp ghi ch b sung v giao dch ny",tradeSummary:"Tm tt giao dch",totalValue:"Thnh tin",feesTaxes:"Ph & Thu",amountReceived:"Tng tin nhn",amountPaid:"Tng tin tr",processing:"ang x l...",create:"To",update:"Cp nht",createTrade:"To mi giao dch",updateTrade:"Cp nht giao dch",loadingTradeForm:"ang ti biu mu giao dch...",noPortfoliosAvailable:"Khng c danh mc no. Vui lng to danh mc trc.",createPortfolioFirst:"To danh mc",error:"Li",noPortfoliosFoundError:"Khng tm thy danh mc. Vui lng kim tra xem backend c ang chy v th li."},tradeDetails:{title:"Chi tit giao dch",tradeInformation:"Thng tin giao dch",basicInformation:"Thng tin c bn",modal:{title:"Chi tit giao dch",loadingMessage:"ang ti chi tit giao dch...",editTrade:"Chnh sa"},financialDetails:"Chi tit ti chnh",tradeId:"M giao dch",dateTime:"Ngy & Gi",asset:"Ti sn",type:"Loi",source:"Ngun",quantity:"S lng",pricePerUnit:"Gi mi n v",totalValue:"Tng gi tr",feesTaxes:"Ph & Thu",totalCost:"Tng chi ph",realizedPL:"Li/L thc t",notes:"Ghi ch",tradeMatchingDetails:"Chi tit khp lnh",totalMatched:"Tng  khp",remaining:"Cn li",totalRealizedPL:"Tng Li/L thc t",buyTradeId:"M lnh mua",matchedQty:"S lng khp",buyPrice:"Gi mua",sellPrice:"Gi bn",pl:"Li/L",matchedDate:"Ngy khp",unmatchedTradeWarning:" Lnh bn ny cn li <strong>{{quantity}} n v</strong> cha c khp. Hy cn nhc khp vi cc lnh mua c sn  thc hin li/l.",loadingTradeDetails:"ang ti chi tit giao dch...",tradeTypes:{MARKET:"Lnh th trng",LIMIT:"Lnh gii hn",STOP:"Lnh dng"},tradeSources:{MANUAL:"Th cng",API:"API",IMPORT:"Nhp vo"}}},k5={title:"Danh mc ti sn",pageTitle:"Danh mc ti sn",pageSubtitle:"Qun l ti sn trong danh mc ca bn",subtitle:"Xem chi tit ti sn ca bn trn tt c danh mc",name:"Tn ti sn",type:"Loi ti sn",currentPrice:"Gi hin ti",change:"Thay i gi",changePercent:"Thay i %",quantity:"S lng",value:"Gi tr",profit:"Li nhun",profitPercent:"Li nhun %",table:{asset:"Ti sn",type:"Loi",symbol:"M",quantity:"S lng",priceComparison:"So snh gi",totalValue:"Tng gi tr",lastUpdated:"Gi cp nht cui",priceMode:"Cp nht gi"},metrics:{totalAssets:"S lng ti sn",assetsInPortfolio:"Ti sn trong danh mc",totalValue:"Tng gi tr",combinedAssetValue:"Gi tr ti sn kt hp",averageValue:"Gi tr trung bnh",perAssetAverage:"Trung bnh mi ti sn",currentProfitLoss:"Li/l hin ti",totalProfit:"Tng li",totalLoss:"Tng l",assetTypes:"Loi ti sn",differentCategories:"Cc danh mc khc nhau",profitable:"Li",loss:"L"},actions:{viewDetails:"Xem chi tit",editAsset:"Chnh sa ti sn",deleteAsset:"Xa ti sn",refreshData:"Lm mi",quickCreate:"To nhanh",quickCreateTooltip:"Chn nhiu ti sn t danh sch mu - Nhanh v d dng",addAsset:"Thm ti sn",addAssetTooltip:"To ti sn mi vi thng tin chi tit",add:"Thm"},filters:{title:"B lc",active:"ang hot ng",activeFilters:"B lc",clearAll:"Xa lc",search:"Tm kim",type:"Loi ti sn",portfolio:"Danh mc"},noAssets:{title:"Khng tm thy ti sn",description:"Bn cha c ti sn no trong danh mc. Hy bt u bng cch thm ti sn  theo di cc khon u t ca bn."},withTrades:{title:"Ti sn c giao dch",subtitle:"Ti sn  c giao dch (mua/bn)",noAssets:{title:"Khng c ti sn hot ng",description:"Bn cha c ti sn no c hot ng giao dch."}},withoutTrades:{title:"Ti sn cha giao dch",subtitle:"Ti sn cha c giao dch",noAssets:{title:"Khng c ti sn khng hot ng",description:"Tt c ti sn ca bn u c hot ng giao dch."}},errors:{loadingError:"Li ti ti sn"}},P5={english:"English",vietnamese:"Ting Vit",selectLanguage:"Chn ngn ng"},D5={title:"Tng quan Ti chnh",subtitle:"Qun l danh mc u t v phn tch ti chnh ton din",overview:"Tng quan",totalValue:"Tng gi tr",totalChange:"Tng thay i",totalChangePercent:"Tng thay i %",portfolioCount:"S danh mc",assetCount:"S ti sn",recentActivity:"Hot ng gn y",performance:"Hiu sut",allocation:"Phn b",topPerformers:"Ti sn tt nht",worstPerformers:"Ti sn km nht",noData:"Khng c d liu",loading:"ang ti tng quan...",failedToLoad:"Khng th ti d liu tng quan",checkConnection:"Vui lng kim tra kt ni v th li.",totalAssets:"Tng ti sn qun l",totalPL:"Tng li nhun",cashPosition:"Tin mt",averagePortfolioValue:"Gi tr trung bnh",portfolio:"Danh mc",portfolios:"Danh mc",profitable:"C li",loss:"L",ofTotal:"ca tng",liquid:"Thanh khon",perPortfolio:"Mi danh mc",balanced:"Cn bng",refreshData:"Lm mi",systemStatus:"Trng thi h thng: Hot ng",lastUpdated:"Cp nht cui",dataUpdateStatus:{justUpdated:"Va cp nht",minutesAgo:"{{minutes}} pht trc",hoursAgo:"{{hours}} gi trc",daysAgo:"{{days}} ngy trc",noData:"Khng c d liu",loading:"ang ti...",systemPaused:"Cp nht gi tm dng"},portfoliosActive:"Danh mc hot ng",portfolioPerformance:"Phn tch hiu sut danh mc",bestPerforming:"Li nhun danh mc tt nht",bestPortfolioCash:"Tin mt danh mc tt nht",quickInsights:{title:"Thng tin nhanh",name:"Danh mc",totalValue:"Gi tr",dailyGrowth:"Hm nay",ytdGrowth:"YTD"},averagePortfolioValueLabel:"Gi tr trung bnh:",totalReturn:"Tng li nhun:",activePortfolios:"Danh mc hot ng:",systemHealth:"Sc khe h thng:",excellent:"Tuyt vi",investmentPortfolios:"Danh mc u t",managePortfolios:"Qun l v theo di danh mc u t ca bn",createNewPortfolio:"To danh mc mi",noPortfoliosFound:"Khng tm thy danh mc",startInvestment:"Bt u hnh trnh u t bng cch to danh mc u tin  theo di v qun l ti sn",createFirstPortfolio:"To danh mc u tin",active:"Hot ng"},A5={title:"H s c nhn",editProfile:"Chnh sa h s",saveChanges:"Lu thay i",saving:"ang lu...",cancel:"Hy",basicInformation:"Thng tin c bn",advancedInformation:"Thng tin nng cao",security:"Bo mt",username:"Tn ng nhp",usernameHelper:"Tn ng nhp khng th thay i",fullName:"H v tn",email:"Email",emailVerified:"Email  xc thc",emailVerificationRequired:"Cn xc thc email",phone:"S in thoi",dateOfBirth:"Ngy sinh",address:"a ch",completeProfileNotice:"Hon thin h s ca bn",completeProfileDescription:"Vui lng in thng tin  truy cp y  cc tnh nng. Trang ny ang  ch  chnh sa  gip bn bt u.",setPassword:"t mt khu",setPasswordDescription:"t mt khu  bo mt ti khon ca bn",newPassword:"Mt khu mi",passwordHelper:"Mt khu phi c t nht 6 k t (ch ci, s hoc k t c bit)",setting:"ang t...",changePassword:"i mt khu",changePasswordDescription:"Mt khu  c t. Bn c th thay i bn di.",currentPassword:"Mt khu hin ti",changing:"ang i...",userNotFound:"Khng tm thy ngi dng",failedToLoadProfile:"Khng th ti h s",profileUpdatedSuccessfully:"Cp nht h s thnh cng",passwordSetSuccessfully:"t mt khu thnh cng",passwordChangedSuccessfully:"i mt khu thnh cng",pleaseCompleteProfile:"Vui lng hon thin h s trc khi hy",authStates:{complete:"Ti khon bo mt",partial:"H s hon chnh",demo:"Ti khon demo",unknown:"Khng xc nh"},errors:{failedToUpdateProfile:"Khng th cp nht h s",failedToSetPassword:"Khng th t mt khu",currentPasswordIncorrect:"Mt khu hin ti khng ng. Vui lng kim tra li mt khu hin ti.",userHasNoPassword:"Ti khon cha c mt khu. Vui lng t mt khu trc.",authenticationFailed:"Xc thc tht bi. Vui lng ng nhp li.",passwordTooShort:"Mt khu mi khng hp l. Mt khu phi c t nht 6 k t.",invalidData:"D liu khng hp l. Vui lng kim tra li thng tin.",userNotFound:"Khng tm thy ti khon. Vui lng ng nhp li.",cannotChangePassword:"Khng th thay i mt khu. Vui lng th li."}},I5={required:"Trng ny l bt buc",invalidEmail:"a ch email khng hp l",invalidNumber:"S khng hp l",invalidDate:"Ngy khng hp l",minLength:"Ti thiu {{min}} k t",maxLength:"Ti a {{max}} k t",minValue:"Gi tr ti thiu l {{min}}",maxValue:"Gi tr ti a l {{max}}",submit:"Gi",cancel:"Hy",save:"Lu",delete:"Xa",edit:"Chnh sa",create:"To mi",update:"Cp nht",close:"ng",confirm:"Xc nhn",yes:"C",no:"Khng",loading:"ang ti...",saving:"ang lu...",deleting:"ang xa...",success:"Thnh cng",error:"Li",warning:"Cnh bo",info:"Thng tin"},R5={noData:"Khng c d liu",loading:"ang ti...",search:"Tm kim",filter:"Lc",sort:"Sp xp",export:"Xut",import:"Nhp",refresh:"Lm mi",rowsPerPage:"S dng",of:"ca",date:"Ngy",actions:"",view:"Xem",edit:"Chnh sa",delete:"Xa",copy:"Sao chp",download:"Ti xung"},M5={success:"Thnh cng",error:"Li",warning:"Cnh bo",info:"Thng tin",portfolioCreated:"To danh mc thnh cng",portfolioUpdated:"Cp nht danh mc thnh cng",portfolioDeleted:"Xa danh mc thnh cng",assetAdded:"Thm ti sn thnh cng",assetUpdated:"Cp nht ti sn thnh cng",assetDeleted:"Xa ti sn thnh cng",tradeExecuted:"Thc hin giao dch thnh cng",depositAdded:"Thm tin gi thnh cng",settingsSaved:"Lu ci t thnh cng",operationFailed:"Thao tc tht bi",networkError:"Li mng",unauthorized:"Khng c quyn truy cp",forbidden:"Truy cp b cm"},N5={required:"Trng ny l bt buc",email:"Vui lng nhp a ch email hp l",url:"Vui lng nhp URL hp l",number:"Vui lng nhp s hp l",integer:"Vui lng nhp s nguyn hp l",positive:"Vui lng nhp s dng",negative:"Vui lng nhp s m",min:"Gi tr ti thiu l {{min}}",max:"Gi tr ti a l {{max}}",minLength:"Ti thiu {{min}} k t",maxLength:"Ti a {{max}} k t",pattern:"Vui lng nhp ng nh dng",unique:"Gi tr ny phi l duy nht",exists:"Gi tr ny phi tn ti",date:"Vui lng nhp ngy hp l",time:"Vui lng nhp gi hp l",currency:"Vui lng nhp s tin hp l"},L5={general:" xy ra li",network:"Li mng",server:"Li my ch",notFound:"Khng tm thy",unauthorized:"Khng c quyn",forbidden:"B cm",timeout:"Ht thi gian ch",validation:"Li xc thc",unknown:"Li khng xc nh"},E5={title:"Danh sch c phn",subtitle:"Danh mc u t v hiu sut ca bn",loading:"ang ti danh mc u t...",error:{loadFailed:"Khng th ti d liu danh mc",loadDetailsFailed:"Khng th ti chi tit danh mc",fetchDetailsFailed:"Khng th ti chi tit danh mc",deleteTransactionFailed:"Khng th xa giao dch",recalculateNavFailed:"Khng th tnh li NAV. Vui lng th li.",noDetailsFound:"Khng tm thy chi tit danh mc"},summary:{totalInvestment:"Tin vn",currentValue:"Gi tr hin ti",totalPnL:"Tng li nhun",totalReturn:"Tng trng",holdingsCount:"{{count}} Danh mc",holdingsCount_other:"{{count}} Danh mc",marketValue:"Gi tr th trng",profitable:"C li",loss:"L",performance:"Hiu sut"},table:{title:"Danh mc u t",subtitle:"Xem chi tit danh mc u t ca bn trn tt c cc danh mc",portfolio:"Tn danh mc",units:"S lng",avgCostPerUnit:"Gi TB/n v",totalInvestment:"Tng u t",currentValue:"Gi tr hin ti",unrealizedPnL:"P&L cha thc hin",realizedPnL:"P&L  thc hin",totalPnL:"Li nhun",returnPercent:"Li nhun %",date:"Ngy",type:"Loi",navPerUnit:"NAV/n v",amount:"S tin",description:"M t",source:"Ngun"},empty:{title:"Khng tm thy danh mc",message:"Bn cha c danh mc u t no. Hy bt u u t bng cch ng k cc qu c sn."},actions:{viewPortfolio:"Xem Portfolio",backToPortfolio:"Quay li Portfolio",recalculate:"Tnh li",recalculateNav:"Tnh li NAV",recalculating:"ang tnh li..."},detail:{investmentIn:"u t vo {{portfolioName}}",portfolioPerformance:"Hiu sut Portfolio",currentValue:"Gi tr hin ti",totalInvestment:"Tng u t",unrealizedPnL:"P&L cha thc hin",returnPercent:"Li nhun %",transactionSummary:"Tm tt giao dch",totalTransactions:"Tng giao dch",totalFundUnits:"Tng s n v qu",subscriptions:"ng k mua",redemptions:"ng k bn",unitsSubscribed:"n v  ng k",holdingDetails:"Chi tit danh mc",totalUnits:"Tng n v",avgCostPerUnit:"Gi TB/n v",currentNav:"NAV hin ti",transactionHistory:"Lch s giao dch"},modal:{subtitle:"Lch s ng k & mua li",summary:"Tm tt",totalFundUnits:"Tng s n v qu",totalUnitsHeld:"Tng n v ang nm gi",totalSubscriptions:"Tng mua",subscriptionCount:"S ln ng k",totalRedemptions:"Tng bn",redemptionCount:"S ln mua li",totalInvested:"Tng u t",amountInvested:"S tin u t",noTransactions:"Khng tm thy giao dch",noTransactionsMessage:"Danh mc ny cha c giao dch ng k hoc mua li no."},transaction:{subscription:"Thm mi",redemption:"Rt vn"},subscriptionModal:{title:"ng k mua qu",redemptionTitle:"Rt vn qu",fundInformation:"Thng tin qu",fundName:"Tn qu",navPerUnit:"NAV/n v",account:"Ti khon",accountPlaceholder:"Tm kim ti khon hoc nhp ID ti khon mi...",investmentAmount:"S tin u t",investmentAmountPlaceholder:"Nhp s tin u t (v d: 1,000,000)",unitsAutoCalculated:"n v (T ng tnh)",unitsPlaceholder:"n v s c tnh t ng",unitsHelperText:"n v c tnh da trn s tin v NAV/n v",transactionDate:"Ngy giao dch",transactionDateHelper:"Chn ngy cho ng k ny",description:"M t",descriptionPlaceholder:"M t ty chn cho ng k ny",calculationSummary:"Tm tt tnh ton",calculatedUnits:"n v tnh ton",investmentAmountLabel:"S tin u t",calculationNotice:"n v c tnh t ng da trn s tin u t v NAV/n v hin ti.",dataImpactNotice:" Thng bo tc ng d liu",dataImpactMessage:"To ng k ny s t ng cp nht:",dataImpactItem1:"NAV/n v Portfolio v tng n v ang lu hnh",dataImpactItem2:"Cc ch s danh mc nh u t (n v, u t, P&L)",dataImpactItem3:"Bn ghi dng tin v s d portfolio",dataImpactNote:"Tt c tnh ton s da trn ngy hin ti v NAV/n v hin ti",createSubscription:"To ng k",createRedemption:"To rt vn",creating:"ang to...",creatingRedemption:"ang to rt vn...",validation:{accountRequired:"Vui lng chn ti khon hoc nhp ID ti khon",amountRequired:"S tin phi ln hn 0",unitsRequired:"n v phi ln hn 0",dateRequired:"Ngy giao dch l bt buc"},error:{createFailed:"Khng th to ng k. Vui lng th li.",unauthorized:"Ti khon khng c php u t vo qu ny. Vui lng lin h qun tr vin.",invalidData:"D liu ng k khng hp l. Vui lng kim tra thng tin nhp.",notFound:"Khng tm thy Portfolio hoc ti khon. Vui lng lm mi v th li."}},redemptionModal:{title:"ng k rt vn qu",fundInformation:"Thng tin qu",fundName:"Tn qu",navPerUnit:"NAV/n v",investorAccount:"Ti khon nh u t (C danh mc)",investorAccountPlaceholder:"Tm kim nh u t c danh mc trong qu ny...",investorAccountHelper:"Ch hin th cc ti khon c danh mc trong qu ny",redemptionAmount:"S tin rt vn (T ng tnh)",redemptionAmountPlaceholder:"S tin s c tnh t ng",redemptionAmountHelper:"S tin c tnh t ng da trn n v v NAV/n v",unitsToRedeem:"n v cn rt",unitsPlaceholder:"Nhp s n v cn rt",transactionDate:"Ngy giao dch",transactionDateHelper:"Chn ngy cho rt vn ny",description:"M t",descriptionPlaceholder:"M t ty chn cho rt vn ny",redemptionSummary:"Tm tt rt vn",unitsToRedeemLabel:"n v cn rt",calculatedAmount:"S tin tnh ton",calculationNotice:"S tin c tnh t ng da trn s n v bn nhp v NAV/n v hin ti.",dataImpactNotice:" Thng bo tc ng d liu",dataImpactMessage:"X l rt vn ny s t ng cp nht:",dataImpactItem1:"NAV/n v Portfolio v tng n v ang lu hnh",dataImpactItem2:"Cc ch s danh mc nh u t (n v, u t, P&L)",dataImpactItem3:"Bn ghi dng tin v s d portfolio",dataImpactNote:"Tt c tnh ton s da trn ngy hin ti v NAV/n v hin ti",processRedemption:"X l rt vn",processing:"ang x l...",validation:{accountRequired:"Vui lng chn ti khon",unitsRequired:"n v phi ln hn 0",dateRequired:"Ngy giao dch l bt buc"},error:{createFailed:"Khng th to rt vn. Vui lng th li."}},edit:{title:"Chnh sa c phn {{type}}",transactionInfo:"Thng tin c phn",transactionType:"Loi c phn",navPerUnit:"NAV/n v",units:"n v",unitsPlaceholder:"Nhp s n v",amount:"S tin",amountPlaceholder:"Nhp s tin (v d: 1,000,000)",transactionDate:"Ngy giao dch",description:"M t",descriptionPlaceholder:"M t ty chn cho giao dch ny",calculationSummary:"Tm tt tnh ton",calculatedAmount:"S tin tnh ton",amountDifferenceNote:"Lu : S tin tnh ton ({{calculated}}) khc vi s tin nhp ({{entered}}). iu ny c th do ph hoc lm trn.",recalculationNotice:" Thng bo tnh li d liu",recalculationMessage:"Khi bn cp nht giao dch ny, h thng s t ng tnh li:",recalculationItem1:"NAV/n v ca Portfolio v tng n v ang lu hnh",recalculationItem2:"Cc ch s danh mc (n v, u t, P&L) ti ngy giao dch",recalculationItem3:"Tt c bn ghi dng tin lin quan",recalculationDate:"Tnh li s da trn ngy giao dch: {{date}}",updateTransaction:"Cp nht giao dch",updating:"ang cp nht...",error:{updateFailed:"Khng th cp nht giao dch. Vui lng th li."},validation:{unitsRequired:"n v phi ln hn 0",amountRequired:"S tin phi ln hn 0",dateRequired:"Ngy giao dch l bt buc"}},delete:{title:"Xc nhn xa giao dch",message:"Bn c chc chn mun xa giao dch ny? Hnh ng ny khng th hon tc.",transactionDetails:"Chi tit giao dch",recalculationImpact:" Tc ng tnh li d liu",recalculationMessage:"Xa giao dch ny s kch hot tnh li t ng:",recalculationItem1:"NAV/n v ca Danh mc v tng n v ang lu hnh",recalculationItem2:"Tt c ch s danh mc (n v, u t, P&L) s c tnh li t cc giao dch cn li",recalculationItem3:"Cc bn ghi dng tin lin quan s b xa",recalculationDate:"Tnh li s da trn ngy giao dch gc: {{date}}",deleting:"ang xa...",deleteTransaction:"Xa giao dch"}},W5={holdings:{notFund:"Danh mc ny khng phi l Qu",notFundMessage:"Danh mc ny cha c cu hnh l qu. Chuyn i thnh qu  qun l NAV/n v.",convert:"Chuyn i",convertToFund:"Chuyn i thnh Qu",fundSummary:"Tm tt Qu",recalculateNav:"Tnh li NAV/n v",refreshHoldings:"Lm mi Danh mc & Tm tt Qu",navPerUnit:"NAV/n v",totalOutstandingUnits:"Tng n v ang lu hnh",numberOfInvestors:"S nh u t",totalPnL:"Tng li nhun",lastNavUpdate:"Cp nht NAV cui",new:"Mi",newSubscription:"ng k mi",process:"X l",processRedemption:"X l mua li",convertToPortfolio:"Chuyn i thnh Portfolio",investorHoldings:"Danh mc nh u t",noHoldings:"Khng tm thy danh mc nh u t",noHoldingsMessage:"To ng k u tin  bt u theo di danh mc nh u t",investor:"Nh u t",units:"n v",avgCost:"Gi TB",totalInvestment:"Tng u t",currentValue:"Gi tr hin ti",unrealizedPnL:"P&L cha thc hin",returnPercent:"Li nhun %",viewDetails:"Xem chi tit",convertToFundModal:{title:"Chuyn i Danh mc thnh Qu",portfolioInformation:"Thng tin Danh mc",portfolioName:"Tn Danh mc",baseCurrency:"Tin t c s",conversionOptions:"Ty chn Chuyn i",useSnapshotDate:"S dng ngy snapshot lch s  chuyn i",snapshotDate:"Ngy Snapshot",snapshotDateHelper:"Chn ngy lch s  s dng tnh ton NAV trong qu trnh chuyn i",conversionInformation:"Thng tin Chuyn i",conversionInfoWithDate:"iu ny s chuyn i danh mc thnh qu s dng trng thi danh mc tnh n ngy {{date}}. NAV mi n v s c tnh da trn gi tr danh mc ti ngy c th .",conversionInfoCurrent:"iu ny s chuyn i danh mc thnh qu s dng trng thi danh mc hin ti. NAV mi n v s c tnh da trn gi tr danh mc hin ti.",conversionInfoAfter:"Sau khi chuyn i, bn s c th qun l ng k qu, mua li v theo di danh mc nh u t.",converting:"ang chuyn i...",convert:"Chuyn i",convertToFund:"Chuyn i thnh Qu",validation:{invalidDateFormat:"nh dng ngy khng hp l. Vui lng s dng nh dng YYYY-MM-DD.",dateInFuture:"Ngy snapshot khng th l ngy trong tng lai.",snapshotDateRequired:"Ngy snapshot l bt buc khi s dng snapshot lch s."},error:{convertFailed:"Khng th chuyn i danh mc thnh qu"}},convertToPortfolioModal:{title:"Chuyn i Qu thnh Danh mc",warningTitle:"Hnh ng ny s xa vnh vin tt c d liu lin quan n qu!",confirmationQuestion:'Bn c chc chn mun chuyn i qu "{{name}}" tr li thnh danh mc thng thng?',willDelete:"iu ny s xa vnh vin:",deleteItem1:"Tt c danh mc nh u t v lch s giao dch ca h",deleteItem2:"Tt c giao dch n v qu (ng k v mua li)",deleteItem3:"Tt c dng tin lin quan n giao dch n v qu",deleteItem4:"NAV mi n v v tng n v ang lu hnh s c t li v 0",deleteItem5:"S nh u t s c t li v 0",willRetain:"Danh mc s gi li:",retainItem1:"Tt c giao dch v lch s ca chng",retainItem2:"Tt c tin gi v dng tin khng lin quan n n v qu",retainItem3:"Tt c snapshot hiu sut v d liu phn tch",retainItem4:"S d tin mt s c tnh li t cc dng tin cn li",confirmationLabel:"Ti hiu rng hnh ng ny s xa vnh vin tt c d liu lin quan n fund v khng th hon tc",converting:"ang chuyn i...",convert:"Chuyn i",convertToPortfolio:"Chuyn i thnh Danh mc"}}},F5={title:"Qun l Tin gi",management:"Qun l tin gi",createNew:"To mi",createNewDeposit:"To mi",createSuccess:"To tin gi thnh cng!",createError:"C li xy ra khi to tin gi",updateSuccess:"Cp nht tin gi thnh cng!",updateError:"C li xy ra khi cp nht tin gi",settleSuccess:"Tt ton tin gi thnh cng!",settleError:"C li xy ra khi tt ton tin gi",deleteSuccess:"Xa tin gi thnh cng!",deleteError:"C li xy ra khi xa tin gi",loadError:"C li xy ra khi ti d liu tin gi",noDeposits:"Cha c tin gi no. Hy to tin gi u tin!",bank:"Ngn hng",accountNumber:"S ti khon",principal:"Tin gc",interestRate:"Li sut",term:"K hn",totalValue:"Tng gi tr",viewDetails:"Xem chi tit",actions:"",status:"Trng thi",edit:"Chnh sa",delete:"Xa",settle:"Tt ton",active:"Hot ng",settled:" tt ton",matured:" n hn",all:"Tt c",allPortfolios:"Tt c portfolios",searchByBank:"Tm kim theo ngn hng",clearFilters:"Xa b lc",filters:"B lc",refresh:"Lm mi",overview:"Tng quan",totalDeposits:"Tng s tin gi",activeDeposits:"ang hot ng",settledDeposits:" tt ton",totalPrincipal:"Tng gc",averageInterestRate:"Li sut TB",settledInterest:"Li  tt ton",accruedInterest:"Li cha tt ton",actualInterest:"Li thc t",average:"Trung bnh",confirmDelete:"Xc nhn xa tin gi",cannotUndo:"Hnh ng ny khng th hon tc",deleteWarning:"Cnh bo:",deleteWarningText:"Bn sp xa vnh vin tin gi ny. Tt c d liu lin quan s b mt v khng th khi phc.",cancel:"Hy b",deletePermanently:"Xa vnh vin",principalAmount:"S tin gc:",interestRateLabel:"Li sut:",termLabel:"K hn:",totalValueLabel:"Tng gi tr:",form:{editTitle:"Chnh sa tin gi",createTitle:"To tin gi",bankName:"Tn ngn hng",accountNumber:"S ti khon (ty chn)",principal:"S tin gc",principalPlaceholder:"Nhp s tin gc",interestRate:"Li sut (%/nm)",interestRatePlaceholder:"Nhp li sut",term:"K hn",termHelper:"Chn k hn  t ng tnh ngy kt thc",startDate:"Ngy bt u",endDate:"Ngy kt thc",notes:"Ghi ch",processing:"ang x l...",update:"Cp nht",create:"To",cancel:"Hy",save:"Lu",termOptions:{"1M":"1 Thng","3M":"3 Thng","6M":"6 Thng","1Y":"1 Nm","2Y":"2 Nm","3Y":"3 Nm","5Y":"5 Nm"},validation:{portfolioIdRequired:"Portfolio ID l bt buc",bankNameRequired:"Tn ngn hng l bt buc",bankNameMaxLength:"Tn ngn hng khng c qu 100 k t",accountNumberMaxLength:"S ti khon khng c qu 50 k t",principalRequired:"S tin gc l bt buc",principalMin:"S tin gc phi ln hn 0",interestRateRequired:"Li sut l bt buc",interestRateMin:"Li sut phi ln hn hoc bng 0",interestRateMax:"Li sut khng c qu 100%",startDateRequired:"Ngy bt u l bt buc",endDateRequired:"Ngy kt thc l bt buc",notesMaxLength:"Ghi ch khng c qu 500 k t",endDateAfterStart:"Ngy kt thc phi sau ngy bt u",termTooLong:"K hn khng c qu 10 nm",errorOccurred:"C li xy ra"}},details:{title:"Chi tit tin gi",maturityProgress:"Tin  n hn",portfolioInfo:"Thng tin danh mc",portfolioName:"Tn danh mc",loadingPortfolio:"ang ti danh mc...",portfolioLoadError:"Khng th ti thng tin danh mc",noPortfolioData:"Khng c d liu danh mc",financialInfo:"Thng tin ti chnh",principal:"S tin gc",interestRate:"Li sut",accruedInterest:"Li tch ly",totalValue:"Tng gi tr",actualInterest:"Li thc t ( tt ton)",timelineInfo:"Thng tin thi gian",startDate:"Ngy bt u",endDate:"Ngy kt thc",settlementDate:"Ngy tt ton",additionalInfo:"Thng tin b sung",notes:"Ghi ch",daysUntilMaturity:"{{days}} ngy n hn"},settlement:{title:"Tt ton tin gi",subtitle:"Xc nhn v hon tt vic tt ton",settlementInfo:"Thng tin tt ton",settlementInfoDesc:"Chi tit tin gi v thng tin tt ton",depositInfo:"Thng tin tin gi",settlementDetails:"Thng tin tt ton",financialSummary:"Tm tt ti chnh",bankName:"Tn ngn hng",term:"K hn",principal:"Gc",interestRate:"Li sut",accruedInterest:"Li tch ly",total:"Tng",actualInterest:"Li thc t",actualInterestPlaceholder:"Nhp s tin li thc t",settlementDate:"Ngy tt ton",settlementDateHelper:"Chn ngy tt ton",notes:"Ghi ch",totalReceived:"Tng nhn c",interest:"Li",confirmSettlement:"Xc nhn tt ton",processing:"ang tt ton...",validation:{actualInterestRequired:"S tin li thc t l bt buc",actualInterestMin:"S tin li phi ln hn hoc bng 0",settlementDateRequired:"Ngy tt ton l bt buc",notesMaxLength:"Ghi ch khng c qu 500 k t"}},depositActions:{edit:"Chnh sa tin gi",settle:"Tt ton"},depositStatus:{active:"ang hot ng",settled:" tt ton",cancelled:" hy"}},z5={title:"Dng tin",subtitle:"Theo di cc giao dch tin mt ca danh mc",refresh:"Lm mi",filter:"Lc",deposit:"Tin vo",withdraw:"Tin ra",dividend:"C tc",createDeposit:"To tin vo",createWithdrawal:"To tin ra",createDividend:"To c tc",management:{title:"Qun l dng tin"},summary:{title:"Tm tt dng tin",totalDeposits:"Tng tin vo",totalWithdrawals:"Tng tin ra",totalDividends:"Tng c tc",netCashFlow:"Dng tin rng",deposits:"Tin vo",withdrawals:"Tin ra",dividends:"C tc",netFlow:"Dng tin rng",totalInflows:"Tng tin vo",totalOutflows:"Tng tin ra",transactions:"S giao dch"},chart:{title:"Biu  dng tin",subtitle:"Trc quan ha xu hng dng tin",loading:"ang ti d liu biu ...",fetchingData:"ang ti d liu cho danh mc",noData:{title:"Khng c d liu",message:"Khng c d liu dng tin cho khong thi gian  chn"},refresh:"Lm mi biu ",chartType:"Loi biu ",lineChart:"Biu  ng",barChart:"Biu  ct",pieChart:"Biu  trn",timeRange:"Khong thi gian",last7Days:"7 ngy qua",last30Days:"30 ngy qua",last90Days:"90 ngy qua",lastYear:"Nm qua",dataPoints:"{{count}} im d liu",view:"Xem {{range}}",deposits:"Tin vo",withdrawals:"Tin ra",dividends:"C tc",interest:"Li sut"},filters:{filter:"Lc",transactionTypes:"Loi giao dch",dateRange:"Khong thi gian",type:"Loi",allTypes:"Tt c loi",deposits:"Tin vo",withdrawals:"Tin ra",dividends:"C tc",interest:"Li sut",fees:"Ph",taxes:"Thu",adjustments:"iu chnh",buyTrades:"Giao dch mua",sellTrades:"Giao dch bn",tradeSettlements:"Thanh ton giao dch",depositSettlements:"Thanh ton gi tin",depositCreations:"To gi tin",apply:"p dng",applyFilters:"p dng b lc",activeFilters:"B lc ang hot ng",reset:"t li",resetAll:"t li tt c",from:"T",to:"n",types:"Loi"},table:{type:"Loi",amount:"S tin",description:"M t",reference:"Tham chiu",fundingSource:"Ngun tin",date:"Ngy",status:"Trng thi",actions:"",transactionCount:"{{count}} giao dch",total:"Tng",items:"{{count}} mc",group:"Nhm",groupByDate:"Nhm theo ngy",expand:"M rng",expandAll:"M rng tt c",collapse:"Thu gn",collapseAll:"Thu gn tt c"},form:{amount:"S tin",amountPlaceholder:"Nhp s tin",enterAmount:"Nhp s tin",original:"Gc",new:"Mi",currency:"Tin t",currencyHelper:"Tin t cho giao dch",status:"Trng thi",completed:"Hon thnh",pending:"ang ch",cancelled:" hy",originalStatus:"Trng thi gc",fundingSource:"Ngun tin",fundingSourceOptional:"Ngun tin",fundingSourcePlaceholder:"VD: VIETCOMBANK, BANK_ACCOUNT_001",fundingSourceHelper:"Ngun tin",flowDate:"Ngy dng tin",flowDateHelper:"Ngy xy ra dng tin",reference:"Tham chiu",referenceHelper:"S hoc m tham chiu",description:"M t",descriptionHelper:"M t giao dch",descriptionOptional:"M t (Ty chn)",referenceOptional:"Tham chiu (Ty chn)"},modal:{createTitle:"To {{type}}",editTitle:"Chnh sa dng tin",createDeposit:"To tin vo",createWithdrawal:"To tin ra",createDividend:"To c tc",transaction:"Giao dch {{type}}",creating:"ang to...",updating:"ang cp nht...",creatingCashFlow:"ang to dng tin...",updatingCashFlow:"ang cp nht dng tin...",createCashFlow:"To dng tin",updateCashFlow:"Cp nht dng tin"},delete:{title:"Xa dng tin",message:"Bn c chc chn mun xa dng tin ny?",warning:"Hnh ng ny khng th hon tc.",cancelledWarning:"Dng tin ny  b hy v khng th xa.",cancelledHelper:"Ch c th xa cc dng tin ang hot ng.",error:"Li khi xa dng tin",errorHelper:"Vui lng th li hoc lin h h tr.",type:"Loi",amount:"S tin",description:"M t",status:"Trng thi",deleting:"ang xa...",delete:"Xa",confirm:"Bn c chc chn mun hy dng tin ny?"},transfer:{title:"Chuyn tin",description:"Ghi ch chuyn tin",error:"Li khi chuyn tin",errorHelper:"Vui lng kim tra thng tin v th li.",fromSource:"T ngun",fromSourceHelper:"Ngun chuyn t",toSource:"n ngun",toSourcePlaceholder:"Nhp ngun ch",amount:"S tin",amountPlaceholder:"Nhp s tin chuyn",amountHelper:"Chuyn {{amount}}",amountHelperEmpty:"Nhp s tin cn chuyn",date:"Ngy",dateHelper:"Ngy chuyn tin",descriptionLabel:"M t",descriptionPlaceholder:"Chuyn t {{from}} n {{to}}",descriptionHelper:"M t giao dch chuyn tin",source:"Ngun",destination:"ch",summary:"Tm tt chuyn tin",summaryText:"Chuyn {{amount}} t {{from}} n {{to}}",summaryHelper:"iu ny s to hai mc dng tin: mt dng ra t ngun v mt dng vo ch.",transferring:"ang chuyn...",transfer:"Chuyn",transferCash:"Chuyn tin"},tooltips:{cannotEditCancelled:"Khng th chnh sa dng tin  hy",edit:"Chnh sa",delete:"Xa"},pagination:{showing:"Hin th {{start}} n {{end}} trong {{total}} mc",perPage:"Mi trang"},validation:{invalidDates:"Khong ngy khng hp l. Vui lng kim tra ngy v th li."},error:{loadFailed:"Khng th ti dng tin",createFailed:"Khng th to dng tin",cancelFailed:"Khng th hy dng tin"},typeDescription:{deposit:"Tin vo danh mc ca bn",withdrawal:"Tin ra khi danh mc ca bn",dividend:"Tin c tc nhn c",default:"Giao dch dng tin"},status:{completed:"Hon thnh",pending:"ang ch",cancelled:" hy"},fundingSource:{title:"Ngun tin",subtitle:"Theo di dng tin theo ngun tin",grid:"Li",gridView:"Xem li",list:"Danh sch",listView:"Xem danh sch",fundingSource:"Ngun tin",netAmount:"Tin c",inflow:"Tin vo",outflow:"Tin ra",transactions:"Giao dch",lastTransaction:"Giao dch cui",typeToSearch:"Nhp  tm kim ngun tin",enterNew:"Nhp ngun tin mi",enterNewSource:"Nhp ngun tin mi",inputLabel:"Ngun tin",inputPlaceholder:"Nhp ngun tin"},tabs:{analytics:"Phn tch",history:"Lch s"},history:{title:"Lch s dng tin",transactionCount:"{{count}} giao dch"},withdrawal:"Tin ra",transferCash:"Chuyn tin"},O5={title:"To giao dch mi",subtitle:"Chn loi giao dch bn mun thc hin",create:"To",tabs:{trading:"Mua/Bn",cashflow:"Np/Rt tin",deposit:"Tin gi",transfer:"Chuyn tin"},options:{trading:{title:"Mua/Bn ti sn",description:"Mua/Bn c phiu, tri phiu, vng..."},cashFlow:{title:"Np/Rt tin",description:"Np hoc rt tin t danh mc"},bankDeposit:{title:"Tin gi ngn hng",description:"To tin gi ngn hng vi li sut"},bankTransfer:{title:"Chuyn tin",description:"Chuyn tin gia cc ngun vn"}},bankDeposit:{title:"To Tin gi",description:"Thm thng tin tin gi ngn hng vi li sut"},goToCashFlow:"i n Dng tin",goToTrading:"i n Giao dch",portfolioInfo:{title:"Danh mc c chn",fundingSource:"Ngun vn",selectPortfolio:"Chn danh mc"},error:{noPortfolio:"Khng tm thy danh mc",noPortfolioDescription:"Vui lng to danh mc trc khi thc hin giao dch"}},V5={benchmarkLoadFailed:"Khng th ti d liu benchmark",mwrBenchmarkLoadFailed:"Khng th ti d liu MWR benchmark",riskMetricsLoadFailed:"Khng th ti d liu risk metrics"},$5={title:"Lch s hiu sut NAV",subtitle:"S pht trin ca gi tr ti sn rng theo thi gian",tooltipDescription:"Theo di thay i gi tr danh mc v cc ch s hiu sut",returnPercent:"Li nhun %",navValue:"Gi tr NAV",currentNav:"NAV hin ti",totalReturn:"Tng trng NAV",maxDrawdown:"St gim ti a",dataPoints:"im d liu",loading:"ang ti d liu lch s NAV...",error:{loadFailed:"Khng th ti lch s NAV",unableToLoad:"Khng th ti d liu lch s NAV"},noData:{title:"Khng c d liu lch s NAV",message:"D liu lch s s xut hin  y khi c sn"},tooltipContent:{navValue:"Gi tr NAV",portfolioPnL:"P&L danh mc",cumulativeReturn:"Li nhun tch ly"},legend:{navValue:"Gi tr NAV",portfolioPnL:"P&L danh mc"},tooltip:{navValue:"Gi tr NAV",portfolioPnL:"P&L danh mc",cumulativeReturn:"Li nhun tch ly"}},H5={noData:"Khng c d liu benchmark",subtitle:"Hiu sut danh mc so vi {{benchmarkName}}",portfolio:"Danh mc",difference:"Chnh lch",trackingError:"Li theo di",tooltip:{title:"Ghi ch cho nh u t:",twr:"TWR",twrDescription:"phn nh nng lc qun l qu,  loi b nh hng ca dng tin.",mwr:"MWR",mwrDescription:"phn nh li nhun thc t ca tng nh u t, c th khc nhau ty thi im np/rt vn.",comparison:"NT nn so snh MWR c nhn vi TWR qu  hiu r s khc bit.",difference:"Chnh lch"}},B5={subtitle:"Hiu sut danh mc so vi {{benchmarkName}}",portfolio:"Danh mc (MWR)",difference:"Chnh lch",noData:"Khng c d liu cho biu  MWR",tooltip:{title:"Ghi ch cho nh u t:",mwr:"MWR",mwrDescription:"phn nh li nhun thc t ca tng nh u t, c th khc nhau ty thi im np/rt vn.",twr:"TWR",twrDescription:"phn nh nng lc qun l qu,  loi b nh hng ca dng tin.",comparison:"NT nn so snh MWR c nhn vi TWR qu  hiu r s khc bit.",difference:"Chnh lch"}},U5={title:"Phn tch giao dch",subtitle:"Thng tin hiu sut ton din v phn tch",loading:"ang ti phn tch...",noData:"Khng c d liu giao dch  phn tch",error:{loadFailed:"Khng th ti phn tch giao dch",invalidData:"nh dng d liu phn tch khng hp l",portfolioLoadFailed:"Khng th ti thng tin danh mc",portfolioNotFound:"Khng tm thy danh mc"},totalPnL:"Tng P&L",realizedPnL:"P&L  thc hin",unrealizedPnL:"P&L cha thc hin",winRate:"T l thng",tradingStatistics:"Thng k",trades:"Giao dch",average:"TB",buyTrades:"Giao dch mua",sellTrades:"Giao dch bn",totalVolume:"Tng gi tr",riskMetrics:"Ch s ri ro ti sn",riskLevel:"Mc ",riskLevels:{high:"Cao",medium:"Trung bnh",low:"Thp"},maxDrawdown:"St gim ti a",var95:"VaR 95%",sharpeRatio:"T l Sharpe",monthlyPerformance:"Hiu sut u t",assetPerformance:"Hiu sut ti sn  bn",pieChart:"Biu  trn",compactList:"Danh sch gn",noAssetData:"Khng c d liu hiu sut ti sn",topTrades:"Giao dch hiu sut tt nht",best:"Tt nht",worstTrades:"Giao dch hiu sut km nht",worst:"Km nht",assetPerformanceDetails:"Chi tit hiu sut ti sn",asset:"Ti sn",side:"Hng",pnl:"P&L",date:"Ngy",tooltip:{totalPnL:"Tng P&L",realizedPnL:"P&L  thc hin",unrealizedPnL:"P&L cha thc hin",trades:"Giao dch",winRate:"T l thng",volume:"Khi lng",symbol:"M",pnl:"P&L",performance:"Hiu sut"},timeframe:{allTime:"Tt c",oneMonth:"1 Thng",threeMonths:"3 Thng",sixMonths:"6 Thng",oneYear:"1 Nm"},granularity:{daily:"Ngy",weekly:"Tun",monthly:"Thng"},table:{asset:"Ti sn",side:"Hng",pnl:"P&L",date:"Ngy",quantity:"S lng",avgCost:"Gi mua TB",marketValue:"Tng tin bn",trades:"Giao dch"},status:{win:"Thng",loss:"Thua"},unknown:{asset:"Khng xc nh",assetName:"Ti sn khng xc nh"}},_5={noData:"Khng c d liu ch s ri ro",loading:"ang ti ch s ri ro...",subtitle:"Phn tch ri ro ton din v cc ch s sc khe danh mc",var95:"Gi tr ri ro (95%)",sharpeRatio:"T l Sharpe",volatility:"Bin ng",maxDrawdown:"St gim ti a",additionalMetrics:"Ch s ri ro b sung",var99:"VaR (99%)",beta:"Beta",calmarRatio:"T l Calmar",sortinoRatio:"T l Sortino",error:{loadFailed:"Khng th ti d liu ch s ri ro"}},Y5={title:"Tm tt NAV",subtitle:"Tng quan gi tr ti sn rng",tooltipContent:{currentNav:"Gi tr ti sn rng hin ti"},navPerUnit:"NAV/n v",navTotal:"NAV Tng",growth:"Tng trng",decline:"Suy gim",investorBenefit:"Li ch mi NT",navPerUnitTooltip:"NAV/Unit = NAV Tng  S n v qu ang lu hnh. Th hin li ch ca mi nh u t.",navPerUnitGrowth:"Tng trng NAV/Unit",navGrowth:"Tng trng NAV",recent:"Gn nht",fromStart:"T u nm",infoNote:" NAV Tng = Tin mt + Gi tr ti sn | NAV/Unit = NAV Tng  S n v qu"},q5={modal:{editTitle:"Chnh sa ti sn",createTitle:"To ti sn mi",updateAsset:"Cp nht ti sn",createAsset:"To ti sn"},selector:{title:"Thm ti sn vo danh mc",subtitle:"Chn ti sn c sn hoc to mi",tabs:{selectExisting:"Chn ti sn c sn",createNew:"To ti sn mi"},search:{label:"Tm kim ti sn",placeholder:"Tm kim theo tn hoc m..."},noAssets:{message:"Khng tm thy ti sn. Hy th to ti sn mi."},createAsset:"To ti sn",add:"Thm",addSelected:"Thm ti sn  chn",error:{createFailed:"Khng th to ti sn"}},autocomplete:{label:"Ti sn",placeholder:"Tm kim ti sn...",loading:"ang ti ti sn...",loadMore:"Ti thm ti sn...",noResults:'Khng tm thy ti sn cho "{{searchTerm}}"',noAssets:"Khng c ti sn no",create:"To",createNew:"To ti sn mi",currentPrice:"Gi hin ti"},form:{fields:{name:"Tn ti sn",symbol:"M ti sn",symbolPlaceholder:"VD: AAPL, HPG",symbolHelper:"M ti sn khng th thay i sau khi to.",symbolFoundInSystem:" M ny c trong h thng v sn sng  s dng",symbolDisabledHelper:"M ti sn khng th thay i sau khi to",type:"Loi ti sn",priceMode:"Cp nht gi",priceModeHelper:"Chn cch qun l gi cho ti sn ny",manualPrice:"Gi hin ti",manualPricePlaceholder:"Nhp gi ti sn",manualPriceHelper:"Gi ny s c s dng thay v t cp nht gi t th trng",currency:"Tin t",currencyHelper:"Hin ti ch h tr VND",description:"M t",descriptionPlaceholder:"M t ty chn cho ti sn"},validation:{nameRequired:"Tn ti sn l bt buc",symbolRequired:"M ti sn l bt buc",symbolInvalidFormat:"M ti sn ch c cha ch ci v s",typeRequired:"Loi ti sn l bt buc",priceModeRequired:"Ch  gi l bt buc",manualPriceRequired:"Gi th cng l bt buc khi chn ch  th cng"},priceMode:{automatic:"T ng",automaticDescription:"H thng t ly gi t th trng v cp nht nh k",manual:"Th cng",manualDescription:"Nhp gi th cng, khng t ng cp nht t th trng",readOnlyInfo:"Ch ngi to ti sn mi c th thay i ch  gi"},loading:{types:"ang ti loi ti sn...",fetchingGlobalAsset:"ang tm kim thng tin ti sn t th trng..."},error:{typesLoadFailed:"Li ti loi ti sn"},warning:{differencesWithGlobalAsset:" Thng tin ti sn khc vi h thng",differencesExplanation:"Thng tin ny c th khc vi h thng. Bn c th cp nht  ng b vi thng tin mi nht."},actions:{syncWithGlobalAsset:"Cp nht t h thng"},info:{computedFields:{title:"Cc trng tnh ton",description:"Gi tr ban u, s lng ban u, gi tr hin ti v s lng hin ti c tnh ton t ng da trn cc giao dch v gi th trng ca bn. Cc trng ny s c cp nht khi bn to giao dch cho ti sn ny."}}},details:{title:"Chi tit ti sn",editTooltip:"Chnh sa ti sn",deleteTooltip:"Xa ti sn",loading:"ang ti...",demo:"Demo",demoDataWarning:"S dng d liu demo - API c th khng kh dng",noPortfolios:"Khng c danh mc lin kt",status:{active:"Hot ng",inactive:"Khng hot ng"},portfolios:{title:"Danh mc",chip:"{{count}} Danh mc"},trading:{title:"Bn ghi giao dch",chip:"{{count}} Giao dch",demoDescription:"Hot ng giao dch demo (API khng kh dng)",realDescription:"Hot ng giao dch thc t cho ti sn ny",foundInPortfolios:"Tm thy trong {{count}} danh mc vi giao dch thc t"},metrics:{currentValue:"Gi tr hin ti",unrealizedPnL:"P&L cha thc hin",pnlPercentage:"Phn trm P&L",quantity:"S lng"},sections:{keyMetrics:"Ch s chnh",financialOverview:"Tng quan ti chnh",priceInformation:"Thng tin gi",positionDetails:"Chi tit v th",performanceAnalytics:"Phn tch hiu sut",assetInformation:"Thng tin ti sn"},price:{currentPrice:"Gi th trng",averageCost:"Gi mua trung bnh",priceChange:"Thay i gi"},position:{totalQuantity:"Tng s lng",costBasis:"C s chi ph",marketValue:"Gi tr th trng"},performance:{daily:"Hng ngy",weekly:"Hng tun",monthly:"Hng thng",yearly:"Hng nm"},metadata:{created:" to",lastUpdated:"Cp nht ln cui",assetId:"ID ti sn"}},delete:{title:"Xa ti sn",titleWithTrades:"Xa ti sn c giao dch",deleting:"ang xa...",delete:"Xa",deleteWithImpact:"Xa ti sn & d liu b nh hng",affectedPortfolios:"Danh mc b nh hng",impactAnalysis:"Phn tch tc ng",impactDescription:'Ti sn "{{assetName}}" ang c s dng trong {{portfolioCount, plural, one {danh mc} other {cc danh mc}}} ca bn vi {{tradeCount}} bn ghi giao dch.',warningMessage:"Xa ti sn ny s nh hng n tnh ton danh mc v d liu lch s.",whatWillBeDeleted:"Nhng g s b xa",theAsset:'Ti sn "{{assetName}}"',tradingRecords:"{{count}} bn ghi giao dch",transactionHistory:"Ton b lch s giao dch lin quan",portfolioCalculations:"Tnh ton hiu sut danh mc s b nh hng",safeToDelete:"An ton  xa",safeDescription:'Ti sn "{{assetName}}" khng c giao dch hoc s dng danh mc lin quan.',safeMessage:"Ti sn ny c th c xa an ton m khng nh hng n d liu danh mc.",noTradeRecords:"Khng c bn ghi giao dch (an ton  xa)",confirmationText:'Ti hiu rng hnh ng ny khng th hon tc v s xa vnh vin ti sn "{{assetName}}" {{tradeCount}} bn ghi giao dch {{portfolioCount}} danh mc.'}},G5={error:{loadFailed:"Khng th ti d liu bo co"},noData:"Khng c d liu",noReportData:"Khng c d liu bo co",title:"Bo co ti chnh",subtitle:"Tng quan ton din v s d tin mt, tin gi v ti sn theo danh mc",portfolioFilter:"Lc danh mc",allPortfolios:"Tt c danh mc",portfoliosSelected:"{{count}} danh mc  chn",cashBalance:{title:"Tng s d tin mt",subtitle:"Thanh khon kh dng",change:"Thanh khon",byFundingSource:"Theo ngun tin"},deposits:{title:"Tng tin gi",subtitle:"{{count}} khon tin gi",change:"Hot ng",byBank:"Theo ngn hng",byTerm:"Theo k hn gi"},assets:{title:"Tng ti sn",subtitle:"{{count}} ti sn",change:"a dng ha",byExchange:"Theo sn giao dch/nn tng",byGroup:"Theo nhm ti sn"},columns:{fundingSource:"Ngun tin",totalAmount:"Tng s tin",share:"T l",bank:"Ngn hng",count:"S lng",value:"Gi tr",term:"K hn",exchange:"Sn giao dch",capitalValue:"Gi tr vn",currentValue:"Gi tr hin ti",assetGroup:"Nhm ti sn",pnl:"P&L"}},K5={title:"Bo co ti sn",subtitle:"Tng quan ti sn hin c",lastUpdated:"Cp nht ln cui",totalValue:"Tng gi tr",totalValueDesc:"Tng ti sn danh mc",totalValueWithInterest:"Tng vn v li",investmentAssets:"Tin u t",deposits:"Tin gi",cashBalance:"Tin mt",ofTotal:"tng ti sn",assetTypes:"Cc loi ti sn",performance:"Hiu sut",diversified:"a dng ha",totalAssets:"Tng ti sn",positions:"v th u t",assetAllocation:"Phn b ti sn theo loi",assetType:"Loi ti sn",value:"Tng gi tr",percentage:"T l",count:"S lng",assetDetails:"Chi tit ti sn",symbol:"M",name:"Tn ti sn",type:"Loi",quantity:"S lng",price:"Gi th trng",unrealizedPl:"Li/L",depositsSummary:"Tng quan tin gi",totalDeposits:"Tng tin gi",depositCount:"S khon gi",depositPercentage:"T l tin gi",depositsDetails:"Chi tit tin gi",depositId:"M tin gi",bankName:"Ngn hng",accountNumber:"S ti khon",principal:"S tin gc",interestRate:"Li sut (%)",status:"Trng thi",startDate:"Ngy bt u",endDate:"Ngy kt thc",growthMetrics:"Ch s tng trng",dailyGrowth:"Hm nay",monthlyGrowth:"Thng ny",ytdGrowth:"T u nm (TWR)",error:{loadFailed:"Khng th ti bo co u t. Vui lng th li sau."}},Q5={title:"Danh mc u t",subtitle:"Tng quan tt c danh mc u t ca bn",loading:"ang ti danh sch portfolio...",detailedReport:"Bo co chi tit",backToList:"Quay li danh sch",clickToView:"Nhn  xem chi tit",owner:"To bi",totalValue:"Tng tin",cash:"Tin mt",investments:"Tin u t",deposits:"Tin gi",performance:"Hiu sut",lastestDaily:"Gn nht",daily:"Hm nay",monthly:"Thng ny",ytd:"T u nm (TWR)",lastUpdated:"Cp nht ln cui",noPortfolios:"Cha c danh mc no",noPortfoliosDesc:"Bn cha c quyn truy cp vo bt k danh mc u t no. Hy xem c phn ca bn hoc lin h vi qun tr vin  c cp quyn.",viewHoldings:"Xem c phn",managePortfolios:"Qun l danh mc",previous:"Trc",next:"Tip",close:"ng",error:{loadFailed:"ang ti d liu ..."}},X5={title:"Qun l ti khon",subtitle:"Qun l ti khon ca bn, to ti khon mi v cp nht thng tin ti khon.",error:{loadFailed:"Khng th ti ti khon",deleteFailed:"Khng th xa ti khon"},confirmDelete:"Bn c chc chn mun xa ti khon ny khng?",copyIdTooltip:"Nhp  sao chp ID ti khon",create:"To",createAccount:"To ti khon",main:"Ti khon chnh",investor:"Nh u t",protectedAccount:"Ti khon c bo v",noAccounts:"Khng tm thy ti khon. To ti khon u tin ca bn  bt u.",moreActions:"Thm hnh ng",deleteConfirm:{title:"Xa ti khon",subtitle:"Hnh ng ny khng th hon tc",message:'Bn c chc chn mun xa ti khon "{{accountName}}" ({{accountEmail}})?',warning:"iu ny s xa vnh vin ti khon v tt c d liu lin quan. Hnh ng ny khng th hon tc.",deleting:"ang xa..."}},J5={switching:"ang chuyn...",switchAccount:"Chuyn ti khon",selectAccount:"Chn ti khon",editCurrentAccount:"Chnh sa ti khon hin ti",loadingAccounts:"ang ti ti khon...",noAccounts:"Khng c ti khon no",mainAccount:"Ti khon chnh",demoAccount:"Ti khon Demo",demoAccountBanner:{title:"Bn ang s dng ti khon Demo",demoMode:"Ch  Demo",message:"Ti khon Demo ch cho php xem d liu (read-only).  c y  quyn chnh sa v qun l, vui lng chuyn sang ti khon chnh ca bn.",switchToMainAccount:"Chuyn sang ti khon chnh",switchToAccount:"Chuyn ti khon",noOtherAccounts:"Lu : Bn cha c ti khon chnh. Vui lng lin h qun tr vin  to ti khon."},demoAccountSuggestion:{title:"Khm ph ti khon Demo",newFeature:"Tnh nng mi",message:"Th nghim h thng vi ti khon Demo  xem cc tnh nng v d liu mu. Ti khon Demo cung cp d liu thc t v cho php bn khm ph h thng mt cch an ton.",tryDemo:"Th Demo"},investor:"Nh u t",protectedAccount:"Ti khon c bo v",updateAccountInfo:"Cp nht thng tin ti khon",manageAccounts:"Qun l ti khon",manageAccountsDescription:"To, chnh sa v qun l tt c ti khon",refreshAccounts:"Lm mi ti khon"},Z5={title:"Ci t",subtitle:"Qun l ci t v ty chn ti khon ca bn",tabs:{accountManagement:"Ti khon",security:"Bo mt",profile:"H s",notifications:"Thng bo",appearance:"Giao din",adminMessages:"Tin nhn qun tr"},security:{title:"Ci t bo mt",subtitle:"Qun l ty chn bo mt v ci t xc thc ca bn.",password:{title:"Mt khu",subtitle:"Thay i mt khu ca bn",description:"Cp nht mt khu  gi ti khon ca bn an ton."},twoFactor:{title:"Xc thc hai yu t",subtitle:"Thm mt lp bo mt b sung",description:"Bt 2FA  bo v ti khon ca bn vi mt lp bo mt b sung."}},notifications:{title:"Ci t thng bo",subtitle:"Cu hnh cch bn nhn thng bo v cnh bo.",email:{title:"Thng bo qua email",subtitle:"Qun l cnh bo email",description:"Chn thng bo email bn mun nhn."},push:{title:"Thng bo y",subtitle:"Thng bo trnh duyt",description:"Kim sot thng bo y ca trnh duyt  cp nht theo thi gian thc."}},appearance:{title:"Ci t giao din",subtitle:"Ty chnh giao din ng dng ca bn.",theme:{title:"Ch ",subtitle:"Chn ch  a thch ca bn",description:"Chuyn i gia ch  sng v ti."},language:{title:"Ngn ng",subtitle:"Chn ngn ng ca bn",description:"Chn ngn ng a thch ca bn cho giao din."}}},eI={error:{createFailed:"Khng th to ti khon. Vui lng th li."},title:"To ti khon mi",creating:"ang to...",create:"To",createAccount:"To ti khon",accountInfoTitle:"Thng tin ti khon",fields:{name:"Tn ch ti khon",nameHelper:"Nhp tn y  ca ch ti khon",email:"a ch email",emailHelper:"a ch ny s c s dng nhn email t h thng",baseCurrency:"Tin t c s",canInvest:"Nh u t",canInvestHelper:"Bt ty chn ny nu l nh u t c nhn ch u t c phn vo cc qu. Trng hp tt ty chn ny, ti khon s hot ng nh nh qun l qu."}},tI={title:"Portfolios",subtitle:"Xem danh sch portfolio",columns:{portfolioName:"Tn Portfolio",portfolioId:"ID Portfolio",createdBy:"Ngi to",createdById:"ID Ngi to",totalValue:"Tng gi tr",createdAt:"Ngy to"},noPortfolios:"Khng tm thy portfolio no trong h thng",error:{loadFailed:"Khng th ti danh sch portfolio"}},nI={portfolioList:{title:"Portfolios",subtitle:"Xem portfolio trong h thng",loading:"ang ti portfolio...",error:"Khng th ti danh sch portfolio",totalPortfolios:"Tng Portfolio",uniqueUsers:"Ngi dng duy nht",totalValue:"Tng gi tr",lastUpdated:"Cp nht ln cui",searchPlaceholder:"Tm kim portfolio hoc ngi dng...",refresh:"Lm mi",noResults:"Khng tm thy portfolio no ph hp vi tm kim",noPortfolios:"Khng tm thy portfolio no trong h thng",table:{portfolioName:"Tn Portfolio",portfolioId:"ID Portfolio",createdBy:"Ngi to",user:"Ngi dng",currency:"Tin t",createdAt:"Ngy to",actions:"Actions"},deletePortfolio:"Xa Portfolio",deleteDialog:{title:"Xa Portfolio",message:'Bn c chc chn mun xa portfolio "{{portfolioName}}"? Hnh ng ny khng th hon tc.'}}},rI={error:{loadUsers:"Khng th ti ngi dng",sendFailed:"Khng th gi tin nhn",noPermission:"Bn khng c quyn truy cp tnh nng ny. Yu cu vai tr qun tr."},validation:{titleAndMessageRequired:"Tiu  v tin nhn l bt buc",selectTarget:'Vui lng chn ngi dng mc tiu, vai tr hoc bt "Gi cho tt c"'},success:{sent:"Tin nhn  gi thnh cng ti {{target}}"},allUsers:"tt c ngi dng",usersCount:"{{count}} ngi dng",title:"Gi tin nhn cho ngi dng",subtitle:"Gi thng bo n ngi dng c th, vai tr hoc tt c ngi dng trong h thng.",messageDetails:{title:"Chi tit tin nhn",titleLabel:"Tiu  tin nhn",titlePlaceholder:"Nhp tiu  tin nhn",contentLabel:"Ni dung tin nhn",contentPlaceholder:"Nhp ni dung tin nhn ca bn",actionUrlLabel:"URL lin kt",actionUrlPlaceholder:"v d: /portfolios, /settings",actionUrlHelper:"Ngi dng c th nhp vo lin kt ny t thng bo",priorityLabel:"u tin"},priority:{low:"Thp",normal:"Bnh thng",high:"Cao"},targetUsers:{title:"Ngi dng mc tiu",sendToAll:"Gi cho tt c ngi dng",selectUsers:"Chn ngi dng",searchUsers:"Tm kim ngi dng...",selectByRole:"Hoc chn theo vai tr",selectRole:"Chn vai tr"},roles:{user:"Ngi dng",admin:"Qun tr vin",superAdmin:"Qun tr vin cp cao"},sending:"ang gi...",send:"Gi",sendMessage:"Gi tin nhn"},sI={title:"Sao lu danh mc",subtitle:"Qun l v xem sao lu danh mc",pageTitle:"Qun l sao lu d liu",pageSubtitle:"Qun l sao lu danh mc, xem biu  hiu sut v xut/nhp d liu",selectPortfolio:"Chn danh mc",selectPortfolioPlaceholder:"Chn danh mc t danh sch  trn  xem sao lu",portfolioDetails:"Chi tit danh mc",totalSnapshots:"Tng s sao lu",latestSnapshot:"Sao lu mi nht",oldestSnapshot:"Sao lu c nht",portfolioInfo:"Thng tin danh mc",noSnapshots:"Khng c sao lu",snapshots:"sao lu",latest:"Mi nht",created:"To",loadingSnapshots:"(ang ti sao lu...)",failedToLoadPortfolios:"Khng th ti danh mc",refreshData:"Lm mi d liu",refreshing:"ang lm mi...",refreshConfirmTitle:"Xc nhn lm mi d liu",refreshConfirm:"Bn c chc chn mun lm mi tt c d liu sao lu?",refreshWarning:"Hnh ng ny s lm mi tt c d liu v c th mt vi giy  hon thnh.",createSnapshots:"To sao lu",recalculateAll:"Tnh li tt c",recalculating:"ang tnh li...",createForAllPortfolios:"To sao lu tt c danh mc",createForMultiplePortfolios:"To sao lu cho nhiu danh mc",selectPortfolios:"Chn danh mc",portfoliosSelected:"danh mc  chn",selectAtLeastOnePortfolio:"Vui lng chn t nht mt danh mc",selectGranularity:"Vui lng chn  chi tit",processing:"ang x l {days} ngy cho {portfolios} danh mc...",deleteSnapshots:"Xa sao lu",moreActions:"Thm hnh ng",refreshDataTooltip:"Lm mi d liu",moreActionsTooltip:"Thm hnh ng",snapshotDeletedSuccess:"Sao lu  c xa thnh cng!",snapshotDeleteFailed:"Khng th xa sao lu. Vui lng th li.",recalculateConfirmTitle:"Xc nhn tnh li sao lu",recalculateConfirm:"Bn c chc chn mun tnh li tt c sao lu cho danh mc ny?",recalculateWarning:"Hnh ng ny s tnh li tt c sao lu hin c v c th mt vi pht  hon thnh.",recalculateSuccess:"Tt c sao lu  c tnh li thnh cng!",recalculateFailed:"Khng th tnh li sao lu. Vui lng th li.",dataRefreshedSuccess:"D liu  c lm mi thnh cng!",dataRefreshError:"Li lm mi d liu",deleteSuccess:"Xa thnh cng",deleteFailed:"Xa tht bi",snapshotCreatedSuccess:"Sao lu  c to thnh cng cho danh mc vo",snapshotCreateFailed:"Khng th to sao lu",tabs:{portfolioSummary:"Tng quan danh mc",portfolioPerformance:"Hiu sut danh mc",assetGroupPerformance:"Hiu sut nhm ti sn",assetPerformance:"Hiu sut ti sn",assetSnapshots:"Sao lu ti sn"},modals:{createSnapshot:{title:"To sao lu cho tt c ti sn",selectPortfolio:"Chn danh mc",dateRangeMode:"Ch  khong ngy",singleDateMode:"Ch  ngy n",dateRangeModeDescription:"To sao lu cho nhiu ngy",singleDateModeDescription:"To sao lu cho mt ngy",snapshotDate:"Ngy sao lu",startDate:"Ngy bt u",endDate:"Ngy kt thc",selectDate:"Chn ngy cho sao lu",startDateHelper:"Ngy bt u cho khong sao lu",endDateHelper:"Ngy kt thc cho khong sao lu",granularity:" chi tit",daily:"Hng ngy",weekly:"Hng tun",monthly:"Hng thng",create:"To",creating:"ang to...",cancel:"Hy",createSnapshot:"To sao lu",created:"Mi nht",selectPortfolioAndGranularity:"Vui lng chn danh mc v  chi tit",selectStartDate:"Vui lng chn ngy bt u",selectEndDate:"Vui lng chn ngy kt thc",startDateBeforeEndDate:"Ngy bt u phi trc ngy kt thc",startDateNotFuture:"Ngy bt u khng th l tng lai",processingDays:"ang x l {{days}} ngy sao lu... iu ny c th mt vi pht.",successCreated:" to thnh cng {{count}} sao lu cho {{portfolioName}}",noSnapshotsCreated:"Khng c sao lu no c to cho danh mc {{portfolioName}}.",errorCreating:"Li {{status}}: {{message}}",failedToLoadPortfolios:"Khng th ti danh mc",createForMultiplePortfolios:"To sao lu cho nhiu danh mc",useDateRange:"S dng khong ngy",selectPortfolios:"Chn danh mc",portfoliosSelected:"danh mc  chn",selectAtLeastOnePortfolio:"Vui lng chn t nht mt danh mc",selectGranularity:"Vui lng chn  chi tit",loadingPortfolios:"ang ti danh mc...",processing:"ang x l {days} ngy cho {portfolios} danh mc...",lastSnapshot:"Sao lu cui cng",noSnapshots:"Cha c sao lu",totalSnapshots:"Tng sao lu"},deleteSnapshots:{title:"Xa sao lu",deleteMode:"Ch  xa",specificDate:"Ngy c th",dateRange:"Khong ngy",byGranularity:"Theo  chi tit",specificDateDescription:"Xa tt c sao lu cho mt ngy c th",dateRangeDescription:"Xa tt c sao lu trong khong ngy",granularityDescription:"Xa tt c sao lu ca  chi tit c th (hng ngy/hng tun/hng thng)",granularity:" chi tit",daily:"Hng ngy",weekly:"Hng tun",monthly:"Hng thng",snapshotDate:"Ngy sao lu",startDate:"Ngy bt u",endDate:"Ngy kt thc",selectDate:"Chn ngy  xa sao lu",startDateHelper:"Ngy bt u cho khong xa",endDateHelper:"Ngy kt thc cho khong xa",warning:"Cnh bo: Hnh ng ny khng th hon tc!",warningDescription:"Tt c sao lu  chn s b xa vnh vin khi c s d liu.",delete:"Xa",deleting:"ang xa...",cancel:"Hy",deleteSnapshots:"Xa sao lu",portfolioIdRequired:"ID danh mc l bt buc",selectSnapshotDate:"Vui lng chn ngy sao lu",selectBothDates:"Vui lng chn c ngy bt u v ngy kt thc",startDateBeforeEndDate:"Ngy bt u phi trc ngy kt thc",invalidDeleteMode:"Ch  xa khng hp l",successDeleted:" xa thnh cng {{count}} sao lu",errorDeleting:"Li {{status}}: {{message}}",failedToDelete:"Khng th xa sao lu"}}},aI={error:{updateFailed:"Khng th cp nht ti khon. Vui lng th li."},title:"Chnh sa thng tin ti khon",updating:"ang cp nht...",update:"Cp nht",updateAccount:"Cp nht ti khon",fields:{name:"Tn ch ti khon",nameHelper:"Nhp tn y  ca ch ti khon",email:"a ch email",emailHelper:"a ch ny s c s dng nhn email t h thng",baseCurrency:"Tin t c s",canInvest:"Nh u t",canInvestHelper:"Bt ty chn ny nu l nh u t c nhn ch u t c phn vo cc qu. Trng hp tt ty chn ny, ti khon s hot ng nh nh qun l qu."}},iI={title:"Chn mu danh mc",searchPlaceholder:"Tm kim mu danh mc...",noDescription:"Khng c m t",createdBy:"To bi: {{name}}",tradesCount:"{{count}} giao dch",tradesCount_other:"{{count}} giao dch",cashFlowsCount:"{{count}} dng tin",cashFlowsCount_other:"{{count}} dng tin",depositsCount:"{{count}} tin gi",depositsCount_other:"{{count}} tin gi",noSearchResults:"Khng c danh mc no ph hp vi tm kim",noPortfolios:"Khng c danh mc cng khai no",error:{loadFailed:"Khng th ti danh mc cng khai"}},oI={title:"Chn Assets t h thng",help:{title:" Hng dn s dng",description:"Chn cc assets t danh sch mu  to nhanh trong portfolio ca bn. Danh sch ch hin th cc assets m bn cha s hu. Bn cng c th tm kim theo tn hoc symbol."},search:{label:"Tm kim assets",placeholder:"Nhp tn hoc symbol..."},type:{label:"Loi Asset",all:"Tt c"},select:{selectAll:"Chn tt c",deselectAll:"B chn"},creating:"ang to...",createCount:"To {{count}}",createAssets:"To {{count}} Assets",results:{found:"Tm thy {{count}} assets cha c trong danh sch ca bn"},noAssets:{allOwned:"Bn  c tt c assets c sn trong h thng",noSearchResults:"Khng tm thy assets ph hp vi iu kin tm kim"},success:{allCreated:" To thnh cng {{count}} assets",partialCreated:" To thnh cng {{created}}/{{total}} assets. {{failed}} assets tht bi."},error:{loadFailed:"Li khi ti danh sch assets",createFailed:" Li khi to assets",allFailed:" To tht bi tt c {{count}} assets"}},lI={title:"MMOTION",subtitle:{enterUsername:"Nn tng qun l ton din a ti sn",welcomeBack:"Nhp tn ngi dng  tip tc (khng cn mt khu)",signIn:"Nhp tn ngi dng v mt khu  ng nhp",continue:"Nhp tn ngi dng  tip tc (khng cn mt khu)"},form:{username:"Tn ngi dng",password:"Mt khu",usernamePlaceholder:"Nhp tn ngi dng",passwordPlaceholder:"Nhp mt khu  tip tc",usernameHelper:"Nhp tn ngi dng",passwordHelper:"Nhp mt khu  tip tc",passwordHelperError:"Vui lng nhp mt khu chnh xc"},buttons:{enterUsername:"ng nhp",welcomeBack:"Cho Mng Tr Li",signIn:"ng Nhp",continue:"Tip Tc",signingIn:"ang ng nhp...",backToWelcome:"Quay Li Trang Cho Mng",hide:"n",show:"Hin",forgetPassword:"Qun mt khu?"},messages:{welcomeBack:"Cho mng tr li, {{username}}",enterPassword:"Nhp mt khu  tip tc",userHasPassword:"Ngi dng ny  c mt khu - vui lng nhp mt khu  tip tc",userIncomplete:"Ngi dng ny c h s cha hon chnh - khng cn mt khu",easyStart:"Ch cn nhp tn - bt u d dng, bo mt tuyt i, s dng linh hot.",usernameRequired:"Vui lng nhp tn ngi dng",passwordRequired:"Mt khu l bt buc cho ngi dng ny",incorrectPassword:"Mt khu khng chnh xc. Vui lng th li.",loginFailed:"ng nhp tht bi. Vui lng th li.",usernameFormat:"Tn ngi dng ch bao gm ch, s, du gch ngang (-) v gch di (_)",newUserWelcome:" Cho mng n vi MMOTION! Nhp vo y  bt u vi hng dn ca chng ti.",newUserWelcomeTitle:"Cho mng n vi MMOTION!",newUserWelcomeMessage:"Bn  sn sng! Hy cng tham quan nhanh  gip bn bt u qun l cc khon u t ca mnh."},history:{title:"ng Nhp Nhanh",secure:"Bo mt",removeUser:"Xa ngi dng khi lch s"},errors:{loginFailed:"ng nhp tht bi. Vui lng th li.",incorrectPassword:"Mt khu khng chnh xc. Vui lng th li.",usernameFormat:"Tn ngi dng ch c cha ch ci, s, du gch ngang (-) v gch di (_)",usernameRequired:"Vui lng nhp tn ngi dng",passwordRequired:"Mt khu l bt buc cho ngi dng ny"}},cI={title:"XEM NHANH V NN TNG",subtitle:"Nn tng qun l ton din a ti sn vi phn tch v bo co nng cao",buttons:{getStarted:"Bt u",viewDashboard:"Xem Tng quan"},features:{title:"Tnh nng chnh",portfolio:{title:"Qun l Danh mc",description:"To v qun l nhiu danh mc vi theo di hiu sut",feature1:"H tr a danh mc",feature2:"Theo di hiu sut thi gian thc",feature3:"Trc quan ha phn b ti sn",feature4:"Phn tch hiu sut lch s"},trading:{title:"Qun l Giao dch",description:"Cng c qun l nng cao v qun l ri ro",feature1:"Khp lnh FIFO/LIFO",feature2:"Qun l v th",feature3:"Cng c qun l ri ro",feature4:"Thit lp ct l v cht li"},analytics:{title:"Phn tch & Bo co",description:"Phn tch ton din vi TWR, IRR v cc ch s ri ro",feature1:"Phn tch hiu sut (TWR, IRR)",feature2:"Ch s ri ro (Sharpe ratio, VaR)",feature3:"Biu  tng tc",feature4:"So snh vi benchmark"},assets:{title:"Qun l Ti sn",description:"Qun l a dng ti sn vi d liu th trng thc",feature1:"H tr nhiu loi ti sn",feature2:"D liu th trng thi gian thc",feature3:"Theo di lch s gi",feature4:"Phn tch hiu sut ti sn"},deposits:{title:"Qun l Tin gi",description:"Theo di tin gi ngn hng vi tnh ton li sut",feature1:"Theo di tin gi ngn hng",feature2:"Tnh ton li sut",feature3:"H tr tt ton sm",feature4:"Qun l dng tin"},funds:{title:"Qun l Qu",description:"Qun l qu chuyn nghip vi theo di NAV/n v",feature1:"Qun l NAV/n v",feature2:"C phn nh u t",feature3:"ng k/Mua li",feature4:"Theo di hiu sut qu"}},quickStart:{title:"Hng dn Bt u Nhanh",step1:{title:"To Danh mc u tin",description:"Bt u bng cch to danh mc  theo di cc khon u t",action:"To Danh mc"},step2:{title:"Thm Giao dch u tin",description:"Ghi li cc giao dch u t v theo di v th",action:"Thm Giao dch"},step3:{title:"Qun l Ti sn",description:"Thm v qun l ti sn u t vi gi thi gian thc",action:"Qun l Ti sn"},step4:{title:"Xem Phn tch",description:"Phn tch hiu sut danh mc v a ra quyt nh sng sut",action:"Xem Phn tch"}},capabilities:{title:"Kh nng H thng",realTime:"Cp nht D liu Thi gian thc",analytics:"Phn tch Nng cao",multiAccount:"Qun l nhiu ti khon",mobile:"Tng thch Di ng",secure:"Bo mt & ng tin cy",scalable:"Kin trc M rng"},footer:{message:"Sn sng bt u qun l danh mc u t?",dashboard:"Tng quan",portfolios:"Danh mc"},quickStartGuide:{subtitle:"Lm theo cc bc n gin ny  bt u vi qun l danh mc ca bn",progress:{step:"Bc {{current}} trong {{total}}",complete:"{{percentage}}% Hon thnh"},navigation:{previous:"Trc",next:"Tip theo"},completion:{title:"Chc mng! ",message:"Bn  hon thnh tt c cc bc thit lp. H thng qun l danh mc ca bn  sn sng s dng!"},steps:{currentStep:"Bc hin ti",clickToContinue:"Nhp  tip tc",createPortfolio:{title:"To Danh mc u tin",description:"Bt u bng cch to danh mc mi  t chc cc khon u t ca bn. y s l khng gian lm vic chnh  theo di hiu sut v qun l ti sn.",action:"To Danh mc"},addCashFlow:{title:"Thm Ngun Tin",description:"Thit lp ngun tin ban u  ti tr cho danh mc ca bn. y c th l lng, tit kim hoc cc ngun thu nhp khc.",action:"Thm Ngun Tin"},addTrade:{title:"Thm Giao dch u tin",description:"Ghi li giao dch mua hoc bn u tin ca bn. H thng s t ng tnh ton v th v theo di hiu sut ca bn.",action:"Bt u Giao dch"},manageAssets:{title:"Qun l Ti sn",description:"Thm v t chc cc ti sn u t ca bn. Theo di c phiu, tri phiu, vng, tin gi v cc cng c u t khc.",action:"Qun l Ti sn"},viewDashboard:{title:"Xem Bng iu khin",description:"Theo di hiu sut danh mc ca bn vi phn tch thi gian thc, biu  v cng c bo co ton din.",action:"Xem Bng iu khin"}}},examples:{title:"D liu v Biu ",subtitle:"Xem trc cc tnh nng phn tch v bo co ca h thng",portfolioTable:{title:"Bng Danh mc",description:"Theo di nhiu danh mc u t vi gi tr tng v hiu sut",columns:{name:"Tn",currency:"Tin t",totalValue:"Tng gi tr",return:"Li nhun"}},tradingTable:{title:"Bng Giao dch",description:"Qun l cc giao dch mua/bn vi theo di chi tit",columns:{symbol:"M",side:"Loi",quantity:"S lng",price:"Gi",total:"Tng"}},allocationChart:{title:"Biu  Phn b Ti sn",description:"Trc quan ha phn b danh mc theo loi ti sn",allocation:"Phn b"},performanceChart:{title:"Biu  Hiu sut",description:"Theo di hiu sut danh mc theo thi gian",return:"Li nhun"}}},dI={title:"Qun l Quyn Truy cp Danh mc",addNewPermission:"Thm Quyn Mi",accountId:"ID Ti khon",accountIdPlaceholder:"Nhp ID ti khon (nh dng UUID)",permission:"Quyn",addPermission:"Thm Quyn",currentPermissions:"Quyn Hin ti",account:"Ti khon",granted:"c cp",actions:"Thao tc",removePermission:"Xa Quyn",transferCreator:"Chuyn Ngi to Danh mc",transferCreatorWarning:"CNH BO: Hnh ng quan trng!",transferCreatorWarningMessage:"Bn ang chuyn quyn s hu danh mc cho ngi khc. Sau khi chuyn, bn s mt quyn s hu v khng cn thy danh mc ny. Hnh ng ny khng th hon tc!",transferCreatorSuccess:" chuyn quyn s hu danh mc thnh cng!",deleteSuccess:" xa quyn truy cp thnh cng!",confirmRemove:"Xc nhn xa quyn truy cp",confirmRemoveDescription:"Bn c chc chn mun xa quyn truy cp ny khng? Hnh ng ny khng th hon tc.",noPermissions:"Cha c quyn no c thit lp cho danh mc ny",noPermissionsDescription:"Thm ti khon  chia s quyn truy cp danh mc ny",permissionTypes:{owner:"Ch s hu",update:"Chnh sa",view:"Ch xem",creator:"Ngi to"},errors:{loadFailed:"Khng th ti quyn",addFailed:"Khng th thm quyn",deleteFailed:"Khng th xa quyn",transferCreatorFailed:"Khng th chuyn quyn s hu danh mc"}},uI={title:"Thit b ng tin cy",subtitle:"Qun l cc thit b c th truy cp ti khon m khng cn mt khu",stats:{totalDevices:"Tng thit b",activeDevices:"Thit b hot ng",expiredDevices:"Thit b ht hn",highTrust:" tin cy cao"},noDevices:{title:"Khng c thit b ng tin cy",subtitle:"Thit b s c t ng thm khi bn ng nhp"},device:{lastUsed:"Ln cui s dng",expired:"Ht hn",revoke:"Thu hi thit b",revokeAll:"Xa tt c thit b",refresh:"Lm mi"},dialogs:{revokeDevice:{title:"Thu hi thit b",message:"Bn c chc chn mun thu hi thit b ny? Bn s cn nhp mt khu ln sau khi ng nhp t thit b ny.",cancel:"Hy",confirm:"Thu hi"},revokeAll:{title:"Thu hi tt c thit b",warning:"iu ny s thu hi tt c thit b ng tin cy. Bn s cn nhp mt khu ln sau khi ng nhp t bt k thit b no.",message:"Bn c chc chn mun thu hi tt c {{count}} thit b?",cancel:"Hy",confirm:"Thu hi tt c",revoking:"ang thu hi..."}},errors:{loadFailed:"Khng th ti d liu thit b",revokeFailed:"Khng th thu hi thit b",revokeAllFailed:"Khng th thu hi tt c thit b"}},hI={title:"Qun mt khu",subtitle:"Nhp email ca bn  nhn mt khu mi",emailLabel:"Email",submitButton:"Gi yu cu",backToLogin:"Quay li ng nhp",contactAdmin:{title:"Lin h Admin",description:"Nu bn qun mt khu, vui lng lin h admin  c h tr",button:"Lin h Admin",modal:{title:"Lin h Admin",description:"Tnh nng ang pht trin. Vui lng lin h qua email bn di  c h tr nhanh nht.",contactInfo:"Thng tin lin h:",messageLabel:"Tin nhn",messagePlaceholder:"M t chi tit vn  ca bn...",cancel:"Hy",send:"Gi tin nhn",sending:"ang gi...",success:"Tin nhn  c gi thnh cng! Admin s lin h li sm nht c th."}},globalAsset:{priceMode:{automatic:"T ng",manual:"Th cng",automaticDescription:"T ng ly gi t th trng",manualDescription:"Ch nhp gi th cng"}},errors:{emailRequired:"Vui lng nhp email",invalidEmail:"Email khng hp l",submitFailed:"Gi yu cu tht bi"}},mI={title:"MMOTION",subtitle:"Nn tng qun l ton din ti sn ca bn",sections:{assetTypes:{title:"a Dng Ti Sn",subtitle:"a dng cc loi ti sn  a dng ha danh mc u t"},stockFunds:{title:"Chng Ch Qu C Phiu",subtitle:"Cc qu u t vo c phiu"},bondFunds:{title:"Chng Ch Qu Tri Phiu",subtitle:"Cc qu u t vo tri phiu"},topStocks:{title:"Top C Phiu",subtitle:"Nhng c phiu c khi lng giao dch ln"}},assetTypes:{stock:"C phiu",stockDesc:"u t vo c phiu trn cc sn giao dch",bond:"Tri phiu",bondDesc:"u t vo tri phiu chnh ph v doanh nghip",gold:"Vng",goldDesc:"u t vo vng v kim loi qu",crypto:"Tin in t",cryptoDesc:"u t vo tin in t v ti sn s",commodity:"Hng ha",commodityDesc:"u t vo hng ha v nguyn liu",realEstate:"Bt ng sn",realEstateDesc:"u t vo bt ng sn v REIT",other:"Khc",otherDesc:"Cc loi ti sn khc"},table:{symbol:"M",name:"Tn",price:"Gi NAV",change:"Thay i",exchange:"Sn"},noData:"Khng c d liu",cta:{title:"Sn sng bt u qun l danh mc u t ca bn?",description:"ng nhp hoc ng k ngay  tri nghim y  cc tnh nng qun l danh mc u t chuyn nghip",button:"Bt u ngay min ph"},stats:{products:"Sn phm qu",users:"Ngi dng",portfolios:"Danh mc u t"},projectName:"MMO",menu:{home:"Trang ch",features:"Tnh nng","features.portfolio":"Qun l danh mc","features.tracking":"Theo di hng ngy","features.security":"Bo mt",contact:"Lin h"},register:{short:"ng k",full:"ng k"},login:{short:"Bt u",full:"Bt u ngay"},features:{title:"Tnh nng ni bt",subtitle:"Cng c mnh m cho qun l u t hiu qu"},trust:{title:"u t an ton v minh bch",subtitle:"H thng qun l danh mc u t chuyn nghip vi  bo mt cao",safe:{title:"An ton tuyt i",description:"Tin v ti sn c qun l v gim st cht ch"},transparent:{title:"Minh bch",description:"Theo di v qun l ti sn mt cch minh bch"},professional:{title:"Chuyn nghip",description:"H thng qun l danh mc u t chuyn nghip"}},steps:{badge:"Hng dn",title:"Bt u ngay ch vi 3 bc",subtitle:"u t cha bao gi d dng hn. Bt u hnh trnh u t ca bn ngay hm nay",register:{title:"ng nhp",description:"ng nhp vo h thng  bt u s dng"},invest:{title:"To mc tiu u t",description:"To mc tiu u t theo mc tiu u t ca bn"},manage:{title:"Qun l ti sn",description:"Theo di ti sn thun tin v giao dch d dng"}},vision:{title:"Bin mc tiu ca bn thnh hin thc",easyManagement:"Qun l d dng",free:"Hon ton min ph"}},xI={common:j5,dataDisplay:v5,goals:w5,navigation:S5,portfolio:T5,trading:C5,assets:k5,language:P5,dashboard:D5,profile:A5,forms:I5,tables:R5,notifications:M5,validation:N5,errors:L5,holdings:E5,nav:W5,deposit:F5,cashflow:z5,genericForm:O5,portfolioError:V5,navHistory:$5,benchmark:H5,mwrBenchmark:B5,tradeAnalysis:U5,riskMetrics:_5,navSummary:Y5,asset:q5,report:G5,investorReport:K5,investorView:Q5,accountManagement:X5,accountSwitcher:J5,settings:Z5,createAccountModal:eI,adminPortfolioList:tI,admin:nI,adminMessage:rI,snapshots:sI,editAccountModal:aI,publicPortfolioSelector:iI,bulkAssetSelector:oI,login:lI,welcome:cI,permissions:dI,deviceManagement:uI,forgetPassword:hI,home:mI},pI={en:{translation:b5},vi:{translation:xI}};Bn.use(Lx).use(nf).init({resources:pI,lng:"vi",fallbackLng:"vi",debug:!1,interpolation:{escapeValue:!1},returnObjects:!0,detection:{order:["localStorage","navigator","htmlTag"],caches:["localStorage"]}});const gI=zl.createRoot(document.getElementById("root"));gI.render(e.jsx(rt.StrictMode,{children:e.jsx(cA,{})}));
//# sourceMappingURL=index-D55qHQXi.js.map
